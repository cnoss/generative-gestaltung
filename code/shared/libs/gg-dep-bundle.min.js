!function(){
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var saveAs=saveAs||function(view){"use strict";if(!(void 0===view||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var doc=view.document,get_URL=function(){return view.URL||view.webkitURL||view},save_link=doc.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,click=function(node){var event=new MouseEvent("click");node.dispatchEvent(event)},is_safari=/constructor/i.test(view.HTMLElement)||view.safari,is_chrome_ios=/CriOS\/[\d]+/.test(navigator.userAgent),throw_outside=function(ex){(view.setImmediate||view.setTimeout)((function(){throw ex}),0)},force_saveable_type="application/octet-stream",arbitrary_revoke_timeout=4e4,revoke=function(file){var revoker;setTimeout((function(){"string"==typeof file?get_URL().revokeObjectURL(file):file.remove()}),4e4)},dispatch=function(filesaver,event_types,event){for(var i=(event_types=[].concat(event_types)).length;i--;){var listener=filesaver["on"+event_types[i]];if("function"==typeof listener)try{listener.call(filesaver,event||filesaver)}catch(ex){throw_outside(ex)}}},auto_bom=function(blob){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)?new Blob([String.fromCharCode(65279),blob],{type:blob.type}):blob},FileSaver=function(blob,name,no_auto_bom){no_auto_bom||(blob=auto_bom(blob));var filesaver=this,type,force=blob.type===force_saveable_type,object_url,dispatch_all=function(){dispatch(filesaver,"writestart progress write writeend".split(" "))},fs_error=function(){if((is_chrome_ios||force&&is_safari)&&view.FileReader){var reader=new FileReader;return reader.onloadend=function(){var url=is_chrome_ios?reader.result:reader.result.replace(/^data:[^;]*;/,"data:attachment/file;"),popup;view.open(url,"_blank")||(view.location.href=url),url=void 0,filesaver.readyState=filesaver.DONE,dispatch_all()},reader.readAsDataURL(blob),void(filesaver.readyState=filesaver.INIT)}var opened;(object_url||(object_url=get_URL().createObjectURL(blob)),force)?view.location.href=object_url:view.open(object_url,"_blank")||(view.location.href=object_url);filesaver.readyState=filesaver.DONE,dispatch_all(),revoke(object_url)};if(filesaver.readyState=filesaver.INIT,can_use_save_link)return object_url=get_URL().createObjectURL(blob),void setTimeout((function(){save_link.href=object_url,save_link.download=name,click(save_link),dispatch_all(),revoke(object_url),filesaver.readyState=filesaver.DONE}));fs_error()},FS_proto=FileSaver.prototype,saveAs=function(blob,name,no_auto_bom){return new FileSaver(blob,name||blob.name||"download",no_auto_bom)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(blob,name,no_auto_bom){return name=name||blob.name||"download",no_auto_bom||(blob=auto_bom(blob)),navigator.msSaveOrOpenBlob(blob,name)}:(FS_proto.abort=function(){},FS_proto.readyState=FS_proto.INIT=0,FS_proto.WRITING=1,FS_proto.DONE=2,FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null,saveAs)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",(function(){return saveAs}))}(),function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;(g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).g=f()}}((function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){var n=t[o][1][e];return s(n||e)}),l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){(function(process,global){!function(global,factory){factory("object"==typeof exports&&void 0!==module?exports:global.async=global.async||{})}(this,(function(exports){"use strict";function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}var nativeMax=Math.max;function overRest$1(func,start,transform){return start=nativeMax(void 0===start?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];index=-1;for(var otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=transform(array),apply(func,this,otherArgs)}}function identity(value){return value}function rest(func,start){return overRest$1(func,start,identity)}var initialParams=function(fn){return rest((function(args){var callback=args.pop();fn.call(this,args,callback)}))};function applyEach$1(eachfn){return rest((function(fns,args){var go=initialParams((function(args,callback){var that=this;return eachfn(fns,(function(fn,cb){fn.apply(that,args.concat([cb]))}),callback)}));return args.length?go.apply(this,args):go}))}var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root.Symbol,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(value){var isOwn=hasOwnProperty.call(value,symToStringTag$1),tag=value[symToStringTag$1];try{value[symToStringTag$1]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag$1]=tag:delete value[symToStringTag$1]),result}var objectProto$1,nativeObjectToString$1=Object.prototype.toString;function objectToString(value){return nativeObjectToString$1.call(value)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(value){return null==value?void 0===value?undefinedTag:nullTag:(value=Object(value),symToStringTag&&symToStringTag in value?getRawTag(value):objectToString(value))}function isObject(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)}var asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return tag==funcTag||tag==genTag||tag==asyncTag||tag==proxyTag}var MAX_SAFE_INTEGER=9007199254740991;function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function noop(){}function once(fn){return function(){if(null!==fn){var callFn=fn;fn=null,callFn.apply(this,arguments)}}}var iteratorSymbol="function"==typeof Symbol&&Symbol.iterator,getIterator=function(coll){return iteratorSymbol&&coll[iteratorSymbol]&&coll[iteratorSymbol]()};function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}function isObjectLike(value){return null!=value&&"object"==typeof value}var argsTag="[object Arguments]";function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag}var objectProto$3=Object.prototype,hasOwnProperty$2=objectProto$3.hasOwnProperty,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty$2.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")},isArray=Array.isArray;function stubFalse(){return!1}var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports,Buffer=freeModule&&freeModule.exports===freeExports?root.Buffer:void 0,nativeIsBuffer,isBuffer=(Buffer?Buffer.isBuffer:void 0)||stubFalse,MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(value,length){return!!(length=null==length?9007199254740991:length)&&("number"==typeof value||reIsUint.test(value))&&value>-1&&value%1==0&&value<length}var argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag,float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}function baseUnary(func){return function(value){return func(value)}}typedArrayTags["[object Float32Array]"]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$1,freeProcess=freeModule$1&&freeModule$1.exports===freeExports$1&&freeGlobal.process,nodeUtil=function(){try{return freeProcess&&freeProcess.binding("util")}catch(e){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$2,hasOwnProperty$1=Object.prototype.hasOwnProperty;function arrayLikeKeys(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty$1.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}var objectProto$5=Object.prototype;function isPrototype(value){var Ctor=value&&value.constructor,proto;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto$5)}function overArg(func,transform){return function(arg){return func(transform(arg))}}var nativeKeys=overArg(Object.keys,Object),objectProto$4,hasOwnProperty$3=Object.prototype.hasOwnProperty;function baseKeys(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty$3.call(object,key)&&"constructor"!=key&&result.push(key);return result}function keys(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function createArrayIterator(coll){var i=-1,len=coll.length;return function next(){return++i<len?{value:coll[i],key:i}:null}}function createES2015Iterator(iterator){var i=-1;return function next(){var item=iterator.next();return item.done?null:(i++,{value:item.value,key:i})}}function createObjectIterator(obj){var okeys=keys(obj),i=-1,len=okeys.length;return function next(){var key=okeys[++i];return i<len?{value:obj[key],key:key}:null}}function iterator(coll){if(isArrayLike(coll))return createArrayIterator(coll);var iterator=getIterator(coll);return iterator?createES2015Iterator(iterator):createObjectIterator(coll)}function onlyOnce(fn){return function(){if(null===fn)throw new Error("Callback was already called.");var callFn=fn;fn=null,callFn.apply(this,arguments)}}var breakLoop={};function _eachOfLimit(limit){return function(obj,iteratee,callback){if(callback=once(callback||noop),limit<=0||!obj)return callback(null);var nextElem=iterator(obj),done=!1,running=0;function iterateeCallback(err,value){if(running-=1,err)done=!0,callback(err);else{if(value===breakLoop||done&&running<=0)return done=!0,callback(null);replenish()}}function replenish(){for(;running<limit&&!done;){var elem=nextElem();if(null===elem)return done=!0,void(running<=0&&callback(null));running+=1,iteratee(elem.value,elem.key,onlyOnce(iterateeCallback))}}replenish()}}function eachOfLimit(coll,limit,iteratee,callback){_eachOfLimit(limit)(coll,iteratee,callback)}function doLimit(fn,limit){return function(iterable,iteratee,callback){return fn(iterable,limit,iteratee,callback)}}function eachOfArrayLike(coll,iteratee,callback){callback=once(callback||noop);var index=0,completed=0,length=coll.length;function iteratorCallback(err){err?callback(err):++completed===length&&callback(null)}for(0===length&&callback(null);index<length;index++)iteratee(coll[index],index,onlyOnce(iteratorCallback))}var eachOfGeneric=doLimit(eachOfLimit,1/0),eachOf=function(coll,iteratee,callback){var eachOfImplementation;(isArrayLike(coll)?eachOfArrayLike:eachOfGeneric)(coll,iteratee,callback)};function doParallel(fn){return function(obj,iteratee,callback){return fn(eachOf,obj,iteratee,callback)}}function _asyncMap(eachfn,arr,iteratee,callback){callback=callback||noop;var results=[],counter=0;eachfn(arr=arr||[],(function(value,_,callback){var index=counter++;iteratee(value,(function(err,v){results[index]=v,callback(err)}))}),(function(err){callback(err,results)}))}var map=doParallel(_asyncMap),applyEach=applyEach$1(map);function doParallelLimit(fn){return function(obj,limit,iteratee,callback){return fn(_eachOfLimit(limit),obj,iteratee,callback)}}var mapLimit=doParallelLimit(_asyncMap),mapSeries=doLimit(mapLimit,1),applyEachSeries=applyEach$1(mapSeries),apply$2=rest((function(fn,args){return rest((function(callArgs){return fn.apply(null,args.concat(callArgs))}))}));function asyncify(func){return initialParams((function(args,callback){var result;try{result=func.apply(this,args)}catch(e){return callback(e)}isObject(result)&&"function"==typeof result.then?result.then((function(value){callback(null,value)}),(function(err){callback(err.message?err:new Error(err))})):callback(null,result)}))}function arrayEach(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););return array}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}var baseFor=createBaseFor();function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys)}function baseFindIndex(array,predicate,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?1:-1);fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}function baseIsNaN(value){return value!=value}function strictIndexOf(array,value,fromIndex){for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}function baseIndexOf(array,value,fromIndex){return value==value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}var auto=function(tasks,concurrency,callback){"function"==typeof concurrency&&(callback=concurrency,concurrency=null),callback=once(callback||noop);var keys$$1,numTasks=keys(tasks).length;if(!numTasks)return callback(null);concurrency||(concurrency=numTasks);var results={},runningTasks=0,hasError=!1,listeners={},readyTasks=[],readyToCheck=[],uncheckedDependencies={};function enqueueTask(key,task){readyTasks.push((function(){runTask(key,task)}))}function processQueue(){if(0===readyTasks.length&&0===runningTasks)return callback(null,results);for(;readyTasks.length&&runningTasks<concurrency;){var run;readyTasks.shift()()}}function addListener(taskName,fn){var taskListeners=listeners[taskName];taskListeners||(taskListeners=listeners[taskName]=[]),taskListeners.push(fn)}function taskComplete(taskName){var taskListeners;arrayEach(listeners[taskName]||[],(function(fn){fn()})),processQueue()}function runTask(key,task){if(!hasError){var taskCallback=onlyOnce(rest((function(err,args){if(runningTasks--,args.length<=1&&(args=args[0]),err){var safeResults={};baseForOwn(results,(function(val,rkey){safeResults[rkey]=val})),safeResults[key]=args,hasError=!0,listeners=[],callback(err,safeResults)}else results[key]=args,taskComplete(key)})));runningTasks++;var taskFn=task[task.length-1];task.length>1?taskFn(results,taskCallback):taskFn(taskCallback)}}function checkForDeadlocks(){for(var currentTask,counter=0;readyToCheck.length;)counter++,arrayEach(getDependents(currentTask=readyToCheck.pop()),(function(dependent){0==--uncheckedDependencies[dependent]&&readyToCheck.push(dependent)}));if(counter!==numTasks)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function getDependents(taskName){var result=[];return baseForOwn(tasks,(function(task,key){isArray(task)&&baseIndexOf(task,taskName,0)>=0&&result.push(key)})),result}baseForOwn(tasks,(function(task,key){if(!isArray(task))return enqueueTask(key,[task]),void readyToCheck.push(key);var dependencies=task.slice(0,task.length-1),remainingDependencies=dependencies.length;if(0===remainingDependencies)return enqueueTask(key,task),void readyToCheck.push(key);uncheckedDependencies[key]=remainingDependencies,arrayEach(dependencies,(function(dependencyName){if(!tasks[dependencyName])throw new Error("async.auto task `"+key+"` has a non-existent dependency in "+dependencies.join(", "));addListener(dependencyName,(function(){0==--remainingDependencies&&enqueueTask(key,task)}))}))})),checkForDeadlocks(),processQueue()};function arrayMap(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}var symbolTag="[object Symbol]";function isSymbol(value){return"symbol"==typeof value||isObjectLike(value)&&baseGetTag(value)==symbolTag}var INFINITY=1/0,symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return arrayMap(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}function baseSlice(array,start,end){var index=-1,length=array.length;start<0&&(start=-start>length?0:length+start),(end=end>length?length:end)<0&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}function castSlice(array,start,end){var length=array.length;return end=void 0===end?length:end,!start&&end>=length?array:baseSlice(array,start,end)}function charsEndIndex(strSymbols,chrSymbols){for(var index=strSymbols.length;index--&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1;);return index}function charsStartIndex(strSymbols,chrSymbols){for(var index=-1,length=strSymbols.length;++index<length&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1;);return index}function asciiToArray(string){return string.split("")}var rsAstralRange,rsComboMarksRange,rsComboSymbolsRange="\\u20d0-\\u20f0",rsVarRange,rsZWJ,reHasUnicode=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]");function hasUnicode(string){return reHasUnicode.test(string)}var rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$1,rsComboSymbolsRange$1="\\u20d0-\\u20f0",rsVarRange$1="\\ufe0e\\ufe0f",rsAstral="[\\ud800-\\udfff]",rsCombo="[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier,rsNonAstral="[^\\ud800-\\udfff]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ$1="\\u200d",reOptMod="(?:"+rsCombo+"|"+rsFitz+")?",rsOptVar="[\\ufe0e\\ufe0f]?",rsOptJoin,rsSeq=rsOptVar+reOptMod+"(?:\\u200d(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");function unicodeToArray(string){return string.match(reUnicode)||[]}function stringToArray(string){return hasUnicode(string)?unicodeToArray(string):asciiToArray(string)}function toString(value){return null==value?"":baseToString(value)}var reTrim=/^\s+|\s+$/g;function trim(string,chars,guard){if((string=toString(string))&&(guard||void 0===chars))return string.replace(reTrim,"");if(!string||!(chars=baseToString(chars)))return string;var strSymbols=stringToArray(string),chrSymbols=stringToArray(chars),start,end;return castSlice(strSymbols,charsStartIndex(strSymbols,chrSymbols),charsEndIndex(strSymbols,chrSymbols)+1).join("")}var FN_ARGS=/^(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/(=.+)?(\s*)$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function parseParams(func){return func=(func=(func=(func=func.toString().replace(STRIP_COMMENTS,"")).match(FN_ARGS)[2].replace(" ",""))?func.split(FN_ARG_SPLIT):[]).map((function(arg){return trim(arg.replace(FN_ARG,""))}))}function autoInject(tasks,callback){var newTasks={};baseForOwn(tasks,(function(taskFn,key){var params;if(isArray(taskFn))params=taskFn.slice(0,-1),taskFn=taskFn[taskFn.length-1],newTasks[key]=params.concat(params.length>0?newTask:taskFn);else if(1===taskFn.length)newTasks[key]=taskFn;else{if(params=parseParams(taskFn),0===taskFn.length&&0===params.length)throw new Error("autoInject task functions require explicit parameters.");params.pop(),newTasks[key]=params.concat(newTask)}function newTask(results,taskCb){var newArgs=arrayMap(params,(function(name){return results[name]}));newArgs.push(taskCb),taskFn.apply(null,newArgs)}})),auto(newTasks,callback)}var hasSetImmediate="function"==typeof setImmediate&&setImmediate,hasNextTick="object"==typeof process&&"function"==typeof process.nextTick,_defer;function fallback(fn){setTimeout(fn,0)}function wrap(defer){return rest((function(fn,args){defer((function(){fn.apply(null,args)}))}))}var setImmediate$1=wrap(_defer=hasSetImmediate?setImmediate:hasNextTick?process.nextTick:fallback);function DLL(){this.head=this.tail=null,this.length=0}function setInitial(dll,node){dll.length=1,dll.head=dll.tail=node}function queue(worker,concurrency,payload){if(null==concurrency)concurrency=1;else if(0===concurrency)throw new Error("Concurrency must not be zero");function _insert(data,insertAtFront,callback){if(null!=callback&&"function"!=typeof callback)throw new Error("task callback must be a function");if(q.started=!0,isArray(data)||(data=[data]),0===data.length&&q.idle())return setImmediate$1((function(){q.drain()}));for(var i=0,l=data.length;i<l;i++){var item={data:data[i],callback:callback||noop};insertAtFront?q._tasks.unshift(item):q._tasks.push(item)}setImmediate$1(q.process)}function _next(tasks){return rest((function(args){workers-=1;for(var i=0,l=tasks.length;i<l;i++){var task=tasks[i],index=baseIndexOf(workersList,task,0);index>=0&&workersList.splice(index),task.callback.apply(task,args),null!=args[0]&&q.error(args[0],task.data)}workers<=q.concurrency-q.buffer&&q.unsaturated(),q.idle()&&q.drain(),q.process()}))}var workers=0,workersList=[],q={_tasks:new DLL,concurrency:concurrency,payload:payload,saturated:noop,unsaturated:noop,buffer:concurrency/4,empty:noop,drain:noop,error:noop,started:!1,paused:!1,push:function(data,callback){_insert(data,!1,callback)},kill:function(){q.drain=noop,q._tasks.empty()},unshift:function(data,callback){_insert(data,!0,callback)},process:function(){for(;!q.paused&&workers<q.concurrency&&q._tasks.length;){var tasks=[],data=[],l=q._tasks.length;q.payload&&(l=Math.min(l,q.payload));for(var i=0;i<l;i++){var node=q._tasks.shift();tasks.push(node),data.push(node.data)}0===q._tasks.length&&q.empty(),workers+=1,workersList.push(tasks[0]),workers===q.concurrency&&q.saturated();var cb=onlyOnce(_next(tasks));worker(data,cb)}},length:function(){return q._tasks.length},running:function(){return workers},workersList:function(){return workersList},idle:function(){return q._tasks.length+workers===0},pause:function(){q.paused=!0},resume:function(){if(!1!==q.paused){q.paused=!1;for(var resumeCount=Math.min(q.concurrency,q._tasks.length),w=1;w<=resumeCount;w++)setImmediate$1(q.process)}}};return q}function cargo(worker,payload){return queue(worker,1,payload)}DLL.prototype.removeLink=function(node){return node.prev?node.prev.next=node.next:this.head=node.next,node.next?node.next.prev=node.prev:this.tail=node.prev,node.prev=node.next=null,this.length-=1,node},DLL.prototype.empty=DLL,DLL.prototype.insertAfter=function(node,newNode){newNode.prev=node,newNode.next=node.next,node.next?node.next.prev=newNode:this.tail=newNode,node.next=newNode,this.length+=1},DLL.prototype.insertBefore=function(node,newNode){newNode.prev=node.prev,newNode.next=node,node.prev?node.prev.next=newNode:this.head=newNode,node.prev=newNode,this.length+=1},DLL.prototype.unshift=function(node){this.head?this.insertBefore(this.head,node):setInitial(this,node)},DLL.prototype.push=function(node){this.tail?this.insertAfter(this.tail,node):setInitial(this,node)},DLL.prototype.shift=function(){return this.head&&this.removeLink(this.head)},DLL.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)};var eachOfSeries=doLimit(eachOfLimit,1);function reduce(coll,memo,iteratee,callback){callback=once(callback||noop),eachOfSeries(coll,(function(x,i,callback){iteratee(memo,x,(function(err,v){memo=v,callback(err)}))}),(function(err){callback(err,memo)}))}var seq$1=rest((function seq(functions){return rest((function(args){var that=this,cb=args[args.length-1];"function"==typeof cb?args.pop():cb=noop,reduce(functions,args,(function(newargs,fn,cb){fn.apply(that,newargs.concat([rest((function(err,nextargs){cb(err,nextargs)}))]))}),(function(err,results){cb.apply(that,[err].concat(results))}))}))})),compose=rest((function(args){return seq$1.apply(null,args.reverse())}));function concat$1(eachfn,arr,fn,callback){var result=[];eachfn(arr,(function(x,index,cb){fn(x,(function(err,y){result=result.concat(y||[]),cb(err)}))}),(function(err){callback(err,result)}))}var concat=doParallel(concat$1);function doSeries(fn){return function(obj,iteratee,callback){return fn(eachOfSeries,obj,iteratee,callback)}}var concatSeries=doSeries(concat$1),constant=rest((function(values){var args=[null].concat(values);return initialParams((function(ignoredArgs,callback){return callback.apply(this,args)}))}));function _createTester(eachfn,check,getResult){return function(arr,limit,iteratee,cb){function done(){cb&&cb(null,getResult(!1))}function wrappedIteratee(x,_,callback){if(!cb)return callback();iteratee(x,(function(err,v){cb&&(err||check(v))?(err?cb(err):cb(err,getResult(!0,x)),cb=iteratee=!1,callback(err,breakLoop)):callback()}))}arguments.length>3?(cb=cb||noop,eachfn(arr,limit,wrappedIteratee,done)):(cb=(cb=iteratee)||noop,iteratee=limit,eachfn(arr,wrappedIteratee,done))}}function _findGetResult(v,x){return x}var detect=_createTester(eachOf,identity,_findGetResult),detectLimit=_createTester(eachOfLimit,identity,_findGetResult),detectSeries=_createTester(eachOfSeries,identity,_findGetResult);function consoleFunc(name){return rest((function(fn,args){fn.apply(null,args.concat([rest((function(err,args){"object"==typeof console&&(err?console.error&&console.error(err):console[name]&&arrayEach(args,(function(x){console[name](x)})))}))]))}))}var dir=consoleFunc("dir");function doDuring(fn,test,callback){callback=onlyOnce(callback||noop);var next=rest((function(err,args){if(err)return callback(err);args.push(check),test.apply(this,args)}));function check(err,truth){return err?callback(err):truth?void fn(next):callback(null)}check(null,!0)}function doWhilst(iteratee,test,callback){callback=onlyOnce(callback||noop);var next=rest((function(err,args){return err?callback(err):test.apply(this,args)?iteratee(next):void callback.apply(null,[null].concat(args))}));iteratee(next)}function doUntil(fn,test,callback){doWhilst(fn,(function(){return!test.apply(this,arguments)}),callback)}function during(test,fn,callback){function next(err){if(err)return callback(err);test(check)}function check(err,truth){return err?callback(err):truth?void fn(next):callback(null)}callback=onlyOnce(callback||noop),test(check)}function _withoutIndex(iteratee){return function(value,index,callback){return iteratee(value,callback)}}function eachLimit(coll,iteratee,callback){eachOf(coll,_withoutIndex(iteratee),callback)}function eachLimit$1(coll,limit,iteratee,callback){_eachOfLimit(limit)(coll,_withoutIndex(iteratee),callback)}var eachSeries=doLimit(eachLimit$1,1);function ensureAsync(fn){return initialParams((function(args,callback){var sync=!0;args.push((function(){var innerArgs=arguments;sync?setImmediate$1((function(){callback.apply(null,innerArgs)})):callback.apply(null,innerArgs)})),fn.apply(this,args),sync=!1}))}function notId(v){return!v}var every=_createTester(eachOf,notId,notId),everyLimit=_createTester(eachOfLimit,notId,notId),everySeries=doLimit(everyLimit,1);function baseProperty(key){return function(object){return null==object?void 0:object[key]}}function filterArray(eachfn,arr,iteratee,callback){var truthValues=new Array(arr.length);eachfn(arr,(function(x,index,callback){iteratee(x,(function(err,v){truthValues[index]=!!v,callback(err)}))}),(function(err){if(err)return callback(err);for(var results=[],i=0;i<arr.length;i++)truthValues[i]&&results.push(arr[i]);callback(null,results)}))}function filterGeneric(eachfn,coll,iteratee,callback){var results=[];eachfn(coll,(function(x,index,callback){iteratee(x,(function(err,v){err?callback(err):(v&&results.push({index:index,value:x}),callback())}))}),(function(err){err?callback(err):callback(null,arrayMap(results.sort((function(a,b){return a.index-b.index})),baseProperty("value")))}))}function _filter(eachfn,coll,iteratee,callback){var filter;(isArrayLike(coll)?filterArray:filterGeneric)(eachfn,coll,iteratee,callback||noop)}var filter=doParallel(_filter),filterLimit=doParallelLimit(_filter),filterSeries=doLimit(filterLimit,1);function forever(fn,errback){var done=onlyOnce(errback||noop),task=ensureAsync(fn);function next(err){if(err)return done(err);task(next)}next()}var log=consoleFunc("log");function mapValuesLimit(obj,limit,iteratee,callback){callback=once(callback||noop);var newObj={};eachOfLimit(obj,limit,(function(val,key,next){iteratee(val,key,(function(err,result){if(err)return next(err);newObj[key]=result,next()}))}),(function(err){callback(err,newObj)}))}var mapValues=doLimit(mapValuesLimit,1/0),mapValuesSeries=doLimit(mapValuesLimit,1),_defer$1;function has(obj,key){return key in obj}function memoize(fn,hasher){var memo=Object.create(null),queues=Object.create(null);hasher=hasher||identity;var memoized=initialParams((function memoized(args,callback){var key=hasher.apply(null,args);has(memo,key)?setImmediate$1((function(){callback.apply(null,memo[key])})):has(queues,key)?queues[key].push(callback):(queues[key]=[callback],fn.apply(null,args.concat([rest((function(args){memo[key]=args;var q=queues[key];delete queues[key];for(var i=0,l=q.length;i<l;i++)q[i].apply(null,args)}))])))}));return memoized.memo=memo,memoized.unmemoized=fn,memoized}var nextTick=wrap(_defer$1=hasNextTick?process.nextTick:hasSetImmediate?setImmediate:fallback);function _parallel(eachfn,tasks,callback){callback=callback||noop;var results=isArrayLike(tasks)?[]:{};eachfn(tasks,(function(task,key,callback){task(rest((function(err,args){args.length<=1&&(args=args[0]),results[key]=args,callback(err)})))}),(function(err){callback(err,results)}))}function parallelLimit(tasks,callback){_parallel(eachOf,tasks,callback)}function parallelLimit$1(tasks,limit,callback){_parallel(_eachOfLimit(limit),tasks,callback)}var queue$1=function(worker,concurrency){return queue((function(items,cb){worker(items[0],cb)}),concurrency,1)},priorityQueue=function(worker,concurrency){var q=queue$1(worker,concurrency);return q.push=function(data,priority,callback){if(null==callback&&(callback=noop),"function"!=typeof callback)throw new Error("task callback must be a function");if(q.started=!0,isArray(data)||(data=[data]),0===data.length)return setImmediate$1((function(){q.drain()}));priority=priority||0;for(var nextNode=q._tasks.head;nextNode&&priority>=nextNode.priority;)nextNode=nextNode.next;for(var i=0,l=data.length;i<l;i++){var item={data:data[i],priority:priority,callback:callback};nextNode?q._tasks.insertBefore(nextNode,item):q._tasks.push(item)}setImmediate$1(q.process)},delete q.unshift,q};function race(tasks,callback){if(callback=once(callback||noop),!isArray(tasks))return callback(new TypeError("First argument to race must be an array of functions"));if(!tasks.length)return callback();for(var i=0,l=tasks.length;i<l;i++)tasks[i](callback)}var slice=Array.prototype.slice;function reduceRight(array,memo,iteratee,callback){var reversed;reduce(slice.call(array).reverse(),memo,iteratee,callback)}function reflect(fn){return initialParams((function reflectOn(args,reflectCallback){return args.push(rest((function callback(err,cbArgs){if(err)reflectCallback(null,{error:err});else{var value=null;1===cbArgs.length?value=cbArgs[0]:cbArgs.length>1&&(value=cbArgs),reflectCallback(null,{value:value})}}))),fn.apply(this,args)}))}function reject$1(eachfn,arr,iteratee,callback){_filter(eachfn,arr,(function(value,cb){iteratee(value,(function(err,v){cb(err,!v)}))}),callback)}var reject=doParallel(reject$1);function reflectAll(tasks){var results;return isArray(tasks)?results=arrayMap(tasks,reflect):(results={},baseForOwn(tasks,(function(task,key){results[key]=reflect.call(this,task)}))),results}var rejectLimit=doParallelLimit(reject$1),rejectSeries=doLimit(rejectLimit,1);function constant$1(value){return function(){return value}}function retry(opts,task,callback){var DEFAULT_TIMES=5,DEFAULT_INTERVAL=0,options={times:DEFAULT_TIMES,intervalFunc:constant$1(DEFAULT_INTERVAL)};function parseTimes(acc,t){if("object"==typeof t)acc.times=+t.times||DEFAULT_TIMES,acc.intervalFunc="function"==typeof t.interval?t.interval:constant$1(+t.interval||DEFAULT_INTERVAL),acc.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");acc.times=+t||DEFAULT_TIMES}}if(arguments.length<3&&"function"==typeof opts?(callback=task||noop,task=opts):(parseTimes(options,opts),callback=callback||noop),"function"!=typeof task)throw new Error("Invalid arguments for async.retry");var attempt=1;function retryAttempt(){task((function(err){err&&attempt++<options.times&&("function"!=typeof options.errorFilter||options.errorFilter(err))?setTimeout(retryAttempt,options.intervalFunc(attempt)):callback.apply(null,arguments)}))}retryAttempt()}var retryable=function(opts,task){return task||(task=opts,opts=null),initialParams((function(args,callback){function taskFn(cb){task.apply(null,args.concat([cb]))}opts?retry(opts,taskFn,callback):retry(taskFn,callback)}))};function series(tasks,callback){_parallel(eachOfSeries,tasks,callback)}var some=_createTester(eachOf,Boolean,identity),someLimit=_createTester(eachOfLimit,Boolean,identity),someSeries=doLimit(someLimit,1);function sortBy(coll,iteratee,callback){function comparator(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0}map(coll,(function(x,callback){iteratee(x,(function(err,criteria){if(err)return callback(err);callback(null,{value:x,criteria:criteria})}))}),(function(err,results){if(err)return callback(err);callback(null,arrayMap(results.sort(comparator),baseProperty("value")))}))}function timeout(asyncFn,milliseconds,info){var originalCallback,timer,timedOut=!1;function injectedCallback(){timedOut||(originalCallback.apply(null,arguments),clearTimeout(timer))}function timeoutCallback(){var name=asyncFn.name||"anonymous",error=new Error('Callback function "'+name+'" timed out.');error.code="ETIMEDOUT",info&&(error.info=info),timedOut=!0,originalCallback(error)}return initialParams((function(args,origCallback){originalCallback=origCallback,timer=setTimeout(timeoutCallback,milliseconds),asyncFn.apply(null,args.concat(injectedCallback))}))}var nativeCeil=Math.ceil,nativeMax$1=Math.max;function baseRange(start,end,step,fromRight){for(var index=-1,length=nativeMax$1(nativeCeil((end-start)/(step||1)),0),result=Array(length);length--;)result[fromRight?length:++index]=start,start+=step;return result}function timeLimit(count,limit,iteratee,callback){mapLimit(baseRange(0,count,1),limit,iteratee,callback)}var times=doLimit(timeLimit,1/0),timesSeries=doLimit(timeLimit,1);function transform(coll,accumulator,iteratee,callback){3===arguments.length&&(callback=iteratee,iteratee=accumulator,accumulator=isArray(coll)?[]:{}),callback=once(callback||noop),eachOf(coll,(function(v,k,cb){iteratee(accumulator,v,k,cb)}),(function(err){callback(err,accumulator)}))}function unmemoize(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}}function whilst(test,iteratee,callback){if(callback=onlyOnce(callback||noop),!test())return callback(null);var next=rest((function(err,args){return err?callback(err):test()?iteratee(next):void callback.apply(null,[null].concat(args))}));iteratee(next)}function until(test,fn,callback){whilst((function(){return!test.apply(this,arguments)}),fn,callback)}var waterfall=function(tasks,callback){if(callback=once(callback||noop),!isArray(tasks))return callback(new Error("First argument to waterfall must be an array of functions"));if(!tasks.length)return callback();var taskIndex=0;function nextTask(args){if(taskIndex===tasks.length)return callback.apply(null,[null].concat(args));var taskCallback=onlyOnce(rest((function(err,args){if(err)return callback.apply(null,[err].concat(args));nextTask(args)}))),task;args.push(taskCallback),tasks[taskIndex++].apply(null,args)}nextTask([])},index={applyEach:applyEach,applyEachSeries:applyEachSeries,apply:apply$2,asyncify:asyncify,auto:auto,autoInject:autoInject,cargo:cargo,compose:compose,concat:concat,concatSeries:concatSeries,constant:constant,detect:detect,detectLimit:detectLimit,detectSeries:detectSeries,dir:dir,doDuring:doDuring,doUntil:doUntil,doWhilst:doWhilst,during:during,each:eachLimit,eachLimit:eachLimit$1,eachOf:eachOf,eachOfLimit:eachOfLimit,eachOfSeries:eachOfSeries,eachSeries:eachSeries,ensureAsync:ensureAsync,every:every,everyLimit:everyLimit,everySeries:everySeries,filter:filter,filterLimit:filterLimit,filterSeries:filterSeries,forever:forever,log:log,map:map,mapLimit:mapLimit,mapSeries:mapSeries,mapValues:mapValues,mapValuesLimit:mapValuesLimit,mapValuesSeries:mapValuesSeries,memoize:memoize,nextTick:nextTick,parallel:parallelLimit,parallelLimit:parallelLimit$1,priorityQueue:priorityQueue,queue:queue$1,race:race,reduce:reduce,reduceRight:reduceRight,reflect:reflect,reflectAll:reflectAll,reject:reject,rejectLimit:rejectLimit,rejectSeries:rejectSeries,retry:retry,retryable:retryable,seq:seq$1,series:series,setImmediate:setImmediate$1,some:some,someLimit:someLimit,someSeries:someSeries,sortBy:sortBy,timeout:timeout,times:times,timesLimit:timeLimit,timesSeries:timesSeries,transform:transform,unmemoize:unmemoize,until:until,waterfall:waterfall,whilst:whilst,all:every,any:some,forEach:eachLimit,forEachSeries:eachSeries,forEachLimit:eachLimit$1,forEachOf:eachOf,forEachOfSeries:eachOfSeries,forEachOfLimit:eachOfLimit,inject:reduce,foldl:reduce,foldr:reduceRight,select:filter,selectLimit:filterLimit,selectSeries:filterSeries,wrapSync:asyncify};exports.default=index,exports.applyEach=applyEach,exports.applyEachSeries=applyEachSeries,exports.apply=apply$2,exports.asyncify=asyncify,exports.auto=auto,exports.autoInject=autoInject,exports.cargo=cargo,exports.compose=compose,exports.concat=concat,exports.concatSeries=concatSeries,exports.constant=constant,exports.detect=detect,exports.detectLimit=detectLimit,exports.detectSeries=detectSeries,exports.dir=dir,exports.doDuring=doDuring,exports.doUntil=doUntil,exports.doWhilst=doWhilst,exports.during=during,exports.each=eachLimit,exports.eachLimit=eachLimit$1,exports.eachOf=eachOf,exports.eachOfLimit=eachOfLimit,exports.eachOfSeries=eachOfSeries,exports.eachSeries=eachSeries,exports.ensureAsync=ensureAsync,exports.every=every,exports.everyLimit=everyLimit,exports.everySeries=everySeries,exports.filter=filter,exports.filterLimit=filterLimit,exports.filterSeries=filterSeries,exports.forever=forever,exports.log=log,exports.map=map,exports.mapLimit=mapLimit,exports.mapSeries=mapSeries,exports.mapValues=mapValues,exports.mapValuesLimit=mapValuesLimit,exports.mapValuesSeries=mapValuesSeries,exports.memoize=memoize,exports.nextTick=nextTick,exports.parallel=parallelLimit,exports.parallelLimit=parallelLimit$1,exports.priorityQueue=priorityQueue,exports.queue=queue$1,exports.race=race,exports.reduce=reduce,exports.reduceRight=reduceRight,exports.reflect=reflect,exports.reflectAll=reflectAll,exports.reject=reject,exports.rejectLimit=rejectLimit,exports.rejectSeries=rejectSeries,exports.retry=retry,exports.retryable=retryable,exports.seq=seq$1,exports.series=series,exports.setImmediate=setImmediate$1,exports.some=some,exports.someLimit=someLimit,exports.someSeries=someSeries,exports.sortBy=sortBy,exports.timeout=timeout,exports.times=times,exports.timesLimit=timeLimit,exports.timesSeries=timesSeries,exports.transform=transform,exports.unmemoize=unmemoize,exports.until=until,exports.waterfall=waterfall,exports.whilst=whilst,exports.all=every,exports.allLimit=everyLimit,exports.allSeries=everySeries,exports.any=some,exports.anyLimit=someLimit,exports.anySeries=someSeries,exports.find=detect,exports.findLimit=detectLimit,exports.findSeries=detectSeries,exports.forEach=eachLimit,exports.forEachSeries=eachSeries,exports.forEachLimit=eachLimit$1,exports.forEachOf=eachOf,exports.forEachOfSeries=eachOfSeries,exports.forEachOfLimit=eachOfLimit,exports.inject=reduce,exports.foldl=reduce,exports.foldr=reduceRight,exports.select=filter,exports.selectLimit=filterLimit,exports.selectSeries=filterSeries,exports.wrapSync=asyncify,Object.defineProperty(exports,"__esModule",{value:!0})}))}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:8}],2:[function(require,module,exports){var MAX_SAFE_INTEGER=9007199254740991,argsTag="[object Arguments]",funcTag="[object Function]",genTag="[object GeneratorFunction]",reIsUint=/^(?:0|[1-9]\d*)$/;function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}var objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,objectToString=objectProto.toString,propertyIsEnumerable=objectProto.propertyIsEnumerable,nativeMax=Math.max;function arrayLikeKeys(value,inherited){var result=isArray(value)||isArguments(value)?baseTimes(value.length,String):[],length=result.length,skipIndexes=!!length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isIndex(key,length))||result.push(key);return result}function assignValue(object,key,value){var objValue=object[key];hasOwnProperty.call(object,key)&&eq(objValue,value)&&(void 0!==value||key in object)||(object[key]=value)}function baseKeysIn(object){if(!isObject(object))return nativeKeysIn(object);var isProto=isPrototype(object),result=[];for(var key in object)("constructor"!=key||!isProto&&hasOwnProperty.call(object,key))&&result.push(key);return result}function baseRest(func,start){return start=nativeMax(void 0===start?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];index=-1;for(var otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=array,apply(func,this,otherArgs)}}function copyObject(source,props,object,customizer){object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):void 0;assignValue(object,key,void 0===newValue?source[key]:newValue)}return object}function createAssigner(assigner){return baseRest((function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:void 0,guard=length>2?sources[2]:void 0;for(customizer=assigner.length>3&&"function"==typeof customizer?(length--,customizer):void 0,guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?void 0:customizer,length=1),object=Object(object);++index<length;){var source=sources[index];source&&assigner(object,source,index,customizer)}return object}))}function isIndex(value,length){return!!(length=null==length?9007199254740991:length)&&("number"==typeof value||reIsUint.test(value))&&value>-1&&value%1==0&&value<length}function isIterateeCall(value,index,object){if(!isObject(object))return!1;var type=typeof index;return!!("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object)&&eq(object[index],value)}function isPrototype(value){var Ctor=value&&value.constructor,proto;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}function nativeKeysIn(object){var result=[];if(null!=object)for(var key in Object(object))result.push(key);return result}function eq(value,other){return value===other||value!=value&&other!=other}function isArguments(value){return isArrayLikeObject(value)&&hasOwnProperty.call(value,"callee")&&(!propertyIsEnumerable.call(value,"callee")||objectToString.call(value)==argsTag)}var isArray=Array.isArray;function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}function isFunction(value){var tag=isObject(value)?objectToString.call(value):"";return tag==funcTag||tag==genTag}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isObjectLike(value){return!!value&&"object"==typeof value}var assignIn=createAssigner((function(object,source){copyObject(source,keysIn(source),object)}));function keysIn(object){return isArrayLike(object)?arrayLikeKeys(object,!0):baseKeysIn(object)}module.exports=assignIn},{}],3:[function(require,module,exports){(function(global){var MAX_SAFE_INTEGER=9007199254740991,argsTag="[object Arguments]",funcTag="[object Function]",genTag="[object GeneratorFunction]",freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")();function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}var objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,objectToString=objectProto.toString,Symbol=root.Symbol,propertyIsEnumerable=objectProto.propertyIsEnumerable,spreadableSymbol=Symbol?Symbol.isConcatSpreadable:void 0;function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;for(predicate||(predicate=isFlattenable),result||(result=[]);++index<length;){var value=array[index];depth>0&&predicate(value)?depth>1?baseFlatten(value,depth-1,predicate,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}function isFlattenable(value){return isArray(value)||isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}function flatten(array){var length;return array&&array.length?baseFlatten(array,1):[]}function isArguments(value){return isArrayLikeObject(value)&&hasOwnProperty.call(value,"callee")&&(!propertyIsEnumerable.call(value,"callee")||objectToString.call(value)==argsTag)}var isArray=Array.isArray;function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}function isFunction(value){var tag=isObject(value)?objectToString.call(value):"";return tag==funcTag||tag==genTag}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isObjectLike(value){return!!value&&"object"==typeof value}module.exports=flatten}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(require,module,exports){(function(global){var LARGE_ARRAY_SIZE=200,FUNC_ERROR_TEXT="Expected a function",HASH_UNDEFINED="__lodash_hash_undefined__",UNORDERED_COMPARE_FLAG=1,PARTIAL_COMPARE_FLAG=2,INFINITY=1/0,MAX_SAFE_INTEGER=9007199254740991,argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",promiseTag="[object Promise]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag,float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,reLeadingDot=/^\./,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reEscapeChar=/\\(\\)?/g,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsUint=/^(?:0|[1-9]\d*)$/,typedArrayTags={};typedArrayTags["[object Float32Array]"]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports,freeProcess=freeModule&&freeModule.exports===freeExports&&freeGlobal.process,nodeUtil=function(){try{return freeProcess&&freeProcess.binding("util")}catch(e){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray;function arrayAggregator(array,setter,iteratee,accumulator){for(var index=-1,length=array?array.length:0;++index<length;){var value=array[index];setter(accumulator,value,iteratee(value),array)}return accumulator}function arraySome(array,predicate){for(var index=-1,length=array?array.length:0;++index<length;)if(predicate(array[index],index,array))return!0;return!1}function baseProperty(key){return function(object){return null==object?void 0:object[key]}}function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}function baseUnary(func){return function(value){return func(value)}}function getValue(object,key){return null==object?void 0:object[key]}function isHostObject(value){var result=!1;if(null!=value&&"function"!=typeof value.toString)try{result=!!(value+"")}catch(e){}return result}function mapToArray(map){var index=-1,result=Array(map.size);return map.forEach((function(value,key){result[++index]=[key,value]})),result}function overArg(func,transform){return function(arg){return func(transform(arg))}}function setToArray(set){var index=-1,result=Array(set.size);return set.forEach((function(value){result[++index]=value})),result}var arrayProto=Array.prototype,funcProto=Function.prototype,objectProto=Object.prototype,coreJsData=root["__core-js_shared__"],maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"",uid,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectToString=objectProto.toString,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Symbol=root.Symbol,Uint8Array=root.Uint8Array,propertyIsEnumerable=objectProto.propertyIsEnumerable,splice=arrayProto.splice,nativeKeys=overArg(Object.keys,Object),DataView=getNative(root,"DataView"),Map=getNative(root,"Map"),Promise=getNative(root,"Promise"),Set=getNative(root,"Set"),WeakMap=getNative(root,"WeakMap"),nativeCreate=getNative(Object,"create"),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),symbolProto=Symbol?Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function Hash(entries){var index=-1,length=entries?entries.length:0;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{}}function hashDelete(key){return this.has(key)&&delete this.__data__[key]}function hashGet(key){var data=this.__data__;if(nativeCreate){var result=data[key];return result===HASH_UNDEFINED?void 0:result}return hasOwnProperty.call(data,key)?data[key]:void 0}function hashHas(key){var data=this.__data__;return nativeCreate?void 0!==data[key]:hasOwnProperty.call(data,key)}function hashSet(key,value){var data;return this.__data__[key]=nativeCreate&&void 0===value?HASH_UNDEFINED:value,this}function ListCache(entries){var index=-1,length=entries?entries.length:0;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function listCacheClear(){this.__data__=[]}function listCacheDelete(key){var data=this.__data__,index=assocIndexOf(data,key),lastIndex;return!(index<0||(index==data.length-1?data.pop():splice.call(data,index,1),0))}function listCacheGet(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?void 0:data[index][1]}function listCacheHas(key){return assocIndexOf(this.__data__,key)>-1}function listCacheSet(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?data.push([key,value]):data[index][1]=value,this}function MapCache(entries){var index=-1,length=entries?entries.length:0;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function mapCacheClear(){this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}function mapCacheDelete(key){return getMapData(this,key).delete(key)}function mapCacheGet(key){return getMapData(this,key).get(key)}function mapCacheHas(key){return getMapData(this,key).has(key)}function mapCacheSet(key,value){return getMapData(this,key).set(key,value),this}function SetCache(values){var index=-1,length=values?values.length:0;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}function setCacheAdd(value){return this.__data__.set(value,HASH_UNDEFINED),this}function setCacheHas(value){return this.__data__.has(value)}function Stack(entries){this.__data__=new ListCache(entries)}function stackClear(){this.__data__=new ListCache}function stackDelete(key){return this.__data__.delete(key)}function stackGet(key){return this.__data__.get(key)}function stackHas(key){return this.__data__.has(key)}function stackSet(key,value){var cache=this.__data__;if(cache instanceof ListCache){var pairs=cache.__data__;if(!Map||pairs.length<199)return pairs.push([key,value]),this;cache=this.__data__=new MapCache(pairs)}return cache.set(key,value),this}function arrayLikeKeys(value,inherited){var result=isArray(value)||isArguments(value)?baseTimes(value.length,String):[],length=result.length,skipIndexes=!!length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isIndex(key,length))||result.push(key);return result}function assocIndexOf(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}function baseAggregator(collection,setter,iteratee,accumulator){return baseEach(collection,(function(value,key,collection){setter(accumulator,value,iteratee(value),collection)})),accumulator}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var baseEach=createBaseEach(baseForOwn),baseFor=createBaseFor();function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys)}function baseGet(object,path){for(var index=0,length=(path=isKey(path,object)?[path]:castPath(path)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:void 0}function baseGetTag(value){return objectToString.call(value)}function baseHasIn(object,key){return null!=object&&key in Object(object)}function baseIsEqual(value,other,customizer,bitmask,stack){return value===other||(null==value||null==other||!isObject(value)&&!isObjectLike(other)?value!=value&&other!=other:baseIsEqualDeep(value,other,baseIsEqual,customizer,bitmask,stack))}function baseIsEqualDeep(object,other,equalFunc,customizer,bitmask,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;objIsArr||(objTag=(objTag=getTag(object))==argsTag?objectTag:objTag),othIsArr||(othTag=(othTag=getTag(other))==argsTag?objectTag:othTag);var objIsObj=objTag==objectTag&&!isHostObject(object),othIsObj=othTag==objectTag&&!isHostObject(other),isSameTag=objTag==othTag;if(isSameTag&&!objIsObj)return stack||(stack=new Stack),objIsArr||isTypedArray(object)?equalArrays(object,other,equalFunc,customizer,bitmask,stack):equalByTag(object,other,objTag,equalFunc,customizer,bitmask,stack);if(!(2&bitmask)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new Stack),equalFunc(objUnwrapped,othUnwrapped,customizer,bitmask,stack)}}return!!isSameTag&&(stack||(stack=new Stack),equalObjects(object,other,equalFunc,customizer,bitmask,stack))}function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(void 0===objValue&&!(key in object))return!1}else{var stack=new Stack;if(customizer)var result=customizer(objValue,srcValue,key,object,source,stack);if(!(void 0===result?baseIsEqual(srcValue,objValue,customizer,3,stack):result))return!1}}return!0}function baseIsNative(value){return!(!isObject(value)||isMasked(value))&&(isFunction(value)||isHostObject(value)?reIsNative:reIsHostCtor).test(toSource(value));var pattern}function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objectToString.call(value)]}function baseIteratee(value){return"function"==typeof value?value:null==value?identity:"object"==typeof value?isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value):property(value)}function baseKeys(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}function baseMatches(source){var matchData=getMatchData(source);return 1==matchData.length&&matchData[0][2]?matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||baseIsMatch(object,source,matchData)}}function baseMatchesProperty(path,srcValue){return isKey(path)&&isStrictComparable(srcValue)?matchesStrictComparable(toKey(path),srcValue):function(object){var objValue=get(object,path);return void 0===objValue&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,void 0,3)}}function basePropertyDeep(path){return function(object){return baseGet(object,path)}}function baseToString(value){if("string"==typeof value)return value;if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}function castPath(value){return isArray(value)?value:stringToPath(value)}function createAggregator(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,baseIteratee(iteratee,2),accumulator)}}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}function equalArrays(array,other,equalFunc,customizer,bitmask,stack){var isPartial=2&bitmask,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var stacked=stack.get(array);if(stacked&&stack.get(other))return stacked==other;var index=-1,result=!0,seen=1&bitmask?new SetCache:void 0;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(void 0!==compared){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,(function(othValue,othIndex){if(!seen.has(othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,customizer,bitmask,stack)))return seen.add(othIndex)}))){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,customizer,bitmask,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}function equalByTag(object,other,tag,equalFunc,customizer,bitmask,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case arrayBufferTag:return!(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array(object),new Uint8Array(other)));case boolTag:case dateTag:case numberTag:return eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag:case stringTag:return object==other+"";case mapTag:var convert=mapToArray;case setTag:var isPartial=2&bitmask;if(convert||(convert=setToArray),object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=1,stack.set(object,other);var result=equalArrays(convert(object),convert(other),equalFunc,customizer,bitmask,stack);return stack.delete(object),result;case symbolTag:if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}function equalObjects(object,other,equalFunc,customizer,bitmask,stack){var isPartial=2&bitmask,objProps=keys(object),objLength=objProps.length,othProps,othLength;if(objLength!=keys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var stacked=stack.get(object);if(stacked&&stack.get(other))return stacked==other;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){var objValue=object[key=objProps[index]],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(void 0===compared?objValue===othValue||equalFunc(objValue,othValue,customizer,bitmask,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor)&&(result=!1)}return stack.delete(object),stack.delete(other),result}function getMapData(map,key){var data=map.__data__;return isKeyable(key)?data["string"==typeof key?"string":"hash"]:data.map}function getMatchData(object){for(var result=keys(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}function getNative(object,key){var value=getValue(object,key);return baseIsNative(value)?value:void 0}var getTag=baseGetTag;function hasPath(object,path,hasFunc){for(var result,index=-1,length=(path=isKey(path,object)?[path]:castPath(path)).length;++index<length;){var key=toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||!!(length=object?object.length:0)&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object));var length}function isIndex(value,length){return!!(length=null==length?9007199254740991:length)&&("number"==typeof value||reIsUint.test(value))&&value>-1&&value%1==0&&value<length}function isKey(value,object){if(isArray(value))return!1;var type=typeof value;return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object)}function isKeyable(value){var type=typeof value;return"string"==type||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value}function isMasked(func){return!!maskSrcKey&&maskSrcKey in func}function isPrototype(value){var Ctor=value&&value.constructor,proto;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}function isStrictComparable(value){return value==value&&!isObject(value)}function matchesStrictComparable(key,srcValue){return function(object){return null!=object&&object[key]===srcValue&&(void 0!==srcValue||key in Object(object))}}(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag||Map&&getTag(new Map)!=mapTag||Promise&&getTag(Promise.resolve())!=promiseTag||Set&&getTag(new Set)!=setTag||WeakMap&&getTag(new WeakMap)!=weakMapTag)&&(getTag=function(value){var result=objectToString.call(value),Ctor=result==objectTag?value.constructor:void 0,ctorString=Ctor?toSource(Ctor):void 0;if(ctorString)switch(ctorString){case dataViewCtorString:return dataViewTag;case mapCtorString:return mapTag;case promiseCtorString:return promiseTag;case setCtorString:return setTag;case weakMapCtorString:return weakMapTag}return result});var stringToPath=memoize((function(string){string=toString(string);var result=[];return reLeadingDot.test(string)&&result.push(""),string.replace(rePropName,(function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number||match)})),result}));function toKey(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}function toSource(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}var groupBy=createAggregator((function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):result[key]=[value]}));function memoize(func,resolver){if("function"!=typeof func||resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result),result};return memoized.cache=new(memoize.Cache||MapCache),memoized}function eq(value,other){return value===other||value!=value&&other!=other}function isArguments(value){return isArrayLikeObject(value)&&hasOwnProperty.call(value,"callee")&&(!propertyIsEnumerable.call(value,"callee")||objectToString.call(value)==argsTag)}memoize.Cache=MapCache;var isArray=Array.isArray;function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}function isFunction(value){var tag=isObject(value)?objectToString.call(value):"";return tag==funcTag||tag==genTag}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isObjectLike(value){return!!value&&"object"==typeof value}function isSymbol(value){return"symbol"==typeof value||isObjectLike(value)&&objectToString.call(value)==symbolTag}var isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;function toString(value){return null==value?"":baseToString(value)}function get(object,path,defaultValue){var result=null==object?void 0:baseGet(object,path);return void 0===result?defaultValue:result}function hasIn(object,path){return null!=object&&hasPath(object,path,baseHasIn)}function keys(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function identity(value){return value}function property(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path)}module.exports=groupBy}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(require,module,exports){(function(global){var MAX_SAFE_INTEGER=9007199254740991,argsTag="[object Arguments]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",objectTag="[object Object]",promiseTag="[object Promise]",setTag="[object Set]",weakMapTag="[object WeakMap]",dataViewTag="[object DataView]",reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports;function getValue(object,key){return null==object?void 0:object[key]}function isHostObject(value){var result=!1;if(null!=value&&"function"!=typeof value.toString)try{result=!!(value+"")}catch(e){}return result}function overArg(func,transform){return function(arg){return func(transform(arg))}}var funcProto=Function.prototype,objectProto=Object.prototype,coreJsData=root["__core-js_shared__"],maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"",uid,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectToString=objectProto.toString,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Buffer=moduleExports?root.Buffer:void 0,propertyIsEnumerable=objectProto.propertyIsEnumerable,nativeIsBuffer=Buffer?Buffer.isBuffer:void 0,nativeKeys=overArg(Object.keys,Object),DataView=getNative(root,"DataView"),Map=getNative(root,"Map"),Promise=getNative(root,"Promise"),Set=getNative(root,"Set"),WeakMap=getNative(root,"WeakMap"),nonEnumShadows=!propertyIsEnumerable.call({valueOf:1},"valueOf"),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap);function baseGetTag(value){return objectToString.call(value)}function baseIsNative(value){return!(!isObject(value)||isMasked(value))&&(isFunction(value)||isHostObject(value)?reIsNative:reIsHostCtor).test(toSource(value));var pattern}function getNative(object,key){var value=getValue(object,key);return baseIsNative(value)?value:void 0}var getTag=baseGetTag;function isMasked(func){return!!maskSrcKey&&maskSrcKey in func}function isPrototype(value){var Ctor=value&&value.constructor,proto;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}function toSource(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}function isArguments(value){return isArrayLikeObject(value)&&hasOwnProperty.call(value,"callee")&&(!propertyIsEnumerable.call(value,"callee")||objectToString.call(value)==argsTag)}(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag||Map&&getTag(new Map)!=mapTag||Promise&&getTag(Promise.resolve())!=promiseTag||Set&&getTag(new Set)!=setTag||WeakMap&&getTag(new WeakMap)!=weakMapTag)&&(getTag=function(value){var result=objectToString.call(value),Ctor=result==objectTag?value.constructor:void 0,ctorString=Ctor?toSource(Ctor):void 0;if(ctorString)switch(ctorString){case dataViewCtorString:return dataViewTag;case mapCtorString:return mapTag;case promiseCtorString:return promiseTag;case setCtorString:return setTag;case weakMapCtorString:return weakMapTag}return result});var isArray=Array.isArray;function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}var isBuffer=nativeIsBuffer||stubFalse;function isEmpty(value){if(isArrayLike(value)&&(isArray(value)||"string"==typeof value||"function"==typeof value.splice||isBuffer(value)||isArguments(value)))return!value.length;var tag=getTag(value);if(tag==mapTag||tag==setTag)return!value.size;if(nonEnumShadows||isPrototype(value))return!nativeKeys(value).length;for(var key in value)if(hasOwnProperty.call(value,key))return!1;return!0}function isFunction(value){var tag=isObject(value)?objectToString.call(value):"";return tag==funcTag||tag==genTag}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isObjectLike(value){return!!value&&"object"==typeof value}function stubFalse(){return!1}module.exports=isEmpty}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(require,module,exports){(function(global){var LARGE_ARRAY_SIZE=200,FUNC_ERROR_TEXT="Expected a function",HASH_UNDEFINED="__lodash_hash_undefined__",UNORDERED_COMPARE_FLAG=1,PARTIAL_COMPARE_FLAG=2,INFINITY=1/0,MAX_SAFE_INTEGER=9007199254740991,argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",promiseTag="[object Promise]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag,float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,reLeadingDot=/^\./,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reEscapeChar=/\\(\\)?/g,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsUint=/^(?:0|[1-9]\d*)$/,typedArrayTags={};typedArrayTags["[object Float32Array]"]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports,freeProcess=freeModule&&freeModule.exports===freeExports&&freeGlobal.process,nodeUtil=function(){try{return freeProcess&&freeProcess.binding("util")}catch(e){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray;function arrayReduce(array,iteratee,accumulator,initAccum){var index=-1,length=array?array.length:0;for(initAccum&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}function arraySome(array,predicate){for(var index=-1,length=array?array.length:0;++index<length;)if(predicate(array[index],index,array))return!0;return!1}function baseProperty(key){return function(object){return null==object?void 0:object[key]}}function baseReduce(collection,iteratee,accumulator,initAccum,eachFunc){return eachFunc(collection,(function(value,index,collection){accumulator=initAccum?(initAccum=!1,value):iteratee(accumulator,value,index,collection)})),accumulator}function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}function baseUnary(func){return function(value){return func(value)}}function getValue(object,key){return null==object?void 0:object[key]}function isHostObject(value){var result=!1;if(null!=value&&"function"!=typeof value.toString)try{result=!!(value+"")}catch(e){}return result}function mapToArray(map){var index=-1,result=Array(map.size);return map.forEach((function(value,key){result[++index]=[key,value]})),result}function overArg(func,transform){return function(arg){return func(transform(arg))}}function setToArray(set){var index=-1,result=Array(set.size);return set.forEach((function(value){result[++index]=value})),result}var arrayProto=Array.prototype,funcProto=Function.prototype,objectProto=Object.prototype,coreJsData=root["__core-js_shared__"],maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"",uid,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectToString=objectProto.toString,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Symbol=root.Symbol,Uint8Array=root.Uint8Array,propertyIsEnumerable=objectProto.propertyIsEnumerable,splice=arrayProto.splice,nativeKeys=overArg(Object.keys,Object),DataView=getNative(root,"DataView"),Map=getNative(root,"Map"),Promise=getNative(root,"Promise"),Set=getNative(root,"Set"),WeakMap=getNative(root,"WeakMap"),nativeCreate=getNative(Object,"create"),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),symbolProto=Symbol?Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function Hash(entries){var index=-1,length=entries?entries.length:0;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{}}function hashDelete(key){return this.has(key)&&delete this.__data__[key]}function hashGet(key){var data=this.__data__;if(nativeCreate){var result=data[key];return result===HASH_UNDEFINED?void 0:result}return hasOwnProperty.call(data,key)?data[key]:void 0}function hashHas(key){var data=this.__data__;return nativeCreate?void 0!==data[key]:hasOwnProperty.call(data,key)}function hashSet(key,value){var data;return this.__data__[key]=nativeCreate&&void 0===value?HASH_UNDEFINED:value,this}function ListCache(entries){var index=-1,length=entries?entries.length:0;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function listCacheClear(){this.__data__=[]}function listCacheDelete(key){var data=this.__data__,index=assocIndexOf(data,key),lastIndex;return!(index<0||(index==data.length-1?data.pop():splice.call(data,index,1),0))}function listCacheGet(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?void 0:data[index][1]}function listCacheHas(key){return assocIndexOf(this.__data__,key)>-1}function listCacheSet(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?data.push([key,value]):data[index][1]=value,this}function MapCache(entries){var index=-1,length=entries?entries.length:0;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function mapCacheClear(){this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}function mapCacheDelete(key){return getMapData(this,key).delete(key)}function mapCacheGet(key){return getMapData(this,key).get(key)}function mapCacheHas(key){return getMapData(this,key).has(key)}function mapCacheSet(key,value){return getMapData(this,key).set(key,value),this}function SetCache(values){var index=-1,length=values?values.length:0;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}function setCacheAdd(value){return this.__data__.set(value,HASH_UNDEFINED),this}function setCacheHas(value){return this.__data__.has(value)}function Stack(entries){this.__data__=new ListCache(entries)}function stackClear(){this.__data__=new ListCache}function stackDelete(key){return this.__data__.delete(key)}function stackGet(key){return this.__data__.get(key)}function stackHas(key){return this.__data__.has(key)}function stackSet(key,value){var cache=this.__data__;if(cache instanceof ListCache){var pairs=cache.__data__;if(!Map||pairs.length<199)return pairs.push([key,value]),this;cache=this.__data__=new MapCache(pairs)}return cache.set(key,value),this}function arrayLikeKeys(value,inherited){var result=isArray(value)||isArguments(value)?baseTimes(value.length,String):[],length=result.length,skipIndexes=!!length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isIndex(key,length))||result.push(key);return result}function assocIndexOf(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var baseEach=createBaseEach(baseForOwn),baseFor=createBaseFor();function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys)}function baseGet(object,path){for(var index=0,length=(path=isKey(path,object)?[path]:castPath(path)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:void 0}function baseGetTag(value){return objectToString.call(value)}function baseHasIn(object,key){return null!=object&&key in Object(object)}function baseIsEqual(value,other,customizer,bitmask,stack){return value===other||(null==value||null==other||!isObject(value)&&!isObjectLike(other)?value!=value&&other!=other:baseIsEqualDeep(value,other,baseIsEqual,customizer,bitmask,stack))}function baseIsEqualDeep(object,other,equalFunc,customizer,bitmask,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;objIsArr||(objTag=(objTag=getTag(object))==argsTag?objectTag:objTag),othIsArr||(othTag=(othTag=getTag(other))==argsTag?objectTag:othTag);var objIsObj=objTag==objectTag&&!isHostObject(object),othIsObj=othTag==objectTag&&!isHostObject(other),isSameTag=objTag==othTag;if(isSameTag&&!objIsObj)return stack||(stack=new Stack),objIsArr||isTypedArray(object)?equalArrays(object,other,equalFunc,customizer,bitmask,stack):equalByTag(object,other,objTag,equalFunc,customizer,bitmask,stack);if(!(2&bitmask)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new Stack),equalFunc(objUnwrapped,othUnwrapped,customizer,bitmask,stack)}}return!!isSameTag&&(stack||(stack=new Stack),equalObjects(object,other,equalFunc,customizer,bitmask,stack))}function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(void 0===objValue&&!(key in object))return!1}else{var stack=new Stack;if(customizer)var result=customizer(objValue,srcValue,key,object,source,stack);if(!(void 0===result?baseIsEqual(srcValue,objValue,customizer,3,stack):result))return!1}}return!0}function baseIsNative(value){return!(!isObject(value)||isMasked(value))&&(isFunction(value)||isHostObject(value)?reIsNative:reIsHostCtor).test(toSource(value));var pattern}function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objectToString.call(value)]}function baseIteratee(value){return"function"==typeof value?value:null==value?identity:"object"==typeof value?isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value):property(value)}function baseKeys(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}function baseMatches(source){var matchData=getMatchData(source);return 1==matchData.length&&matchData[0][2]?matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||baseIsMatch(object,source,matchData)}}function baseMatchesProperty(path,srcValue){return isKey(path)&&isStrictComparable(srcValue)?matchesStrictComparable(toKey(path),srcValue):function(object){var objValue=get(object,path);return void 0===objValue&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,void 0,3)}}function basePropertyDeep(path){return function(object){return baseGet(object,path)}}function baseToString(value){if("string"==typeof value)return value;if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}function castPath(value){return isArray(value)?value:stringToPath(value)}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}function equalArrays(array,other,equalFunc,customizer,bitmask,stack){var isPartial=2&bitmask,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var stacked=stack.get(array);if(stacked&&stack.get(other))return stacked==other;var index=-1,result=!0,seen=1&bitmask?new SetCache:void 0;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(void 0!==compared){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,(function(othValue,othIndex){if(!seen.has(othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,customizer,bitmask,stack)))return seen.add(othIndex)}))){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,customizer,bitmask,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}function equalByTag(object,other,tag,equalFunc,customizer,bitmask,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case arrayBufferTag:return!(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array(object),new Uint8Array(other)));case boolTag:case dateTag:case numberTag:return eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag:case stringTag:return object==other+"";case mapTag:var convert=mapToArray;case setTag:var isPartial=2&bitmask;if(convert||(convert=setToArray),object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=1,stack.set(object,other);var result=equalArrays(convert(object),convert(other),equalFunc,customizer,bitmask,stack);return stack.delete(object),result;case symbolTag:if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}function equalObjects(object,other,equalFunc,customizer,bitmask,stack){var isPartial=2&bitmask,objProps=keys(object),objLength=objProps.length,othProps,othLength;if(objLength!=keys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var stacked=stack.get(object);if(stacked&&stack.get(other))return stacked==other;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){var objValue=object[key=objProps[index]],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(void 0===compared?objValue===othValue||equalFunc(objValue,othValue,customizer,bitmask,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor)&&(result=!1)}return stack.delete(object),stack.delete(other),result}function getMapData(map,key){var data=map.__data__;return isKeyable(key)?data["string"==typeof key?"string":"hash"]:data.map}function getMatchData(object){for(var result=keys(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}function getNative(object,key){var value=getValue(object,key);return baseIsNative(value)?value:void 0}var getTag=baseGetTag;function hasPath(object,path,hasFunc){for(var result,index=-1,length=(path=isKey(path,object)?[path]:castPath(path)).length;++index<length;){var key=toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||!!(length=object?object.length:0)&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object));var length}function isIndex(value,length){return!!(length=null==length?9007199254740991:length)&&("number"==typeof value||reIsUint.test(value))&&value>-1&&value%1==0&&value<length}function isKey(value,object){if(isArray(value))return!1;var type=typeof value;return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object)}function isKeyable(value){var type=typeof value;return"string"==type||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value}function isMasked(func){return!!maskSrcKey&&maskSrcKey in func}function isPrototype(value){var Ctor=value&&value.constructor,proto;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}function isStrictComparable(value){return value==value&&!isObject(value)}function matchesStrictComparable(key,srcValue){return function(object){return null!=object&&object[key]===srcValue&&(void 0!==srcValue||key in Object(object))}}(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag||Map&&getTag(new Map)!=mapTag||Promise&&getTag(Promise.resolve())!=promiseTag||Set&&getTag(new Set)!=setTag||WeakMap&&getTag(new WeakMap)!=weakMapTag)&&(getTag=function(value){var result=objectToString.call(value),Ctor=result==objectTag?value.constructor:void 0,ctorString=Ctor?toSource(Ctor):void 0;if(ctorString)switch(ctorString){case dataViewCtorString:return dataViewTag;case mapCtorString:return mapTag;case promiseCtorString:return promiseTag;case setCtorString:return setTag;case weakMapCtorString:return weakMapTag}return result});var stringToPath=memoize((function(string){string=toString(string);var result=[];return reLeadingDot.test(string)&&result.push(""),string.replace(rePropName,(function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number||match)})),result}));function toKey(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}function toSource(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}function reduce(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduce:baseReduce,initAccum=arguments.length<3;return func(collection,baseIteratee(iteratee,4),accumulator,initAccum,baseEach)}function memoize(func,resolver){if("function"!=typeof func||resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result),result};return memoized.cache=new(memoize.Cache||MapCache),memoized}function eq(value,other){return value===other||value!=value&&other!=other}function isArguments(value){return isArrayLikeObject(value)&&hasOwnProperty.call(value,"callee")&&(!propertyIsEnumerable.call(value,"callee")||objectToString.call(value)==argsTag)}memoize.Cache=MapCache;var isArray=Array.isArray;function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}function isFunction(value){var tag=isObject(value)?objectToString.call(value):"";return tag==funcTag||tag==genTag}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isObjectLike(value){return!!value&&"object"==typeof value}function isSymbol(value){return"symbol"==typeof value||isObjectLike(value)&&objectToString.call(value)==symbolTag}var isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;function toString(value){return null==value?"":baseToString(value)}function get(object,path,defaultValue){var result=null==object?void 0:baseGet(object,path);return void 0===result?defaultValue:result}function hasIn(object,path){return null!=object&&hasPath(object,path,baseHasIn)}function keys(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function identity(value){return value}function property(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path)}module.exports=reduce}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(require,module,exports){var MAX_SAFE_INTEGER=9007199254740991,argsTag="[object Arguments]",funcTag="[object Function]",genTag="[object GeneratorFunction]",reIsUint=/^(?:0|[1-9]\d*)$/;function arrayMap(array,iteratee){for(var index=-1,length=array?array.length:0,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}function baseValues(object,props){return arrayMap(props,(function(key){return object[key]}))}function overArg(func,transform){return function(arg){return func(transform(arg))}}var objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,objectToString=objectProto.toString,propertyIsEnumerable=objectProto.propertyIsEnumerable,nativeKeys=overArg(Object.keys,Object);function arrayLikeKeys(value,inherited){var result=isArray(value)||isArguments(value)?baseTimes(value.length,String):[],length=result.length,skipIndexes=!!length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isIndex(key,length))||result.push(key);return result}function baseKeys(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}function isIndex(value,length){return!!(length=null==length?9007199254740991:length)&&("number"==typeof value||reIsUint.test(value))&&value>-1&&value%1==0&&value<length}function isPrototype(value){var Ctor=value&&value.constructor,proto;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}function isArguments(value){return isArrayLikeObject(value)&&hasOwnProperty.call(value,"callee")&&(!propertyIsEnumerable.call(value,"callee")||objectToString.call(value)==argsTag)}var isArray=Array.isArray;function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}function isFunction(value){var tag=isObject(value)?objectToString.call(value):"";return tag==funcTag||tag==genTag}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isObjectLike(value){return!!value&&"object"==typeof value}function keys(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function values(object){return object?baseValues(object,keys(object)):[]}module.exports=values},{}],8:[function(require,module,exports){var process=module.exports={},cachedSetTimeout,cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],9:[function(require,module,exports){var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function blur(pixels,width,height,radius){if(!(isNaN(radius)||radius<1)){var x,y,i,p,yp,yi,yw,r_sum,g_sum,b_sum,a_sum,r_out_sum,g_out_sum,b_out_sum,a_out_sum,r_in_sum,g_in_sum,b_in_sum,a_in_sum,pr,pg,pb,pa,rbs,div=(radius|=0)+radius+1,w4=width<<2,widthMinus1=width-1,heightMinus1=height-1,radiusPlus1=radius+1,sumFactor=radiusPlus1*(radiusPlus1+1)/2,stackStart=new BlurStack,stack=stackStart;for(i=1;i<div;i++)if(stack=stack.next=new BlurStack,i==radiusPlus1)var stackEnd=stack;stack.next=stackStart;var stackIn=null,stackOut=null;yw=yi=0;var mul_sum=mul_table[radius],shg_sum=shg_table[radius];for(y=0;y<height;y++){for(r_in_sum=g_in_sum=b_in_sum=a_in_sum=r_sum=g_sum=b_sum=a_sum=0,r_out_sum=radiusPlus1*(pr=pixels[yi]),g_out_sum=radiusPlus1*(pg=pixels[yi+1]),b_out_sum=radiusPlus1*(pb=pixels[yi+2]),a_out_sum=radiusPlus1*(pa=pixels[yi+3]),r_sum+=sumFactor*pr,g_sum+=sumFactor*pg,b_sum+=sumFactor*pb,a_sum+=sumFactor*pa,stack=stackStart,i=0;i<radiusPlus1;i++)stack.r=pr,stack.g=pg,stack.b=pb,stack.a=pa,stack=stack.next;for(i=1;i<radiusPlus1;i++)p=yi+((widthMinus1<i?widthMinus1:i)<<2),r_sum+=(stack.r=pr=pixels[p])*(rbs=radiusPlus1-i),g_sum+=(stack.g=pg=pixels[p+1])*rbs,b_sum+=(stack.b=pb=pixels[p+2])*rbs,a_sum+=(stack.a=pa=pixels[p+3])*rbs,r_in_sum+=pr,g_in_sum+=pg,b_in_sum+=pb,a_in_sum+=pa,stack=stack.next;for(stackIn=stackStart,stackOut=stackEnd,x=0;x<width;x++)pixels[yi+3]=pa=a_sum*mul_sum>>shg_sum,0!=pa?(pa=255/pa,pixels[yi]=(r_sum*mul_sum>>shg_sum)*pa,pixels[yi+1]=(g_sum*mul_sum>>shg_sum)*pa,pixels[yi+2]=(b_sum*mul_sum>>shg_sum)*pa):pixels[yi]=pixels[yi+1]=pixels[yi+2]=0,r_sum-=r_out_sum,g_sum-=g_out_sum,b_sum-=b_out_sum,a_sum-=a_out_sum,r_out_sum-=stackIn.r,g_out_sum-=stackIn.g,b_out_sum-=stackIn.b,a_out_sum-=stackIn.a,p=yw+((p=x+radius+1)<widthMinus1?p:widthMinus1)<<2,r_sum+=r_in_sum+=stackIn.r=pixels[p],g_sum+=g_in_sum+=stackIn.g=pixels[p+1],b_sum+=b_in_sum+=stackIn.b=pixels[p+2],a_sum+=a_in_sum+=stackIn.a=pixels[p+3],stackIn=stackIn.next,r_out_sum+=pr=stackOut.r,g_out_sum+=pg=stackOut.g,b_out_sum+=pb=stackOut.b,a_out_sum+=pa=stackOut.a,r_in_sum-=pr,g_in_sum-=pg,b_in_sum-=pb,a_in_sum-=pa,stackOut=stackOut.next,yi+=4;yw+=width}for(x=0;x<width;x++){for(g_in_sum=b_in_sum=a_in_sum=r_in_sum=g_sum=b_sum=a_sum=r_sum=0,r_out_sum=radiusPlus1*(pr=pixels[yi=x<<2]),g_out_sum=radiusPlus1*(pg=pixels[yi+1]),b_out_sum=radiusPlus1*(pb=pixels[yi+2]),a_out_sum=radiusPlus1*(pa=pixels[yi+3]),r_sum+=sumFactor*pr,g_sum+=sumFactor*pg,b_sum+=sumFactor*pb,a_sum+=sumFactor*pa,stack=stackStart,i=0;i<radiusPlus1;i++)stack.r=pr,stack.g=pg,stack.b=pb,stack.a=pa,stack=stack.next;for(yp=width,i=1;i<=radius;i++)yi=yp+x<<2,r_sum+=(stack.r=pr=pixels[yi])*(rbs=radiusPlus1-i),g_sum+=(stack.g=pg=pixels[yi+1])*rbs,b_sum+=(stack.b=pb=pixels[yi+2])*rbs,a_sum+=(stack.a=pa=pixels[yi+3])*rbs,r_in_sum+=pr,g_in_sum+=pg,b_in_sum+=pb,a_in_sum+=pa,stack=stack.next,i<heightMinus1&&(yp+=width);for(yi=x,stackIn=stackStart,stackOut=stackEnd,y=0;y<height;y++)pixels[3+(p=yi<<2)]=pa=a_sum*mul_sum>>shg_sum,pa>0?(pa=255/pa,pixels[p]=(r_sum*mul_sum>>shg_sum)*pa,pixels[p+1]=(g_sum*mul_sum>>shg_sum)*pa,pixels[p+2]=(b_sum*mul_sum>>shg_sum)*pa):pixels[p]=pixels[p+1]=pixels[p+2]=0,r_sum-=r_out_sum,g_sum-=g_out_sum,b_sum-=b_out_sum,a_sum-=a_out_sum,r_out_sum-=stackIn.r,g_out_sum-=stackIn.g,b_out_sum-=stackIn.b,a_out_sum-=stackIn.a,p=x+((p=y+radiusPlus1)<heightMinus1?p:heightMinus1)*width<<2,r_sum+=r_in_sum+=stackIn.r=pixels[p],g_sum+=g_in_sum+=stackIn.g=pixels[p+1],b_sum+=b_in_sum+=stackIn.b=pixels[p+2],a_sum+=a_in_sum+=stackIn.a=pixels[p+3],stackIn=stackIn.next,r_out_sum+=pr=stackOut.r,g_out_sum+=pg=stackOut.g,b_out_sum+=pb=stackOut.b,a_out_sum+=pa=stackOut.a,r_in_sum-=pr,g_in_sum-=pg,b_in_sum-=pb,a_in_sum-=pa,stackOut=stackOut.next,yi+=width}}}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}module.exports=blur},{}],10:[function(require,module,exports){function DOMParser(options){this.options=options||{locator:{}}}function buildErrorHandler(errorImpl,domBuilder,locator){if(!errorImpl){if(domBuilder instanceof DOMHandler)return domBuilder;errorImpl=domBuilder}var errorHandler={},isCallback=errorImpl instanceof Function;function build(key){var fn=errorImpl[key];!fn&&isCallback&&(fn=2==errorImpl.length?function(msg){errorImpl(key,msg)}:errorImpl),errorHandler[key]=fn&&function(msg){fn("[xmldom "+key+"]\t"+msg+_locator(locator))}||function(){}}return locator=locator||{},build("warning"),build("error"),build("fatalError"),errorHandler}function DOMHandler(){this.cdata=!1}function position(locator,node){node.lineNumber=locator.lineNumber,node.columnNumber=locator.columnNumber}function _locator(l){if(l)return"\n@"+(l.systemId||"")+"#[line:"+l.lineNumber+",col:"+l.columnNumber+"]"}function _toString(chars,start,length){return"string"==typeof chars?chars.substr(start,length):chars.length>=start+length||start?new java.lang.String(chars,start,length)+"":chars}function appendElement(hander,node){hander.currentElement?hander.currentElement.appendChild(node):hander.doc.appendChild(node)}DOMParser.prototype.parseFromString=function(source,mimeType){var options=this.options,sax=new XMLReader,domBuilder=options.domBuilder||new DOMHandler,errorHandler=options.errorHandler,locator=options.locator,defaultNSMap=options.xmlns||{},entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return locator&&domBuilder.setDocumentLocator(locator),sax.errorHandler=buildErrorHandler(errorHandler,domBuilder,locator),sax.domBuilder=options.domBuilder||domBuilder,/\/x?html?$/.test(mimeType)&&(entityMap.nbsp=" ",entityMap.copy="©",defaultNSMap[""]="http://www.w3.org/1999/xhtml"),defaultNSMap.xml=defaultNSMap.xml||"http://www.w3.org/XML/1998/namespace",source?sax.parse(source,defaultNSMap,entityMap):sax.errorHandler.error("invalid doc source"),domBuilder.doc},DOMHandler.prototype={startDocument:function(){this.doc=(new DOMImplementation).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(namespaceURI,localName,qName,attrs){var doc=this.doc,el=doc.createElementNS(namespaceURI,qName||localName),len=attrs.length;appendElement(this,el),this.currentElement=el,this.locator&&position(this.locator,el);for(var i=0;i<len;i++){var namespaceURI=attrs.getURI(i),value=attrs.getValue(i),qName=attrs.getQName(i),attr=doc.createAttributeNS(namespaceURI,qName);this.locator&&position(attrs.getLocator(i),attr),attr.value=attr.nodeValue=value,el.setAttributeNode(attr)}},endElement:function(namespaceURI,localName,qName){var current=this.currentElement,tagName=current.tagName;this.currentElement=current.parentNode},startPrefixMapping:function(prefix,uri){},endPrefixMapping:function(prefix){},processingInstruction:function(target,data){var ins=this.doc.createProcessingInstruction(target,data);this.locator&&position(this.locator,ins),appendElement(this,ins)},ignorableWhitespace:function(ch,start,length){},characters:function(chars,start,length){if(chars=_toString.apply(this,arguments)){if(this.cdata)var charNode=this.doc.createCDATASection(chars);else var charNode=this.doc.createTextNode(chars);this.currentElement?this.currentElement.appendChild(charNode):/^\s*$/.test(chars)&&this.doc.appendChild(charNode),this.locator&&position(this.locator,charNode)}},skippedEntity:function(name){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(locator){(this.locator=locator)&&(locator.lineNumber=0)},comment:function(chars,start,length){chars=_toString.apply(this,arguments);var comm=this.doc.createComment(chars);this.locator&&position(this.locator,comm),appendElement(this,comm)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(name,publicId,systemId){var impl=this.doc.implementation;if(impl&&impl.createDocumentType){var dt=impl.createDocumentType(name,publicId,systemId);this.locator&&position(this.locator,dt),appendElement(this,dt)}},warning:function(error){console.warn("[xmldom warning]\t"+error,_locator(this.locator))},error:function(error){console.error("[xmldom error]\t"+error,_locator(this.locator))},fatalError:function(error){throw console.error("[xmldom fatalError]\t"+error,_locator(this.locator)),error}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(key){DOMHandler.prototype[key]=function(){return null}}));var XMLReader=require("./sax").XMLReader,DOMImplementation=exports.DOMImplementation=require("./dom").DOMImplementation;exports.XMLSerializer=require("./dom").XMLSerializer,exports.DOMParser=DOMParser},{"./dom":11,"./sax":12}],11:[function(require,module,exports){function copy(src,dest){for(var p in src)dest[p]=src[p]}function _extends(Class,Super){var pt=Class.prototype;if(Object.create){var ppt=Object.create(Super.prototype);pt.__proto__=ppt}if(!(pt instanceof Super)){function t(){}t.prototype=Super.prototype,copy(pt,t=new t),Class.prototype=pt=t}pt.constructor!=Class&&("function"!=typeof Class&&console.error("unknow Class:"+Class),pt.constructor=Class)}var htmlns="http://www.w3.org/1999/xhtml",NodeType={},ELEMENT_NODE=NodeType.ELEMENT_NODE=1,ATTRIBUTE_NODE=NodeType.ATTRIBUTE_NODE=2,TEXT_NODE=NodeType.TEXT_NODE=3,CDATA_SECTION_NODE=NodeType.CDATA_SECTION_NODE=4,ENTITY_REFERENCE_NODE=NodeType.ENTITY_REFERENCE_NODE=5,ENTITY_NODE=NodeType.ENTITY_NODE=6,PROCESSING_INSTRUCTION_NODE=NodeType.PROCESSING_INSTRUCTION_NODE=7,COMMENT_NODE=NodeType.COMMENT_NODE=8,DOCUMENT_NODE=NodeType.DOCUMENT_NODE=9,DOCUMENT_TYPE_NODE=NodeType.DOCUMENT_TYPE_NODE=10,DOCUMENT_FRAGMENT_NODE=NodeType.DOCUMENT_FRAGMENT_NODE=11,NOTATION_NODE=NodeType.NOTATION_NODE=12,ExceptionCode={},ExceptionMessage={},INDEX_SIZE_ERR=ExceptionCode.INDEX_SIZE_ERR=(ExceptionMessage[1]="Index size error",1),DOMSTRING_SIZE_ERR=ExceptionCode.DOMSTRING_SIZE_ERR=(ExceptionMessage[2]="DOMString size error",2),HIERARCHY_REQUEST_ERR=ExceptionCode.HIERARCHY_REQUEST_ERR=(ExceptionMessage[3]="Hierarchy request error",3),WRONG_DOCUMENT_ERR=ExceptionCode.WRONG_DOCUMENT_ERR=(ExceptionMessage[4]="Wrong document",4),INVALID_CHARACTER_ERR=ExceptionCode.INVALID_CHARACTER_ERR=(ExceptionMessage[5]="Invalid character",5),NO_DATA_ALLOWED_ERR=ExceptionCode.NO_DATA_ALLOWED_ERR=(ExceptionMessage[6]="No data allowed",6),NO_MODIFICATION_ALLOWED_ERR=ExceptionCode.NO_MODIFICATION_ALLOWED_ERR=(ExceptionMessage[7]="No modification allowed",7),NOT_FOUND_ERR=ExceptionCode.NOT_FOUND_ERR=(ExceptionMessage[8]="Not found",8),NOT_SUPPORTED_ERR=ExceptionCode.NOT_SUPPORTED_ERR=(ExceptionMessage[9]="Not supported",9),INUSE_ATTRIBUTE_ERR=ExceptionCode.INUSE_ATTRIBUTE_ERR=(ExceptionMessage[10]="Attribute in use",10),INVALID_STATE_ERR=ExceptionCode.INVALID_STATE_ERR=(ExceptionMessage[11]="Invalid state",11),SYNTAX_ERR=ExceptionCode.SYNTAX_ERR=(ExceptionMessage[12]="Syntax error",12),INVALID_MODIFICATION_ERR=ExceptionCode.INVALID_MODIFICATION_ERR=(ExceptionMessage[13]="Invalid modification",13),NAMESPACE_ERR=ExceptionCode.NAMESPACE_ERR=(ExceptionMessage[14]="Invalid namespace",14),INVALID_ACCESS_ERR=ExceptionCode.INVALID_ACCESS_ERR=(ExceptionMessage[15]="Invalid access",15);function DOMException(code,message){if(message instanceof Error)var error=message;else error=this,Error.call(this,ExceptionMessage[code]),this.message=ExceptionMessage[code],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return error.code=code,message&&(this.message=this.message+": "+message),error}function NodeList(){}function LiveNodeList(node,refresh){this._node=node,this._refresh=refresh,_updateLiveList(this)}function _updateLiveList(list){var inc=list._node._inc||list._node.ownerDocument._inc;if(list._inc!=inc){var ls=list._refresh(list._node);__set__(list,"length",ls.length),copy(ls,list),list._inc=inc}}function NamedNodeMap(){}function _findNodeIndex(list,node){for(var i=list.length;i--;)if(list[i]===node)return i}function _addNamedNode(el,list,newAttr,oldAttr){if(oldAttr?list[_findNodeIndex(list,oldAttr)]=newAttr:list[list.length++]=newAttr,el){newAttr.ownerElement=el;var doc=el.ownerDocument;doc&&(oldAttr&&_onRemoveAttribute(doc,el,oldAttr),_onAddAttribute(doc,el,newAttr))}}function _removeNamedNode(el,list,attr){var i=_findNodeIndex(list,attr);if(!(i>=0))throw DOMException(NOT_FOUND_ERR,new Error(el.tagName+"@"+attr));for(var lastIndex=list.length-1;i<lastIndex;)list[i]=list[++i];if(list.length=lastIndex,el){var doc=el.ownerDocument;doc&&(_onRemoveAttribute(doc,el,attr),attr.ownerElement=null)}}function DOMImplementation(features){if(this._features={},features)for(var feature in features)this._features=features[feature]}function Node(){}function _xmlEncoder(c){return("<"==c?"&lt;":">"==c&&"&gt;")||"&"==c&&"&amp;"||'"'==c&&"&quot;"||"&#"+c.charCodeAt()+";"}function _visitNode(node,callback){if(callback(node))return!0;if(node=node.firstChild)do{if(_visitNode(node,callback))return!0}while(node=node.nextSibling)}function Document(){}function _onAddAttribute(doc,el,newAttr){var ns;doc&&doc._inc++,"http://www.w3.org/2000/xmlns/"==newAttr.namespaceURI&&(el._nsMap[newAttr.prefix?newAttr.localName:""]=newAttr.value)}function _onRemoveAttribute(doc,el,newAttr,remove){var ns;doc&&doc._inc++,"http://www.w3.org/2000/xmlns/"==newAttr.namespaceURI&&delete el._nsMap[newAttr.prefix?newAttr.localName:""]}function _onUpdateChild(doc,el,newChild){if(doc&&doc._inc){doc._inc++;var cs=el.childNodes;if(newChild)cs[cs.length++]=newChild;else{for(var child=el.firstChild,i=0;child;)cs[i++]=child,child=child.nextSibling;cs.length=i}}}function _removeChild(parentNode,child){var previous=child.previousSibling,next=child.nextSibling;return previous?previous.nextSibling=next:parentNode.firstChild=next,next?next.previousSibling=previous:parentNode.lastChild=previous,_onUpdateChild(parentNode.ownerDocument,parentNode),child}function _insertBefore(parentNode,newChild,nextChild){var cp=newChild.parentNode;if(cp&&cp.removeChild(newChild),newChild.nodeType===DOCUMENT_FRAGMENT_NODE){var newFirst=newChild.firstChild;if(null==newFirst)return newChild;var newLast=newChild.lastChild}else newFirst=newLast=newChild;var pre=nextChild?nextChild.previousSibling:parentNode.lastChild;newFirst.previousSibling=pre,newLast.nextSibling=nextChild,pre?pre.nextSibling=newFirst:parentNode.firstChild=newFirst,null==nextChild?parentNode.lastChild=newLast:nextChild.previousSibling=newLast;do{newFirst.parentNode=parentNode}while(newFirst!==newLast&&(newFirst=newFirst.nextSibling));return _onUpdateChild(parentNode.ownerDocument||parentNode,parentNode),newChild.nodeType==DOCUMENT_FRAGMENT_NODE&&(newChild.firstChild=newChild.lastChild=null),newChild}function _appendSingleChild(parentNode,newChild){var cp=newChild.parentNode;if(cp){var pre=parentNode.lastChild;cp.removeChild(newChild);var pre=parentNode.lastChild}var pre=parentNode.lastChild;return newChild.parentNode=parentNode,newChild.previousSibling=pre,newChild.nextSibling=null,pre?pre.nextSibling=newChild:parentNode.firstChild=newChild,parentNode.lastChild=newChild,_onUpdateChild(parentNode.ownerDocument,parentNode,newChild),newChild}function Element(){this._nsMap={}}function Attr(){}function CharacterData(){}function Text(){}function Comment(){}function CDATASection(){}function DocumentType(){}function Notation(){}function Entity(){}function EntityReference(){}function DocumentFragment(){}function ProcessingInstruction(){}function XMLSerializer(){}function nodeSerializeToString(isHtml,nodeFilter){var buf=[],refNode=9==this.nodeType?this.documentElement:this,prefix=refNode.prefix,uri=refNode.namespaceURI,prefix;if(uri&&null==prefix&&null==(prefix=refNode.lookupPrefix(uri)))var visibleNamespaces=[{namespace:uri,prefix:null}];return serializeToString(this,buf,isHtml,nodeFilter,visibleNamespaces),buf.join("")}function needNamespaceDefine(node,isHTML,visibleNamespaces){var prefix=node.prefix||"",uri=node.namespaceURI;if(!prefix&&!uri)return!1;if("xml"===prefix&&"http://www.w3.org/XML/1998/namespace"===uri||"http://www.w3.org/2000/xmlns/"==uri)return!1;for(var i=visibleNamespaces.length;i--;){var ns=visibleNamespaces[i];if(ns.prefix==prefix)return ns.namespace!=uri}return!0}function serializeToString(node,buf,isHTML,nodeFilter,visibleNamespaces){if(nodeFilter){if(!(node=nodeFilter(node)))return;if("string"==typeof node)return void buf.push(node)}switch(node.nodeType){case ELEMENT_NODE:visibleNamespaces||(visibleNamespaces=[]);var startVisibleNamespaces=visibleNamespaces.length,attrs=node.attributes,len=attrs.length,child=node.firstChild,nodeName=node.tagName;isHTML=htmlns===node.namespaceURI||isHTML,buf.push("<",nodeName);for(var i=0;i<len;i++){var attr;"xmlns"==(attr=attrs.item(i)).prefix?visibleNamespaces.push({prefix:attr.localName,namespace:attr.value}):"xmlns"==attr.nodeName&&visibleNamespaces.push({prefix:"",namespace:attr.value})}for(var i=0;i<len;i++){var attr;if(needNamespaceDefine(attr=attrs.item(i),isHTML,visibleNamespaces)){var prefix=attr.prefix||"",uri=attr.namespaceURI,ns=prefix?" xmlns:"+prefix:" xmlns";buf.push(ns,'="',uri,'"'),visibleNamespaces.push({prefix:prefix,namespace:uri})}serializeToString(attr,buf,isHTML,nodeFilter,visibleNamespaces)}if(needNamespaceDefine(node,isHTML,visibleNamespaces)){var prefix=node.prefix||"",uri=node.namespaceURI,ns=prefix?" xmlns:"+prefix:" xmlns";buf.push(ns,'="',uri,'"'),visibleNamespaces.push({prefix:prefix,namespace:uri})}if(child||isHTML&&!/^(?:meta|link|img|br|hr|input)$/i.test(nodeName)){if(buf.push(">"),isHTML&&/^script$/i.test(nodeName))for(;child;)child.data?buf.push(child.data):serializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces),child=child.nextSibling;else for(;child;)serializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces),child=child.nextSibling;buf.push("</",nodeName,">")}else buf.push("/>");return;case DOCUMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(var child=node.firstChild;child;)serializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces),child=child.nextSibling;return;case ATTRIBUTE_NODE:return buf.push(" ",node.name,'="',node.value.replace(/[<&"]/g,_xmlEncoder),'"');case TEXT_NODE:return buf.push(node.data.replace(/[<&]/g,_xmlEncoder));case CDATA_SECTION_NODE:return buf.push("<![CDATA[",node.data,"]]>");case COMMENT_NODE:return buf.push("\x3c!--",node.data,"--\x3e");case DOCUMENT_TYPE_NODE:var pubid=node.publicId,sysid=node.systemId;if(buf.push("<!DOCTYPE ",node.name),pubid)buf.push(' PUBLIC "',pubid),sysid&&"."!=sysid&&buf.push('" "',sysid),buf.push('">');else if(sysid&&"."!=sysid)buf.push(' SYSTEM "',sysid,'">');else{var sub=node.internalSubset;sub&&buf.push(" [",sub,"]"),buf.push(">")}return;case PROCESSING_INSTRUCTION_NODE:return buf.push("<?",node.target," ",node.data,"?>");case ENTITY_REFERENCE_NODE:return buf.push("&",node.nodeName,";");default:buf.push("??",node.nodeName)}}function importNode(doc,node,deep){var node2;switch(node.nodeType){case ELEMENT_NODE:(node2=node.cloneNode(!1)).ownerDocument=doc;case DOCUMENT_FRAGMENT_NODE:break;case ATTRIBUTE_NODE:deep=!0}if(node2||(node2=node.cloneNode(!1)),node2.ownerDocument=doc,node2.parentNode=null,deep)for(var child=node.firstChild;child;)node2.appendChild(importNode(doc,child,deep)),child=child.nextSibling;return node2}function cloneNode(doc,node,deep){var node2=new node.constructor;for(var n in node){var v=node[n];"object"!=typeof v&&v!=node2[n]&&(node2[n]=v)}switch(node.childNodes&&(node2.childNodes=new NodeList),node2.ownerDocument=doc,node2.nodeType){case ELEMENT_NODE:var attrs=node.attributes,attrs2=node2.attributes=new NamedNodeMap,len=attrs.length;attrs2._ownerElement=node2;for(var i=0;i<len;i++)node2.setAttributeNode(cloneNode(doc,attrs.item(i),!0));break;case ATTRIBUTE_NODE:deep=!0}if(deep)for(var child=node.firstChild;child;)node2.appendChild(cloneNode(doc,child,deep)),child=child.nextSibling;return node2}function __set__(object,key,value){object[key]=value}DOMException.prototype=Error.prototype,copy(ExceptionCode,DOMException),NodeList.prototype={length:0,item:function(index){return this[index]||null},toString:function(isHTML,nodeFilter){for(var buf=[],i=0;i<this.length;i++)serializeToString(this[i],buf,isHTML,nodeFilter);return buf.join("")}},LiveNodeList.prototype.item=function(i){return _updateLiveList(this),this[i]},_extends(LiveNodeList,NodeList),NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(key){for(var i=this.length;i--;){var attr=this[i];if(attr.nodeName==key)return attr}},setNamedItem:function(attr){var el=attr.ownerElement;if(el&&el!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);var oldAttr=this.getNamedItem(attr.nodeName);return _addNamedNode(this._ownerElement,this,attr,oldAttr),oldAttr},setNamedItemNS:function(attr){var el=attr.ownerElement,oldAttr;if(el&&el!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);return oldAttr=this.getNamedItemNS(attr.namespaceURI,attr.localName),_addNamedNode(this._ownerElement,this,attr,oldAttr),oldAttr},removeNamedItem:function(key){var attr=this.getNamedItem(key);return _removeNamedNode(this._ownerElement,this,attr),attr},removeNamedItemNS:function(namespaceURI,localName){var attr=this.getNamedItemNS(namespaceURI,localName);return _removeNamedNode(this._ownerElement,this,attr),attr},getNamedItemNS:function(namespaceURI,localName){for(var i=this.length;i--;){var node=this[i];if(node.localName==localName&&node.namespaceURI==namespaceURI)return node}return null}},DOMImplementation.prototype={hasFeature:function(feature,version){var versions=this._features[feature.toLowerCase()];return!(!versions||version&&!(version in versions))},createDocument:function(namespaceURI,qualifiedName,doctype){var doc=new Document;if(doc.implementation=this,doc.childNodes=new NodeList,doc.doctype=doctype,doctype&&doc.appendChild(doctype),qualifiedName){var root=doc.createElementNS(namespaceURI,qualifiedName);doc.appendChild(root)}return doc},createDocumentType:function(qualifiedName,publicId,systemId){var node=new DocumentType;return node.name=qualifiedName,node.nodeName=qualifiedName,node.publicId=publicId,node.systemId=systemId,node}},Node.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(newChild,refChild){return _insertBefore(this,newChild,refChild)},replaceChild:function(newChild,oldChild){this.insertBefore(newChild,oldChild),oldChild&&this.removeChild(oldChild)},removeChild:function(oldChild){return _removeChild(this,oldChild)},appendChild:function(newChild){return this.insertBefore(newChild,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(deep){return cloneNode(this.ownerDocument||this,this,deep)},normalize:function(){for(var child=this.firstChild;child;){var next=child.nextSibling;next&&next.nodeType==TEXT_NODE&&child.nodeType==TEXT_NODE?(this.removeChild(next),child.appendData(next.data)):(child.normalize(),child=next)}},isSupported:function(feature,version){return this.ownerDocument.implementation.hasFeature(feature,version)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(namespaceURI){for(var el=this;el;){var map=el._nsMap;if(map)for(var n in map)if(map[n]==namespaceURI)return n;el=el.nodeType==ATTRIBUTE_NODE?el.ownerDocument:el.parentNode}return null},lookupNamespaceURI:function(prefix){for(var el=this;el;){var map=el._nsMap;if(map&&prefix in map)return map[prefix];el=el.nodeType==ATTRIBUTE_NODE?el.ownerDocument:el.parentNode}return null},isDefaultNamespace:function(namespaceURI){var prefix;return null==this.lookupPrefix(namespaceURI)}},copy(NodeType,Node),copy(NodeType,Node.prototype),Document.prototype={nodeName:"#document",nodeType:DOCUMENT_NODE,doctype:null,documentElement:null,_inc:1,insertBefore:function(newChild,refChild){if(newChild.nodeType==DOCUMENT_FRAGMENT_NODE){for(var child=newChild.firstChild;child;){var next=child.nextSibling;this.insertBefore(child,refChild),child=next}return newChild}return null==this.documentElement&&newChild.nodeType==ELEMENT_NODE&&(this.documentElement=newChild),_insertBefore(this,newChild,refChild),newChild.ownerDocument=this,newChild},removeChild:function(oldChild){return this.documentElement==oldChild&&(this.documentElement=null),_removeChild(this,oldChild)},importNode:function(importedNode,deep){return importNode(this,importedNode,deep)},getElementById:function(id){var rtv=null;return _visitNode(this.documentElement,(function(node){if(node.nodeType==ELEMENT_NODE&&node.getAttribute("id")==id)return rtv=node,!0})),rtv},createElement:function(tagName){var node=new Element,attrs;return node.ownerDocument=this,node.nodeName=tagName,node.tagName=tagName,node.childNodes=new NodeList,(node.attributes=new NamedNodeMap)._ownerElement=node,node},createDocumentFragment:function(){var node=new DocumentFragment;return node.ownerDocument=this,node.childNodes=new NodeList,node},createTextNode:function(data){var node=new Text;return node.ownerDocument=this,node.appendData(data),node},createComment:function(data){var node=new Comment;return node.ownerDocument=this,node.appendData(data),node},createCDATASection:function(data){var node=new CDATASection;return node.ownerDocument=this,node.appendData(data),node},createProcessingInstruction:function(target,data){var node=new ProcessingInstruction;return node.ownerDocument=this,node.tagName=node.target=target,node.nodeValue=node.data=data,node},createAttribute:function(name){var node=new Attr;return node.ownerDocument=this,node.name=name,node.nodeName=name,node.localName=name,node.specified=!0,node},createEntityReference:function(name){var node=new EntityReference;return node.ownerDocument=this,node.nodeName=name,node},createElementNS:function(namespaceURI,qualifiedName){var node=new Element,pl=qualifiedName.split(":"),attrs=node.attributes=new NamedNodeMap;return node.childNodes=new NodeList,node.ownerDocument=this,node.nodeName=qualifiedName,node.tagName=qualifiedName,node.namespaceURI=namespaceURI,2==pl.length?(node.prefix=pl[0],node.localName=pl[1]):node.localName=qualifiedName,attrs._ownerElement=node,node},createAttributeNS:function(namespaceURI,qualifiedName){var node=new Attr,pl=qualifiedName.split(":");return node.ownerDocument=this,node.nodeName=qualifiedName,node.name=qualifiedName,node.namespaceURI=namespaceURI,node.specified=!0,2==pl.length?(node.prefix=pl[0],node.localName=pl[1]):node.localName=qualifiedName,node}},_extends(Document,Node),Element.prototype={nodeType:ELEMENT_NODE,hasAttribute:function(name){return null!=this.getAttributeNode(name)},getAttribute:function(name){var attr=this.getAttributeNode(name);return attr&&attr.value||""},getAttributeNode:function(name){return this.attributes.getNamedItem(name)},setAttribute:function(name,value){var attr=this.ownerDocument.createAttribute(name);attr.value=attr.nodeValue=""+value,this.setAttributeNode(attr)},removeAttribute:function(name){var attr=this.getAttributeNode(name);attr&&this.removeAttributeNode(attr)},appendChild:function(newChild){return newChild.nodeType===DOCUMENT_FRAGMENT_NODE?this.insertBefore(newChild,null):_appendSingleChild(this,newChild)},setAttributeNode:function(newAttr){return this.attributes.setNamedItem(newAttr)},setAttributeNodeNS:function(newAttr){return this.attributes.setNamedItemNS(newAttr)},removeAttributeNode:function(oldAttr){return this.attributes.removeNamedItem(oldAttr.nodeName)},removeAttributeNS:function(namespaceURI,localName){var old=this.getAttributeNodeNS(namespaceURI,localName);old&&this.removeAttributeNode(old)},hasAttributeNS:function(namespaceURI,localName){return null!=this.getAttributeNodeNS(namespaceURI,localName)},getAttributeNS:function(namespaceURI,localName){var attr=this.getAttributeNodeNS(namespaceURI,localName);return attr&&attr.value||""},setAttributeNS:function(namespaceURI,qualifiedName,value){var attr=this.ownerDocument.createAttributeNS(namespaceURI,qualifiedName);attr.value=attr.nodeValue=""+value,this.setAttributeNode(attr)},getAttributeNodeNS:function(namespaceURI,localName){return this.attributes.getNamedItemNS(namespaceURI,localName)},getElementsByTagName:function(tagName){return new LiveNodeList(this,(function(base){var ls=[];return _visitNode(base,(function(node){node===base||node.nodeType!=ELEMENT_NODE||"*"!==tagName&&node.tagName!=tagName||ls.push(node)})),ls}))},getElementsByTagNameNS:function(namespaceURI,localName){return new LiveNodeList(this,(function(base){var ls=[];return _visitNode(base,(function(node){node===base||node.nodeType!==ELEMENT_NODE||"*"!==namespaceURI&&node.namespaceURI!==namespaceURI||"*"!==localName&&node.localName!=localName||ls.push(node)})),ls}))}},Document.prototype.getElementsByTagName=Element.prototype.getElementsByTagName,Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS,_extends(Element,Node),Attr.prototype.nodeType=ATTRIBUTE_NODE,_extends(Attr,Node),CharacterData.prototype={data:"",substringData:function(offset,count){return this.data.substring(offset,offset+count)},appendData:function(text){text=this.data+text,this.nodeValue=this.data=text,this.length=text.length},insertData:function(offset,text){this.replaceData(offset,0,text)},appendChild:function(newChild){throw new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR])},deleteData:function(offset,count){this.replaceData(offset,count,"")},replaceData:function(offset,count,text){var start,end;text=this.data.substring(0,offset)+text+this.data.substring(offset+count),this.nodeValue=this.data=text,this.length=text.length}},_extends(CharacterData,Node),Text.prototype={nodeName:"#text",nodeType:TEXT_NODE,splitText:function(offset){var text=this.data,newText=text.substring(offset);text=text.substring(0,offset),this.data=this.nodeValue=text,this.length=text.length;var newNode=this.ownerDocument.createTextNode(newText);return this.parentNode&&this.parentNode.insertBefore(newNode,this.nextSibling),newNode}},_extends(Text,CharacterData),Comment.prototype={nodeName:"#comment",nodeType:COMMENT_NODE},_extends(Comment,CharacterData),CDATASection.prototype={nodeName:"#cdata-section",nodeType:CDATA_SECTION_NODE},_extends(CDATASection,CharacterData),DocumentType.prototype.nodeType=DOCUMENT_TYPE_NODE,_extends(DocumentType,Node),Notation.prototype.nodeType=NOTATION_NODE,_extends(Notation,Node),Entity.prototype.nodeType=ENTITY_NODE,_extends(Entity,Node),EntityReference.prototype.nodeType=ENTITY_REFERENCE_NODE,_extends(EntityReference,Node),DocumentFragment.prototype.nodeName="#document-fragment",DocumentFragment.prototype.nodeType=DOCUMENT_FRAGMENT_NODE,_extends(DocumentFragment,Node),ProcessingInstruction.prototype.nodeType=PROCESSING_INSTRUCTION_NODE,_extends(ProcessingInstruction,Node),XMLSerializer.prototype.serializeToString=function(node,isHtml,nodeFilter){return nodeSerializeToString.call(node,isHtml,nodeFilter)},Node.prototype.toString=nodeSerializeToString;try{if(Object.defineProperty){function getTextContent(node){switch(node.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:var buf=[];for(node=node.firstChild;node;)7!==node.nodeType&&8!==node.nodeType&&buf.push(getTextContent(node)),node=node.nextSibling;return buf.join("");default:return node.nodeValue}}Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node.prototype,"textContent",{get:function(){return getTextContent(this)},set:function(data){switch(this.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(;this.firstChild;)this.removeChild(this.firstChild);(data||String(data))&&this.appendChild(this.ownerDocument.createTextNode(data));break;default:this.data=data,this.value=data,this.nodeValue=data}}}),__set__=function(object,key,value){object["$$"+key]=value}}}catch(e){}exports.DOMImplementation=DOMImplementation,exports.XMLSerializer=XMLSerializer},{}],12:[function(require,module,exports){var nameStartChar=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameChar=new RegExp("[\\-\\.0-9"+nameStartChar.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),tagNamePattern=new RegExp("^"+nameStartChar.source+nameChar.source+"*(?::"+nameStartChar.source+nameChar.source+"*)?$"),S_TAG=0,S_ATTR=1,S_ATTR_SPACE=2,S_EQ=3,S_ATTR_NOQUOT_VALUE=4,S_ATTR_END=5,S_TAG_SPACE=6,S_TAG_CLOSE=7;function XMLReader(){}function parse(source,defaultNSMapCopy,entityMap,domBuilder,errorHandler){function fixedFromCharCode(code){if(code>65535){var surrogate1=55296+((code-=65536)>>10),surrogate2=56320+(1023&code);return String.fromCharCode(surrogate1,surrogate2)}return String.fromCharCode(code)}function entityReplacer(a){var k=a.slice(1,-1);return k in entityMap?entityMap[k]:"#"===k.charAt(0)?fixedFromCharCode(parseInt(k.substr(1).replace("x","0x"))):(errorHandler.error("entity not found:"+a),a)}function appendText(end){if(end>start){var xt=source.substring(start,end).replace(/&#?\w+;/g,entityReplacer);locator&&position(start),domBuilder.characters(xt,0,end-start),start=end}}function position(p,m){for(;p>=lineEnd&&(m=linePattern.exec(source));)lineStart=m.index,lineEnd=lineStart+m[0].length,locator.lineNumber++;locator.columnNumber=p-lineStart+1}for(var lineStart=0,lineEnd=0,linePattern=/.*(?:\r\n?|\n)|.*$/g,locator=domBuilder.locator,parseStack=[{currentNSMap:defaultNSMapCopy}],closeMap={},start=0;;){try{var tagStart=source.indexOf("<",start);if(tagStart<0){if(!source.substr(start).match(/^\s*$/)){var doc=domBuilder.doc,text=doc.createTextNode(source.substr(start));doc.appendChild(text),domBuilder.currentElement=text}return}switch(tagStart>start&&appendText(tagStart),source.charAt(tagStart+1)){case"/":var end=source.indexOf(">",tagStart+3),tagName=source.substring(tagStart+2,end),config=parseStack.pop();end<0?(tagName=source.substring(tagStart+2).replace(/[\s<].*/,""),errorHandler.error("end tag name: "+tagName+" is not complete:"+config.tagName),end=tagStart+1+tagName.length):tagName.match(/\s</)&&(tagName=tagName.replace(/[\s<].*/,""),errorHandler.error("end tag name: "+tagName+" maybe not complete"),end=tagStart+1+tagName.length);var localNSMap=config.localNSMap,endMatch=config.tagName==tagName,endIgnoreCaseMach;if(endMatch||config.tagName&&config.tagName.toLowerCase()==tagName.toLowerCase()){if(domBuilder.endElement(config.uri,config.localName,tagName),localNSMap)for(var prefix in localNSMap)domBuilder.endPrefixMapping(prefix);endMatch||errorHandler.fatalError("end tag name: "+tagName+" is not match the current start tagName:"+config.tagName)}else parseStack.push(config);end++;break;case"?":locator&&position(tagStart),end=parseInstruction(source,tagStart,domBuilder);break;case"!":locator&&position(tagStart),end=parseDCC(source,tagStart,domBuilder,errorHandler);break;default:locator&&position(tagStart);var el=new ElementAttributes,currentNSMap=parseStack[parseStack.length-1].currentNSMap,end=parseElementStartPart(source,tagStart,el,currentNSMap,entityReplacer,errorHandler),len=el.length;if(!el.closed&&fixSelfClosed(source,end,el.tagName,closeMap)&&(el.closed=!0,entityMap.nbsp||errorHandler.warning("unclosed xml attribute")),locator&&len){for(var locator2=copyLocator(locator,{}),i=0;i<len;i++){var a=el[i];position(a.offset),a.locator=copyLocator(locator,{})}domBuilder.locator=locator2,appendElement(el,domBuilder,currentNSMap)&&parseStack.push(el),domBuilder.locator=locator}else appendElement(el,domBuilder,currentNSMap)&&parseStack.push(el);"http://www.w3.org/1999/xhtml"!==el.uri||el.closed?end++:end=parseHtmlSpecialContent(source,end,el.tagName,entityReplacer,domBuilder)}}catch(e){errorHandler.error("element parse error: "+e),end=-1}end>start?start=end:appendText(Math.max(tagStart,start)+1)}}function copyLocator(f,t){return t.lineNumber=f.lineNumber,t.columnNumber=f.columnNumber,t}function parseElementStartPart(source,start,el,currentNSMap,entityReplacer,errorHandler){for(var attrName,value,p=++start,s=0;;){var c=source.charAt(p);switch(c){case"=":if(1===s)attrName=source.slice(start,p),s=3;else{if(2!==s)throw new Error("attribute equal must after attrName");s=3}break;case"'":case'"':if(3===s||1===s){if(1===s&&(errorHandler.warning('attribute value must after "="'),attrName=source.slice(start,p)),start=p+1,!((p=source.indexOf(c,start))>0))throw new Error("attribute value no end '"+c+"' match");value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer),el.add(attrName,value,start-1),s=5}else{if(4!=s)throw new Error('attribute value must after "="');value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer),el.add(attrName,value,start),errorHandler.warning('attribute "'+attrName+'" missed start quot('+c+")!!"),start=p+1,s=5}break;case"/":switch(s){case 0:el.setTagName(source.slice(start,p));case 5:case 6:case 7:s=7,el.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return errorHandler.error("unexpected end of input"),0==s&&el.setTagName(source.slice(start,p)),p;case">":switch(s){case 0:el.setTagName(source.slice(start,p));case 5:case 6:case 7:break;case 4:case 1:"/"===(value=source.slice(start,p)).slice(-1)&&(el.closed=!0,value=value.slice(0,-1));case 2:2===s&&(value=attrName),4==s?(errorHandler.warning('attribute "'+value+'" missed quot(")!!'),el.add(attrName,value.replace(/&#?\w+;/g,entityReplacer),start)):("http://www.w3.org/1999/xhtml"===currentNSMap[""]&&value.match(/^(?:disabled|checked|selected)$/i)||errorHandler.warning('attribute "'+value+'" missed value!! "'+value+'" instead!!'),el.add(value,value,start));break;case 3:throw new Error("attribute value missed!!")}return p;case"":c=" ";default:if(c<=" ")switch(s){case 0:el.setTagName(source.slice(start,p)),s=6;break;case 1:attrName=source.slice(start,p),s=2;break;case 4:var value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer);errorHandler.warning('attribute "'+value+'" missed quot(")!!'),el.add(attrName,value,start);case 5:s=6}else switch(s){case 2:var tagName=el.tagName;"http://www.w3.org/1999/xhtml"===currentNSMap[""]&&attrName.match(/^(?:disabled|checked|selected)$/i)||errorHandler.warning('attribute "'+attrName+'" missed value!! "'+attrName+'" instead2!!'),el.add(attrName,attrName,start),start=p,s=1;break;case 5:errorHandler.warning('attribute space is required"'+attrName+'"!!');case 6:s=1,start=p;break;case 3:s=4,start=p;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}p++}}function appendElement(el,domBuilder,currentNSMap){for(var tagName=el.tagName,localNSMap=null,i=el.length;i--;){var a=el[i],qName=a.qName,value=a.value,nsp;if((nsp=qName.indexOf(":"))>0)var prefix=a.prefix=qName.slice(0,nsp),localName=qName.slice(nsp+1),nsPrefix="xmlns"===prefix&&localName;else localName=qName,prefix=null,nsPrefix="xmlns"===qName&&"";a.localName=localName,!1!==nsPrefix&&(null==localNSMap&&(localNSMap={},_copy(currentNSMap,currentNSMap={})),currentNSMap[nsPrefix]=localNSMap[nsPrefix]=value,a.uri="http://www.w3.org/2000/xmlns/",domBuilder.startPrefixMapping(nsPrefix,value))}for(var i=el.length;i--;){var prefix;(prefix=(a=el[i]).prefix)&&("xml"===prefix&&(a.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==prefix&&(a.uri=currentNSMap[prefix||""]))}var nsp;(nsp=tagName.indexOf(":"))>0?(prefix=el.prefix=tagName.slice(0,nsp),localName=el.localName=tagName.slice(nsp+1)):(prefix=null,localName=el.localName=tagName);var ns=el.uri=currentNSMap[prefix||""];if(domBuilder.startElement(ns,localName,tagName,el),!el.closed)return el.currentNSMap=currentNSMap,el.localNSMap=localNSMap,!0;if(domBuilder.endElement(ns,localName,tagName),localNSMap)for(prefix in localNSMap)domBuilder.endPrefixMapping(prefix)}function parseHtmlSpecialContent(source,elStartEnd,tagName,entityReplacer,domBuilder){if(/^(?:script|textarea)$/i.test(tagName)){var elEndStart=source.indexOf("</"+tagName+">",elStartEnd),text=source.substring(elStartEnd+1,elEndStart);if(/[&<]/.test(text))return/^script$/i.test(tagName)?(domBuilder.characters(text,0,text.length),elEndStart):(text=text.replace(/&#?\w+;/g,entityReplacer),domBuilder.characters(text,0,text.length),elEndStart)}return elStartEnd+1}function fixSelfClosed(source,elStartEnd,tagName,closeMap){var pos=closeMap[tagName];return null==pos&&((pos=source.lastIndexOf("</"+tagName+">"))<elStartEnd&&(pos=source.lastIndexOf("</"+tagName)),closeMap[tagName]=pos),pos<elStartEnd}function _copy(source,target){for(var n in source)target[n]=source[n]}function parseDCC(source,start,domBuilder,errorHandler){var next;switch(source.charAt(start+2)){case"-":var end;return"-"===source.charAt(start+3)?(end=source.indexOf("--\x3e",start+4))>start?(domBuilder.comment(source,start+4,end-start-4),end+3):(errorHandler.error("Unclosed comment"),-1):-1;default:if("CDATA["==source.substr(start+3,6)){var end=source.indexOf("]]>",start+9);return domBuilder.startCDATA(),domBuilder.characters(source,start+9,end-start-9),domBuilder.endCDATA(),end+3}var matchs=split(source,start),len=matchs.length;if(len>1&&/!doctype/i.test(matchs[0][0])){var name=matchs[1][0],pubid=len>3&&/^public$/i.test(matchs[2][0])&&matchs[3][0],sysid=len>4&&matchs[4][0],lastMatch=matchs[len-1];return domBuilder.startDTD(name,pubid&&pubid.replace(/^(['"])(.*?)\1$/,"$2"),sysid&&sysid.replace(/^(['"])(.*?)\1$/,"$2")),domBuilder.endDTD(),lastMatch.index+lastMatch[0].length}}return-1}function parseInstruction(source,start,domBuilder){var end=source.indexOf("?>",start);if(end){var match=source.substring(start,end).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(match){var len=match[0].length;return domBuilder.processingInstruction(match[1],match[2]),end+2}return-1}return-1}function ElementAttributes(source){}function _set_proto_(thiz,parent){return thiz.__proto__=parent,thiz}function split(source,start){var match,buf=[],reg=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(reg.lastIndex=start,reg.exec(source);match=reg.exec(source);)if(buf.push(match),match[1])return buf}XMLReader.prototype={parse:function(source,defaultNSMap,entityMap){var domBuilder=this.domBuilder;domBuilder.startDocument(),_copy(defaultNSMap,defaultNSMap={}),parse(source,defaultNSMap,entityMap,domBuilder,this.errorHandler),domBuilder.endDocument()}},ElementAttributes.prototype={setTagName:function(tagName){if(!tagNamePattern.test(tagName))throw new Error("invalid tagName:"+tagName);this.tagName=tagName},add:function(qName,value,offset){if(!tagNamePattern.test(qName))throw new Error("invalid attribute:"+qName);this[this.length++]={qName:qName,value:value,offset:offset}},length:0,getLocalName:function(i){return this[i].localName},getLocator:function(i){return this[i].locator},getQName:function(i){return this[i].qName},getURI:function(i){return this[i].uri},getValue:function(i){return this[i].value}},_set_proto_({},_set_proto_.prototype)instanceof _set_proto_||(_set_proto_=function(thiz,parent){function p(){}for(parent in p.prototype=parent,p=new p,thiz)p[parent]=thiz[parent];return p}),exports.XMLReader=XMLReader},{}],13:[function(require,module,exports){"use strict";var isEmpty=require("lodash.isempty"),flatten=require("lodash.flatten"),vg=require("./libraries/vg/vg"),img=require("./libraries/img/img"),g={};function importCommands(module){for(var k in module)g[k]=module[k]}for(var k in vg)g[k]=vg[k];for(var k in delete g.delete,img)g[k]=img[k];function splitRow(s,delimiter){var row=[],c,col="",i,inString=!1;for(s=s.trim(),i=0;i<s.length;i+=1)'"'===(c=s[i])?'"'===s[i+1]?(col+='"',i+=1):inString=!inString:c===delimiter?inString?col+=c:(row.push(col),col=""):col+=c;return row.push(col),row}importCommands(require("./libraries/math")),importCommands(require("./libraries/string")),importCommands(require("./libraries/list")),importCommands(require("./libraries/data")),importCommands(require("./libraries/image")),importCommands(require("./libraries/graphics")),importCommands(require("./libraries/easing")),g.importSVG=function(svgString){return g.svg.parseString(svgString)},g.importImage=function(image){var layer=g.Layer.fromImage(image);return new g.Img(layer.toCanvas())},g.importText=function(string){return string?String(string):""},g.importCSV=function(csvString,delimiter){var csvRows,header;if(delimiter=delimiter||",",!csvString)return null;header=splitRow((csvRows=csvString.split(/\r\n|\r|\n/g))[0],delimiter),csvRows=csvRows.slice(1);for(var row,rows=[],m,sr,col,index,i=0;i<csvRows.length;i+=1)if(row=csvRows[i],!isEmpty(row)){for(m={},sr=splitRow(row,delimiter),index=0;index<sr.length;index+=1)col=sr[index],m[header[index]]=isNaN(col)?col:parseFloat(col);rows.push(m)}return rows},g.merge=function(){var args=flatten(arguments);if(Array.isArray(args)){for(var objects=[],i=0;i<args.length;i+=1)isEmpty(args[i])||objects.push(args[i]);if(objects.length>0){var o=objects[0];if(o&&(o.commands||o.shapes||o.fontFamily))return vg.merge(objects);if(o instanceof img.Img)return img.merge(objects)}}return null},g.mix=function(a,b,t){if(t=void 0!==t?t:.5,"number"==typeof a)return a*(1-t)+b*t;if("object"==typeof a){for(var result={},keys=Object.keys(a),i=0,n=keys.length;i<n;i+=1){var k=keys[i],va=a[k],vb=b[k];void 0!==va&&void 0!==vb&&(result[k]=g.mix(va,vb,t))}return result}return 0},module.exports=g},{"./libraries/data":14,"./libraries/easing":16,"./libraries/graphics":17,"./libraries/image":18,"./libraries/img/img":22,"./libraries/list":25,"./libraries/math":26,"./libraries/string":27,"./libraries/vg/vg":49,"lodash.flatten":3,"lodash.isempty":5}],14:[function(require,module,exports){"use strict";var values=require("lodash.values"),groupBy=require("lodash.groupby"),list=require("./list"),g={convert:function(v,inMin,inMax,outMin,outMax){var argLength=arguments.length;if(2===argLength){var d=arguments[1];inMin=d.inMin,inMax=d.inMax,outMin=d.outMin,outMax=d.outMax}else 3===argLength&&(inMin=arguments[1][0],inMax=arguments[1][1],outMin=arguments[2][0],outMax=arguments[2][1]);try{v=(v-inMin)/(inMax-inMin)}catch(e){v=inMin}return outMin+v*(outMax-outMin)},filterData:function(data,key,op,value){var i,l,row,obj;if(null==value)return data;var results=[];if("=="===op)for(i=0,l=data.length;i<l;i++)(obj=(row=data[i])[key])==value&&results.push(row);else if("!="===op)for(i=0,l=data.length;i<l;i++)(obj=(row=data[i])[key])!=value&&results.push(row);else if(">"===op)for(i=0,l=data.length;i<l;i++)(obj=(row=data[i])[key])>value&&results.push(row);else if(">="===op)for(i=0,l=data.length;i<l;i++)(obj=(row=data[i])[key])>=value&&results.push(row);else if("<"===op)for(i=0,l=data.length;i<l;i++)(obj=(row=data[i])[key])<value&&results.push(row);else{if("<="!==op)throw new Error("Invalid op "+op);for(i=0,l=data.length;i<l;i++)(obj=(row=data[i])[key])<=value&&results.push(row)}return results},groupBy:function(data,key){return values(groupBy(data,key))},keys:function(data){for(var allKeys=[],i=0;i<data.length;i++)allKeys=allKeys.concat(Object.keys(data[i]));return list.distinct(allKeys)},lookup:function(table,key){var obj,v;if(void 0!==(v=(obj=table)[key]))return"function"==typeof v&&(v=v.call(obj)),v;for(var token,tokens=key.split("."),i=0;i<tokens.length;i+=1)token=tokens[i],obj&&(obj="function"==typeof obj[token]?(v=obj[token]).call(obj):obj[token]);return obj},dataScale:function(domain,outMin,outMax){return{domain:domain,outMin:outMin,outMax:outMax}},ticks:function(min,max,n){n=void 0!==n?n:10;var span=max-min,step=Math.pow(10,Math.floor(Math.log(span/n)/Math.LN10)),err=n/span*step,ticks=[],i;for(err<=.15?step*=10:err<=.35?step*=5:err<=.75&&(step*=2),min=Math.ceil(min/step)*step,max=Math.floor(max/step)*step+.5*step,i=min;i<max;i+=step)ticks.push(i);return ticks}};module.exports=g},{"./list":25,"lodash.groupby":4,"lodash.values":7}],15:[function(require,module,exports){"use strict";function isBuffer(){return!1}function isObject(arg){return"object"==typeof arg&&null!==arg}function objectToString(o){return Object.prototype.toString.call(o)}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isNullOrUndefined(arg){return null==arg}var util={isObject:isObject,isRegExp:isRegExp,isDate:isDate,isNullOrUndefined:isNullOrUndefined,isBuffer:isBuffer},pSlice=Array.prototype.slice,deepEqual={},isArguments,_deepEqual,objEquiv;_deepEqual=function(actual,expected){if(actual===expected)return!0;if(util.isBuffer(actual)&&util.isBuffer(expected)){if(actual.length!==expected.length)return!1;for(var i=0;i<actual.length;i++)if(actual[i]!==expected[i])return!1;return!0}return util.isDate(actual)&&util.isDate(expected)?actual.getTime()===expected.getTime():util.isRegExp(actual)&&util.isRegExp(expected)?actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase:util.isObject(actual)||util.isObject(expected)?objEquiv(actual,expected):actual==expected},deepEqual.deepEqual=_deepEqual,isArguments=function(object){return"[object Arguments]"===Object.prototype.toString.call(object)},objEquiv=function(a,b){if(util.isNullOrUndefined(a)||util.isNullOrUndefined(b))return!1;if(a.prototype!==b.prototype)return!1;var aIsArgs=isArguments(a),bIsArgs=isArguments(b),ka,kb,key,i;if(aIsArgs&&!bIsArgs||!aIsArgs&&bIsArgs)return!1;if(aIsArgs)return a=pSlice.call(a),b=pSlice.call(b),_deepEqual(a,b);try{ka=Object.keys(a),kb=Object.keys(b)}catch(e){return!1}if(ka.length!==kb.length)return!1;for(ka.sort(),kb.sort(),i=ka.length-1;i>=0;i--)if(ka[i]!=kb[i])return!1;for(i=ka.length-1;i>=0;i--)if(key=ka[i],!_deepEqual(a[key],b[key]))return!1;return!0},module.exports=deepEqual},{}],16:[function(require,module,exports){"use strict";var g={easeInQuad:function(t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},easeInCubic:function(t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t+b:c/2*((t-=2)*t*t+2)+b},easeInQuart:function(t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t+b:-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(t,b,c,d){return 0===t?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(t,b,c,d){return t===d?b+c:c*(1-Math.pow(2,-10*t/d))+b},easeInOutExpo:function(t,b,c,d){return 0===t?b:t===d?b+c:(t/=d/2)<1?c/2*Math.pow(2,10*(t-1))+b:c/2*(2-Math.pow(2,-10*--t))+b},easeInCirc:function(t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(t,b,c,d){return(t/=d/2)<1?-c/2*(Math.sqrt(1-t*t)-1)+b:c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(t,b,c,d){var s=1.70158,p=0,a=c;return 0===t?b:1==(t/=d)?b+c:(p||(p=.3*d),a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),-a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)+b)},easeOutElastic:function(t,b,c,d){var s=1.70158,p=0,a=c;return 0===t?b:1==(t/=d)?b+c:(p||(p=.3*d),a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b)},easeInOutElastic:function(t,b,c,d){var s=1.70158,p=0,a=c;return 0===t?b:2==(t/=d/2)?b+c:(p||(p=d*(.3*1.5)),a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*-.5+b:a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b)},easeInBack:function(t,b,c,d,s){return void 0===s&&(s=1.70158),c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(t,b,c,d,s){return void 0===s&&(s=1.70158),c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(t,b,c,d,s){return void 0===s&&(s=1.70158),(t/=d/2)<1?c/2*(t*t*((1+(s*=1.525))*t-s))+b:c/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+b},easeInBounce:function(t,b,c,d){return c-g.easeOutBounce(d-t,0,c,d)+b},easeOutBounce:function(t,b,c,d){return(t/=d)<1/2.75?c*(7.5625*t*t)+b:t<2/2.75?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:t<2.5/2.75?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},easeInOutBounce:function(t,b,c,d){return t<d/2?.5*g.easeInBounce(2*t,0,c,d)+b:.5*g.easeOutBounce(2*t-d,0,c,d)+.5*c+b},easing:function(f){var fn=g[f],args=Array.prototype.slice.call(arguments,1);return fn.apply(null,args)}};module.exports=g},{}],17:[function(require,module,exports){"use strict";var vg=require("./vg/vg"),img=require("./img/img"),math=require("./math"),g={};function clamp(val,min,max){return Math.min(max,Math.max(min,val))}function transformShape(shape,t){return t.transformShape(shape)}function transformImage(image,t){return image._transform(t.m)}function transform(shape,t){if(shape instanceof vg.Path||shape instanceof vg.Group||shape instanceof vg.Text||void 0!==shape.x&&void 0!==shape.y)return transformShape(shape,t);if(Array.isArray(shape)){for(var l=[],i=0;i<shape.length;i+=1)l.push(transform(shape[i],t));return l}return shape instanceof img.Img?transformImage(shape,t):void 0}g.HORIZONTAL="horizontal",g.VERTICAL="vertical",g.BOTH="both",g.LEFT="left",g.RIGHT="right",g.CENTER="center",g.TOP="top",g.BOTTOM="bottom",g.MIDDLE="middle",g.align=function(shape,position,hAlign,vAlign){if(shape){var dx,dy,t,x=position.x,y=position.y,bounds=vg.bounds(shape);return dx=hAlign===g.LEFT?x-bounds.x:hAlign===g.RIGHT?x-bounds.x-bounds.width:hAlign===g.CENTER?x-bounds.x-bounds.width/2:0,dy=vAlign===g.TOP?y-bounds.y:vAlign===g.BOTTOM?y-bounds.y-bounds.height:vAlign===g.MIDDLE?y-bounds.y-bounds.height/2:0,transform(shape,t=(new vg.Transform).translate(dx,dy))}},g.colorize=function(shape,options){var args=arguments;if(("object"!=typeof options||options instanceof vg.Color)&&(options={},void 0!==args[1]&&(options.fill=args[1]),void 0!==args[2]&&(options.stroke=args[2]),void 0!==args[3]&&(options.strokeWidth=args[3])),shape instanceof vg.Path||shape instanceof vg.Group)return shape.colorize(options);if(shape instanceof img.Img||shape instanceof vg.Text){if(options.fill||0===options.fill)return shape.colorize(options.fill);throw new Error("No color given")}},g.copy=function(shape,copies,order,translate,rotate,scale){var i,t,j,op,fn,shapes=[],tx=0,ty=0,r=0,sx=1,sy=1,isListOfPoints=!1;for(shape instanceof vg.Path||shape instanceof vg.Group||shape instanceof vg.Text?fn=transformShape:Array.isArray(shape)&&shape.length>0&&void 0!==shape[0].x&&void 0!==shape[0].y?(isListOfPoints=!0,fn=transformShape):shape instanceof img.Img&&(fn=transformImage),i=0;i<copies;i+=1){for(t=new vg.Transform,j=0;j<order.length;j+=1)"t"===(op=order[j])?t=t.translate(tx,ty):"r"===op?t=t.rotate(r):"s"===op&&(t=t.scale(sx,sy));isListOfPoints?shapes=shapes.concat(fn(shape,t)):shapes.push(fn(shape,t)),tx+=translate.x,ty+=translate.y,r+=rotate,sx+=scale.x,sy+=scale.y}return shapes},g.flip=function(shape,axis){if("none"===axis)return shape;if(shape instanceof vg.Path||shape instanceof vg.Group||shape instanceof vg.Text||Array.isArray(shape)&&shape.length>0&&void 0!==shape[0].x&&void 0!==shape[0].y){var x=axis===g.HORIZONTAL||axis===g.BOTH?-1:1,y=axis===g.VERTICAL||axis===g.BOTH?-1:1;return vg.scale(shape,new vg.Point(x,y),vg.centerPoint(shape))}if(shape instanceof img.Img){var image=shape,layer=image.toLayer(!1);return axis!==g.HORIZONTAL&&axis!==g.BOTH||layer.flipHorizontal(),axis!==g.VERTICAL&&axis!==g.BOTH||layer.flipVertical(),image.withCanvas(layer.toCanvas())}},g.fit=function(shape,position,width,height,stretch){if(shape){stretch=void 0!==stretch&&stretch;var t,sx,sy,bounds=vg.bounds(shape),bx=bounds.x,by=bounds.y,bw=bounds.width,bh=bounds.height;return bw=bw>1e-12?bw:0,bh=bh>1e-12?bh:0,t=(t=new vg.Transform).translate(position.x,position.y),stretch?(sx=bw>0?width/bw:1,sy=bh>0?height/bh:1):(sx=bw>0?width/bw:Number.MAX_VALUE,sy=bh>0?height/bh:Number.MAX_VALUE,sx=sy=Math.min(sx,sy)),transform(shape,t=(t=t.scale(sx,sy)).translate(-bw/2-bx,-bh/2-by))}},g.fitTo=function(shape,bounding,stretch){if(shape){if(!bounding)return shape;var bounds=vg.bounds(bounding),bx=bounds.x,by=bounds.y,bw=bounds.width,bh=bounds.height;return g.fit(shape,{x:bx+bw/2,y:by+bh/2},bw,bh,stretch)}},g.hslAdjust=function(v,hue,saturation,lightness,alpha){if(alpha||(alpha=0),v instanceof img.Img){var image=v,layer=image.toLayer(!1);return layer.addFilter("hslAdjust",{h:hue,s:saturation,l:lightness,a:alpha}),image.withCanvas(layer.toCanvas())}hue=clamp(hue,-1,1),saturation=clamp(saturation,-1,1),lightness=clamp(lightness,-1,1),alpha=clamp(alpha,-1,1);var satMul=1+saturation*(saturation<0?1:2),lightMul=lightness<0?1+lightness:1-lightness,lightAdd=lightness<0?0:lightness,r,g,b,vs,ms,vm,h,s,l,m,vmh,sextant;function hslAdjust(v1){if(v1 instanceof vg.Group){for(var newShapes=[],i=0;i<v1.shapes.length;i+=1)newShapes.push(hslAdjust(v1.shapes[i]));return new vg.Group(newShapes)}if(v1 instanceof vg.Path){var p=v1.clone();return p.fill=hslAdjust(p.fill),p.stroke=hslAdjust(p.stroke),p}var c=v1;return c instanceof vg.Color||(c=vg.Color.parse(c)),r=c.r,g=c.g,b=c.b,0===hue&&0===saturation||(g>(vs=r)&&(vs=g),b>vs&&(vs=b),g<(ms=r)&&(ms=g),b<ms&&(ms=b),vm=vs-ms,(l=(ms+vs)/2)>0&&vm>0&&(l<=.5?((s=vm/(vs+ms)*satMul)>1&&(s=1),v=l*(1+s)):((s=vm/(2-vs-ms)*satMul)>1&&(s=1),v=l+s-l*s),(h=r===vs?g===ms?5+(vs-b)/vm+hue:1-(vs-g)/vm+hue:g===vs?b===ms?1+(vs-r)/vm+hue:3-(vs-b)/vm+hue:r===ms?3+(vs-g)/vm+hue:5-(vs-r)/vm+hue)<0&&(h+=6),h>=6&&(h-=6),vmh=(v-(m=l+l-v))*(h-(sextant=h>>0)),0===sextant?(r=v,g=m+vmh,b=m):1===sextant?(r=v-vmh,g=v,b=m):2===sextant?(r=m,g=v,b=m+vmh):3===sextant?(r=m,g=v-vmh,b=v):4===sextant?(r=m+vmh,g=m,b=v):5===sextant&&(r=v,g=m,b=v-vmh))),(r=r*lightMul+lightAdd)<0&&(r=0),(g=g*lightMul+lightAdd)<0&&(g=0),(b=b*lightMul+lightAdd)<0&&(b=0),r>1&&(r=1),g>1&&(g=1),b>1&&(b=1),new vg.Color(r,g,b,c.a+alpha)}return hue=6*hue%6,hslAdjust(v)},g.rgbAdjust=function(v,red,green,blue,alpha){function rgbAdjust(v){if(v instanceof img.Img){var image=v,layer=image.toLayer(!1);return layer.addFilter("rgbAdjust",{r:red,g:green,b:blue,a:alpha}),image.withCanvas(layer.toCanvas())}if(v instanceof vg.Group){for(var newShapes=[],i=0;i<v.shapes.length;i+=1)newShapes.push(rgbAdjust(v.shapes[i]));return new vg.Group(newShapes)}if(v instanceof vg.Path){var p=v.clone();return p.fill=rgbAdjust(p.fill),p.stroke=rgbAdjust(p.stroke),p}var c=v;return c instanceof vg.Color||(c=vg.Color.parse(c)),new vg.Color(c.r+red,c.g+green,c.b+blue,c.a+alpha)}return alpha||(alpha=0),red=clamp(red,-1,1),green=clamp(green,-1,1),blue=clamp(blue,-1,1),alpha=clamp(alpha,-1,1),rgbAdjust(v)},g.stack=function(shapes,direction,margin){if(!shapes)return[];if(shapes.length<=1)return shapes;var i,shape,tx,ty,t,bounds,firstBounds=shapes[0].bounds(),newShapes=[];if("e"===direction)for(tx=firstBounds.x,i=0;i<shapes.length;i+=1)bounds=(shape=shapes[i]).bounds(),t=(new vg.Transform).translate(tx-bounds.x,0),newShapes.push(transform(shape,t)),tx+=bounds.width+margin;else if("w"===direction)for(tx=firstBounds.x+firstBounds.width,i=0;i<shapes.length;i+=1)bounds=(shape=shapes[i]).bounds(),t=(new vg.Transform).translate(tx-(bounds.x+bounds.width),0),newShapes.push(transform(shape,t)),tx-=bounds.width+margin;else if("n"===direction)for(ty=firstBounds.y+firstBounds.height,i=0;i<shapes.length;i+=1)bounds=(shape=shapes[i]).bounds(),t=(new vg.Transform).translate(0,ty-(bounds.y+bounds.height)),newShapes.push(transform(shape,t)),ty-=bounds.height+margin;else if("s"===direction)for(ty=firstBounds.y,i=0;i<shapes.length;i+=1)bounds=(shape=shapes[i]).bounds(),t=(new vg.Transform).translate(0,ty-bounds.y),newShapes.push(transform(shape,t)),ty+=bounds.height+margin;return newShapes},g.angle=function(point1,point2){var args=arguments;return 4===args.length?(point1=vg.Point.read(args[0],args[1]),point2=vg.Point.read(args[2],args[3])):(point1=vg.Point.read(point1),point2=vg.Point.read(point2)),math.degrees(Math.atan2(point2.y-point1.y,point2.x-point1.x))},g.coordinates=function(point,angle,distance){var args=arguments;return 4===args.length?(point=vg.Point.read(args[0],args[1]),angle=args[2],distance=args[3]):point=vg.Point.read(point),vg.geo.coordinates(point.x,point.y,angle,distance)},g.distance=function(point1,point2){var args=arguments;return 4===args.length?(point1=vg.Point.read(args[0],args[1]),point2=vg.Point.read(args[2],args[3])):(point1=vg.Point.read(point1),point2=vg.Point.read(point2)),Math.sqrt(Math.pow(point2.x-point1.x,2)+Math.pow(point2.y-point1.y,2))},g.grayColor=function(gray,alpha){return alpha||0===alpha||(alpha=1),vg.Color.gray(gray,alpha,1)},g.hexColor=function(s){function isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n)}return"#"!==(s=isNumeric(s)?s.toString(16):String(s))[0]&&(s="#"+s),vg.Color.parse(s)},g.hslColor=function(hue,saturation,lightness,alpha){return alpha||0===alpha||(alpha=1),vg.Color.hsl(hue,saturation,lightness,alpha,1)},g.rgbColor=function(red,green,blue,alpha){return alpha||0===alpha||(alpha=1),vg.Color.rgb(red,green,blue,alpha,1)},g.desaturate=function(shape,method){return shape?shape.desaturate({method:method}):null},g.invert=function(shape){if(!shape)return null;if(shape instanceof img.Img){var image=shape,layer=image.toLayer(!1);return layer.addFilter("invert"),image.withCanvas(layer.toCanvas())}return shape.invert()},module.exports=g},{"./img/img":22,"./math":26,"./vg/vg":49}],18:[function(require,module,exports){"use strict";var vg=require("./vg/vg"),img=require("./img/img"),Img=img.Img,Layer=img.Layer,ImageCanvas=img.ImageCanvas,g={blend:function(image1,image2,mode){var b1=image1.bounds(),b2=image2.bounds(),b=new vg.Rect(b1.x,b1.y,b1.width,b1.height).unite(b2),width=Math.ceil(b.width),height=Math.ceil(b.height),dx=width/2+b.x,dy=height/2+b.y,canvas=new ImageCanvas(width,height),l1;canvas.addLayer(image1.toLayer()).translate(-dx,-dy);var l2=canvas.addLayer(image2.toLayer());return l2.translate(-dx,-dy),l2.blendmode=mode,new Img(canvas.render(),dx,dy)},blur:function(image,radius){var layer=image.toLayer(!1);return layer.addFilter("blur",{radius:radius}),image.withCanvas(layer.toCanvas())},brighten:function(image,brightness,contrast){var layer=image.toLayer(!1);return layer.addFilter("brightness",{brightness:brightness/100,contrast:contrast/100}),image.withCanvas(layer.toCanvas())},bump:function(image,position,radius,zoom){var layer=image.toLayer(!1);return layer.addFilter("bump",{dx:position.x,dy:position.y,radius:radius,zoom:zoom/100}),image.withCanvas(layer.toCanvas())},colorImage:function(width,height,color){var layer=Layer.fromColor(color);return layer.width=width,layer.height=height,new Img(layer.toCanvas())},crop:function(image,bounding){return image.crop(bounding)},crossEdges:function(image,strength){var layer=image.toLayer(!1);return layer.addFilter("crossedges",{strength:strength/100}),image.withCanvas(layer.toCanvas())},dent:function(image,position,radius,zoom){var layer=image.toLayer(!1);return layer.addFilter("dent",{dx:position.x,dy:position.y,radius:radius,zoom:zoom/100}),image.withCanvas(layer.toCanvas())},emboss:function(image,amount,angle){var layer=image.toLayer(!1);return layer.addFilter("emboss",{amount:amount/100,angle:angle}),image.withCanvas(layer.toCanvas())},equalize:function(image){var layer=image.toLayer(!1);return layer.addFilter("equalize"),image.withCanvas(layer.toCanvas())},findEdges:function(image){var layer=image.toLayer(!1);return layer.addFilter("findedges"),image.withCanvas(layer.toCanvas())},glow:function(image,amount,kernelSize){var layer=image.toLayer(!1);return layer.addFilter("glow",{amount:amount/100,kernelSize:kernelSize}),image.withCanvas(layer.toCanvas())},gradientImage:function(width,height,startColor,endColor,type,angle,spread){var layer=Layer.fromGradient(startColor,endColor,type,angle,spread/100);return layer.width=width,layer.height=height,new Img(layer.toCanvas())},histogram:function(image,channel,relative){var pixels=image.getPixels(),vals=new Array(256),i,c,pixel,comp;for(i=0;i<vals.length;i+=1)vals[i]=0;if("lum"===channel)for(i=0;i<pixels.width*pixels.height;i+=1)comp=.2125*(pixel=pixels.get(i))[0]+.7154*pixel[1]+.0721*pixel[2],vals[Math.round(comp)]+=1;else for("red"===channel&&(c=0),"green"===channel&&(c=1),"blue"===channel&&(c=2),"alpha"===channel&&(c=3),i=0;i<pixels.width*pixels.height;i+=1)vals[comp=(pixel=pixels.get(i))[c]]+=1;if(relative)for(i=0;i<vals.length;i+=1)vals[i]/=pixels.width*pixels.height;return vals},lightTunnel:function(image,position,radius){var layer=image.toLayer(!1);return layer.addFilter("splash",{dx:position.x,dy:position.y,radius:radius}),image.withCanvas(layer.toCanvas())},luminanceBW:function(image){var layer=image.toLayer(!1);return layer.addFilter("luminancebw"),image.withCanvas(layer.toCanvas())},mask:function(image,mask){image=image.transformed(),mask=mask.transformed();var layer=image.toLayer(!1),maskLayer=mask.toLayer(),b1=image.bounds(),b2=mask.bounds(),b=new vg.Rect(b1.x,b1.y,b1.width,b1.height).unite(b2),width=Math.ceil(b.width),height=Math.ceil(b.height),dx=width/2+b.x,dy=height/2+b.y;maskLayer.translate(-dx,-dy);var l=layer.mask.addLayer("white");return l.width=layer.width,l.height=layer.height,layer.mask.addLayer(maskLayer),image.withCanvas(layer.toCanvas())},mosaic:function(image,blockSize){var layer=image.toLayer(!1);return layer.addFilter("mosaic",{blockSize:blockSize}),image.withCanvas(layer.toCanvas())},pinch:function(image,position,zoom){var layer=image.toLayer(!1);return layer.addFilter("pinch",{dx:position.x,dy:position.y,zoom:zoom/100}),image.withCanvas(layer.toCanvas())},posterize:function(image,levels){var layer=image.toLayer(!1);return layer.addFilter("posterize",{levels:levels}),image.withCanvas(layer.toCanvas())},removeNoise:function(image){var layer=image.toLayer(!1);return layer.addFilter("removenoise"),image.withCanvas(layer.toCanvas())},solarize:function(image){var layer=image.toLayer(!1);return layer.addFilter("solarize"),image.withCanvas(layer.toCanvas())},toBitmap:function(shape,bounding){var canvas=document.createElement("canvas"),bounds,x=(bounds=bounding?bounding.bounds():shape.bounds()).x,y=bounds.y,width=canvas.width=Math.ceil(bounds.width),height=canvas.height=Math.ceil(bounds.height),ctx=canvas.getContext("2d");return ctx.translate(-x,-y),shape.draw(ctx),new Img(canvas,width/2+x,height/2+y)},toPixels:function(image,step){step=step>1?step:1;for(var canvas=image.canvas,imgWidth=canvas.width,imgHeight=canvas.height,ctx,data,pixels=canvas.getContext("2d").getImageData(0,0,canvas.width,canvas.height).data,stride=4*canvas.width,outPixels=[],y=0;y<imgHeight;y+=step)for(var x=0;x<imgWidth;x+=step){var offset=y*stride+4*x,pr=pixels[offset],pg=pixels[offset+1],pb=pixels[offset+2],pa=pixels[offset+3];outPixels.push({x:x-imgWidth/2,y:y-imgHeight/2,r:pr,g:pg,b:pb,a:pa,color:new vg.Color(pr/255,pg/255,pb/255,pa/255)})}return outPixels},twirl:function(image,position,radius,angle){var layer=image.toLayer(!1);return layer.addFilter("twirl",{dx:position.x,dy:position.y,radius:radius,angle:angle}),image.withCanvas(layer.toCanvas())}};module.exports=g},{"./img/img":22,"./vg/vg":49}],19:[function(require,module,exports){"use strict";var async=require("async"),process=require("./process"),CanvasRenderer=require("./canvasrenderer");function passThrough(canvas,callback){callback(null,canvas)}var AsyncRenderer={};function processLayers(iCanvas){return function(layer,callback){async.compose(AsyncRenderer.processImage(layer.filters),AsyncRenderer.processMask(layer.mask),AsyncRenderer.load(iCanvas,layer))(null,callback)}}AsyncRenderer.toImage=function(){return function(canvas,callback){callback(null,CanvasRenderer.toImage(canvas))}},AsyncRenderer.load=function(iCanvas,layer){return layer.isPath()?AsyncRenderer.loadFile(layer.data):layer.isFill()?AsyncRenderer.generateColor(iCanvas,layer):layer.isGradient()?AsyncRenderer.generateGradient(iCanvas,layer):layer.isHtmlCanvas()?AsyncRenderer.loadHtmlCanvas(layer.data):layer.isImage()?AsyncRenderer.loadImage(layer.data):layer.isImageCanvas()?AsyncRenderer.loadImageCanvas(layer.data):void 0},AsyncRenderer.loadFile=function(src){return function(_,callback){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),source=new Image;source.onload=function(){canvas.width=source.width,canvas.height=source.height,ctx.drawImage(source,0,0,canvas.width,canvas.height),callback(null,canvas)},source.src=src}},AsyncRenderer.loadHtmlCanvas=function(canvas){return function(_,callback){callback(null,canvas)}},AsyncRenderer.loadImageCanvas=function(iCanvas){return function(_,callback){iCanvas.render((function(canvas){callback(null,canvas)}))}},AsyncRenderer.loadImage=function(img){return function(_,callback){var canvas;callback(null,CanvasRenderer.loadImage(img))}},AsyncRenderer.generateColor=function(iCanvas,layer){return function(_,callback){var canvas;callback(null,CanvasRenderer.generateColor(iCanvas,layer))}},AsyncRenderer.generateGradient=function(iCanvas,layer){return function(_,callback){var canvas;callback(null,CanvasRenderer.generateGradient(iCanvas,layer))}},AsyncRenderer.processImage=function(filters){return 0===filters.length?passThrough:function(canvas,callback){CanvasRenderer.processImage(canvas,filters),callback(null,canvas)}},AsyncRenderer.processMask=function(mask){return 0===mask.layers.length?passThrough:function(canvas,callback){mask.width=canvas.width,mask.height=canvas.height,AsyncRenderer.renderBW(mask,(function(c){var data,maskFilter={name:"mask",options:{data:c.getContext("2d").getImageData(0,0,c.width,c.height).data,x:0,y:0,width:c.width,height:c.height}},fn;AsyncRenderer.processImage([maskFilter])(canvas,callback)}))}},AsyncRenderer.mergeManualBlend=function(iCanvas,layerData){return function(canvas,callback){CanvasRenderer.mergeManualBlend(iCanvas,layerData)(canvas),callback(null,canvas)}},AsyncRenderer.mergeNativeBlend=function(iCanvas,layerData){return function(canvas,callback){CanvasRenderer.mergeNativeBlend(iCanvas,layerData)(canvas),callback(null,canvas)}},AsyncRenderer.merge=function(iCanvas,layerData,callback){var renderPipe=CanvasRenderer.createRenderPipe(AsyncRenderer,iCanvas,layerData);renderPipe.reverse();var canvas=CanvasRenderer.singleLayerWithOpacity(iCanvas,layerData[0]);renderPipe.push((function(_,cb){cb(null,canvas)})),async.compose.apply(null,renderPipe)(null,(function(){callback(canvas)}))},AsyncRenderer.composite=function(iCanvas,layerData,callback){layerData&&0!==layerData.length?1!==layerData.length?AsyncRenderer.merge(iCanvas,layerData,callback):callback(CanvasRenderer.singleLayerWithOpacity(iCanvas,layerData[0])):callback(null)},AsyncRenderer.render=function(iCanvas,callback){async.map(iCanvas.layers,processLayers(iCanvas),(function(err,layerImages){callback&&AsyncRenderer.composite(iCanvas,CanvasRenderer.getLayerData(iCanvas,layerImages),callback)}))},AsyncRenderer.renderBW=function(iCanvas,callback){AsyncRenderer.render(iCanvas,(function(canvas){var data=canvas.getContext("2d").getImageData(0,0,canvas.width,canvas.height).data,bwFilter={name:"desaturate",options:{method:"ITU-R BT.709"}},fn;AsyncRenderer.processImage([bwFilter])(canvas,(function(err,c){callback(c)}))}))},module.exports=AsyncRenderer},{"./canvasrenderer":21,"./process":23,async:1}],20:[function(require,module,exports){"use strict";var blend,process,aliases={normal:"source-over","linear-dodge":"add"};function addAliases(d){var i,mode,alias,modes=Object.keys(aliases);for(i=0;i<modes.length;i+=1)mode=modes[i],alias=aliases[mode],d[mode]=d[alias]}function realBlendMode(mode){return void 0!==aliases[mode]?aliases[mode]:mode}function getNativeModes(){if("undefined"==typeof document)return{};var i,mode,darken,ok,nativeModes={},dCanvas=document.createElement("canvas"),ctx=dCanvas.getContext("2d");if(!ctx)return{};var native=["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],maybeNative=["multiply","screen","overlay","soft-light","hard-light","color-dodge","color-burn","darken","lighten","difference","exclusion","hue","saturation","luminosity","color","add","subtract","average","negation"],nonNative=["divide","darker-color","lighter-color","linear-burn","linear-light","vivid-light","pin-light","hard-mix"];for(i=0;i<native.length;i+=1)nativeModes[native[i]]=!0;for(i=0;i<nonNative.length;i+=1)nativeModes[nonNative[i]]=!1;for(dCanvas.width=1,dCanvas.height=1,i=0;i<maybeNative.length;i+=1){darken="darken"===(mode=maybeNative[i]),ok=!1,ctx.save();try{ctx.fillStyle=darken?"#300":"#a00",ctx.fillRect(0,0,1,1),ctx.globalCompositeOperation=mode,ctx.globalCompositeOperation===mode&&(ctx.fillStyle=darken?"#a00":"#300",ctx.fillRect(0,0,1,1),ok=ctx.getImageData(0,0,1,1).data[0]!==(darken?170:51))}catch(e){}ctx.restore(),nativeModes[mode]=ok}return addAliases(nativeModes),nativeModes}function _blend(inData,outData,width,height,options){process(inData,outData,width,height,options)}function _wrap(type){return function(inData,outData,width,height,options){options.type=type,_blend(inData,outData,width,height,options)}}process=function(inData,outData,width,height,options){var blend_fn,sr,sg,sb,sa,dr,dg,db,da,or,og,ob,oa,max=Math.max,min=Math.min,div_2_255=2/255,R=.2126,G=.7152,B=.0722;function rgbToHsy(r,g,b){var h,s,y;return b/=255,(r/=255)==(g/=255)&&g===b?(s=0,h=0):h=r>=g&&g>=b?60*(g-b)/(s=r-b):g>r&&r>=b?60*(g-r)/(s=g-b)+60:g>=b&&b>r?60*(b-r)/(s=g-r)+120:b>g&&g>r?60*(b-g)/(s=b-r)+180:b>r&&r>=g?60*(r-g)/(s=b-g)+240:60*(r-b)/(s=r-g)+300,y=R*r+G*g+B*b,[h%360,min(max(s,0),1),min(max(y,0),1)]}function hsyToRgb(h,s,y){var r,g,b,k;return(h%=360)>=0&&h<60?(r=(b=y-R*s-G*(k=s*h/60))+s,g=b+k):h>=60&&h<120?(b=(g=y+B*s+R*(k=s*(h-60)/60))-s,r=g-k):h>=120&&h<180?(g=(r=y-G*s-B*(k=s*(h-120)/60))+s,b=r+k):h>=180&&h<240?(r=(b=y+R*s+G*(k=s*(h-180)/60))-s,g=b-k):h>=240&&h<300?(b=(g=y-B*s-R*(k=s*(h-240)/60))+s,r=g+k):(g=(r=y+G*s+B*(k=s*(h-300)/60))-s,b=r-k),[r=255*min(max(r,0),1),g=255*min(max(g,0),1),b=255*min(max(b,0),1)]}function _sourceover(){or=sr,og=sg,ob=sb}function _svg_sourceover(){or=sr+dr-dr*sa,og=sg+dg-dg*sa,ob=sb+db-db*sa}function _multiply(){or=dr*sr/255,og=dg*sg/255,ob=db*sb/255}function _svg_multiply(){or=sr*dr+sr*(1-da)+dr*(1-sa),og=sg*dg+sg*(1-da)+dg*(1-sa),ob=sb*db+sb*(1-da)+db*(1-sa)}function _subtract(){or=max(dr-sr,0),og=max(dg-sg,0),ob=max(db-sb,0)}function _svg_subtract(){or=max(dr*sa-sr*da,0)+sr*(1-da)+dr*(1-sa),og=max(dg*sa-sg*da,0)+sg*(1-da)+dg*(1-sa),ob=max(db*sa-sb*da,0)+sb*(1-da)+db*(1-sa)}function _divide(){or=0===sr?0:dr/sr*255,og=0===sg?0:dg/sg*255,ob=0===sb?0:db/sb*255}function _screen(){or=255-((255-dr)*(255-sr)>>8),og=255-((255-dg)*(255-sg)>>8),ob=255-((255-db)*(255-sb)>>8)}function _svg_screen(){or=sr+dr-sr*dr,og=sg+dg-sg*dg,ob=sb+db-sb*db}function _lighten(){or=dr>sr?dr:sr,og=dg>sg?dg:sg,ob=db>sb?db:sb}function _svg_lighten(){or=max(sr*da,dr*sa)+sr*(1-da)+dr*(1-sa),og=max(sg*da,dg*sa)+sg*(1-da)+dg*(1-sa),ob=max(sb*da,db*sa)+sb*(1-da)+db*(1-sa)}function _darken(){or=dr<sr?dr:sr,og=dg<sg?dg:sg,ob=db<sb?db:sb}function _svg_darken(){or=min(sr*da,dr*sa)+sr*(1-da)+dr*(1-sa),og=min(sg*da,dg*sa)+sg*(1-da)+dg*(1-sa),ob=min(sb*da,db*sa)+sb*(1-da)+db*(1-sa)}function _darkercolor(){.3*dr+.59*dg+.11*db<=.3*sr+.59*sg+.11*sb?(or=dr,og=dg,ob=db):(or=sr,og=sg,ob=sb)}function _svg_darkercolor(){dr*sa*.3+dg*sa*.59+db*sa*.11<=sr*da*.3+sg*da*.59+sb*da*.11?(or=dr*sa,og=dg*sa,ob=db*sa):(or=sr*da,og=sg*da,ob=sb*da),or+=sr*(1-da)+dr*(1-sa),og+=sg*(1-da)+dg*(1-sa),ob+=sb*(1-da)+db*(1-sa)}function _lightercolor(){.3*dr+.59*dg+.11*db>.3*sr+.59*sg+.11*sb?(or=dr,og=dg,ob=db):(or=sr,og=sg,ob=sb)}function _svg_lightercolor(){dr*sa*.3+dg*sa*.59+db*sa*.11>sr*da*.3+sg*da*.59+sb*da*.11?(or=dr*sa,og=dg*sa,ob=db*sa):(or=sr*da,og=sg*da,ob=sb*da),or+=sr*(1-da)+dr*(1-sa),og+=sg*(1-da)+dg*(1-sa),ob+=sb*(1-da)+db*(1-sa)}function _add(){or=min(dr+sr,255),og=min(dg+sg,255),ob=min(db+sb,255)}function _linearburn(){or=(or=dr+sr)<255?0:or-255,og=(og=dg+sg)<255?0:og-255,ob=(ob=db+sb)<255?0:ob-255}function _difference(){or=(or=dr-sr)<0?-or:or,og=(og=dg-sg)<0?-og:og,ob=(ob=db-sb)<0?-ob:ob}function _svg_difference(){or=sr+dr-2*min(sr*da,dr*sa),og=sg+dg-2*min(sg*da,dg*sa),ob=sb+db-2*min(sb*da,db*sa)}function _exclusion(){or=dr-(dr*(2/255)-1)*sr,og=dg-(dg*(2/255)-1)*sg,ob=db-(db*(2/255)-1)*sb}function _svg_exclusion(){or=sr*da+dr*sa-2*sr*dr+sr*(1-da)+dr*(1-sa),og=sg*da+dg*sa-2*sg*dg+sg*(1-da)+dg*(1-sa),ob=sb*da+db*sa-2*sb*db+sb*(1-da)+db*(1-sa)}function _overlay(){or=dr<128?sr*dr*(2/255):255-(255-sr)*(255-dr)*(2/255),og=dg<128?sg*dg*(2/255):255-(255-sg)*(255-dg)*(2/255),ob=db<128?sb*db*(2/255):255-(255-sb)*(255-db)*(2/255)}function _svg_overlay(){or=2*dr<=da?2*sr*dr+sr*(1-da)+dr*(1-sa):sr*(1+da)+dr*(1+sa)-2*dr*sr-da*sa,og=2*dg<=da?2*sg*dg+sg*(1-da)+dg*(1-sa):sg*(1+da)+dg*(1+sa)-2*dg*sg-da*sa,ob=2*db<=da?2*sb*db+sb*(1-da)+db*(1-sa):sb*(1+da)+db*(1+sa)-2*db*sb-da*sa}function _softlight(){or=dr<128?(64+(sr>>1))*dr*(2/255):255-(191-(sr>>1))*(255-dr)*(2/255),og=dg<128?(64+(sg>>1))*dg*(2/255):255-(191-(sg>>1))*(255-dg)*(2/255),ob=db<128?(64+(sb>>1))*db*(2/255):255-(191-(sb>>1))*(255-db)*(2/255)}function _svg_softlight(){var m,pow=Math.pow;if(0===da)return or=sr,og=sg,void(ob=sb);m=dr/da,2*sr<=sa?or=dr*(sa+(2*sr-sa)*(1-m))+sr*(1-da)+dr*(1-sa):2*sr>sa&&4*dr<=da?or=da*(2*sr-sa)*(16*pow(m,3)-12*pow(m,2)-3*m)+sr-sr*da+dr:2*sr>sa&&4*dr>da&&(or=da*(2*sr-sa)*(pow(m,.5)-m)+sr-sr*da+dr),m=dg/da,2*sg<=sa?og=dg*(sa+(2*sg-sa)*(1-m))+sg*(1-da)+dg*(1-sa):2*sg>sa&&4*dg<=da?og=da*(2*sg-sa)*(16*pow(m,3)-12*pow(m,2)-3*m)+sg-sg*da+dg:2*sg>sa&&4*dg>da&&(og=da*(2*sg-sa)*(pow(m,.5)-m)+sg-sg*da+dg),m=db/da,2*sb<=sa?ob=db*(sa+(2*sb-sa)*(1-m))+sb*(1-da)+db*(1-sa):2*sb>sa&&4*db<=da?ob=da*(2*sb-sa)*(16*pow(m,3)-12*pow(m,2)-3*m)+sb-sb*da+db:2*sb>sa&&4*db>da&&(ob=da*(2*sb-sa)*(pow(m,.5)-m)+sb-sb*da+db)}function _hardlight(){or=sr<128?dr*sr*(2/255):255-(255-dr)*(255-sr)*(2/255),og=sg<128?dg*sg*(2/255):255-(255-dg)*(255-sg)*(2/255),ob=sb<128?db*sb*(2/255):255-(255-db)*(255-sb)*(2/255)}function _svg_hardlight(){or=2*sr<=sa?2*sr*dr+sr*(1-da)+dr*(1-sa):sr*(1+da)+dr*(1+sa)-sa*da-2*sr*dr,og=2*sg<=sa?2*sg*dg+sg*(1-da)+dg*(1-sa):sg*(1+da)+dg*(1+sa)-sa*da-2*sg*dg,ob=2*sb<=sa?2*sb*db+sb*(1-da)+db*(1-sa):sb*(1+da)+db*(1+sa)-sa*da-2*sb*db}function _colordodge(){var dr1=(dr<<8)/(255-sr),dg1=(dg<<8)/(255-sg),db1=(db<<8)/(255-sb);or=dr1>255||255===sr?255:dr1,og=dg1>255||255===sg?255:dg1,ob=db1>255||255===sb?255:db1}function _svg_colordodge(){if(0===da)return or=sr,og=sg,void(ob=sb);sr===sa&&0===dr?or=sr*(1-da):sr===sa?or=sa*da+sr*(1-da)+dr*(1-sa):sr<sa&&(or=sa*da*min(1,dr/da*sa/(sa-sr))+sr*(1-da)+dr*(1-sa)),sg===sa&&0===dg?og=sg*(1-da):sr===sa?og=sa*da+sg*(1-da)+dg*(1-sa):sr<sa&&(og=sa*da*min(1,dg/da*sa/(sa-sg))+sg*(1-da)+dg*(1-sa)),sb===sa&&0===db?ob=sb*(1-da):sr===sa?ob=sa*da+sb*(1-da)+db*(1-sa):sr<sa&&(ob=sa*da*min(1,db/da*sa/(sa-sb))+sb*(1-da)+db*(1-sa))}function _colorburn(){var dr1=255-(255-dr<<8)/sr,dg1=255-(255-dg<<8)/sg,db1=255-(255-db<<8)/sb;or=dr1<0||0===sr?0:dr1,og=dg1<0||0===sg?0:dg1,ob=db1<0||0===sb?0:db1}function _svg_colorburn(){if(0===da)return or=sr,og=sg,void(ob=sb);0===sr&&dr===da?or=sa*da+dr*(1-sa):0===sr?or=dr*(1-sa):sr>0&&(or=sa*da*(1-min(1,(1-dr/da)*sa/sr))+sr*(1-da)+dr*(1-sa)),0===sg&&dg===da?og=sa*da+dg*(1-sa):0===sg?og=dg*(1-sa):sg>0&&(og=sa*da*(1-min(1,(1-dg/da)*sa/sg))+sg*(1-da)+dg*(1-sa)),0===sb&&db===da?ob=sa*da+db*(1-sa):0===sb?ob=db*(1-sa):sb>0&&(ob=sa*da*(1-min(1,(1-db/da)*sa/sb))+sb*(1-da)+db*(1-sa))}function _linearlight(){var dr1=2*sr+dr-256,dg1=2*sg+dg-256,db1=2*sb+db-256;or=dr1<0||sr<128&&dr1<0?0:dr1>255?255:dr1,og=dg1<0||sg<128&&dg1<0?0:dg1>255?255:dg1,ob=db1<0||sb<128&&db1<0?0:db1>255?255:db1}function _vividlight(){var a;or=sr<128?sr?(a=255-(255-dr<<8)/(2*sr))<0?0:a:0:(a=2*sr-256)<255?(a=(dr<<8)/(255-a))>255?255:a:a<0?0:a,og=sg<128?sg?(a=255-(255-dg<<8)/(2*sg))<0?0:a:0:(a=2*sg-256)<255?(a=(dg<<8)/(255-a))>255?255:a:a<0?0:a,ob=sb<128?sb?(a=255-(255-db<<8)/(2*sb))<0?0:a:0:(a=2*sb-256)<255?(a=(db<<8)/(255-a))>255?255:a:a<0?0:a}function _pinlight(){var a;or=sr<128?dr<(a=2*sr)?dr:a:dr>(a=2*sr-256)?dr:a,og=sg<128?dg<(a=2*sg)?dg:a:dg>(a=2*sg-256)?dg:a,ob=sb<128?db<(a=2*sb)?db:a:db>(a=2*sb-256)?db:a}function _hardmix(){var a;or=sr<128?255-(255-dr<<8)/(2*sr)<128||0===sr?0:255:(a=2*sr-256)<255&&(dr<<8)/(255-a)<128?0:255,og=sg<128?255-(255-dg<<8)/(2*sg)<128||0===sg?0:255:(a=2*sg-256)<255&&(dg<<8)/(255-a)<128?0:255,ob=sb<128?255-(255-db<<8)/(2*sb)<128||0===sb?0:255:(a=2*sb-256)<255&&(db<<8)/(255-a)<128?0:255}function _hue(){var hcl1=rgbToHsy(dr,dg,db),hcl2,rgb=hsyToRgb(rgbToHsy(sr,sg,sb)[0],hcl1[1],hcl1[2]);or=rgb[0],og=rgb[1],ob=rgb[2]}function _saturation(){var hcl1=rgbToHsy(dr,dg,db),hcl2=rgbToHsy(sr,sg,sb),rgb=hsyToRgb(hcl1[0],hcl2[1],hcl1[2]);or=rgb[0],og=rgb[1],ob=rgb[2]}function _luminosity(){var hcl1=rgbToHsy(dr,dg,db),hcl2=rgbToHsy(sr,sg,sb),rgb=hsyToRgb(hcl1[0],hcl1[1],hcl2[2]);or=rgb[0],og=rgb[1],ob=rgb[2]}function _color(){var hcl1=rgbToHsy(dr,dg,db),hcl2=rgbToHsy(sr,sg,sb),rgb=hsyToRgb(hcl2[0],hcl2[1],hcl1[2]);or=rgb[0],og=rgb[1],ob=rgb[2]}function rectIntersect(r1,r2){var right1=r1.x+r1.width,bottom1=r1.y+r1.height,right2=r2.x+r2.width,bottom2=r2.y+r2.height,x=max(r1.x,r2.x),y=max(r1.y,r2.y),w,h;return[x,y,max(min(right1,right2)-x,0),max(min(bottom1,bottom2)-y,0)]}blend_fn={"source-over":_svg_sourceover,multiply:_svg_multiply,subtract:_svg_subtract,divide:_divide,screen:_svg_screen,lighten:_svg_lighten,darken:_svg_darken,"darker-color":_svg_darkercolor,"lighter-color":_svg_lightercolor,add:_add,"linear-burn":_linearburn,difference:_svg_difference,exclusion:_svg_exclusion,overlay:_svg_overlay,"soft-light":_svg_softlight,"hard-light":_svg_hardlight,"color-dodge":_svg_colordodge,"color-burn":_svg_colorburn,"linear-light":_linearlight,"vivid-light":_vividlight,"pin-light":_pinlight,"hard-mix":_hardmix,hue:_hue,saturation:_saturation,luminosity:_luminosity,color:_color},function(){var pix,pixIn,x,y,a,a2,da2,demultiply,fBlend,data2=options.data,opacity=0===options.opacity?0:options.opacity||1,fn=blend_fn[options.type||"_svg_normal"],dx=options.dx||0,dy=options.dy||0,ri=rectIntersect({x:0,y:0,width:width,height:height},{x:dx,y:dy,width:options.width,height:options.height}),xi=ri[0],yi=ri[1],wi=ri[2],hi=ri[3];function pBlend(){sa=data2[pixIn+3]/255*opacity,da=inData[pix+3]/255,demultiply=255/(da2=sa+da-sa*da),sr=data2[pixIn]/255*sa,sg=data2[pixIn+1]/255*sa,sb=data2[pixIn+2]/255*sa,dr=inData[pix]/255*da,dg=inData[pix+1]/255*da,db=inData[pix+2]/255*da,fn(),outData[pix]=or*demultiply,outData[pix+1]=og*demultiply,outData[pix+2]=ob*demultiply,outData[pix+3]=255*da2}function sBlend(){dr=inData[pix],dg=inData[pix+1],db=inData[pix+2],sr=data2[pixIn],sg=data2[pixIn+1],sb=data2[pixIn+2],fn(),outData[pix]=or,outData[pix+1]=og,outData[pix+2]=ob,outData[pix+3]=inData[pix+3],(a=opacity*data2[pixIn+3]/255)<1&&(a2=1-a,outData[pix]=inData[pix]*a2+outData[pix]*a,outData[pix+1]=inData[pix+1]*a2+outData[pix+1]*a,outData[pix+2]=inData[pix+2]*a2+outData[pix+2]*a)}for(fBlend=0===fn.name.indexOf("_svg_")?pBlend:sBlend,y=0;y<height;y+=1)for(x=0;x<width;x+=1)pix=4*(y*width+x),y>=yi&&x>=xi&&x<xi+wi&&y<yi+hi?(pixIn=4*((y-dy)*options.width+x-dx),fBlend()):(outData[pix]=inData[pix],outData[pix+1]=inData[pix+1],outData[pix+2]=inData[pix+2],outData[pix+3]=inData[pix+3])}()},blend=function(){for(var mode,d={blend:_blend},modes=["source-over","add","multiply","subtract","divide","screen","lighten","darken","darker-color","lighter-color","linear-burn","difference","exclusion","overlay","soft-light","hard-light","color-dodge","color-burn","linear-light","vivid-light","pin-light","hard-mix","hue","saturation","luminosity","color"],i=0;i<modes.length;i+=1)d[mode=modes[i]]=_wrap(mode);for(modes=Object.keys(modes),i=0;i<modes.length;i+=1);return addAliases(d),d.getNativeModes=getNativeModes,d.realBlendMode=realBlendMode,d}(),module.exports=blend},{}],21:[function(require,module,exports){"use strict";var blend=require("./blend"),process=require("./process"),util=require("./util"),nativeBlendModes=blend.getNativeModes();function createImageData(ctx,width,height){return ctx.createImageData?ctx.createImageData(width,height):ctx.getImageData(0,0,width,height)}var CanvasRenderer={};function transformLayer(ctx,iCanvas,layer){var m=layer.transform.matrix();ctx.translate(iCanvas.width/2,iCanvas.height/2),ctx.transform(m[0],m[1],m[3],m[4],m[6],m[7]),(layer.flip_h||layer.flip_v)&&ctx.scale(layer.flip_h?-1:1,layer.flip_v?-1:1),ctx.translate(-layer.img.width/2,-layer.img.height/2)}function transformRect(iCanvas,layer){var pt,minx,miny,maxx,maxy,width=layer.img.width,height=layer.img.height,p1,p2,p3,p4,points=[{x:0,y:0},{x:width,y:0},{x:0,y:height},{x:width,y:height}],t=util.transform();t=(t=(t=t.translate(iCanvas.width/2,iCanvas.height/2)).append(layer.transform)).translate(-layer.img.width/2,-layer.img.height/2);for(var i=0;i<4;i+=1)pt=t.transformPoint(points[i]),0===i?(minx=maxx=pt.x,miny=maxy=pt.y):(pt.x<minx&&(minx=pt.x),pt.x>maxx&&(maxx=pt.x),pt.y<miny&&(miny=pt.y),pt.y>maxy&&(maxy=pt.y));return{x:minx,y:miny,width:maxx-minx,height:maxy-miny}}function rectIntersect(r1,r2){var right1=r1.x+r1.width,bottom1=r1.y+r1.height,right2=r2.x+r2.width,bottom2=r2.y+r2.height,x=Math.max(r1.x,r2.x),y=Math.max(r1.y,r2.y),w,h;return{x:x,y:y,width:Math.max(Math.min(right1,right2)-x,0),height:Math.max(Math.min(bottom1,bottom2)-y,0)}}function calcLayerRect(iCanvas,layer){var rect=transformRect(iCanvas,layer);return rect=rectIntersect(rect,{x:0,y:0,width:iCanvas.width,height:iCanvas.height}),{x:Math.round(rect.x),y:Math.round(rect.y),width:Math.ceil(rect.width),height:Math.ceil(rect.height)}}function getTransformedLayerData(iCanvas,layer,rect){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");return canvas.width=rect.width,canvas.height=rect.height,ctx.translate(-rect.x,-rect.y),transformLayer(ctx,iCanvas,layer),ctx.drawImage(layer.img,0,0),ctx.getImageData(0,0,rect.width,rect.height)}CanvasRenderer.toImage=function(canvas){var img=new Image;return img.width=canvas.width,img.height=canvas.height,img.src=canvas.toDataURL(),img},CanvasRenderer.load=function(iCanvas,layer){return layer.isFill()?CanvasRenderer.generateColor(iCanvas,layer):layer.isGradient()?CanvasRenderer.generateGradient(iCanvas,layer):layer.isHtmlCanvas()?CanvasRenderer.loadHtmlCanvas(layer.data):layer.isImage()?CanvasRenderer.loadImage(layer.data):layer.isImageCanvas()?CanvasRenderer.loadImageCanvas(layer.data):void 0},CanvasRenderer.loadHtmlCanvas=function(canvas){return canvas},CanvasRenderer.loadImageCanvas=function(iCanvas){return iCanvas.render()},CanvasRenderer.loadImage=function(img){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");return canvas.width=img.width,canvas.height=img.height,ctx.drawImage(img,0,0,canvas.width,canvas.height),canvas},CanvasRenderer.generateColor=function(iCanvas,layer){var width=void 0!==layer.width?layer.width:iCanvas.width,height=void 0!==layer.height?layer.height:iCanvas.height,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");return canvas.width=width,canvas.height=height,ctx.fillStyle=layer.data,ctx.fillRect(0,0,width,height),canvas},CanvasRenderer.generateGradient=function(iCanvas,layer){var grd,x1,y1,x2,y2,width=void 0!==layer.width?layer.width:iCanvas.width,height=void 0!==layer.height?layer.height:iCanvas.height,cx=width/2,cy=height/2,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),data=layer.data,type=data.type||"linear",rotateDegrees=data.rotation||0;return"radial"===type?grd=ctx.createRadialGradient(cx,cy,0,cx,cy,Math.min(width,height)/2):(rotateDegrees<0&&(rotateDegrees+=360),0<=rotateDegrees&&rotateDegrees<45?(x1=0,x2=width,y2=height-(y1=height/2*(45-rotateDegrees)/45)):45<=rotateDegrees&&rotateDegrees<135?(y1=0,x2=width-(x1=width*(rotateDegrees-45)/90),y2=height):135<=rotateDegrees&&rotateDegrees<225?(x1=width,x2=0,y2=height-(y1=height*(rotateDegrees-135)/90)):225<=rotateDegrees&&rotateDegrees<315?(y1=height,x2=width-(x1=width*(1-(rotateDegrees-225)/90)),y2=0):315<=rotateDegrees&&(x1=0,x2=width,y2=height-(y1=height-height/2*(rotateDegrees-315)/45)),grd=ctx.createLinearGradient(x1,y1,x2,y2)),grd.addColorStop(data.spread||0,data.startColor),grd.addColorStop(1,data.endColor),canvas.width=width,canvas.height=height,ctx.fillStyle=grd,ctx.fillRect(0,0,width,height),canvas},CanvasRenderer.processImage=function(canvas,filters){if(0===filters.length)return canvas;for(var filter,tmpData,ctx=canvas.getContext("2d"),width=canvas.width,height=canvas.height,inData=ctx.getImageData(0,0,width,height),outData=createImageData(ctx,width,height),i=0;i<filters.length;i+=1)i>0&&(tmpData=inData,inData=outData,outData=tmpData),filter=filters[i],process[filter.name](inData.data,outData.data,width,height,filter.options);return ctx.putImageData(outData,0,0),canvas},CanvasRenderer.processMask=function(canvas,mask){if(0===mask.layers.length)return canvas;mask.width=canvas.width,mask.height=canvas.height;var c=CanvasRenderer.renderBW(mask),data,maskFilter={name:"mask",options:{data:c.getContext("2d").getImageData(0,0,c.width,c.height).data,x:0,y:0,width:c.width,height:c.height}};return CanvasRenderer.processImage(canvas,[maskFilter])},CanvasRenderer.processLayer=function(iCanvas,layer){var layerImage=CanvasRenderer.load(iCanvas,layer),maskedImage=CanvasRenderer.processMask(layerImage,layer.mask);return CanvasRenderer.processImage(maskedImage,layer.filters)},CanvasRenderer.mergeManualBlend=function(iCanvas,layerData){return function(canvas){for(var layer,blendMode,blendData,tmpData,layerOptions,rect,ctx=canvas.getContext("2d"),width=iCanvas.width,height=iCanvas.height,baseData=ctx.getImageData(0,0,width,height),outData=createImageData(ctx,width,height),i=0;i<layerData.length;i+=1)if(layer=layerData[i],(rect=calcLayerRect(iCanvas,layer)).width>0&&rect.height>0){if(i>0&&(tmpData=baseData,baseData=outData,outData=tmpData),layerOptions={data:(blendData=getTransformedLayerData(iCanvas,layer,rect)).data,width:rect.width,height:rect.height,opacity:layer.opacity,dx:rect.x,dy:rect.y},void 0===blend[layer.blendmode])throw new Error("No blend mode named '"+layer.blendmode+"'");blendMode=blend.realBlendMode(layer.blendmode),blend[blendMode](baseData.data,outData.data,width,height,layerOptions)}return ctx.putImageData(outData,0,0),canvas}},CanvasRenderer.singleLayerWithOpacity=function(iCanvas,layer){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");return canvas.width=iCanvas.width,canvas.height=iCanvas.height,ctx.save(),transformLayer(ctx,iCanvas,layer),1!==layer.opacity&&(ctx.globalAlpha=layer.opacity),ctx.drawImage(layer.img,0,0),ctx.restore(),canvas},CanvasRenderer.mergeNativeBlend=function(iCanvas,layerData){return function(canvas){for(var ctx=canvas.getContext("2d"),layer,i=0;i<layerData.length;i+=1)layer=layerData[i],ctx.save(),transformLayer(ctx,iCanvas,layer),1!==layer.opacity&&(ctx.globalAlpha=layer.opacity),"source-over"!==layer.blendmode&&(ctx.globalCompositeOperation=blend.realBlendMode(layer.blendmode)),ctx.drawImage(layer.img,0,0),ctx.restore();return canvas}},CanvasRenderer.createRenderPipe=function(Renderer,iCanvas,layerData){var mode,useNative,currentList,layer,renderPipe=[];function pushList(){if(void 0!==useNative){var fn=useNative?Renderer.mergeNativeBlend:Renderer.mergeManualBlend;renderPipe.push(fn(iCanvas,currentList))}}for(var i=1;i<layerData.length;i+=1)mode=(layer=layerData[i]).blendmode,void 0!==useNative&&useNative===nativeBlendModes[mode]||(pushList(),currentList=[]),currentList.push(layer),useNative=nativeBlendModes[mode],i===layerData.length-1&&pushList();return renderPipe},CanvasRenderer.merge=function(iCanvas,layerData){for(var renderPipe=CanvasRenderer.createRenderPipe(CanvasRenderer,iCanvas,layerData),canvas=CanvasRenderer.singleLayerWithOpacity(iCanvas,layerData[0]),i=0;i<renderPipe.length;i+=1)canvas=renderPipe[i](canvas);return canvas},CanvasRenderer.composite=function(iCanvas,layerData){return layerData&&0!==layerData.length?1===layerData.length?CanvasRenderer.singleLayerWithOpacity(iCanvas,layerData[0]):CanvasRenderer.merge(iCanvas,layerData):null},CanvasRenderer.getLayerData=function(iCanvas,layerImages){for(var d,layer,layerImg,layerData=[],i=0;i<layerImages.length;i+=1)layer=iCanvas.layers[i],d={img:layerImg=layerImages[i],opacity:layer.opacity,blendmode:layer.blendmode,transform:layer.transform,flip_h:layer.flip_h,flip_v:layer.flip_v},layerData.push(d);return layerData},CanvasRenderer.render=function(iCanvas){for(var layerImages=[],i=0;i<iCanvas.layers.length;i+=1)layerImages.push(CanvasRenderer.processLayer(iCanvas,iCanvas.layers[i]));return CanvasRenderer.composite(iCanvas,CanvasRenderer.getLayerData(iCanvas,layerImages))},CanvasRenderer.renderBW=function(iCanvas){var canvas=CanvasRenderer.render(iCanvas),data=canvas.getContext("2d").getImageData(0,0,canvas.width,canvas.height).data,bwFilter={name:"desaturate",options:{method:"ITU-R BT.709"}};return CanvasRenderer.processImage(canvas,[bwFilter])},module.exports=CanvasRenderer},{"./blend":20,"./process":23,"./util":24}],22:[function(require,module,exports){"use strict";var util=require("./util"),CanvasRenderer=require("./canvasrenderer"),AsyncRenderer=require("./asyncrenderer"),img,ImageCanvas,Layer,Img,DEFAULT_WIDTH=800,DEFAULT_HEIGHT=800,TYPE_PATH="path",TYPE_IMAGE="image",TYPE_HTML_CANVAS="htmlCanvas",TYPE_IMAGE_CANVAS="iCanvas",TYPE_FILL="fill",TYPE_GRADIENT="gradient",IDENTITY_TRANSFORM=util.transform(),Transform=IDENTITY_TRANSFORM,clamp=util.clamp,colors=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","transparent","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"];function toColor(v1,v2,v3,v4,v5){var _r,_g,_b,_a,R,G,B,rgb,options;if(void 0===v1)_r=_g=_b=0,_a=1;else if(Array.isArray(v1))options=v2||{},_r=void 0!==v1[0]?v1[0]:0,_g=void 0!==v1[1]?v1[1]:0,_b=void 0!==v1[2]?v1[2]:0,_a=void 0!==v1[3]?v1[3]:options.base||1;else if(void 0!==v1.r)options=v2||{},_r=v1.r,_g=v1.g,_b=v1.b,_a=void 0!==v1.a?v1.a:options.base||1;else if("string"==typeof v1){if(0===v1.indexOf("#"))return v1;if(0===v1.indexOf("rgb"))return v1;if(-1!==colors.indexOf(v1))return v1}else"number"==typeof v1&&(1===arguments.length?(_r=_g=_b=v1,_a=1):2===arguments.length?(_r=_g=_b=v1,_a="number"==typeof v2?v2:(options=v2).base||1):3===arguments.length?"number"==typeof v3?(_r=v1,_g=v2,_b=v3,_a=1):(_r=_g=_b=v1,_a=v2,options=v3):4===arguments.length?(_r=v1,_g=v2,_b=v3,_a="number"==typeof v4?v4:(options=v4||{}).base||1):(_r=v1,_g=v2,_b=v3,_a=v4,options=v5));if("number"!=typeof _r||"number"!=typeof _g||"number"!=typeof _b||"number"!=typeof _a)throw new Error("Invalid color arguments");return void 0!==(options=options||{}).base&&(_r/=options.base,_g/=options.base,_b/=options.base,_a/=options.base),"rgba("+(R=Math.round(255*_r))+", "+(G=Math.round(255*_g))+", "+(B=Math.round(255*_b))+", "+_a+")"}function toGradientData(v1,v2,v3,v4,v5){var startColor,endColor,type,rotation,spread,d,data={};if(1===arguments.length)startColor=(d=v1||{}).startColor,endColor=d.endColor,type=d.type,rotation=d.rotation,spread=d.spread;else if(arguments.length>=2)if(startColor=v1,endColor=v2,type="linear",rotation=0,spread=0,3===arguments.length)"string"==typeof v3?type=v3:"number"==typeof v3&&(rotation=v3);else if(4===arguments.length)if("number"==typeof v3)rotation=v3,spread=v4;else if("linear"===v3)rotation=v4;else{if("radial"!==v3)throw new Error("Wrong argument provided: "+v3);type=v3,spread=v4}else 5===arguments.length&&(type=v3,rotation=v4,spread=v5);if(!startColor&&0!==startColor)throw new Error("No startColor was given.");if(!endColor&&0!==endColor)throw new Error("No endColor was given.");try{data.startColor=toColor(startColor)}catch(e1){throw new Error("startColor is not a valid color: "+startColor)}try{data.endColor=toColor(endColor)}catch(e2){throw new Error("endColor is not a valid color: "+endColor)}if(void 0===type&&(type="linear"),"linear"!==type&&"radial"!==type)throw new Error("Unknown gradient type: "+type);if(data.type=type,void 0===spread&&(spread=0),"number"!=typeof spread)throw new Error("Spread value is not a number: "+spread);if("linear"===type){if(void 0===rotation&&(rotation=0),"number"!=typeof rotation)throw new Error("Rotation value is not a number: "+rotation);data.rotation=rotation}return data.spread=clamp(spread,0,.99),data}function findType(data){if("string"==typeof data)return"path";if(data instanceof Image)return"image";if(data instanceof HTMLCanvasElement)return"htmlCanvas";if(data instanceof ImageCanvas)return"iCanvas";if(void 0!==data.r&&void 0!==data.g&&void 0!==data.b&&void 0!==data.a)return"fill";if(void 0!==data.startColor&&void 0!==data.endColor)return"gradient";throw new Error("Cannot establish type for data ",data)}(Layer=function(data,type){type||(type=findType(data)),this.data=data,this.type=type,"htmlCanvas"!==type&&"iCanvas"!==type&&"image"!==type||(this.width=data.width,this.height=data.height),this.opacity=1,this.blendmode="source-over",this.transform=IDENTITY_TRANSFORM,this.flip_h=!1,this.flip_v=!1,this.mask=new ImageCanvas,this.filters=[]}).Transform=Layer.IDENTITY_TRANSFORM=IDENTITY_TRANSFORM,Layer.prototype.clone=function(){function cloneFilter(filter){var key,value,f={};if(f.name=filter.name,void 0!==filter.options){f.options={};for(var optionsKeys=Object.keys(filter.options),i=0;i<optionsKeys.length;i+=1)key=optionsKeys[i],value=filter.options[key],Array.isArray(value)?f.options[key]=value.slice(0):f.options[key]=value}return f}var d=Object.create(Layer.prototype);d.data=this.data,d.type=this.type,d.width=this.width,d.height=this.height,d.opacity=this.opacity,d.blendmode=this.blendmode,d.transform=this.transform,d.flip_h=this.flip_h,d.flip_v=this.flip_v,d.mask=this.mask.clone(),d.filters=[],"iCanvas"===this.type?d.data=this.data.clone():"gradient"===this.type&&(d.data={startColor:this.data.startColor,endColor:this.data.endColor,type:this.data.type,rotation:this.data.rotation,spread:this.data.spread});for(var i=0;i<this.filters.length;i+=1)d.filters.push(cloneFilter(this.filters[i]));return d},Layer.prototype.setOpacity=function(opacity){this.opacity=clamp(opacity,0,1)},Layer.prototype.translate=function(tx,ty){ty=void 0===ty?0:ty;var t=Transform.translate(tx,ty);this.transform=this.transform.prepend(t)},Layer.prototype.scale=function(sx,sy){sy=void 0===sy?sx:sy;var t=Transform.scale(sx,sy);this.transform=this.transform.prepend(t)},Layer.prototype.rotate=function(rot){var t=Transform.rotate(rot);this.transform=this.transform.prepend(t)},Layer.prototype.skew=function(kx,ky){ky=void 0===ky?kx:ky;var t=Transform.skew(kx,ky);this.transform=this.transform.prepend(t)},Layer.prototype.flipHorizontal=function(arg){this.flip_h=void 0!==arg?arg:!this.flip_h},Layer.prototype.flipVertical=function(arg){this.flip_v=void 0!==arg?arg:!this.flip_v},Layer.prototype.addFilter=function(filter,options){this.filters.push({name:filter,options:options})},Layer.prototype.draw=function(ctx){var width=void 0===this.width?800:this.width,height=void 0===this.height?800:this.height,canvas=new ImageCanvas(width,height);canvas.addLayer(this),canvas.draw(ctx)},Layer.prototype.toCanvas=function(){var canvas=document.createElement("canvas");canvas.width=this.width,canvas.height=this.height;var ctx=canvas.getContext("2d");return this.draw(ctx),canvas},Layer.fromFile=function(filename){return new Layer(filename,"path")},Layer.fromImage=function(image){return new Layer(image,"image")},Layer.fromCanvas=function(canvas){return canvas instanceof HTMLCanvasElement?Layer.fromHtmlCanvas(canvas):Layer.fromImageCanvas(canvas)},Layer.fromHtmlCanvas=function(canvas){return new Layer(canvas,"htmlCanvas")},Layer.fromImageCanvas=function(iCanvas){return new Layer(iCanvas,"iCanvas")},Layer.fromColor=function(color){return new Layer(toColor(color),"fill")},Layer.fromGradient=function(){return new Layer(toGradientData.apply(null,arguments),"gradient")},Layer.prototype.isPath=function(){return"path"===this.type},Layer.prototype.isFill=function(){return"fill"===this.type},Layer.prototype.isGradient=function(){return"gradient"===this.type},Layer.prototype.isHtmlCanvas=function(){return"htmlCanvas"===this.type},Layer.prototype.isImage=function(){return"image"===this.type},Layer.prototype.isImageCanvas=function(){return"iCanvas"===this.type};var Pixels=function(canvas){this.width=canvas.width,this.height=canvas.height;var ctx=canvas.getContext("2d");this._data=ctx.getImageData(0,0,this.width,this.height),this.array=this._data.data};function isPoint(arg){return!!arg&&void 0!==arg.x&&void 0!==arg.y}function pointFromArray(arg){var x=arg[0],y;return{x:x,y:arg.length>1?arg[1]:x}}function pointFromNumber(arg){return{x:arg,y:arg}}function isValidArg(arg){return null!=arg}function convertArg(arg){return Array.isArray(arg)?pointFromArray(arg):"number"==typeof arg?pointFromNumber(arg):isPoint(arg)?arg:void 0}Pixels.prototype.get=function(i){i*=4;var v=this.array;return[v[i+0],v[i+1],v[i+2],v[i+3]]},Pixels.prototype.set=function(i,rgba){i*=4;var v=this.array;v[i+0]=rgba[0],v[i+1]=rgba[1],v[i+2]=rgba[2],v[i+3]=rgba[3]},Pixels.prototype.toCanvas=function(){var canvas=document.createElement("canvas"),ctx;return canvas.width=this.width,canvas.height=this.height,canvas.getContext("2d").putImageData(this._data,0,0),canvas},(ImageCanvas=function(width,height){width||(width=800),height||(height=800),this.width=width,this.height=height,this.layers=[]}).prototype.clone=function(){for(var c=new ImageCanvas(this.width,this.height),i=0;i<this.layers.length;i+=1)c.layers.push(this.layers[i].clone());return c},ImageCanvas.prototype.addLayer=function(arg0){var layer;try{return this.addGradientLayer.apply(this,arguments)}catch(e1){}try{return this.addColorLayer.apply(this,arguments)}catch(e2){}if(1===arguments.length&&("string"==typeof arg0?layer=new Layer(arg0,"path"):arg0 instanceof Layer?layer=arg0:arg0 instanceof HTMLCanvasElement?layer=new Layer(arg0,"htmlCanvas"):arg0 instanceof Image?layer=new Layer(arg0,"image"):arg0 instanceof ImageCanvas&&(layer=new Layer(arg0,"iCanvas"))),!layer)throw new Error("Error creating layer.");return this.layers.push(layer),layer},ImageCanvas.prototype.addColorLayer=function(){var c=toColor.apply(null,arguments),layer=new Layer(c,"fill");return this.layers.push(layer),layer},ImageCanvas.prototype.addGradientLayer=function(){var c=toGradientData.apply(null,arguments),layer=new Layer(c,"gradient");return this.layers.push(layer),layer},ImageCanvas.prototype.render=function(callback){var renderer;return(callback?AsyncRenderer:CanvasRenderer).render(this,callback)},ImageCanvas.prototype.draw=function(ctx,callback){if(callback)this.render((function(canvas){ctx.drawImage(canvas,0,0,canvas.width,canvas.height)}));else{var canvas=this.render();ctx.drawImage(canvas,0,0,canvas.width,canvas.height)}},(Img=function(canvas,x,y){this.canvas=canvas,this.originalWidth=canvas?canvas.width:0,this.originalHeight=canvas?canvas.height:0,this.transform=x||y?Transform.translate(x,y):Layer.IDENTITY_TRANSFORM}).prototype.clone=function(){var n=new Img;return n.canvas=this.canvas,n.originalWidth=this.originalWidth,n.originalHeight=this.originalHeight,n.transform=this.transform,n},Img.prototype.withCanvas=function(canvas){var n=this.clone();return n.canvas=canvas,n},Img.prototype._transform=function(t){var n=this.clone();return n.transform=n.transform.prepend(t),n},Img.prototype.translate=function(position){var t=pointFromNumber(0),args=arguments;return 1===args.length&&isValidArg(position)?t=convertArg(position):2===args.length&&(t={x:args[0],y:args[1]}),0===t.x&&0===t.y?this:this._transform(Transform.translate(t.x,t.y))},Img.prototype.rotate=function(angle){if(!angle)return this;var o=pointFromNumber(0),args=arguments;return 2===args.length?o=convertArg(args[1]):3===args.length&&(o={x:args[1],y:args[2]}),this._transform(Transform.translate(o.x,o.y).rotate(angle).translate(-o.x,-o.y))},Img.prototype.scale=function(scale){var s=pointFromNumber(1),o=pointFromNumber(0),args=arguments;return 1===args.length&&isValidArg(scale)?s=convertArg(scale):2===args.length?"number"==typeof scale&&"number"==typeof args[1]?s={x:args[0],y:args[1]}:(s=convertArg(scale),o=convertArg(args[1])):4===args.length&&(s={x:args[0],y:args[1]},o={x:args[2],y:args[3]}),1===s.x&&1===s.y?this:this._transform(Transform.translate(o.x,o.y).scale(s.x,s.y).translate(-o.x,-o.y))},Img.prototype.skew=function(skew){var k=pointFromNumber(0),o=pointFromNumber(0),args=arguments;return 1===args.length&&isValidArg(skew)?k=convertArg(skew):2===args.length?"number"==typeof skew&&"number"==typeof args[1]?k={x:args[0],y:args[1]}:(k=convertArg(skew),o=convertArg(args[1])):4===args.length&&(k={x:args[0],y:args[1]},o={x:args[2],y:args[3]}),0===k.x&&0===k.y?this:this._transform(Transform.translate(o.x,o.y).skew(k.x,k.y).translate(-o.x,-o.y))},Img.prototype.transformed=function(){return img.merge([this])},Img.prototype.bounds=function(){for(var t=this.transform,x=this.originalWidth/2,y=this.originalHeight/2,p1,p2,p3,p4,points=[{x:-x,y:-y},{x:x,y:-y},{x:-x,y:y},{x:x,y:y}],pt,minx,miny,maxx,maxy,i=0;i<4;i+=1)pt=t.transformPoint(points[i]),0===i?(minx=maxx=pt.x,miny=maxy=pt.y):(pt.x<minx&&(minx=pt.x),pt.x>maxx&&(maxx=pt.x),pt.y<miny&&(miny=pt.y),pt.y>maxy&&(maxy=pt.y));return{x:minx,y:miny,width:maxx-minx,height:maxy-miny}},Img.prototype.colorize=function(color){var colorLayer=Layer.fromColor(color);colorLayer.width=this.originalWidth,colorLayer.height=this.originalHeight;var i=new Img(colorLayer.toCanvas());return i=i._transform(this.transform.matrix()),img.merge([this,i])},Img.prototype.desaturate=function(options){var layer=this.toLayer(!1);return layer.addFilter("desaturate",options),this.withCanvas(layer.toCanvas())},Img.prototype.crop=function(bounding){function rectIntersect(r1,r2){var right1=r1.x+r1.width,bottom1=r1.y+r1.height,right2=r2.x+r2.width,bottom2=r2.y+r2.height,x=Math.max(r1.x,r2.x),y=Math.max(r1.y,r2.y),w,h;return{x:x,y:y,width:Math.max(Math.min(right1,right2)-x,0),height:Math.max(Math.min(bottom1,bottom2)-y,0)}}var iBounds=this.bounds(),bounds=bounding.bounds(),ri=rectIntersect(iBounds,bounds),width=Math.ceil(ri.width),height=Math.ceil(ri.height);if(0===ri.width||0===ri.height)throw new Error("Resulting image has no dimensions");var canvas=new img.ImageCanvas(width,height),l1=canvas.addLayer(this.toLayer());return l1.translate(width/2-bounds.width-bounds.x,height/2-bounds.height-bounds.y),width<bounds.width&&ri.x>iBounds.x&&l1.translate(bounds.width-width,0),height<bounds.height&&ri.y>iBounds.y&&l1.translate(0,bounds.height-height),new Img(canvas.render(),ri.x+width/2,ri.y+height/2)},Img.prototype.draw=function(ctx){ctx.save();var m=this.transform.matrix();ctx.transform(m[0],m[1],m[3],m[4],m[6],m[7]),ctx.translate(-this.originalWidth/2,-this.originalHeight/2),ctx.drawImage(this.canvas,0,0),ctx.restore()},Img.prototype.toLayer=function(copyTransformations){var canvas=document.createElement("canvas"),ctx;canvas.width=this.canvas.width,canvas.height=this.canvas.height,canvas.getContext("2d").drawImage(this.canvas,0,0);var layer=img.Layer.fromHtmlCanvas(canvas);return void 0===copyTransformations&&(copyTransformations=!0),copyTransformations&&(layer.transform=this.transform),layer},Img.prototype.getPixels=function(){return new Pixels(this.canvas)},Img.prototype.toImage=function(){var b=this.bounds(),cropped=this.crop({bounds:function(){return b}}),i=new Image;return i.width=cropped.canvas.width,i.height=cropped.canvas.height,i.src=cropped.canvas.toDataURL(),i},(img={}).Layer=Layer,img.ImageCanvas=ImageCanvas,img.Img=Img,img.Pixels=Pixels;var async=require("async");function loadImage(image,callback){var img=new Image;img.onload=function(){callback(null,[image,this])},img.src=image}function loadImages(images,callback){async.map(images,loadImage,(function(err,loadedImages){if(callback){for(var name,image,d={},i=0;i<loadedImages.length;i+=1)name=loadedImages[i][0],image=loadedImages[i][1],d[name]=image;callback(d)}}))}function rectUnite(r1,r2){var x=Math.min(r1.x,r2.x),y=Math.min(r1.y,r2.y),width,height;return{x:x,y:y,width:Math.max(r1.x+r1.width,r2.x+r2.width)-x,height:Math.max(r1.y+r1.height,r2.y+r2.height)-y}}function merge(images){var i,image,b,l;for(i=0;i<images.length;i+=1)image=images[i],b=0===i?image.bounds():rectUnite(b,image.bounds());var dx=b.width/2+b.x,dy=b.height/2+b.y,canvas=new ImageCanvas(b.width,b.height);for(i=0;i<images.length;i+=1)(l=canvas.addLayer(images[i].toLayer())).translate(-dx,-dy);return new Img(canvas.render(),dx,dy)}img.loadImages=loadImages,img.merge=merge,module.exports=img},{"./asyncrenderer":19,"./canvasrenderer":21,"./util":24,async:1}],23:[function(require,module,exports){
/*!
 * Image processing based on Pixastic library:
 *
 * Pixastic - JavaScript Image Processing
 * http://pixastic.com/
 * Copyright 2012, Jacob Seidelin
 *
 * Dual licensed under the MPL 1.1 or GPLv3 licenses.
 * http://pixastic.com/license-mpl.txt
 * http://pixastic.com/license-gpl-3.0.txt
 *
 */
"use strict";var stackblur=require("stackblur"),util=require("./util"),clamp=util.clamp,LUMINOSITY_ITU_R_BT601="ITU-R BT.601",LUMINOSITY_ITU_R_BT709="ITU-R BT.709";function defaultOptions(options,defaults){if(!options)return defaults;var opt,o={};for(opt in defaults)defaults.hasOwnProperty(opt)&&(void 0===options[opt]?o[opt]=defaults[opt]:o[opt]=options[opt]);return o}function smoothstep(a,b,x){return x<a?0:x>=b?1:(x=(x-a)/(b-a))*x*(3-2*x)}function noise(){return.5*Math.random()+.5}function colorDistance(scale,dest,src){return clamp(scale*dest+(1-scale)*src,0,255)}function convolve3x3(inData,outData,width,height,kernel,alpha,invert,mono){var x,y,n=width*height*4,idx,r,g,b,a,pyc,pyp,pyn,pxc,pxp,pxn,k00=kernel[0][0],k01=kernel[0][1],k02=kernel[0][2],k10=kernel[1][0],k11=kernel[1][1],k12=kernel[1][2],k20=kernel[2][0],k21=kernel[2][1],k22=kernel[2][2],p00,p01,p02,p10,p11,p12,p20,p21,p22;for(y=0;y<height;y+=1)for(pyp=(pyc=y*width*4)-4*width,pyn=pyc+4*width,y<1&&(pyp=pyc),y>=width-1&&(pyn=pyc),x=0;x<width;x+=1)idx=4*(y*width+x),pxp=(pxc=4*x)-4,pxn=pxc+4,x<1&&(pxp=pxc),x>=width-1&&(pxn=pxc),p01=pyp+pxc,p02=pyp+pxn,p10=pyc+pxp,p11=pyc+pxc,p12=pyc+pxn,p20=pyn+pxp,p21=pyn+pxc,p22=pyn+pxn,r=inData[p00=pyp+pxp]*k00+inData[p01]*k01+inData[p02]*k02+inData[p10]*k10+inData[p11]*k11+inData[p12]*k12+inData[p20]*k20+inData[p21]*k21+inData[p22]*k22,g=inData[p00+1]*k00+inData[p01+1]*k01+inData[p02+1]*k02+inData[p10+1]*k10+inData[p11+1]*k11+inData[p12+1]*k12+inData[p20+1]*k20+inData[p21+1]*k21+inData[p22+1]*k22,b=inData[p00+2]*k00+inData[p01+2]*k01+inData[p02+2]*k02+inData[p10+2]*k10+inData[p11+2]*k11+inData[p12+2]*k12+inData[p20+2]*k20+inData[p21+2]*k21+inData[p22+2]*k22,a=alpha?inData[p00+3]*k00+inData[p01+3]*k01+inData[p02+3]*k02+inData[p10+3]*k10+inData[p11+3]*k11+inData[p12+3]*k12+inData[p20+3]*k20+inData[p21+3]*k21+inData[p22+3]*k22:inData[idx+3],mono&&(r=g=b=(r+g+b)/3),invert&&(r=255-r,g=255-g,b=255-b),outData[idx]=r,outData[idx+1]=g,outData[idx+2]=b,outData[idx+3]=a}function convolve5x5(inData,outData,width,height,kernel,alpha,invert,mono){var x,y,n=width*height*4,idx,r,g,b,a,pyc,pyp,pyn,pypp,pynn,pxc,pxp,pxn,pxpp,pxnn,k00=kernel[0][0],k01=kernel[0][1],k02=kernel[0][2],k03=kernel[0][3],k04=kernel[0][4],k10=kernel[1][0],k11=kernel[1][1],k12=kernel[1][2],k13=kernel[1][3],k14=kernel[1][4],k20=kernel[2][0],k21=kernel[2][1],k22=kernel[2][2],k23=kernel[2][3],k24=kernel[2][4],k30=kernel[3][0],k31=kernel[3][1],k32=kernel[3][2],k33=kernel[3][3],k34=kernel[3][4],k40=kernel[4][0],k41=kernel[4][1],k42=kernel[4][2],k43=kernel[4][3],k44=kernel[4][4],p00,p01,p02,p03,p04,p10,p11,p12,p13,p14,p20,p21,p22,p23,p24,p30,p31,p32,p33,p34,p40,p41,p42,p43,p44;for(y=0;y<height;y+=1)for(pyp=(pyc=y*width*4)-4*width,pypp=pyc-4*width*2,pyn=pyc+4*width,pynn=pyc+4*width*2,y<1&&(pyp=pyc),y>=width-1&&(pyn=pyc),y<2&&(pypp=pyp),y>=width-2&&(pynn=pyn),x=0;x<width;x+=1)idx=4*(y*width+x),pxp=(pxc=4*x)-4,pxn=pxc+4,pxpp=pxc-8,pxnn=pxc+8,x<1&&(pxp=pxc),x>=width-1&&(pxn=pxc),x<2&&(pxpp=pxp),x>=width-2&&(pxnn=pxn),p01=pypp+pxp,p02=pypp+pxc,p03=pypp+pxn,p04=pypp+pxnn,p10=pyp+pxpp,p11=pyp+pxp,p12=pyp+pxc,p13=pyp+pxn,p14=pyp+pxnn,p20=pyc+pxpp,p21=pyc+pxp,p22=pyc+pxc,p23=pyc+pxn,p24=pyc+pxnn,p30=pyn+pxpp,p31=pyn+pxp,p32=pyn+pxc,p33=pyn+pxn,p34=pyn+pxnn,p40=pynn+pxpp,p41=pynn+pxp,p42=pynn+pxc,p43=pynn+pxn,p44=pynn+pxnn,r=inData[p00=pypp+pxpp]*k00+inData[p01]*k01+inData[p02]*k02+inData[p03]*k04+inData[p02]*k04+inData[p10]*k10+inData[p11]*k11+inData[p12]*k12+inData[p13]*k14+inData[p12]*k14+inData[p20]*k20+inData[p21]*k21+inData[p22]*k22+inData[p23]*k24+inData[p22]*k24+inData[p30]*k30+inData[p31]*k31+inData[p32]*k32+inData[p33]*k34+inData[p32]*k34+inData[p40]*k40+inData[p41]*k41+inData[p42]*k42+inData[p43]*k44+inData[p42]*k44,g=inData[p00+1]*k00+inData[p01+1]*k01+inData[p02+1]*k02+inData[p03+1]*k04+inData[p02+1]*k04+inData[p10+1]*k10+inData[p11+1]*k11+inData[p12+1]*k12+inData[p13+1]*k14+inData[p12+1]*k14+inData[p20+1]*k20+inData[p21+1]*k21+inData[p22+1]*k22+inData[p23+1]*k24+inData[p22+1]*k24+inData[p30+1]*k30+inData[p31+1]*k31+inData[p32+1]*k32+inData[p33+1]*k34+inData[p32+1]*k34+inData[p40+1]*k40+inData[p41+1]*k41+inData[p42+1]*k42+inData[p43+1]*k44+inData[p42+1]*k44,b=inData[p00+2]*k00+inData[p01+2]*k01+inData[p02+2]*k02+inData[p03+2]*k04+inData[p02+2]*k04+inData[p10+2]*k10+inData[p11+2]*k11+inData[p12+2]*k12+inData[p13+2]*k14+inData[p12+2]*k14+inData[p20+2]*k20+inData[p21+2]*k21+inData[p22+2]*k22+inData[p23+2]*k24+inData[p22+2]*k24+inData[p30+2]*k30+inData[p31+2]*k31+inData[p32+2]*k32+inData[p33+2]*k34+inData[p32+2]*k34+inData[p40+2]*k40+inData[p41+2]*k41+inData[p42+2]*k42+inData[p43+2]*k44+inData[p42+2]*k44,a=alpha?inData[p00+3]*k00+inData[p01+3]*k01+inData[p02+3]*k02+inData[p03+3]*k04+inData[p02+3]*k04+inData[p10+3]*k10+inData[p11+3]*k11+inData[p12+3]*k12+inData[p13+3]*k14+inData[p12+3]*k14+inData[p20+3]*k20+inData[p21+3]*k21+inData[p22+3]*k22+inData[p23+3]*k24+inData[p22+3]*k24+inData[p30+3]*k30+inData[p31+3]*k31+inData[p32+3]*k32+inData[p33+3]*k34+inData[p32+3]*k34+inData[p40+3]*k40+inData[p41+3]*k41+inData[p42+3]*k42+inData[p43+3]*k44+inData[p42+3]*k44:inData[idx+3],mono&&(r=g=b=(r+g+b)/3),invert&&(r=255-r,g=255-g,b=255-b),outData[idx]=r,outData[idx+1]=g,outData[idx+2]=b,outData[idx+3]=a}function gaussian(inData,outData,width,height,kernelSize){var x,y,i,j,n=width*height*4,r,g,b,a,idx,inx,iny,w,tmpData=[],maxKernelSize=13,k1,k2,weights,kernels=[[1]];for(k2=(kernelSize=clamp(kernelSize,3,13))+(k1=-kernelSize/2+(kernelSize%2?.5:0)),i=1;i<13;i+=1)kernels[0][i]=0;for(i=1;i<13;i+=1)for(kernels[i]=[1],j=1;j<13;j+=1)kernels[i][j]=kernels[i-1][j]+kernels[i-1][j-1];for(weights=kernels[kernelSize-1],i=0,w=0;i<kernelSize;i+=1)w+=weights[i];for(i=0;i<kernelSize;i+=1)weights[i]/=w;for(y=0;y<height;y+=1)for(x=0;x<width;x+=1){for(r=g=b=a=0,i=k1;i<k2;i+=1)inx=x+i,iny=y,w=weights[i-k1],inx<0&&(inx=0),inx>=width&&(inx=width-1),r+=inData[idx=4*(iny*width+inx)]*w,g+=inData[idx+1]*w,b+=inData[idx+2]*w,a+=inData[idx+3]*w;tmpData[idx=4*(y*width+x)]=r,tmpData[idx+1]=g,tmpData[idx+2]=b,tmpData[idx+3]=a}for(y=0;y<height;y+=1)for(x=0;x<width;x+=1){for(r=g=b=a=0,i=k1;i<k2;i+=1)inx=x,iny=y+i,w=weights[i-k1],iny<0&&(iny=0),iny>=height&&(iny=height-1),r+=tmpData[idx=4*(iny*width+inx)]*w,g+=tmpData[idx+1]*w,b+=tmpData[idx+2]*w,a+=tmpData[idx+3]*w;outData[idx=4*(y*width+x)]=r,outData[idx+1]=g,outData[idx+2]=b,outData[idx+3]=a}}function getPixel(v,i){return[v[0+(i*=4)],v[i+1],v[i+2],v[i+3]]}function setPixel(v,i,rgba){v[0+(i*=4)]=rgba[0],v[i+1]=rgba[1],v[i+2]=rgba[2],v[i+3]=rgba[3]}function polar(inData,outData,x0,y0,width,height,callback){var y1,x1,x,y,d,a,v;for(x0=width/2+(x0||0),y0=height/2+(y0||0),y1=0;y1<height;y1+=1)for(x1=0;x1<width;x1+=1)x=x1-x0,y=y1-y0,d=(v=callback(d=Math.sqrt(Math.pow(x,2)+Math.pow(y,2)),a=Math.atan2(y,x)))[0],a=v[1],setPixel(outData,x1+y1*width,getPixel(inData,Math.round(x0+Math.cos(a)*d)+Math.round(y0+Math.sin(a)*d)*width))}var process={invert:function(inData,outData,width,height){var i,n=width*height*4;for(i=0;i<n;i+=4)outData[i]=255-inData[i],outData[i+1]=255-inData[i+1],outData[i+2]=255-inData[i+2],outData[i+3]=inData[i+3]},sepia:function(inData,outData,width,height){var i,n=width*height*4,r,g,b;for(i=0;i<n;i+=4)r=inData[i],g=inData[i+1],b=inData[i+2],outData[i]=.393*r+.769*g+.189*b,outData[i+1]=.349*r+.686*g+.168*b,outData[i+2]=.272*r+.534*g+.131*b,outData[i+3]=inData[i+3]},solarize:function(inData,outData,width,height){var i,n=width*height*4,r,g,b;for(i=0;i<n;i+=4)r=inData[i],g=inData[i+1],b=inData[i+2],outData[i]=r>127?255-r:r,outData[i+1]=g>127?255-g:g,outData[i+2]=b>127?255-b:b,outData[i+3]=inData[i+3]},brightness:function(inData,outData,width,height,options){options=defaultOptions(options,{brightness:1,contrast:0});var i,n=width*height*4,r,g,b,contrast=clamp(options.contrast,-1,1)/2,brightness=1+clamp(options.brightness,-1,1),brightMul=brightness<0?-brightness:brightness,brightAdd=brightness<0?0:brightness,contrastAdd;for(contrastAdd=255*-((contrast=.5*Math.tan((contrast+1)*Math.PI/4))-.5),i=0;i<n;i+=4)r=((r=inData[i])+r*brightMul+brightAdd)*contrast+contrastAdd,g=((g=inData[i+1])+g*brightMul+brightAdd)*contrast+contrastAdd,b=((b=inData[i+2])+b*brightMul+brightAdd)*contrast+contrastAdd,outData[i]=r,outData[i+1]=g,outData[i+2]=b,outData[i+3]=inData[i+3]},desaturate:function(inData,outData,width,height,options){var i,n=width*height*4,level,rCoeff,gCoeff,bCoeff;for("ITU-R BT.601"===(options=defaultOptions(options,{method:"ITU-R BT.601"})).method?(rCoeff=.3,gCoeff=.59,bCoeff=.11):"ITU-R BT.709"===options.method&&(rCoeff=.2125,gCoeff=.7154,bCoeff=.0721),i=0;i<n;i+=4)level=inData[i]*rCoeff+inData[i+1]*gCoeff+inData[i+2]*bCoeff,outData[i]=level,outData[i+1]=level,outData[i+2]=level,outData[i+3]=inData[i+3]},lighten:function(inData,outData,width,height,options){options=defaultOptions(options,{amount:.25});var i,n=width*height*4,mul=1+clamp(options.amount,0,1);for(i=0;i<n;i+=4)outData[i]=inData[i]*mul,outData[i+1]=inData[i+1]*mul,outData[i+2]=inData[i+2]*mul,outData[i+3]=inData[i+3]},noise:function(inData,outData,width,height,options){options=defaultOptions(options,{amount:.5,strength:.5,mono:!1});var i,n=width*height*4,rnd,r,g,b,amount=clamp(options.amount,0,1),strength=clamp(options.strength,0,1),mono=!!options.mono,random=Math.random;for(i=0;i<n;i+=4)r=inData[i],g=inData[i+1],b=inData[i+2],(rnd=random())<amount&&(mono?(r+=rnd=strength*(rnd/amount*2-1)*255,g+=rnd,b+=rnd):(r+=strength*random()*255,g+=strength*random()*255,b+=strength*random()*255)),outData[i]=r,outData[i+1]=g,outData[i+2]=b,outData[i+3]=inData[i+3]},flipv:function(inData,outData,width,height){var x,y,n=width*height*4,inPix,outPix;for(y=0;y<height;y+=1)for(x=0;x<width;x+=1)inPix=4*(y*width+x),outData[outPix=4*(y*width+(width-x-1))]=inData[inPix],outData[outPix+1]=inData[inPix+1],outData[outPix+2]=inData[inPix+2],outData[outPix+3]=inData[inPix+3]},fliph:function(inData,outData,width,height){var x,y,n=width*height*4,inPix,outPix;for(y=0;y<height;y+=1)for(x=0;x<width;x+=1)inPix=4*(y*width+x),outData[outPix=4*((height-y-1)*width+x)]=inData[inPix],outData[outPix+1]=inData[inPix+1],outData[outPix+2]=inData[inPix+2],outData[outPix+3]=inData[inPix+3]},blur:function(inData,outData,width,height,options){options=defaultOptions(options,{radius:10});for(var i=0;i<inData.length;i+=1)outData[i]=inData[i];stackblur(outData,width,height,options.radius)},glow:function(inData,outData,width,height,options){var i,n=width*height*4,r,g,b,amount=(options=defaultOptions(options,{amount:.75,kernelSize:5})).amount,tmpData=[];for(gaussian(inData,tmpData,width,height,options.kernelSize),i=0;i<n;i+=4)(r=inData[i]+tmpData[i]*amount)>255&&(r=255),(g=inData[i+1]+tmpData[i+1]*amount)>255&&(g=255),(b=inData[i+2]+tmpData[i+2]*amount)>255&&(b=255),outData[i]=r,outData[i+1]=g,outData[i+2]=b,outData[i+3]=inData[i+3]},convolve3x3:function(inData,outData,width,height,options){convolve3x3(inData,outData,width,height,options.kernel)},convolve5x5:function(inData,outData,width,height,options){convolve5x5(inData,outData,width,height,options.kernel)},sharpen3x3:function(inData,outData,width,height,options){options=defaultOptions(options,{strength:1});var a=-clamp(options.strength,0,1);convolve3x3(inData,outData,width,height,[[a,a,a],[a,1-8*a,a],[a,a,a]])},sharpen5x5:function(inData,outData,width,height,options){options=defaultOptions(options,{strength:1});var a=-clamp(options.strength,0,1);convolve5x5(inData,outData,width,height,[[a,a,a,a,a],[a,a,a,a,a],[a,a,1-24*a,a,a],[a,a,a,a,a],[a,a,a,a,a]])},soften3x3:function(inData,outData,width,height){var c=1/9;convolve3x3(inData,outData,width,height,[[c,c,c],[c,c,c],[c,c,c]])},soften5x5:function(inData,outData,width,height){var c=.04;convolve5x5(inData,outData,width,height,[[c,c,c,c,c],[c,c,c,c,c],[c,c,c,c,c],[c,c,c,c,c],[c,c,c,c,c]])},crossedges:function(inData,outData,width,height,options){options=defaultOptions(options,{strength:1});var a=5*clamp(options.strength,0,1);convolve3x3(inData,outData,width,height,[[0,-a,0],[-a,0,a],[0,a,0]],!1,!0)},emboss:function(inData,outData,width,height,options){var i,n=width*height*4,amount=(options=defaultOptions(options,{amount:1,angle:0})).amount,angle=options.angle,x=Math.cos(-angle)*amount,y=Math.sin(-angle)*amount,a00,a10,a20,a01,a21,a02,a12,a22,tmpData=[];for(convolve3x3(inData,tmpData,width,height,[[-x-y,-y,-y+x],[-x,0,x],[y-x,y,y+x]]),i=0;i<n;i+=4)outData[i]=128+tmpData[i],outData[i+1]=128+tmpData[i+1],outData[i+2]=128+tmpData[i+2],outData[i+3]=inData[i+3]},findedges:function(inData,outData,width,height){var i,n=width*height*4,gr1,gr2,gg1,gg2,gb1,gb2,data1=[],data2=[];for(convolve3x3(inData,data1,width,height,[[-1,0,1],[-2,0,2],[-1,0,1]]),convolve3x3(inData,data2,width,height,[[-1,-2,-1],[0,0,0],[1,2,1]]),i=0;i<n;i+=4)(gr1=data1[i])<0&&(gr1=-gr1),(gr2=data2[i])<0&&(gr2=-gr2),(gg1=data1[i+1])<0&&(gg1=-gg1),(gg2=data2[i+1])<0&&(gg2=-gg2),(gb1=data1[i+2])<0&&(gb1=-gb1),(gb2=data2[i+2])<0&&(gb2=-gb2),outData[i]=255-.8*(gr1+gr2),outData[i+1]=255-.8*(gg1+gg2),outData[i+2]=255-.8*(gb1+gb2),outData[i+3]=inData[i+3]},edgeenhance3x3:function(inData,outData,width,height){var c=-1/9;convolve3x3(inData,outData,width,height,[[c,c,c],[c,17/9,c],[c,c,c]])},edgeenhance5x5:function(inData,outData,width,height){var c=-.04;convolve5x5(inData,outData,width,height,[[c,c,c,c,c],[c,c,c,c,c],[c,c,1.96,c,c],[c,c,c,c,c],[c,c,c,c,c]])},laplace3x3:function(inData,outData,width,height){convolve3x3(inData,outData,width,height,[[-1,-1,-1],[-1,8,-1],[-1,-1,-1]],!1,!0,!0)},laplace5x5:function(inData,outData,width,height){convolve5x5(inData,outData,width,height,[[-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1],[-1,-1,24,-1,-1],[-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1]],!1,!0,!0)},rgbAdjust:function(inData,outData,width,height,options){options=defaultOptions(options,{r:0,g:0,b:0,a:0});var i,n=width*height*4,r,g,b,a,ar=255*clamp(options.r,-1,1),ag=255*clamp(options.g,-1,1),ab=255*clamp(options.b,-1,1),aa=255*clamp(options.a,-1,1);for(i=0;i<n;i+=4)(r=inData[i]+ar)<0&&(r=0),(g=inData[i+1]+ag)<0&&(g=0),(b=inData[i+2]+ab)<0&&(b=0),(a=inData[i+3]+aa)<0&&(a=0),r>255&&(r=255),g>255&&(g=255),b>255&&(b=255),a>255&&(a=255),outData[i]=r,outData[i+1]=g,outData[i+2]=b,outData[i+3]=a},colorfilter:function(inData,outData,width,height,options){var i,n=width*height*4,r,g,b,luminosity=!!(options=defaultOptions(options,{luminosity:!1,r:1,g:.5,b:0})).luminosity,min,max,h,l,h1,chroma,tmp,m,ar=clamp(options.r,0,1),ag=clamp(options.g,0,1),ab=clamp(options.b,0,1);for(i=0;i<n;i+=4)l=.3*(r=inData[i]/255)+.59*(g=inData[i+1]/255)+.11*(b=inData[i+2]/255),r=(r+r*ar)/2,g=(g+g*ag)/2,b=(b+b*ab)/2,luminosity&&(min=max=r,g>max&&(max=g),b>max&&(max=b),g<min&&(min=g),b<min&&(min=b),tmp=(chroma=max-min)*((h=r===max?(g-b)/chroma%6:g===max?(b-r)/chroma+2:(r-g)/chroma+4)-(h1=h>>0)),r=g=b=l-(.3*r+.59*g+.11*b),0===h1?(r+=chroma,g+=tmp):1===h1?(r+=chroma-tmp,g+=chroma):2===h1?(g+=chroma,b+=tmp):3===h1?(g+=chroma-tmp,b+=chroma):4===h1?(r+=tmp,b+=chroma):5===h1&&(r+=chroma,b+=chroma-tmp)),outData[i]=255*r,outData[i+1]=255*g,outData[i+2]=255*b,outData[i+3]=inData[i+3]},hslAdjust:function(inData,outData,width,height,options){options=defaultOptions(options,{h:.5,s:.3,l:.1,a:0});var i,n=width*height*4,r,g,b,a,hue=clamp(options.h,-1,1),saturation=clamp(options.s,-1,1),lightness=clamp(options.l,-1,1),aa=255*clamp(options.a,-1,1),satMul=1+saturation*(saturation<0?1:2),lightMul=lightness<0?1+lightness:1-lightness,lightAdd=lightness<0?0:255*lightness,vs,ms,vm,h,s,l,v,m,vmh,sextant;for(hue=6*hue%6,i=0;i<n;i+=4)r=inData[i],g=inData[i+1],b=inData[i+2],0===hue&&0===saturation||(g>(vs=r)&&(vs=g),b>vs&&(vs=b),g<(ms=r)&&(ms=g),b<ms&&(ms=b),vm=vs-ms,(l=(ms+vs)/510)>0&&vm>0&&(l<=.5?((s=vm/(vs+ms)*satMul)>1&&(s=1),v=l*(1+s)):((s=vm/(510-vs-ms)*satMul)>1&&(s=1),v=l+s-l*s),(h=r===vs?g===ms?5+(vs-b)/vm+hue:1-(vs-g)/vm+hue:g===vs?b===ms?1+(vs-r)/vm+hue:3-(vs-b)/vm+hue:r===ms?3+(vs-g)/vm+hue:5-(vs-r)/vm+hue)<0&&(h+=6),h>=6&&(h-=6),vmh=(v-(m=l+l-v))*(h-(sextant=h>>0)),0===sextant?(r=v,g=m+vmh,b=m):1===sextant?(r=v-vmh,g=v,b=m):2===sextant?(r=m,g=v,b=m+vmh):3===sextant?(r=m,g=v-vmh,b=v):4===sextant?(r=m+vmh,g=m,b=v):5===sextant&&(r=v,g=m,b=v-vmh),r*=255,g*=255,b*=255)),(r=r*lightMul+lightAdd)<0&&(r=0),(g=g*lightMul+lightAdd)<0&&(g=0),(b=b*lightMul+lightAdd)<0&&(b=0),(a=inData[i+3]+aa)<0&&(a=0),r>255&&(r=255),g>255&&(g=255),b>255&&(b=255),a>255&&(a=255),outData[i]=r,outData[i+1]=g,outData[i+2]=b,outData[i+3]=a},posterize:function(inData,outData,width,height,options){options=defaultOptions(options,{levels:5});var i,n=width*height*4,r,g,b,numLevels=clamp(options.levels,2,256),numAreas=256/numLevels,numValues=256/(numLevels-1);for(i=0;i<n;i+=4)outData[i]=numValues*(inData[i]/numAreas>>0),outData[i+1]=numValues*(inData[i+1]/numAreas>>0),outData[i+2]=numValues*(inData[i+2]/numAreas>>0),outData[i+3]=inData[i+3]},removenoise:function(inData,outData,width,height){var x,y,n=width*height*4,r,g,b,c,idx,pyc,pyp,pyn,pxc,pxp,pxn,minR,minG,minB,maxR,maxG,maxB;for(y=0;y<height;y+=1)for(pyp=(pyc=y*width*4)-4*width,pyn=pyc+4*width,y<1&&(pyp=pyc),y>=width-1&&(pyn=pyc),x=0;x<width;x+=1)idx=4*(y*width+x),pxp=(pxc=4*x)-4,pxn=pxc+4,x<1&&(pxp=pxc),x>=width-1&&(pxn=pxc),minR=maxR=inData[pyc+pxp],(c=inData[pyc+pxn])<minR&&(minR=c),c>maxR&&(maxR=c),(c=inData[pyp+pxc])<minR&&(minR=c),c>maxR&&(maxR=c),(c=inData[pyn+pxc])<minR&&(minR=c),c>maxR&&(maxR=c),minG=inData[pyc+pxp+1],(c=inData[pyc+pxn+1])<minG&&(minG=c),(c=inData[pyp+pxc+1])<minG&&(minG=c),(c=inData[pyn+pxc+1])<minG&&(minG=c),minB=inData[pyc+pxp+2],(c=inData[pyc+pxn+2])<minB&&(minB=c),(c=inData[pyp+pxc+2])<minB&&(minB=c),(c=inData[pyn+pxc+2])<minB&&(minB=c),(r=inData[idx])<minR&&(r=minR),r>maxR&&(r=maxR),(g=inData[idx+1])<minG&&(g=minG),g>maxG&&(g=maxG),(b=inData[idx+2])<minB&&(b=minB),b>maxB&&(b=maxB),outData[idx]=r,outData[idx+1]=g,outData[idx+2]=b,outData[idx+3]=inData[idx+3]},mosaic:function(inData,outData,width,height,options){options=defaultOptions(options,{blockSize:8});var blockSize=clamp(options.blockSize,1,Math.max(width,height)),yBlocks=Math.ceil(height/blockSize),xBlocks=Math.ceil(width/blockSize),y0,y1,x0,x1,idx,pidx,i,j,bidx,r,g,b,bi,bj,n=yBlocks*xBlocks,prog,lastProg=0;for(y0=0,bidx=0,i=0;i<yBlocks;i+=1){for(y1=clamp(y0+blockSize,0,height),x0=0,j=0;j<xBlocks;j+=1){for(x1=clamp(x0+blockSize,0,width),r=inData[idx=y0*width+x0<<2],g=inData[idx+1],b=inData[idx+2],bi=y0;bi<y1;bi+=1)for(bj=x0;bj<x1;bj+=1)outData[pidx=bi*width+bj<<2]=r,outData[pidx+1]=g,outData[pidx+2]=b,outData[pidx+3]=inData[pidx+3];x0=x1,bidx+=1}y0=y1}},equalize:function(inData,outData,width,height,options){var n=width*height,p,i,level,ratio,prog,lastProg,round=Math.round,pdf=new Array(256);for(i=0;i<256;i+=1)pdf[i]=0;for(i=0;i<n;i+=1)level=clamp(round(.3*inData[p=4*i]+.59*inData[p+1]+.11*inData[p+2]),0,255),outData[p+3]=level,pdf[level]+=1;var cdf=new Array(256);for(cdf[0]=pdf[0],i=1;i<256;i+=1)cdf[i]=cdf[i-1]+pdf[i];for(i=0;i<256;i+=1)cdf[i]=cdf[i]/n*255;for(i=0;i<n;i+=1)ratio=cdf[level=outData[3+(p=4*i)]]/(level||1),outData[p]=clamp(round(inData[p]*ratio),0,255),outData[p+1]=clamp(round(inData[p+1]*ratio),0,255),outData[p+2]=clamp(round(inData[p+2]*ratio),0,255),outData[p+3]=inData[p+3]},mask:function(inData,outData,width,height,options){var i,n=width*height*4,data=options.data;for(i=0;i<n;i+=4)outData[i]=inData[i],outData[i+1]=inData[i+1],outData[i+2]=inData[i+2],outData[i+3]=inData[i+3]*data[i]/255*data[i+3]/255},bump:function(inData,outData,width,height,options){var m1=(options=defaultOptions(options,{dx:0,dy:0,radius:0,zoom:0})).radius,m2=clamp(options.zoom,0,1);return polar(inData,outData,options.dx,options.dy,width,height,(function(d,a){return[d*smoothstep(0,m2,d/m1),a]}))},dent:function(inData,outData,width,height,options){var m1=(options=defaultOptions(options,{dx:0,dy:0,radius:0,zoom:0})).radius,m2=clamp(options.zoom,0,1);return polar(inData,outData,options.dx,options.dy,width,height,(function(d,a){return[2*d-d*smoothstep(0,m2,d/m1),a]}))},pinch:function(inData,outData,width,height,options){options=defaultOptions(options,{dx:0,dy:0,zoom:0});var m1=util.distance(0,0,width,height),m2=clamp(.75*options.zoom,-.75,.75);return polar(inData,outData,options.dx,options.dy,width,height,(function(d,a){return[d*Math.pow(m1/d,m2)*(1-m2),a]}))},splash:function(inData,outData,width,height,options){var m=(options=defaultOptions(options,{dx:0,dy:0,radius:0})).radius;return polar(inData,outData,options.dx,options.dy,width,height,(function(d,a){return[d>m?m:d,a]}))},twirl:function(inData,outData,width,height,options){options=defaultOptions(options,{dx:0,dy:0,radius:0,angle:0});var m1=util.radians(options.angle),m2=options.radius;return polar(inData,outData,options.dx,options.dy,width,height,(function(d,a){return[d,a+(1-smoothstep(-m2,m2,d))*m1]}))}};module.exports=process},{"./util":24,stackblur:9}],24:[function(require,module,exports){"use strict";function degrees(radians){return 180*radians/Math.PI}function radians(degrees){return degrees/180*Math.PI}function distance(x0,y0,x1,y1){return Math.sqrt(Math.pow(x1-x0,2)+Math.pow(y1-y0,2))}function clamp(val,min,max){return Math.min(max,Math.max(min,val))}function transform(m){function _mmult(a,m){var m0=(m=m.slice())[0],m1=m[1],m2=m[2],m3=m[3],m4=m[4],m5=m[5],m6=m[6],m7=m[7],m8=m[8];return m[0]=a[0]*m0+a[1]*m3,m[1]=a[0]*m1+a[1]*m4,m[3]=a[3]*m0+a[4]*m3,m[4]=a[3]*m1+a[4]*m4,m[6]=a[6]*m0+a[7]*m3+m6,m[7]=a[6]*m1+a[7]*m4+m7,transform(m)}return(m=void 0===m?[1,0,0,0,1,0,0,0,1]:m.slice(),{matrix:function(){return m.slice()},clone:function(){return transform(m)},prepend:function(t){return t.matrix&&(t=t.matrix()),_mmult(m,t)},append:function(t){return t.matrix&&(t=t.matrix()),_mmult(t,m)},translate:function(x,y){return _mmult([1,0,0,0,1,0,x,y,1],m)},scale:function(x,y){return void 0===y&&(y=x),_mmult([x,0,0,0,y,0,0,0,1],m)},skew:function(x,y){void 0===y&&(y=x);var kx=Math.PI*x/180,ky=Math.PI*y/180;return _mmult([1,Math.tan(ky),0,-Math.tan(kx),1,0,0,0,1],m)},rotate:function(angle){var c=Math.cos(radians(angle)),s=Math.sin(radians(angle));return _mmult([c,s,0,-s,c,0,0,0,1],m)},transformPoint:function(point){var x=point.x,y=point.y;return{x:x*m[0]+y*m[3]+m[6],y:x*m[1]+y*m[4]+m[7]}}})}module.exports={degrees:degrees,radians:radians,distance:distance,clamp:clamp,transform:transform}},{}],25:[function(require,module,exports){"use strict";var deepEqual=require("./deepequal"),util=require("./util"),g={combine:function(){var i,l,result=[];for(i=0;i<arguments.length;i++)(l=arguments[i])&&(result=result.concat(l));return result},contains:function(l,value){for(var i=0;i<l.length;i+=1)if(deepEqual.deepEqual(l[i],value))return!0;return!1},cycle:function(l,length){if(!l||length<=0)return[];for(var newList=[],ll=l.length,i=0;i<length;i+=1)newList.push(l[i%ll]);return newList},equals:function(o1,o2){return deepEqual.deepEqual(o1,o2)},count:function(l){return l&&l.length?l.length:0},cull:function(l,booleans){if(!l)return[];if(!booleans)return l;var i,keep,results=[];for(i=0;i<l.length;i++)(keep=booleans[i%booleans.length])&&results.push(l[i]);return results},distinct:function(l){if(!l)return[];var i,length,value,result=[],seen=[];for(i=0,length=l.length;i<length;i+=1)value=l[i],g.contains(seen,value)||(seen.push(value),result.push(l[i]));return result},first:function(l){return l&&0!==l.length?l[0]:null},get:function(l,i){return l&&0!==l.length?l[i]:null},interleave:function(){if(0===arguments.length)return[];for(var results=[],elIndex=0;;){for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(!(arg.length>elIndex))return results;results.push(arg[elIndex])}elIndex+=1}},last:function(l){return l&&0!==l.length?l[l.length-1]:null},pick:function(l,amount,seed){if(!l||0===l.length||amount<=0)return[];seed||0===seed||(seed=Math.random());for(var rand=util.randomGenerator(seed||0),results=[],i=0;i<amount;i+=1)results.push(l[Math.floor(rand(0,l.length))]);return results},randomSample:function(l,amount,seed){if(!l||0===l.length||amount<=0)return[];seed||0===seed||(seed=Math.random());var shuffledlist=g.shuffle(l,seed);return amount?g.slice(shuffledlist,0,amount):shuffledlist},repeat:function(l,amount,perItem){if(!l)return[];if(Array.isArray(l)||(l=[l]),amount<=0)return[];var i,j,v,newList=[];if(perItem)for(i=0;i<l.length;i+=1)for(v=l[i],j=0;j<amount;j+=1)newList.push(v);else for(i=0;i<amount;i+=1)newList.push.apply(newList,l);return newList},rest:function(l){return l?l.slice(1):[]},reverse:function(l){return l.slice().reverse()},second:function(l){return!l||l.length<2?null:l[1]},shift:function(l,amount){if(!l)return[];amount%=l.length;var head=l.slice(0,amount),result=l.slice(amount);return result.push.apply(result,head),result},shuffle:function(l,seed){var i,j,tmp,r;for(seed||0===seed||(seed=Math.random()),r=util.randomGenerator(seed||0),i=(l=l.slice()).length-1;i>0;i--)j=Math.floor(r(0,i+1)),tmp=l[i],l[i]=l[j],l[j]=tmp;return l},slice:function(l,start,size,invert){return l?invert?(firstList=l.slice(0,start),secondList=l.slice(start+size),firstList.push.apply(firstList,secondList),firstList):l.slice(start,start+size):[];var firstList,secondList},sort:function(l,key){if(key){if("string"==typeof key)return l.slice().sort((function(a,b){return a[key]>b[key]?1:a[key]===b[key]?0:-1}));if("function"==typeof key)return l.slice().sort(key)}return l&&void 0!==l[0]&&null!==l[0]&&"number"==typeof l[0]?l.slice().sort((function(a,b){return a-b})):l.slice().sort()},switch:function(index){var nLists=arguments.length-1;return(index%=nLists)<0&&(index+=nLists),arguments[index+1]},takeEvery:function(l,n,offset){var i,results=[];for(offset=offset||0,i=0;i<l.length;i+=1)i%n===offset&&results.push(l[i]);return results},zipMap:function(keys,vals){var i,k,v,m={},minLength=Math.min(keys.length,vals.length);for(i=0;i<minLength;i+=1)k=keys[i],v=vals[i],m[k]=v;return m}};module.exports=g},{"./deepequal":15,"./util":28}],26:[function(require,module,exports){"use strict";var reduce=require("lodash.reduce"),util=require("./util"),vg=require("./vg/vg"),g={},TWO_PI=2*Math.PI;g.abs=Math.abs,g.accumulate=function(values){if(arguments.length>1?values=arguments:1!==arguments.length||Array.isArray(values)||(values=[values]),!values||0===values.length)return[0];var i,b=[],currentTotal=0;for(i=0;i<values.length;i++)b.push(currentTotal),currentTotal+=values[i];return b},g.add=function(a,b){return 2===arguments.length?a+b:reduce(arguments,(function(total,n){return total+n}),0)},g.and=function(bool1,bool2){var argLength=arguments.length;if(2===argLength)return bool1&&bool2;if(1===argLength)return!!bool1;if(0===argLength)throw new Error("Wrong number of arguments");return reduce(arguments,(function(b1,b2){return b1&&b2}),!0)},g.average=function(values){if(arguments.length>1?values=arguments:1!==arguments.length||Array.isArray(values)||(values=[values]),!values||0===values.length)return 0;var i,sum=0;for(i=0;i<values.length;i+=1)sum+=values[i];return sum/values.length},g.boolean=function(v){return!!v},g.ceil=Math.ceil,g.clamp=function(v,min,max){return max="number"==typeof max?max:1,v<(min="number"==typeof min?min:0)?min:v>max?max:v},g.compare=function(v1,v2,comparator){if("<"===comparator)return v1<v2;if(">"===comparator)return v1>v2;if("<="===comparator)return v1<=v2;if(">="===comparator)return v1>=v2;if("=="===comparator)return v1===v2;if("!="===comparator)return v1!==v2;throw new Error("Unknown comparison operation "+comparator)},g.cos=Math.cos,g.degrees=function(radians){return 180*radians/Math.PI},g.divide=function(a,b){var argLength=arguments.length;function checkIfZero(arg){if(0===arg)throw new Error("Divide by zero")}if(2===argLength)return checkIfZero(b),a/b;if(1===argLength)return checkIfZero(a),1/a;if(0===argLength)throw new Error("Wrong number of arguments");return reduce([].slice.call(arguments,1),(function(total,n){return checkIfZero(n),total/n}),arguments[0])},g.e=function(){return Math.E},g.even=function(v){return v%2==0},g.floor=Math.floor,g.integer=function(v){return 0|v},g.log=function(v){return v>0?Math.log(v):-Math.log(-v)},g.makeNumbers=function(s,separator){if(!s)return[];separator||(separator="");var i,num,numbers=[],strings=s.split(separator);for(i=0;i<strings.length;i+=1)(0===(num=parseFloat(strings[i]))||num)&&numbers.push(num);return numbers},g.max=function(){var values=arguments;if(1===arguments.length&&Array.isArray(arguments[0])&&(values=arguments[0]),0===values.length)throw new Error("Wrong number of arguments");return Math.max.apply(null,values)},g.min=function(){var values=arguments;if(1===arguments.length&&Array.isArray(arguments[0])&&(values=arguments[0]),0===values.length)throw new Error("Wrong number of arguments");return Math.min.apply(null,values)},g.mod=function(a,b){return a%b},g.multiply=function(a,b){var argLength=arguments.length;return 2===argLength?a*b:1===argLength?a:reduce(arguments,(function(total,n){return total*n}),1)},g.negate=function(v){return-v},g.not=function(bool){return!bool},g.number=function(v){return v},g.odd=function(v){return v%2!=0},g.or=function(bool1,bool2){var argLength=arguments.length;if(2===argLength)return bool1||bool2;if(1===argLength)return!!bool1;if(0===argLength)throw new Error("Wrong number of arguments");return reduce(arguments,(function(b1,b2){return b1||b2}),!1)},g.perlinNoise=function(x,y,z){return vg.math.noise(x,y,z)},g.pi=function(){return Math.PI},g.pow=Math.pow,g.radians=function(degrees){return degrees*Math.PI/180},g.randomNumbers=function(amount,min,max,seed){var argLength=arguments.length,v;if((argLength<4||!seed&&0!==seed)&&(seed=Math.random()),3===argLength||4===argLength?(min=min||0,max=max||(0===max?0:1)):2===argLength?(max=min||(0===min?0:1),min=0):1===argLength&&(min=0,max=1),max<min){var tmp=max;max=min,min=tmp}for(var delta=max-min,numbers=[],rand=util.randomGenerator(seed||0),i=0;i<amount;i+=1)v=min+rand(0,1)*delta,numbers.push(v);return numbers},g.range=function(min,max,step,includeMax){if(min===max)return[];if(0!==step&&(step=step||(min<max?1:-1)),step>0&&min>max)return[];if(step<0&&min<max)return[];if(0===step)return[];var values=[],i;if(min<max)if(includeMax)for(i=min;i<=max;i+=step)values.push(i);else for(i=min;i<max;i+=step)values.push(i);else if(includeMax)for(i=min;i>=max;i+=step)values.push(i);else for(i=min;i>max;i+=step)values.push(i);return values},g.round=function(v,a){return(a|=0)?Math.round(v/a)*a:Math.round(v)},g.sample=function(amount,min,max,circular){var d,values=[],i;for(values.length=amount,d=circular?(max-min)/amount:(max-min)/(amount-1),i=0;i<amount;i+=1)values[i]=min+i*d;return values},g.sineWave=function(v,min,max,period,offset){void 0===min&&(min=-1),void 0===max&&(max=1),void 0===period&&(period=1),void 0===offset&&(offset=0);var amplitude=(max-min)/2;return min+amplitude+Math.sin((offset+v)*TWO_PI/period)*amplitude},g.squareWave=function(v,min,max,period,offset){var halfPeriod,d;return void 0===min&&(min=-1),void 0===max&&(max=1),void 0===period&&(period=1),void 0===offset&&(offset=0),(v+offset)%period<period/2?max:min},g.triangleWave=function(v,min,max,period,offset){void 0===min&&(min=-1),void 0===max&&(max=1),void 0===period&&(period=1),void 0===offset&&(offset=0);var amplitude,frequency,phase=0,time=v+offset+period/4;return time%period!=0&&(phase=time*(TWO_PI/period)%TWO_PI),phase<0&&(phase+=TWO_PI),(max-min)/2*2*(1-Math.abs(phase/TWO_PI*2-1))+min},g.sawtoothWave=function(v,min,max,period,offset){void 0===min&&(min=-1),void 0===max&&(max=1),void 0===period&&(period=1),void 0===offset&&(offset=0);var amplitude,frequency,phase=0,time=v+offset;return time%period!=0&&(phase=time*(TWO_PI/period)%TWO_PI),phase<0&&(phase+=TWO_PI),phase/TWO_PI*2*((max-min)/2)+min},g.sign=function(v){return v>0?1:0===v?0:-1},g.sin=Math.sin,g.sqrt=Math.sqrt,g.subtract=function(a,b){var argLength=arguments.length;if(2===argLength)return a-b;if(1===argLength)return-a;if(0===argLength)throw new Error("Wrong number of arguments");return reduce([].slice.call(arguments,1),(function(total,n){return total-n}),arguments[0])},g.tan=Math.tan,g.total=function(values){if(arguments.length>1?values=arguments:1!==arguments.length||Array.isArray(values)?0===arguments.length&&(values=[]):values=[values],0===values.length)return 0;var i,total=0;for(i=0;i<values.length;i+=1)total+=values[i];return total},g.xor=function(bool1,bool2){var argLength=arguments.length;if(2===argLength)return!!(bool1^bool2);throw new Error("Wrong number of arguments")},module.exports=g},{"./util":28,"./vg/vg":49,"lodash.reduce":6}],27:[function(require,module,exports){"use strict";var g={characterAt:function(s,index){return s&&0!==s.length?(s=String(s),index<0&&(index=s.length+index),s.charAt(index)):""},concatenate:function(){for(var result="",i=0;i<arguments.length;i++){var s=arguments[i];result+=s=void 0!==s?String(s):""}return result},endsWith:function(s,value){return!(!s||!value)&&-1!==(s=String(s)).indexOf(value,s.length-value.length)},reverse:function(l){return l.slice().reverse()},startsWith:function(s,value){return!(!s||!value)&&0===(s=String(s)).indexOf(value)}};g.string=String,g.stringContains=function(s,sub){return!(!s||!sub)&&-1!==(s=String(s)).indexOf(sub)},g.stringEquals=function(string1,string2,ignoreCase){return string1=String(string1),string2=String(string2),!(!string1||!string2)&&(ignoreCase?string1.toLowerCase()===string2.toLowerCase():string1===string2)},g.stringLength=function(s){return s?(s=String(s)).length:0},g.stringReplace=function(s,old,new_){return(s=String(s)).replace(new RegExp(old,"g"),new_)},g.stringSplit=function(s,separator){return s?(separator&&0!==separator.length||(separator=""),(s=String(s)).split(separator)):[]},g.stringTrim=function(s){return s?(s=String(s)).trim():null},g.substring=function(s,start,end,endOffset){return s?end<start?"":(s=String(s),start<0&&end<0&&(start=s.length+start,end=s.length+end),void 0!==end&&endOffset&&(end+=1),s.substring(start,end)):""},g.toCharacterCodes=function(s){if(!s)return[];var codes=[];codes.length=s.length;for(var i=0;i<s.length;i+=1)codes[i]=s.charCodeAt(i);return codes},g.toCharacters=function(s){return s?(s=String(s)).split(""):[]},g.toLowerCase=function(s){return(s=String(s)).toLowerCase()},g.toTitleCase=function(s){var c,result="";s=String(s);for(var i=0;i<s.length;i+=1)c=s[i],0===result.length||" "===result[result.length-1]?result+=c.toUpperCase():result+=c;return result},g.toUpperCase=function(s){return(s=String(s)).toUpperCase()},g.wordCount=function(s){return s?(s=String(s)).split(new RegExp("\\w+")).length-1:0;var split},g.toWords=function(s){var l=s.split(/\W+/);return""===l[l.length-1]&&l.pop(),l},module.exports=g},{}],28:[function(require,module,exports){"use strict";var randomGenerator=function(seed){if(seed<0){for(var gen=randomGenerator(Math.abs(seed)),i=0;i<23;i+=1)gen();return randomGenerator(gen(0,1e4))}return function(min,max){var v;return(min=min||0)+(seed=(9301*seed+49297)%233280)/233280*((max=max||1)-min)}};exports.randomGenerator=randomGenerator},{}],29:[function(require,module,exports){"use strict";var Color=require("../objects/color"),vg={isDrawable:function(o){return Array.isArray(o)&&(o=o[0]),!!o&&("function"==typeof o.draw||void 0!==o.x&&void 0!==o.y||void 0!==o.r&&void 0!==o.g&&void 0!==o.b)},drawPoints:function(ctx,points){var pt;ctx.fillStyle="blue",ctx.beginPath();for(var i=0;i<points.length;i+=1)pt=points[i],ctx.moveTo(pt.x,pt.y),ctx.arc(pt.x,pt.y,2,0,2*Math.PI,!1);ctx.fill()},drawColoredPoints:function(ctx,points){for(var pt,i=0,n=points.length;i<n;i+=1)pt=points[i],ctx.fillStyle=Color.toCSS(pt),ctx.fillRect(pt.x-2,pt.y-2,4,4)},drawRectangles:function(ctx,rectangles){var r;ctx.save();for(var i=0;i<rectangles.length;i+=1)r=rectangles[i],ctx.strokeStyle="black",ctx.strokeWidth=1,ctx.rect(r.x,r.y,r.width,r.height),ctx.stroke();ctx.restore()},drawColors:function(ctx,colors){var c;ctx.save();for(var i=0;i<colors.length;i+=1)c=colors[i],ctx.fillStyle=Color.toCSS(c),ctx.fillRect(0,0,30,30),ctx.translate(30,0);ctx.restore()},draw:function(ctx,o){var k=o,isArray=!1;if(Array.isArray(o)&&(k=o[0],isArray=!0),k)if("function"==typeof k.draw)if(isArray)for(var i=0,n=o.length;i<n;i+=1)vg.draw(ctx,o[i]);else o.draw(ctx);else void 0!==k.x&&void 0!==k.y?void 0!==k.r&&void 0!==k.g&&void 0!==k.b?vg.drawColoredPoints(ctx,isArray?o:[o]):void 0!==k.width&&void 0!==k.height?vg.drawRectangles(ctx,isArray?o:[o]):vg.drawPoints(ctx,isArray?o:[o]):void 0!==k.r&&void 0!==k.g&&void 0!==k.b&&vg.drawColors(ctx,isArray?o:[o])},toSVG:function(o,options){var includeHeader=!0===(options=options||{}).header,x=void 0!==options.x?options.x:0,y=void 0!==options.y?options.y:0,width=void 0!==options.width?options.width:500,height=void 0!==options.height?options.height:500,svg="";if(o)if("function"==typeof o.toSVG)svg=o.toSVG();else if(Array.isArray(o)){svg="<g>\n";for(var i=0,n=o.length;i<n;i+=1)svg+=vg.toSVG(o[i])+"\n";svg+="</g>\n"}return includeHeader&&(svg='<?xml version="1.0" encoding="utf-8"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="'+x+'" y="'+y+'" width="'+width+'px" height="'+height+'px" viewBox="'+x+" "+y+" "+width+" "+height+'">\n'+svg+"</svg>\n"),svg}};module.exports=vg},{"../objects/color":32}],30:[function(require,module,exports){"use strict";var flatten=require("lodash.flatten"),ClipperLib=require("../../../../third_party/clipper"),bezier=require("../util/bezier"),geo=require("../util/geo"),math=require("../util/math"),random=require("../util/random"),Color=require("../objects/color"),Group=require("../objects/group"),Path=require("../objects/path"),Point=require("../objects/point"),Rect=require("../objects/rect"),Transform=require("../objects/transform"),Transformable=require("../objects/transformable");function _cloneCommand(cmd){var newCmd={type:cmd.type};return newCmd.type!==bezier.CLOSE&&(newCmd.x=cmd.x,newCmd.y=cmd.y),newCmd.type===bezier.QUADTO?(newCmd.x1=cmd.x1,newCmd.y1=cmd.y1):newCmd.type===bezier.CURVETO&&(newCmd.x1=cmd.x1,newCmd.y1=cmd.y1,newCmd.x2=cmd.x2,newCmd.y2=cmd.y2),newCmd}var vg={HORIZONTAL:"horizontal",VERTICAL:"vertical",EAST:"e",WEST:"w",NORTH:"n",SOUTH:"s",bounds:function(o){var r,i,n;if(o){if("function"==typeof o.bounds)return o.bounds();if(void 0!==o.x&&void 0!==o.y)return void 0!==o.width&&void 0!==o.height?new Rect(o.x,o.y,o.width,o.height):new Rect(o.x,o.y,0,0);if(void 0!==o.r&&void 0!==o.g&&void 0!==o.b)return new vg.Rect(0,0,30,30);if(Array.isArray(o)){if(r=null,(n=o.length)>0&&void 0!==o[0].r&&void 0!==o[0].g&&void 0!==o[0].b)return new Rect(0,0,30*o.length,30);for(i=0;i<n;i+=1)r=r?r.unite(vg.bounds(o[i])):vg.bounds(o[i]);return r||new Rect}return new Rect}return new Rect},makeCenteredRect:function(cx,cy,width,height){var x,y;return new Rect(cx-width/2,cy-height/2,width,height)},makePoint:function(x,y){return new Point(x,y)},makeRect:function(x,y,width,height){return new Rect(x,y,width,height)},merge:function(){for(var args=flatten(arguments),shapes=[],i=0;i<args.length;i+=1)args[i]&&0!==args[i].length&&shapes.push(args[i]);return new Group(shapes)},combinePaths:function(shape){return Path.combine(shape)}};vg.shapePoints=vg.toPoints=function(shape){if(!shape)return[];var i;if(shape.commands){var cmd,commands=[];for(i=0;i<shape.commands.length;i+=1)void 0!==(cmd=shape.commands[i]).x&&commands.push(new Point(cmd.x,cmd.y));return commands}var points=[];for(i=0;i<shape.shapes.length;i+=1)points=points.concat(vg.shapePoints(shape.shapes[i]));return points},vg.colorize=function(shape,fill,stroke,strokeWidth){if(shape)return shape.colorize(fill,stroke,strokeWidth)},vg.translate=function(shape,position){return shape.translate?shape.translate(position):Transformable.translate.apply(shape,[position])},vg.scale=function(shape,scale,origin){return shape.scale?shape.scale(scale,origin):Transformable.scale.apply(shape,[scale,origin])},vg.rotate=function(shape,angle,origin){return shape.rotate?shape.rotate(angle,origin):Transformable.rotate.apply(shape,[angle,origin])},vg.skew=function(shape,skew,origin){return shape.skew?shape.skew(skew,origin):Transformable.skew.apply(shape,[skew,origin])},vg.copy=function(shape,copies,order,translate,rotate,scale){var i,t,j,op,shapes=[],tx=0,ty=0,r=0,sx=1,sy=1;for(i=0;i<copies;i+=1){for(t=new Transform,j=0;j<order.length;j+=1)"t"===(op=order[j])?t=t.translate(tx,ty):"r"===op?t=t.rotate(r):"s"===op&&(t=t.scale(sx,sy));Array.isArray(shape)&&shape.length>0&&void 0!==shape[0].x&&void 0!==shape[0].y?shapes=shapes.concat(t.transformShape(shape)):shapes.push(t.transformShape(shape)),tx+=translate.x,ty+=translate.y,r+=rotate,sx+=scale.x,sy+=scale.y}return shapes},vg.fit=function(shape,position,width,height,stretch){if(shape){stretch=void 0!==stretch&&stretch;var t,sx,sy,bounds=vg.bounds(shape),bx=bounds.x,by=bounds.y,bw=bounds.width,bh=bounds.height;return bw=bw>1e-12?bw:0,bh=bh>1e-12?bh:0,t=(t=new Transform).translate(position.x,position.y),stretch?(sx=bw>0?width/bw:1,sy=bh>0?height/bh:1):(sx=bw>0?width/bw:Number.MAX_VALUE,sy=bh>0?height/bh:Number.MAX_VALUE,sx=sy=Math.min(sx,sy)),(t=(t=t.scale(sx,sy)).translate(-bw/2-bx,-bh/2-by)).transformShape(shape)}},vg.fitTo=function(shape,bounding,stretch){if(shape&&bounding){var bounds=vg.bounds(bounding),bx=bounds.x,by=bounds.y,bw=bounds.width,bh=bounds.height;return vg.fit(shape,{x:bx+bw/2,y:by+bh/2},bw,bh,stretch)}},vg._mirrorPoints=function(points,fn){var pt,mPoints=[];mPoints.length=points.length;for(var i=0;i<points.length;i+=1)pt=points[i],mPoints[i]=fn(pt.x,pt.y);return mPoints},vg._mirrorPath=function(path,fn){for(var pt,cmd,ctrl1,ctrl2,p=new Path([],path.fill,path.stroke,path.strokeWidth),i=0;i<path.commands.length;i+=1)if((cmd=path.commands[i]).type===bezier.MOVETO)pt=fn(cmd.x,cmd.y),p.moveTo(pt.x,pt.y);else if(cmd.type===bezier.LINETO)pt=fn(cmd.x,cmd.y),p.lineTo(pt.x,pt.y);else if(cmd.type===bezier.CURVETO)pt=fn(cmd.x,cmd.y),ctrl1=fn(cmd.x1,cmd.y1),ctrl2=fn(cmd.x2,cmd.y2),p.curveTo(ctrl1.x,ctrl1.y,ctrl2.x,ctrl2.y,pt.x,pt.y);else{if(cmd.type!==bezier.CLOSE)throw new Error("Unknown command "+cmd);p.close()}return p},vg._mirrorGroup=function(group,fn){var shape,mShapes=[];mShapes.length=group.shapes.length;for(var i=0;i<group.shapes.length;i+=1)shape=group.shapes[i],mShapes[i]=vg._mirror(shape,fn);return new Group(mShapes)},vg._mirror=function(shape,fn){return Array.isArray(shape)&&shape.length>0&&void 0!==shape[0].x&&void 0!==shape[0].y?vg._mirrorPoints(shape,fn):shape.shapes?vg._mirrorGroup(shape,fn):vg._mirrorPath(shape,fn)},vg.mirror=function(shape,angle,origin,keepOriginal){if(shape){origin=origin||new Point,0!==angle&&(angle=angle||90);var fn=function(x,y){var d=geo.distance(x,y,origin.x,origin.y),a=geo.angle(x,y,origin.x,origin.y),pt=geo.coordinates(origin.x,origin.y,180+angle,d*Math.cos(math.radians(a-angle)));return d=geo.distance(x,y,pt.x,pt.y),a=geo.angle(x,y,pt.x,pt.y),pt=geo.coordinates(x,y,a,2*d),new Point(pt.x,pt.y)},newShape=vg._mirror(shape,fn);return keepOriginal?Array.isArray(shape)&&shape.length>0&&void 0!==shape[0].x&&void 0!==shape[0].y?shape.concat(newShape):new Group([shape,newShape]):newShape}},vg.pathLength=function(shape,options){var precision=20;return options&&options.precision&&(precision=options.precision),shape.length(precision)},vg.resampleByLength=function(shape,maxLength){if(shape)return shape.resampleByLength(maxLength)},vg.resampleByAmount=function(shape,amount,perContour){if(shape)return shape.resampleByAmount(amount,perContour)},vg._wigglePoints=function(shape,offset,rand){var i,dx,dy;if(shape.commands){var p=new Path([],shape.fill,shape.stroke,shape.strokeWidth);for(i=0;i<shape.commands.length;i+=1){dx=(rand(0,1)-.5)*offset.x*2,dy=(rand(0,1)-.5)*offset.y*2;var cmd=shape.commands[i];cmd.type===bezier.MOVETO?p.moveTo(cmd.x+dx,cmd.y+dy):cmd.type===bezier.LINETO?p.lineTo(cmd.x+dx,cmd.y+dy):cmd.type===bezier.CURVETO?p.curveTo(cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x+dx,cmd.y+dy):cmd.type===bezier.CLOSE&&p.close()}return p}if(shape.shapes){var wShapes=[];for(wShapes.length=shape.shapes.length,i=0;i<shape.shapes.length;i+=1)wShapes[i]=vg._wigglePoints(shape.shapes[i],offset,rand);return new Group(wShapes)}if(Array.isArray(shape)&&shape.length>0&&void 0!==shape[0].x&&void 0!==shape[0].y){var wPoints=[];for(wPoints.length=shape.length,i=0;i<shape.length;i+=1)dx=(rand(0,1)-.5)*offset.x*2,dy=(rand(0,1)-.5)*offset.y*2,wPoints[i]=new Point(shape[i].x+dx,shape[i].y+dy);return wPoints}var w=[];for(w.length=shape.length,i=0;i<shape.length;i+=1)w[i]=vg._wigglePoints(shape[i],offset,rand);return w},vg.wigglePoints=function(shape,offset,seed){seed=void 0!==seed?seed:Math.random();var rand=random.generator(seed);return void 0===offset?offset={x:10,y:10}:"number"==typeof offset&&(offset={x:offset,y:offset}),vg._wigglePoints(shape,offset,rand)},vg._wiggleContours=function(shape,offset,rand){var i;if(shape.commands){var dx,dy,t,subPaths=shape.contours(),commands=[];for(i=0;i<subPaths.length;i+=1)dx=(rand(0,1)-.5)*offset.x*2,dy=(rand(0,1)-.5)*offset.y*2,t=(new Transform).translate(dx,dy),commands=commands.concat(t.transformShape(new Path(subPaths[i])).commands);return new Path(commands,shape.fill,shape.stroke,shape.strokeWidth)}if(shape.shapes){var wShapes=[];for(wShapes.length=shape.shapes.length,i=0;i<shape.shapes.length;i+=1)wShapes[i]=vg._wiggleContours(shape.shapes[i],offset,rand);return new Group(wShapes)}var w=[];for(w.length=shape.length,i=0;i<shape.length;i+=1)w[i]=vg._wiggleContours(shape[i],offset,rand);return w},vg.wiggleContours=function(shape,offset,seed){seed=void 0!==seed?seed:Math.random();var rand=random.generator(seed);return void 0===offset?offset={x:10,y:10}:"number"==typeof offset&&(offset={x:offset,y:offset}),vg._wiggleContours(shape,offset,rand)},vg._wigglePaths=function(shape,offset,rand){if(shape.commands)return shape;if(shape.shapes)return new Group(vg._wigglePaths(shape.shapes,offset,rand));if(Array.isArray(shape)){for(var subShape,dx,dy,t,newShapes=[],i=0;i<shape.length;i+=1)(subShape=shape[i]).commands?(dx=(rand(0,1)-.5)*offset.x*2,dy=(rand(0,1)-.5)*offset.y*2,t=(new Transform).translate(dx,dy),newShapes.push(t.transformShape(subShape))):subShape.shapes&&newShapes.push(vg._wigglePaths(subShape,offset,rand));return newShapes}},vg.wigglePaths=function(shape,offset,seed){seed=void 0!==seed?seed:Math.random();var rand=random.generator(seed);return void 0===offset?offset={x:10,y:10}:"number"==typeof offset&&(offset={x:offset,y:offset}),vg._wigglePaths(shape,offset,rand)},vg.scatterPoints=function(shape,amount,seed){if(shape){seed=void 0!==seed?seed:Math.random();var i,j,contourPath,nrKeypoints,tries,inContourCount,x,y,rand=random.generator(seed),bounds=shape.bounds(),bx=bounds.x,by=bounds.y,bw=bounds.width,bh=bounds.height,contours=shape.contours(),paths=[],points=[],POINTS_PER_SEGMENT=5;for(i=0;i<contours.length;i++)nrKeypoints=(contourPath=new Path(contours[i])).commands.length,paths.push(contourPath.points(5*nrKeypoints,{closed:!0}));for(i=0;i<amount;i+=1)for(tries=100;tries>0;){for(inContourCount=0,x=bx+rand(0,1)*bw,y=by+rand(0,1)*bh,j=0;j<paths.length;j++)geo.pointInPolygon(paths[j],x,y)&&(inContourCount+=1);if(inContourCount%2){points.push(new Point(x,y));break}tries-=1}return points}},vg.connectPoints=function(points,closed){if(points){for(var pt,p=new Path,i=0;i<points.length;i+=1)pt=points[i],0===i?p.moveTo(pt.x,pt.y):p.lineTo(pt.x,pt.y);return closed&&p.close(),p.fill=null,p.stroke=Color.BLACK,p}},vg.align=function(shape,position,hAlign,vAlign){if(shape){var dx,dy,t,x=position.x,y=position.y,bounds=vg.bounds(shape);return dx="left"===hAlign?x-bounds.x:"right"===hAlign?x-bounds.x-bounds.width:"center"===hAlign?x-bounds.x-bounds.width/2:0,dy="top"===vAlign?y-bounds.y:"bottom"===vAlign?y-bounds.y-bounds.height:"middle"===vAlign?y-bounds.y-bounds.height/2:0,(t=(new Transform).translate(dx,dy)).transformShape(shape)}},vg.snap=function(shape,distance,strength,center){if(shape){var i,x,y;if(strength=void 0!==strength?strength:1,center=center||Point.ZERO,shape.commands){var p=new Path([],shape.fill,shape.stroke,shape.strokeWidth),cmd,x1,y1,x2,y2;for(i=0;i<shape.commands.length;i+=1)if((cmd=shape.commands[i]).type===bezier.MOVETO||cmd.type===bezier.LINETO||cmd.type===bezier.CURVETO)x=math.snap(cmd.x+center.x,distance,strength)-center.x,y=math.snap(cmd.y+center.y,distance,strength)-center.y,cmd.type===bezier.MOVETO?p.moveTo(x,y):cmd.type===bezier.LINETO?p.lineTo(x,y):cmd.type===bezier.CURVETO&&(x1=math.snap(cmd.x1+center.x,distance,strength)-center.x,y1=math.snap(cmd.y1+center.y,distance,strength)-center.y,x2=math.snap(cmd.x2+center.x,distance,strength)-center.x,y2=math.snap(cmd.y2+center.y,distance,strength)-center.y,p.curveTo(x1,y1,x2,y2,x,y));else{if(cmd.type!==bezier.CLOSE)throw new Error("Invalid path command "+cmd);p.close()}return p}if(shape.shapes){var sShapes=[];for(sShapes.length=shape.shapes.length,i=0;i<shape.shapes.length;i+=1)sShapes[i]=vg.snap(shape.shapes[i],distance,strength,center);return new Group(sShapes)}if(Array.isArray(shape)&&shape.length>0&&void 0!==shape[0].x&&void 0!==shape[0].y){var point,sPoints=[];for(sPoints.length=shape.length,i=0;i<shape.length;i+=1)point=shape[i],x=math.snap(point.x+center.x,distance,strength)-center.x,y=math.snap(point.y+center.y,distance,strength)-center.y,sPoints[i]=new Point(x,y);return sPoints}var s=[];for(s.length=shape.length,i=0;i<shape.length;i+=1)s[i]=vg.snap(shape[i],distance,strength,center);return s}},vg.deletePoints=function(shape,bounding,invert){var i,cmd,commands=[],pt,points=[];if(shape.commands){var newCurve=!0;for(i=0;i<shape.commands.length;i+=1)(void 0===(cmd=_cloneCommand(shape.commands[i])).x||invert&&bounding.contains(cmd.x,cmd.y)||!invert&&!bounding.contains(cmd.x,cmd.y))&&(newCurve&&cmd.type!==bezier.MOVETO&&(cmd.type=bezier.MOVETO),commands.push(cmd),cmd.type===bezier.MOVETO?newCurve=!1:cmd.type===bezier.CLOSE&&(newCurve=!0));return new Path(commands,shape.fill,shape.stroke,shape.strokeWidth)}if(shape.shapes){var dShapes=[];for(dShapes.length=shape.shapes.length,i=0;i<shape.shapes.length;i+=1)dShapes[i]=vg.deletePoints(shape.shapes[i],bounding,invert);return new Group(dShapes)}if(Array.isArray(shape)&&shape.length>0&&void 0!==shape[0].x&&void 0!==shape[0].y){for(i=0;i<shape.length;i+=1)pt=shape[i],(invert&&bounding.contains(pt.x,pt.y)||!invert&&!bounding.contains(pt.x,pt.y))&&points.push(_cloneCommand(pt));return points}var d=[];for(d.length=shape.length,i=0;i<shape.length;i+=1)d[i]=vg.deletePoints(shape[i],bounding,invert);return d},vg.deletePaths=function(shape,bounding,invert){if(shape.commands)return null;if(shape.shapes)return new Group(vg.deletePaths(shape.shapes,bounding,invert));if(Array.isArray(shape)){for(var j,s,selected,cmd,subShapes,newShapes=[],shapes=shape,i=0;i<shapes.length;i+=1)if((s=shapes[i]).commands){for(selected=!1,j=0;j<s.commands.length;j+=1)if(void 0!==(cmd=s.commands[j]).x&&bounding.contains(cmd.x,cmd.y)){selected=!0;break}invert&&!selected||selected&&!invert||newShapes.push(s)}else s.shapes&&0!==(subShapes=vg.deletePaths(s,bounding,invert)).length&&newShapes.push(subShapes);return newShapes}},vg.delete=function(shape,bounding,scope,invert){if(null===shape||null===bounding)return null;if("points"===scope)return vg.deletePoints(shape,bounding,invert);if("paths"===scope)return vg.deletePaths(shape,bounding,invert);throw new Error("Invalid scope.")},vg.pointOnPath=function(shape,t){if(shape){shape.shapes&&(shape=new Path(vg.combinePaths(shape))),(t%=1)<0&&(t=1+t);var pt=shape.point(t);return new Point(pt.x,pt.y)}},vg._x=function(shape){return void 0!==shape.x?shape.x:shape.bounds().x},vg._y=function(shape){return void 0!==shape.y?shape.y:shape.bounds().y},vg._angleToPoint=function(point){return function(shape){if(void 0!==shape.x&&void 0!==shape.y)return geo.angle(shape.x,shape.y,point.x,point.y);var centerPoint=shape.bounds().centerPoint();return geo.angle(centerPoint.x,centerPoint.y,point.x,point.y)}},vg._distanceToPoint=function(point){return function(shape){if(void 0!==shape.x&&void 0!==shape.y)return geo.distance(shape.x,shape.y,point.x,point.y);var centerPoint=shape.bounds().centerPoint();return geo.distance(centerPoint.x,centerPoint.y,point.x,point.y)}},vg.shapeSort=function(shapes,method,origin){if(shapes){origin=origin||Point.ZERO;var methods={x:vg._x,y:vg._y,angle:vg._angleToPoint(origin),distance:vg._distanceToPoint(origin)};if(void 0===(method=methods[method]))return shapes;var newShapes=shapes.slice(0);return newShapes.sort((function(a,b){var _a=method(a),_b=method(b);return _a<_b?-1:_a>_b?1:0})),newShapes}},vg.group=function(){return new Group(flatten(arguments))},vg.ungroup=function(shape){if(shape){if(shape.shapes){var i,s,shapes=[];for(i=0;i<shape.shapes.length;i+=1)(s=shape.shapes[i]).commands?shapes.push(s):s.shapes&&(shapes=shapes.concat(vg.ungroup(s)));return shapes}return shape.commands?[shape]:[]}return[]},vg.centerPoint=function(shape){if(!shape)return Point.ZERO;var r=vg.bounds(shape);return new Point(r.x+r.width/2,r.y+r.height/2)},vg.link=function(shape1,shape2,orientation){if(shape1&&shape2){var p=new Path,a=shape1.bounds(),b=shape2.bounds();if(orientation===vg.HORIZONTAL){var hw=(b.x-(a.x+a.width))/2;p.moveTo(a.x+a.width,a.y),p.curveTo(a.x+a.width+hw,a.y,b.x-hw,b.y,b.x,b.y),p.lineTo(b.x,b.y+b.height),p.curveTo(b.x-hw,b.y+b.height,a.x+a.width+hw,a.y+a.height,a.x+a.width,a.y+a.height),p.close()}else{var hh=(b.y-(a.y+a.height))/2;p.moveTo(a.x,a.y+a.height),p.curveTo(a.x,a.y+a.height+hh,b.x,b.y-hh,b.x,b.y),p.lineTo(b.x+b.width,b.y),p.curveTo(b.x+b.width,b.y-hh,a.x+a.width,a.y+a.height+hh,a.x+a.width,a.y+a.height),p.close()}return p}};var compoundMethods={union:ClipperLib.ClipType.ctUnion,difference:ClipperLib.ClipType.ctDifference,intersection:ClipperLib.ClipType.ctIntersection,xor:ClipperLib.ClipType.ctXor};vg._compoundToPoints=function(shape){var l1=[],i,l,s,j,pt;for(i=0;i<shape.length;i+=1){for(l=[],s=shape[i],j=0;j<s.length;j+=1)(pt=s[j]).type!==bezier.CLOSE&&l.push({X:pt.x,Y:pt.y});l1.push(l)}return l1},vg.compound=function(shape1,shape2,method){shape1.commands||(shape1=Path.combine(shape1)),shape2.commands||(shape2=Path.combine(shape2));var contours1=shape1.resampleByLength(1).contours(),contours2=shape2.resampleByLength(1).contours(),subjPaths=vg._compoundToPoints(contours1),clipPaths=vg._compoundToPoints(contours2),scale=100;ClipperLib.JS.ScaleUpPaths(subjPaths,100),ClipperLib.JS.ScaleUpPaths(clipPaths,100);var cpr=new ClipperLib.Clipper;cpr.AddPaths(subjPaths,ClipperLib.PolyType.ptSubject,shape1.isClosed()),cpr.AddPaths(clipPaths,ClipperLib.PolyType.ptClip,shape2.isClosed());var solutionPaths=new ClipperLib.Paths;cpr.Execute(compoundMethods[method],solutionPaths,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero),solutionPaths=ClipperLib.JS.Clean(solutionPaths,10),ClipperLib.JS.ScaleDownPaths(solutionPaths,100);var path=new Path,i,j,s;for(i=0;i<solutionPaths.length;i+=1){for(s=solutionPaths[i],j=0;j<s.length;j+=1)0===j?path.moveTo(s[j].X,s[j].Y):path.lineTo(s[j].X,s[j].Y);s[0].X===s[s.length-1].X&&s[0].Y===s[s.length-1].Y||path.closePath()}return path},module.exports=vg},{"../../../../third_party/clipper":50,"../objects/color":32,"../objects/group":33,"../objects/path":35,"../objects/point":36,"../objects/rect":37,"../objects/transform":39,"../objects/transformable":40,"../util/bezier":42,"../util/geo":44,"../util/math":46,"../util/random":47,"lodash.flatten":3}],31:[function(require,module,exports){"use strict";var geo=require("../util/geo"),Color=require("../objects/color"),Path=require("../objects/path"),Point=require("../objects/point"),gText=require("../objects/text"),vg={roundedRect:function(cx,cy,width,height,rx,ry){var p=new Path;return p.addRoundedRect(cx,cy,width,height,rx,ry),p},quad:function(pt1,pt2,pt3,pt4){var args=arguments,p=new Path;return 8===args.length?Path.prototype.addQuad.apply(p,args):(pt1=Point.read(pt1),pt2=Point.read(pt2),pt3=Point.read(pt3),pt4=Point.read(pt4),p.addQuad(pt1.x,pt1.y,pt2.x,pt2.y,pt3.x,pt3.y,pt4.x,pt4.y)),p},rect:function(position,width,height,roundness){var args=arguments;if(3===args.length?position=Point.read(position):4===args.length?"number"==typeof args[0]&&"number"==typeof args[1]?(position=Point.read(args[0],args[1]),width=args[2],height=args[3],roundness=null):(position=Point.read(position),roundness=Point.read(roundness)):5!==args.length&&6!==args.length||(position=Point.read(args[0],args[1]),width=args[2],height=args[3],roundness=5===args.length&&"number"==typeof args[4]?Point.read(args[4],args[4]):Point.read(args[4],args[5])),!roundness||0===roundness.x&&0===roundness.y){var p=new Path;return p.addRect(position.x-width/2,position.y-height/2,width,height),p}return vg.roundedRect(position.x-width/2,position.y-height/2,width,height,roundness.x,roundness.y)},ellipse:function(position,width,height){var args=arguments;4===args.length?(position=Point.read(args[0],args[1]),width=args[2],height=args[3]):position=Point.read(position);var p=new Path;return p.addEllipse(position.x-width/2,position.y-height/2,width,height),p},line:function(point1,point2){var args=arguments;4===args.length?(point1=Point.read(args[0],args[1]),point2=Point.read(args[2],args[3])):(point1=Point.read(point1),point2=Point.read(point2));var line=new Path;return line.addLine(point1.x,point1.y,point2.x,point2.y),line.fill=null,line.stroke="black",line},lineAngle:function(point,angle,distance){var args=arguments;4===args.length?(point=Point.read(args[0],args[1]),distance=args[2],angle=args[3]):point=Point.read(point);var point2=geo.coordinates(point.x,point.y,angle,distance);return vg.line(point,point2)},arc:function(position,width,height,startAngle,degrees,arcType){var args=arguments;7===args.length?(position=Point.read(args[0],args[1]),width=args[2],height=args[3],startAngle=args[4],degrees=args[5],arcType=args[6]):position=Point.read(position);var p=new Path;return p.addArc(position.x,position.y,width,height,startAngle,degrees,arcType),p},curve:function(pt1,pt2,t,distance){var args=arguments;6===args.length?(pt1=Point.read(args[0],args[1]),pt2=Point.read(args[2],args[3]),t=args[4],distance=args[5]):(pt1=Point.read(pt1),pt2=Point.read(pt2));var cx=pt1.x+t*(pt2.x-pt1.x),cy=pt1.y+t*(pt2.y-pt1.y),a=geo.angle(pt1.x,pt1.y,pt2.x,pt2.y)+90,q=geo.coordinates(cx,cy,a,distance),qx=q.x,qy=q.y,c1x=pt1.x+2/3*(qx-pt1.x),c1y=pt1.y+2/3*(qy-pt1.y),c2x=pt2.x+2/3*(qx-pt2.x),c2y=pt2.y+2/3*(qy-pt2.y),p=new Path;return p.moveTo(pt1.x,pt1.y),p.curveTo(c1x,c1y,c2x,c2y,pt2.x,pt2.y),p.fill=null,p.stroke=Color.BLACK,p},polygon:function(position,radius,sides,align){var args=arguments;5===args.length||4===args.length&&"number"==typeof args[0]&&"number"==typeof args[1]?(position=Point.read(args[0],args[1]),radius=args[2],sides=args[3],align=5!==args.length||args[4]):(position=Point.read(position),3===args.length&&(align=!0)),sides=Math.max(sides,3);var c0,c1,i,c,x=position.x,y=position.y,r=radius,a=360/sides,da=0;!0===align&&(c0=geo.coordinates(x,y,0,r),c1=geo.coordinates(x,y,a,r),da=-geo.angle(c1.x,c1.y,c0.x,c0.y));var p=new Path;for(i=0;i<sides;i+=1)c=geo.coordinates(x,y,a*i+da,r),0===i?p.moveTo(c.x,c.y):p.lineTo(c.x,c.y);return p.close(),p},star:function(position,points,outer,inner){var args=arguments,i,angle,radius,x,y;5===args.length||4===args.length&&"number"==typeof args[0]&&"number"==typeof args[1]?(position=Point.read(args[0],args[1]),points=args[2],outer=args[3],inner=args[4]):position=Point.read(position),inner||(inner=outer);var p=new Path;for(p.moveTo(position.x,position.y+outer/2),i=1;i<2*points;i+=1)angle=i*Math.PI/points,radius=i%2==1?inner/2:outer/2,x=position.x+radius*Math.sin(angle),y=position.y+radius*Math.cos(angle),p.lineTo(x,y);return p.close(),p}},nonEmpty=function(s){return""!==s},stripCommas=function(c){return c.replace(/,/g," ")};vg.freehand=function(pathString){var i,j,x,y,values,contours=[],elems=pathString.split("M");for(i=0;i<elems.length;i+=1)nonEmpty(elems[i])&&contours.push(stripCommas(elems[i]));var p=new Path;for(j=0;j<contours.length;j+=1){for(values=[],elems=contours[j].split(" "),i=0;i<elems.length;i+=1)nonEmpty(elems[i])&&values.push(elems[i]);for(i=0;i<values.length;i+=2)void 0!==values[i+1]&&(x=parseFloat(values[i]),y=parseFloat(values[i+1]),0===i?p.moveTo(x,y):p.lineTo(x,y))}return p.fill=null,p.stroke=Color.BLACK,p},vg.grid=function(columns,rows,columnWidth,rowHeight,position){var gridWidth,left,gridHeight,top,rowIndex,colIndex,x,y,i,points=[];for(points.length=columns*rows,position=void 0!==position?position:Point.ZERO,columns>1?(gridWidth=columnWidth*(columns-1),left=position.x-gridWidth/2):left=position.x,rows>1?(gridHeight=rowHeight*(rows-1),top=position.y-gridHeight/2):top=position.y,i=0,rowIndex=0;rowIndex<rows;rowIndex+=1)for(colIndex=0;colIndex<columns;colIndex+=1)x=left+colIndex*columnWidth,y=top+rowIndex*rowHeight,points[i]=new Point(x,y),i+=1;return points},vg.text=function(){var t=Object.create(gText.prototype);return t.constructor=gText.prototype,gText.apply(t,arguments),t},vg.demoRect=function(){return new vg.rect({x:0,y:0},100,100,{x:0,y:0})},vg.demoEllipse=function(){return new vg.ellipse({x:0,y:0},100,100)},module.exports=vg},{"../objects/color":32,"../objects/path":35,"../objects/point":36,"../objects/text":38,"../util/geo":44}],32:[function(require,module,exports){"use strict";var math=require("../util/math"),color=require("../util/color"),js=require("../util/js"),HSB="HSB",HSL="HSL",HEX="HEX",Color=function(v1,v2,v3,v4,v5){var _r,_g,_b,_a,rgb,options;void 0===v1?(_r=_g=_b=0,_a=1):Array.isArray(v1)?(options=v2||{},_r=void 0!==v1[0]?v1[0]:0,_g=void 0!==v1[1]?v1[1]:0,_b=void 0!==v1[2]?v1[2]:0,_a=void 0!==v1[3]?v1[3]:options.range||1):void 0!==v1.r?(options=v2||{},_r=v1.r,_g=v1.g,_b=v1.b,_a=void 0!==v1.a?v1.a:options.range||1):"string"==typeof v1?(_r=(rgb=color.hex2rgb(v1))[0],_g=rgb[1],_b=rgb[2],_a=1):"number"==typeof v1&&(1===arguments.length?(_r=_g=_b=v1,_a=1):2===arguments.length?(_r=_g=_b=v1,_a="number"==typeof v2?v2:(options=v2).range||1):3===arguments.length?"number"==typeof v3?(_r=v1,_g=v2,_b=v3,_a=1):(_r=_g=_b=v1,_a=v2,options=v3):4===arguments.length?(_r=v1,_g=v2,_b=v3,_a="number"==typeof v4?v4:(options=v4).range||1):(_r=v1,_g=v2,_b=v3,_a=v4,options=v5)),void 0!==(options=options||{}).range&&(_r/=options.range,_g/=options.range,_b/=options.range,_a/=options.range,options.mode===HSB&&(v1/=options.range,v2/=options.range,v3/=options.range)),options.mode===HSB?(v1=math.clamp(v1,0,1),v2=math.clamp(v2,0,1),v3=math.clamp(v3,0,1),_r=(rgb=color.hsb2rgb(v1,v2,v3))[0],_g=rgb[1],_b=rgb[2]):options.mode===HSL?(v1=math.clamp(v1,0,1),v2=math.clamp(v2,0,1),v3=math.clamp(v3,0,1),_r=(rgb=color.hsl2rgb(v1,v2,v3))[0],_g=rgb[1],_b=rgb[2]):options.mode===HEX&&(_r=(rgb=color.hex2rgb(v1))[0],_g=rgb[1],_b=rgb[2],_a=1),this.r=math.clamp(_r,0,1),this.g=math.clamp(_g,0,1),this.b=math.clamp(_b,0,1),this.a=math.clamp(_a,0,1)};Color.BLACK=new Color(0),Color.WHITE=new Color(1),js.defineAlias(Color,"r","red"),js.defineAlias(Color,"g","green"),js.defineAlias(Color,"b","blue"),js.defineAlias(Color,"a","alpha"),js.defineGetter(Color,"h",(function(){return color.rgb2hsl(this.r,this.g,this.b)[0]})),js.defineGetter(Color,"s",(function(){return color.rgb2hsl(this.r,this.g,this.b)[1]})),js.defineGetter(Color,"l",(function(){return color.rgb2hsl(this.r,this.g,this.b)[2]})),js.defineAlias(Color,"h","hue"),js.defineAlias(Color,"s","saturation"),js.defineAlias(Color,"l","lightness"),js.defineGetter(Color,"rgb",(function(){return[this.r,this.g,this.b]})),js.defineGetter(Color,"rgba",(function(){return[this.r,this.g,this.b,this.a]})),js.defineGetter(Color,"hsb",(function(){return color.rgb2hsb(this.r,this.g,this.b)})),js.defineGetter(Color,"hsba",(function(){return color.rgb2hsb(this.r,this.g,this.b).concat([this.a])})),js.defineGetter(Color,"hsl",(function(){return color.rgb2hsl(this.r,this.g,this.b)})),js.defineGetter(Color,"hsla",(function(){return color.rgb2hsl(this.r,this.g,this.b).concat([this.a])})),Color.prototype.toCSS=function(){return Color.toCSS(this)},Color.prototype.toHex=function(){return this.a>=1?color.rgb2hex(this.r,this.g,this.b):color.rgba2hex(this.r,this.g,this.b,this.a)},Color.prototype.desaturate=function(options){if(this.r===this.g&&this.g===this.b)return this;var rCoeff,gCoeff,bCoeff;void 0!==options&&options.method&&"ITU-R BT.601"!==options.method?"ITU-R BT.709"===options.method&&(rCoeff=.2125,gCoeff=.7154,bCoeff=.0721):(rCoeff=.3,gCoeff=.59,bCoeff=.11);var gray=this.r*rCoeff+this.g*gCoeff+this.b*bCoeff;return new Color(gray,gray,gray,this.a)},Color.prototype.invert=function(){return new Color(1-this.r,1-this.g,1-this.b,this.a)},Color.clone=function(c){return null==c?null:"string"==typeof c?c:new Color(c.r,c.g,c.b,c.a)},Color.toCSS=function(c){if(null===c)return"none";if(void 0===c)return"black";if("string"==typeof c)return c;var r255,g255,b255;if(c instanceof Color)return"rgba("+Math.round(255*c.r)+", "+Math.round(255*c.g)+", "+Math.round(255*c.b)+", "+c.a+")";if(void 0!==c.r&&void 0!==c.g&&void 0!==c.b)return void 0===c.a?"rgb("+c.r+", "+c.g+", "+c.b+")":"rgba("+c.r+", "+c.g+", "+c.b+", "+c.a+")";throw new Error("Don't know how to convert "+c+" to CSS.")},Color.toHex=function(c){return Color.parse(c).toHex()},Color.make=function(){var c=Object.create(Color.prototype);return c.constructor=Color.prototype,Color.apply(c,arguments),c},Color.parse=function(s){function startsWith(s,value){return!(!s||!value)&&0===(s=String(s)).indexOf(value)}var m;if(null==s)return new Color(0,0,0,0);if(s instanceof Color)return s;if(color.namedColors[s])return Color.make.apply(null,color.namedColors[s]);if("#"===s[0])return new Color(s,0,0,0,{mode:HEX});if(startsWith(s,"rgba"))return(m=s.match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+|\d+.\d+)\s*\)$/i))?new Color(parseInt(m[1])/255,parseInt(m[2])/255,parseInt(m[3])/255,parseFloat(m[4])):(m=s.match(/^rgba\s*\(\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)\s*\)$/i))?new Color(parseFloat(m[1])/100,parseFloat(m[2])/100,parseFloat(m[3])/100,parseFloat(m[4])):new Color(0,0,0,0);if(startsWith(s,"rgb"))return(m=s.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i))?new Color(parseInt(m[1])/255,parseInt(m[2])/255,parseInt(m[3])/255):(m=s.match(/^rgb\s*\(\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*\)$/i))?new Color(parseFloat(m[1])/100,parseFloat(m[2])/100,parseFloat(m[3])/100):new Color(0,0,0,0);if(startsWith(s,"hsla"))return(m=s.match(/^hsla\s*\(\s*(\d+|\d+.\d+)\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)\s*\)$/i))?new Color(parseFloat(m[1])/360,parseFloat(m[2])/100,parseFloat(m[3])/100,parseFloat(m[4])):new Color(0,0,0,0);if(startsWith(s,"hsl"))return(m=s.match(/^hsl\s*\(\s*(\d+|\d+.\d+)\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*\)$/i))?new Color(parseFloat(m[1])/360,parseFloat(m[2])/100,parseFloat(m[3])/100):new Color(0,0,0,0);if("none"===s||"null"===s||startsWith(s,"url("))return new Color(0,0,0,0);throw new Error("Color "+s+"can not be parsed")},Color.gray=function(gray,alpha,range){return range=Math.max(range,1),new Color(gray/range,gray/range,gray/range,alpha/range)},Color.rgb=function(red,green,blue,alpha,range){return range=Math.max(range,1),new Color(red/range,green/range,blue/range,alpha/range)},Color.hsb=function(hue,saturation,brightness,alpha,range){return range=Math.max(range,1),new Color(hue/range,saturation/range,brightness/range,alpha/range,{mode:HSB})},Color.hsl=function(hue,saturation,lightness,alpha,range){return range=Math.max(range,1),new Color(hue/range,saturation/range,lightness/range,alpha/range,{mode:HSL})},module.exports=Color},{"../util/color":43,"../util/js":45,"../util/math":46}],33:[function(require,module,exports){"use strict";var Path=require("../objects/path"),Rect=require("../objects/rect"),Color=require("../objects/color"),Group=function(shapes){shapes?shapes.shapes||shapes.commands?this.shapes=[shapes]:shapes&&(this.shapes=shapes):this.shapes=[]};Group.prototype.add=function(shape){this.shapes.push(shape)},Group.prototype.clone=function(){var newShapes=[],n=this.shapes.length,i;for(newShapes.length=n,i=0;i<n;i+=1)newShapes[i]=this.shapes[i].clone();return new Group(newShapes)},Group.prototype.colorize=function(options){var args=arguments;("object"!=typeof options||options instanceof Color)&&(options={},void 0!==args[0]&&(options.fill=args[0]),void 0!==args[1]&&(options.stroke=args[1]),void 0!==args[2]&&(options.strokeWidth=args[2]));var shapes=[];shapes.length=this.shapes.length;for(var i=0;i<this.shapes.length;i+=1)shapes[i]=this.shapes[i].colorize(options);return new Group(shapes)},Group.prototype.desaturate=function(options){var shapes=[];shapes.length=this.shapes.length;for(var i=0;i<this.shapes.length;i+=1)shapes[i]=this.shapes[i].desaturate(options);return new Group(shapes)},Group.prototype.invert=function(){var shapes=[];shapes.length=this.shapes.length;for(var i=0;i<this.shapes.length;i+=1)shapes[i]=this.shapes[i].invert();return new Group(shapes)},Group.prototype.bounds=function(){if(0===this.shapes.length)return new Rect(0,0,0,0);var i,r,shape,shapes=this.shapes;for(i=0;i<shapes.length;i+=1)shape=shapes[i],void 0===r&&(r=shape.bounds()),(shape.shapes&&0!==shape.shapes.length||shape.commands&&0!==shape.commands.length)&&(r=r.unite(shape.bounds()));return void 0!==r?r:new Rect(0,0,0,0)},Group.prototype.contains=function(x,y,precision){void 0===precision&&(precision=100);var i,shapes=this.shapes;for(i=0;i<shapes.length;i+=1)if(shapes[i].contains(x,y,precision))return!0;return!1},Group.prototype.length=function(precision){void 0===precision&&(precision=10);for(var sum=0,shapes=this.shapes,i=0;i<shapes.length;i+=1)sum+=shapes[i].length(precision);return sum},Group.prototype.resampleByAmount=function(points,perContour){var path;if(!perContour)return(path=new Path.combine(this)).resampleByAmount(points,perContour);var shapes=[];shapes.length=this.shapes.length;for(var i=0;i<this.shapes.length;i+=1)shapes[i]=this.shapes[i].resampleByAmount(points,perContour);return new Group(shapes)},Group.prototype.resampleByLength=function(length){var shapes=[];shapes.length=this.shapes.length;for(var i=0;i<this.shapes.length;i+=1)shapes[i]=this.shapes[i].resampleByLength(length);return new Group(shapes)},Group.prototype.toSVG=function(){var l=[];l.length=this.shapes.length;for(var i=0;i<this.shapes.length;i+=1)l[i]=this.shapes[i].toSVG();return"<g>"+l.join("")+"</g>"},Group.prototype.draw=function(ctx){var i,shapes=this.shapes,nShapes=shapes.length;for(i=0;i<nShapes;i+=1)shapes[i].draw(ctx)},module.exports=Group},{"../objects/color":32,"../objects/path":35,"../objects/rect":37}],34:[function(require,module,exports){"use strict";var Vec3=require("../objects/vec3"),Matrix4=function(m){void 0!==m?this.m=m:((m=new Float32Array(16))[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,this.m=m)};Matrix4.IDENTITY=new Matrix4,Matrix4.perspective=function(fov,aspect,zNear,zFar){var m=new Float32Array(Matrix4.IDENTITY.m),tan=1/Math.tan(.5*fov);return m[0]=tan/aspect,m[1]=m[2]=m[3]=0,m[5]=tan,m[4]=m[6]=m[7]=0,m[8]=m[9]=0,m[10]=-zFar/(zNear-zFar),m[11]=1,m[12]=m[13]=m[15]=0,m[14]=zNear*zFar/(zNear-zFar),new Matrix4(m)},Matrix4.lookAt=function(eye,target,up){var m,zAxis,xAxis,yAxis,ex,ey,ez;return m=new Float32Array(16),zAxis=target.subtract(eye).normalize(),xAxis=Vec3.cross(up,zAxis).normalize(),yAxis=Vec3.cross(zAxis,xAxis).normalize(),ex=-Vec3.dot(xAxis,eye),ey=-Vec3.dot(yAxis,eye),ez=-Vec3.dot(zAxis,eye),m[0]=xAxis.x,m[1]=yAxis.x,m[2]=zAxis.x,m[3]=0,m[4]=xAxis.y,m[5]=yAxis.y,m[6]=zAxis.y,m[7]=0,m[8]=xAxis.z,m[9]=yAxis.z,m[10]=zAxis.z,m[11]=0,m[12]=ex,m[13]=ey,m[14]=ez,m[15]=1,new Matrix4(m)},Matrix4.prototype.invert=function(){var l1,l2,l3,l4,l5,l6,l7,l8,l9,l10,l11,l12,l13,l14,l15,l16,l17,l18,l19,l20,l21,l22,l23,l24,l25,l26,l27,l28,l29,l30,l31,l32,l33,l34,l35,l36,l37,l38,l39,m;return l1=this.m[0],l2=this.m[1],l3=this.m[2],l4=this.m[3],l5=this.m[4],l6=this.m[5],l7=this.m[6],l8=this.m[7],l9=this.m[8],l10=this.m[9],l11=this.m[10],l12=this.m[11],l13=this.m[12],l14=this.m[13],l15=this.m[14],l27=1/(l1*(l23=l6*(l17=l11*(l16=this.m[15])-l12*l15)-l7*(l18=l10*l16-l12*l14)+l8*(l19=l10*l15-l11*l14))+l2*(l24=-(l5*l17-l7*(l20=l9*l16-l12*l13)+l8*(l21=l9*l15-l11*l13)))+l3*(l25=l5*l18-l6*l20+l8*(l22=l9*l14-l10*l13))+l4*(l26=-(l5*l19-l6*l21+l7*l22))),l28=l7*l16-l8*l15,l29=l6*l16-l8*l14,l30=l6*l15-l7*l14,l31=l5*l16-l8*l13,l32=l5*l15-l7*l13,l33=l5*l14-l6*l13,l34=l7*l12-l8*l11,l35=l6*l12-l8*l10,l36=l6*l11-l7*l10,l37=l5*l12-l8*l9,l38=l5*l11-l7*l9,l39=l5*l10-l6*l9,(m=new Float32Array(16))[0]=l23*l27,m[4]=l24*l27,m[8]=l25*l27,m[12]=l26*l27,m[1]=-(l2*l17-l3*l18+l4*l19)*l27,m[5]=(l1*l17-l3*l20+l4*l21)*l27,m[9]=-(l1*l18-l2*l20+l4*l22)*l27,m[13]=(l1*l19-l2*l21+l3*l22)*l27,m[2]=(l2*l28-l3*l29+l4*l30)*l27,m[6]=-(l1*l28-l3*l31+l4*l32)*l27,m[10]=(l1*l29-l2*l31+l4*l33)*l27,m[14]=-(l1*l30-l2*l32+l3*l33)*l27,m[3]=-(l2*l34-l3*l35+l4*l36)*l27,m[7]=(l1*l34-l3*l37+l4*l38)*l27,m[11]=-(l1*l35-l2*l37+l4*l39)*l27,m[15]=(l1*l36-l2*l38+l3*l39)*l27,new Matrix4(m)},Matrix4.prototype.multiply=function(other){var m=new Float32Array(16);return m[0]=this.m[0]*other.m[0]+this.m[1]*other.m[4]+this.m[2]*other.m[8]+this.m[3]*other.m[12],m[1]=this.m[0]*other.m[1]+this.m[1]*other.m[5]+this.m[2]*other.m[9]+this.m[3]*other.m[13],m[2]=this.m[0]*other.m[2]+this.m[1]*other.m[6]+this.m[2]*other.m[10]+this.m[3]*other.m[14],m[3]=this.m[0]*other.m[3]+this.m[1]*other.m[7]+this.m[2]*other.m[11]+this.m[3]*other.m[15],m[4]=this.m[4]*other.m[0]+this.m[5]*other.m[4]+this.m[6]*other.m[8]+this.m[7]*other.m[12],m[5]=this.m[4]*other.m[1]+this.m[5]*other.m[5]+this.m[6]*other.m[9]+this.m[7]*other.m[13],m[6]=this.m[4]*other.m[2]+this.m[5]*other.m[6]+this.m[6]*other.m[10]+this.m[7]*other.m[14],m[7]=this.m[4]*other.m[3]+this.m[5]*other.m[7]+this.m[6]*other.m[11]+this.m[7]*other.m[15],m[8]=this.m[8]*other.m[0]+this.m[9]*other.m[4]+this.m[10]*other.m[8]+this.m[11]*other.m[12],m[9]=this.m[8]*other.m[1]+this.m[9]*other.m[5]+this.m[10]*other.m[9]+this.m[11]*other.m[13],m[10]=this.m[8]*other.m[2]+this.m[9]*other.m[6]+this.m[10]*other.m[10]+this.m[11]*other.m[14],m[11]=this.m[8]*other.m[3]+this.m[9]*other.m[7]+this.m[10]*other.m[11]+this.m[11]*other.m[15],m[12]=this.m[12]*other.m[0]+this.m[13]*other.m[4]+this.m[14]*other.m[8]+this.m[15]*other.m[12],m[13]=this.m[12]*other.m[1]+this.m[13]*other.m[5]+this.m[14]*other.m[9]+this.m[15]*other.m[13],m[14]=this.m[12]*other.m[2]+this.m[13]*other.m[6]+this.m[14]*other.m[10]+this.m[15]*other.m[14],m[15]=this.m[12]*other.m[3]+this.m[13]*other.m[7]+this.m[14]*other.m[11]+this.m[15]*other.m[15],new Matrix4(m)},Matrix4.prototype.translate=function(tx,ty,tz){var m=new Float32Array(this.m);return m[12]+=tx,m[13]+=ty,m[14]+=tz,new Matrix4(m)},module.exports=Matrix4},{"../objects/vec3":41}],35:[function(require,module,exports){"use strict";var flatten=require("lodash.flatten"),bezier=require("../util/bezier"),geo=require("../util/geo"),math=require("../util/math"),Color=require("../objects/color"),Rect=require("../objects/rect"),MOVETO=bezier.MOVETO,LINETO=bezier.LINETO,QUADTO=bezier.QUADTO,CURVETO=bezier.CURVETO,CLOSE=bezier.CLOSE,CLOSE_COMMAND=Object.freeze({type:CLOSE}),KAPPA=.5522847498307936;function _cloneCommand(cmd){var newCmd={type:cmd.type};return newCmd.type!==CLOSE&&(newCmd.x=cmd.x,newCmd.y=cmd.y),newCmd.type===QUADTO?(newCmd.x1=cmd.x1,newCmd.y1=cmd.y1):newCmd.type===CURVETO&&(newCmd.x1=cmd.x1,newCmd.y1=cmd.y1,newCmd.x2=cmd.x2,newCmd.y2=cmd.y2),newCmd}var Path=function(commands,fill,stroke,strokeWidth){this.commands=void 0!==commands?commands:[],this.fill=void 0!==fill?fill:"black",this.stroke=void 0!==stroke?stroke:null,this.strokeWidth=void 0!==strokeWidth?strokeWidth:1};Path.prototype.clone=function(){var p=new Path,n=this.commands.length,i;for(p.commands.length=this.commands.length,i=0;i<n;i+=1)p.commands[i]=_cloneCommand(this.commands[i]);return p.fill=Color.clone(this.fill),p.stroke=Color.clone(this.stroke),p.strokeWidth=this.strokeWidth,p},Path.prototype.extend=function(commandsOrPath){var commands=commandsOrPath.commands||commandsOrPath;Array.prototype.push.apply(this.commands,commands)},Path.prototype.moveTo=function(x,y){this.commands.push({type:MOVETO,x:x,y:y})},Path.prototype.lineTo=function(x,y){this.commands.push({type:LINETO,x:x,y:y})},Path.prototype.curveTo=function(x1,y1,x2,y2,x,y){this.commands.push({type:CURVETO,x1:x1,y1:y1,x2:x2,y2:y2,x:x,y:y})},Path.prototype.quadTo=function(x1,y1,x,y){var prevX=this.commands[this.commands.length-1].x,prevY=this.commands[this.commands.length-1].y,cp1x=prevX+2/3*(x1-prevX),cp1y=prevY+2/3*(y1-prevY),cp2x=cp1x+1/3*(x-prevX),cp2y=cp1y+1/3*(y-prevY);this.curveTo(cp1x,cp1y,cp2x,cp2y,x,y)},Path.prototype.closePath=Path.prototype.close=function(){this.commands.push(CLOSE_COMMAND)},Path.prototype.isClosed=function(){return 0!==this.commands.length&&this.commands[this.commands.length-1].type===CLOSE},Path.prototype.addRect=function(x,y,width,height){this.moveTo(x,y),this.lineTo(x+width,y),this.lineTo(x+width,y+height),this.lineTo(x,y+height),this.close()},Path.prototype.addRoundedRect=function(cx,cy,width,height,rx,ry){var ONE_MINUS_QUARTER=1-.552,dx=rx,dy=ry,left=cx,right=cx+width,top=cy,bottom=cy+height;dx=Math.min(dx,.5*width),dy=Math.min(dy,.5*height),this.moveTo(left+dx,top),dx<.5*width&&this.lineTo(right-rx,top),this.curveTo(right-dx*(1-.552),top,right,top+dy*(1-.552),right,top+dy),dy<.5*height&&this.lineTo(right,bottom-dy),this.curveTo(right,bottom-dy*(1-.552),right-dx*(1-.552),bottom,right-dx,bottom),dx<.5*width&&this.lineTo(left+dx,bottom),this.curveTo(left+dx*(1-.552),bottom,left,bottom-dy*(1-.552),left,bottom-dy),dy<.5*height&&this.lineTo(left,top+dy),this.curveTo(left,top+dy*(1-.552),left+dx*(1-.552),top,left+dx,top),this.close()},Path.prototype.addEllipse=function(x,y,width,height){var dx=.5*KAPPA*width,dy=.5*KAPPA*height,x0=x+.5*width,y0=y+.5*height,x1=x+width,y1=y+height;this.moveTo(x,y0),this.curveTo(x,y0-dy,x0-dx,y,x0,y),this.curveTo(x0+dx,y,x1,y0-dy,x1,y0),this.curveTo(x1,y0+dy,x0+dx,y1,x0,y1),this.curveTo(x0-dx,y1,x,y0+dy,x,y0),this.close()},Path.prototype.addLine=function(x1,y1,x2,y2){this.moveTo(x1,y1),this.lineTo(x2,y2)},Path.prototype.addQuad=function(x1,y1,x2,y2,x3,y3,x4,y4){this.moveTo(x1,y1),this.lineTo(x2,y2),this.lineTo(x3,y3),this.lineTo(x4,y4),this.close()},Path.prototype.addArc=function(x,y,width,height,startAngle,degrees,arcType){var w,h,angStRad,ext,arcSegs,increment,cv,lineSegs,index,angle,relX,relY,coords;for(arcType=arcType||"pie",w=width/2,h=height/2,angStRad=math.radians(startAngle),(ext=degrees)>=360||ext<=-360?(arcSegs=4,increment=Math.PI/2,cv=.5522847498307933,ext<0&&(increment=-increment,cv=-cv)):(arcSegs=Math.ceil(Math.abs(ext)/90),increment=math.radians(ext/arcSegs),0==(cv=4/3*Math.sin(increment/2)/(1+Math.cos(increment/2)))&&(arcSegs=0)),"open"===arcType?lineSegs=0:"chord"===arcType?lineSegs=1:"pie"===arcType&&(lineSegs=2),(w<0||h<0)&&(arcSegs=lineSegs=-1),index=0;index<=arcSegs+lineSegs;)angle=angStRad,0===index?this.moveTo(x+Math.cos(angle)*w,y+Math.sin(angle)*h):index>arcSegs?index===arcSegs+lineSegs?this.close():this.lineTo(x,y):(angle+=increment*(index-1),relX=Math.cos(angle),relY=Math.sin(angle),(coords=[]).push(x+(relX-cv*relY)*w),coords.push(y+(relY+cv*relX)*h),angle+=increment,relX=Math.cos(angle),relY=Math.sin(angle),coords.push(x+(relX+cv*relY)*w),coords.push(y+(relY-cv*relX)*h),coords.push(x+relX*w),coords.push(y+relY*h),Path.prototype.curveTo.apply(this,coords)),index+=1},Path.prototype.colorize=function(options){var args=arguments;("object"!=typeof options||options instanceof Color)&&(options={},void 0!==args[0]&&(options.fill=args[0]),void 0!==args[1]&&(options.stroke=args[1]),void 0!==args[2]&&(options.strokeWidth=args[2]));var p=this.clone();return options.fill&&(p.fill=Color.clone(options.fill)),options.stroke&&(p.stroke=Color.clone(options.stroke)),(options.strokeWidth||0===options.strokeWidth)&&(p.strokeWidth=options.strokeWidth),p},Path.prototype.desaturate=function(options){var p=this.clone(),fill=p.fill,stroke=p.stroke;return fill instanceof Color||(fill=Color.parse(fill)),stroke instanceof Color||(stroke=Color.parse(stroke)),p.fill=fill.desaturate(options),p.stroke=stroke.desaturate(options),p},Path.prototype.invert=function(){var p=this.clone(),fill=p.fill,stroke=p.stroke;return fill instanceof Color||(fill=Color.parse(fill)),stroke instanceof Color||(stroke=Color.parse(stroke)),p.fill=fill.invert(),p.stroke=stroke.invert(),p},Path.prototype.contours=function(){for(var contours=[],currentContour=[],cmd,i=0;i<this.commands.length;i+=1)(cmd=this.commands[i]).type===MOVETO?(0!==currentContour.length&&contours.push(currentContour),currentContour=[cmd]):currentContour.push(cmd);return 0!==currentContour.length&&contours.push(currentContour),contours},Path.prototype.bounds=function(){if(this._bounds)return this._bounds;if(0===this.commands.length)return new Rect(0,0,0,0);for(var px,py,prev,right,bottom,minX=Number.MAX_VALUE,minY=Number.MAX_VALUE,maxX=-Number.MAX_VALUE,maxY=-Number.MAX_VALUE,cmd,i=0;i<this.commands.length;i+=1)if((cmd=this.commands[i]).type===MOVETO||cmd.type===LINETO)(px=cmd.x)<minX&&(minX=px),(py=cmd.y)<minY&&(minY=py),px>maxX&&(maxX=px),py>maxY&&(maxY=py),prev=cmd;else if(cmd.type===CURVETO){var r=bezier.extrema(prev.x,prev.y,cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y);right=r.x+r.width,bottom=r.y+r.height,r.x<minX&&(minX=r.x),right>maxX&&(maxX=right),r.y<minY&&(minY=r.y),bottom>maxY&&(maxY=bottom),prev=cmd}return new Rect(minX,minY,maxX-minX,maxY-minY)},Path.prototype.point=function(t,segmentLengths){return void 0===segmentLengths&&(segmentLengths=bezier.segmentLengths(this.commands,!0,10)),bezier.point(this,t,segmentLengths)},Path.prototype.points=function(amount,options){var start=options&&void 0!==options.start?options.start:0,end=options&&void 0!==options.end?options.end:1,d;if(0===this.commands.length)return[];amount=Math.round(amount),d=options&&options.closed?amount>1?(end-start)/amount:end-start:amount>1?(end-start)/(amount-1):end-start;for(var pts=[],segmentLengths=bezier.segmentLengths(this.commands,!0,10),i=0;i<amount;i+=1)pts.push(this.point(start+d*i,segmentLengths));return pts},Path.prototype.length=function(precision){return void 0===precision&&(precision=20),bezier.length(this,precision)},Path.prototype.contains=function(x,y,precision){var points=this.points(void 0!==precision?precision:100);return geo.pointInPolygon(points,x,y)},Path.prototype.resampleByAmount=function(points,perContour){for(var subPaths=perContour?this.contours():[this.commands],p=new Path([],this.fill,this.stroke,this.strokeWidth),j=0;j<subPaths.length;j+=1){var subPath=new Path(subPaths[j]),options={};subPath.isClosed()&&(options.closed=!0);for(var pts=subPath.points(points,options),i=0;i<pts.length;i+=1)0===i?p.moveTo(pts[i].x,pts[i].y):p.lineTo(pts[i].x,pts[i].y);subPath.isClosed()&&p.close()}return p},Path.prototype.resampleByLength=function(segmentLength,options){var force=(options=options||{}).force||!1,subPaths=this.contours(),commands=[];force||(segmentLength=Math.max(segmentLength,1));for(var i=0;i<subPaths.length;i+=1){var subPath=new Path(subPaths[i]),contourLength=subPath.length(),amount=Math.ceil(contourLength/segmentLength);commands=commands.concat(subPath.resampleByAmount(amount).commands)}return new Path(commands,this.fill,this.stroke,this.strokeWidth)},Path.prototype.toPathData=function(){var i,d,cmd,x,y,x1,y1,x2,y2;for(d="",i=0;i<this.commands.length;i+=1)void 0!==(cmd=this.commands[i]).x&&(x=math.clamp(cmd.x,-9999,9999),y=math.clamp(cmd.y,-9999,9999)),void 0!==cmd.x1&&(x1=math.clamp(cmd.x1,-9999,9999),y1=math.clamp(cmd.y1,-9999,9999)),void 0!==cmd.x2&&(x2=math.clamp(cmd.x2,-9999,9999),y2=math.clamp(cmd.y2,-9999,9999)),cmd.type===MOVETO?isNaN(x)||isNaN(y)||(d+="M"+x+" "+y):cmd.type===LINETO?isNaN(x)||isNaN(y)||(d+="L"+x+" "+y):cmd.type===QUADTO?isNaN(x)||isNaN(y)||isNaN(x1)||isNaN(y1)||(d+="Q"+x1+" "+y1+" "+x+" "+y):cmd.type===CURVETO?isNaN(x)||isNaN(y)||isNaN(x1)||isNaN(y1)||isNaN(x2)||isNaN(y2)||(d+="C"+x1+" "+y1+" "+x2+" "+y2+" "+x+" "+y):cmd.type===CLOSE&&(d+="Z");return d},Path.prototype.toSVG=function(){var svg='<path d="';svg+=this.toPathData(),svg+='"';var style="",fill,fillOpacity,stroke,strokeOpacity;return this.fill&&((fill=Color.parse(this.fill)).a<1&&(fillOpacity=fill.a),fill=Color.toHex(fill).substring(0,7)),"black"!==fill&&"#000000"!==fill&&(style+=null==fill?"fill:none;":"fill:"+fill+";"),void 0!==fillOpacity&&(style+="fill-opacity:"+fillOpacity+";"),this.stroke&&((stroke=Color.parse(this.stroke)).a<1&&(strokeOpacity=stroke.a),stroke=Color.toHex(stroke).substring(0,7)),stroke&&(style+="stroke:"+stroke+";",style+="stroke-width:"+this.strokeWidth+";"),void 0!==strokeOpacity&&(style+="stroke-opacity:"+strokeOpacity+";"),style&&(svg+=' style="'+style+'"'),svg+="/>"},Path.prototype.draw=function(ctx){var nCommands,i,cmd;for(ctx.beginPath(),nCommands=this.commands.length,i=0;i<nCommands;i+=1)(cmd=this.commands[i]).type===MOVETO?ctx.moveTo(cmd.x,cmd.y):cmd.type===LINETO?ctx.lineTo(cmd.x,cmd.y):cmd.type===QUADTO?ctx.quadraticCurveTo(cmd.x1,cmd.y1,cmd.x,cmd.y):cmd.type===CURVETO?ctx.bezierCurveTo(cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y):cmd.type===CLOSE&&ctx.closePath();null!==this.fill&&void 0!==this.fill&&(ctx.fillStyle=Color.toCSS(this.fill),ctx.fill()),null!==this.stroke&&void 0!==this.stroke&&null!==this.strokeWidth&&this.strokeWidth>0&&(ctx.strokeStyle=Color.toCSS(this.stroke),ctx.lineWidth=this.strokeWidth,ctx.stroke())},Path.combine=function(){for(var args=Array.apply(null,arguments),shapes=flatten(args),shape,commands=[],i=0;i<shapes.length;i+=1)(shape=shapes[i]).commands?commands=commands.concat(shape.commands):shape.shapes&&(commands=commands.concat(Path.combine(shape.shapes).commands));return new Path(commands)},module.exports=Path},{"../objects/color":32,"../objects/rect":37,"../util/bezier":42,"../util/geo":44,"../util/math":46,"lodash.flatten":3}],36:[function(require,module,exports){"use strict";var Point=function(x,y){this.x=void 0!==x?x:0,this.y=void 0!==y?y:0};Object.defineProperty(Point.prototype,"xy",{get:function(){return[this.x,this.y]}}),Point.ZERO=new Point(0,0),Point.read=function(x,y){if(2===arguments.length)return new Point(x,y);var arg=x;return arg instanceof Point?arg:"number"==typeof arg?new Point(arg,arg):Array.isArray(arg)?0===arg.length?Point.ZERO:(x=arg[0],y=arg.length>1?arg[1]:x,new Point(x,y)):void 0!==arg.x&&void 0!==arg.y?new Point(arg.x,arg.y):Point.ZERO},Point.prototype.clone=function(){return new Point(this.x,this.y)},Point.prototype.add=function(v){return new Point(this.x+v.x,this.y+v.y)},Point.prototype.subtract=Point.prototype.sub=function(v){return new Point(this.x-v.x,this.y-v.y)},Point.prototype.divide=function(n){return new Point(this.x/n,this.y/n)},Point.prototype.multiply=function(n){return new Point(this.x*n,this.y*n)},Point.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Point.prototype.magnitudeSquared=function(){return this.x*this.x+this.y*this.y},Point.prototype.heading=function(){return Math.atan2(this.y,this.x)},Point.prototype.distanceTo=function(v){var dx=this.x-v.x,dy=this.y-v.y;return Math.sqrt(dx*dx+dy*dy)},Point.prototype.normalize=function(){var m=this.magnitude();return 0!==m?this.divide(m):Point.ZERO},Point.prototype.limit=function(speed){return this.magnitudeSquared()>speed*speed?this.normalize().multiply(speed):this},Point.prototype.translate=function(tx,ty){return new Point(this.x+tx,this.y+ty)},Point.prototype.scale=function(sx,sy){return sy=void 0!==sy?sy:sx,new Point(this.x*sx,this.y*sy)},Point.prototype.toString=function(){return"["+this.x+", "+this.y+"]"},module.exports=Point},{}],37:[function(require,module,exports){"use strict";var Point=require("../objects/point"),Rect=function(x,y,width,height){this.x=void 0!==x?x:0,this.y=void 0!==y?y:0,this.width=void 0!==width?width:0,this.height=void 0!==height?height:0};Object.defineProperty(Rect.prototype,"xywh",{get:function(){return[this.x,this.y,this.width,this.height]}}),Rect.prototype.normalize=function(){var x=this.x,y=this.y,width=this.width,height=this.height;return width<0&&(x+=width,width=-width),height<0&&(y+=height,height=-height),new Rect(x,y,width,height)},Rect.prototype.containsPoint=function(x,y){return 1===arguments.length&&(y=x.y,x=x.x),x>=this.x&&x<=this.x+this.width&&y>=this.y&&y<=this.y+this.height},Rect.prototype.containsRect=function(r){return r.x>=this.x&&r.x+r.width<=this.x+this.width&&r.y>=this.y&&r.y+r.height<=this.y+this.height},Rect.prototype.grow=function(dx,dy){var x=this.x-dx,y=this.y-dy,width=this.width+2*dx,height=this.height+2*dy;return new Rect(x,y,width,height)},Rect.prototype.unite=function(r){var x=Math.min(this.x,r.x),y=Math.min(this.y,r.y),width=Math.max(this.x+this.width,r.x+r.width)-x,height=Math.max(this.y+this.height,r.y+r.height)-y;return new Rect(x,y,width,height)},Rect.prototype.addPoint=function(x,y){var dx,dy,_x=this.x,_y=this.y,width=this.width,height=this.height;return x<this.x?(_x=x,width+=dx=this.x-x):x>this.x+this.width&&(width+=dx=x-(this.x+this.width)),y<this.y?(_y=y,height+=dy=this.y-y):y>this.y+this.height&&(height+=dy=y-(this.y+this.height)),new Rect(_x,_y,width,height)},Rect.prototype.centerPoint=function(){return new Point(this.x+this.width/2,this.y+this.height/2)},module.exports=Rect},{"../objects/point":36}],38:[function(require,module,exports){"use strict";var Color=require("../objects/color"),Rect=require("../objects/rect"),Transform=require("../objects/transform"),_dummyContext=null,GText=function(text){var args=Array.prototype.slice.call(arguments,1),secondArg=arguments[1],thirdArg=arguments[2],lastArg=arguments[arguments.length-1],options;this.text=String(text),"number"==typeof secondArg?(this.x=secondArg,this.y=thirdArg,args=args.slice(2)):Array.isArray(secondArg)?(this.x=secondArg[0],this.y=secondArg[1],args=args.slice(1)):"object"==typeof secondArg?(this.x=void 0!==secondArg.x?secondArg.x:0,this.y=void 0!==secondArg.y?secondArg.y:0,args=args.slice(1)):(this.x=0,this.y=0),"object"==typeof lastArg?(options=lastArg,secondArg!==lastArg&&(args=args.slice(0,args.length-1))):options={},args.length?this.fontFamily=args.shift():this.fontFamily=options.fontFamily||options.fontName||options.font||"sans-serif",args.length?this.fontSize=args.shift():this.fontSize=options.fontSize||24,args.length?this.textAlign=args.shift():this.textAlign=options.align||options.textAlign||"left",args.length?this.fill=args.shift():this.fill=options.fill||"black",this.transform=new Transform};GText.prototype.clone=function(){var t=new GText;return t.text=this.text,t.x=this.x,t.y=this.y,t.fontFamily=this.fontFamily,t.fontSize=this.fontSize,t.textAlign=this.textAlign,t.fill=Color.clone(this.fill),t.transform=this.transform,t},GText._getDummyContext=function(){return _dummyContext||(_dummyContext="undefined"!=typeof document?document.createElement("canvas").getContext("2d"):{font:"10px sans-serif",measureText:function(text){var fontSize=parseFloat(this.font);return{width:text.length*fontSize*.6}}}),_dummyContext},GText.prototype._getFont=function(){return this.fontSize+"px "+this.fontFamily},GText.prototype.colorize=function(fill){var t=this.clone();return t.fill=Color.clone(fill),t},GText.prototype.draw=function(ctx){ctx.save(),ctx.font=this._getFont(),ctx.textAlign=this.textAlign;var m=this.transform.m;ctx.transform(m[0],m[1],m[3],m[4],m[6],m[7]),ctx.fillStyle=Color.toCSS(this.fill),ctx.fillText(this.text,this.x,this.y),ctx.restore()},GText.prototype.bounds=function(){var ctx=GText._getDummyContext(),metrics,x=this.x;return ctx.font=this._getFont(),metrics=ctx.measureText(this.text),"center"===this.textAlign?x=this.x-metrics.width/2:"right"===this.textAlign&&(x=this.x-metrics.width),new Rect(x,this.y-this.fontSize,metrics.width,1.2*this.fontSize)},GText.prototype.toSVG=function(){var svg="<text",textAnchor;return svg+=' x="'+this.x+'"',svg+=' y="'+this.y+'"',svg+=' font-family="'+this.fontFamily+'"',svg+=' font-size="'+this.fontSize+'"',"left"===this.textAlign?textAnchor="start":"center"===this.textAlign?textAnchor="middle":"right"===this.textAlign&&(textAnchor="end"),svg+=' text-anchor="'+textAnchor+'"',"black"!==this.fill&&(svg+=' fill="'+Color.toCSS(this.fill)+'"'),svg+=">",svg+=this.text,svg+="</text>"},module.exports=GText},{"../objects/color":32,"../objects/rect":37,"../objects/transform":39}],39:[function(require,module,exports){"use strict";var bezier=require("../util/bezier"),math=require("../util/math"),Group=require("../objects/group"),Path=require("../objects/path"),Point=require("../objects/point"),MOVETO=bezier.MOVETO,LINETO=bezier.LINETO,QUADTO=bezier.QUADTO,CURVETO=bezier.CURVETO,CLOSE=bezier.CLOSE,Transform=function(m){this.m=void 0!==m?m:[1,0,0,0,1,0,0,0,1]};Transform.IDENTITY=new Transform,Transform.identity=function(){return new Transform},Transform._mmult=function(a,b){return void 0!==a.m&&(a=a.m),void 0!==b.m&&(b=b.m),new Transform([a[0]*b[0]+a[1]*b[3],a[0]*b[1]+a[1]*b[4],0,a[3]*b[0]+a[4]*b[3],a[3]*b[1]+a[4]*b[4],0,a[6]*b[0]+a[7]*b[3]+b[6],a[6]*b[1]+a[7]*b[4]+b[7],1])},Transform.prototype.isIdentity=function(){var m=this.m;return 1===m[0]&&0===m[1]&&0===m[2]&&0===m[3]&&1===m[4]&&0===m[5]&&0===m[6]&&0===m[7]&&1===m[8]},Transform.prototype.prepend=function(matrix){return Transform._mmult(this.m,matrix.m)},Transform.prototype.append=function(matrix){return Transform._mmult(matrix.m,this.m)},Transform.prototype.inverse=function(){var m=this.m,d=m[0]*m[4]-m[1]*m[3];return new Transform([m[4]/d,-m[1]/d,0,-m[3]/d,m[0]/d,0,(m[3]*m[7]-m[4]*m[6])/d,-(m[0]*m[7]-m[1]*m[6])/d,1])},Transform.prototype.scale=function(x,y){return void 0===y&&(y=x),Transform._mmult([x,0,0,0,y,0,0,0,1],this.m)},Transform.prototype.translate=function(x,y){return Transform._mmult([1,0,0,0,1,0,x,y,1],this.m)},Transform.prototype.rotate=function(angle){var c=Math.cos(math.radians(angle)),s=Math.sin(math.radians(angle));return Transform._mmult([c,s,0,-s,c,0,0,0,1],this.m)},Transform.prototype.skew=function(x,y){var kx=Math.PI*x/180,ky=Math.PI*y/180;return Transform._mmult([1,Math.tan(ky),0,-Math.tan(kx),1,0,0,0,1],this.m)},Transform.prototype.transformPoint=function(point){var x=point.x,y=point.y,m=this.m;return new Point(x*m[0]+y*m[3]+m[6],x*m[1]+y*m[4]+m[7])},Transform.prototype.transformPoints=function(points){for(var transformedPoints=[],i=0;i<points.length;i+=1)transformedPoints.push(this.transformPoint(points[i]));return transformedPoints},Transform.prototype.transformPath=function(path){var m=this.m,commands=[];commands.length=path.commands.length;for(var i=0,l=path.commands.length;i<l;i++){var cmd=path.commands[i];switch(cmd.type){case MOVETO:case LINETO:commands[i]={type:cmd.type,x:cmd.x*m[0]+cmd.y*m[3]+m[6],y:cmd.x*m[1]+cmd.y*m[4]+m[7]};break;case QUADTO:commands[i]={type:QUADTO,x:cmd.x*m[0]+cmd.y*m[3]+m[6],y:cmd.x*m[1]+cmd.y*m[4]+m[7],x1:cmd.x1*m[0]+cmd.y1*m[3]+m[6],y1:cmd.x1*m[1]+cmd.y1*m[4]+m[7]};break;case CURVETO:commands[i]={type:CURVETO,x:cmd.x*m[0]+cmd.y*m[3]+m[6],y:cmd.x*m[1]+cmd.y*m[4]+m[7],x1:cmd.x1*m[0]+cmd.y1*m[3]+m[6],y1:cmd.x1*m[1]+cmd.y1*m[4]+m[7],x2:cmd.x2*m[0]+cmd.y2*m[3]+m[6],y2:cmd.x2*m[1]+cmd.y2*m[4]+m[7]};break;case CLOSE:commands[i]={type:CLOSE};break;default:throw new Error("Unknown command type "+cmd)}}return new Path(commands,path.fill,path.stroke,path.strokeWidth)},Transform.prototype.transformText=function(text){var t=text.clone();return t.transform=this.append(t.transform),t},Transform.prototype.transformGroup=function(group){for(var transformedShapes=[],i=0;i<group.shapes.length;i+=1)transformedShapes.push(this.transformShape(group.shapes[i]));return new Group(transformedShapes)},Transform.prototype.transformShape=function(shape){var fn;if(shape.shapes)fn=this.transformGroup;else if(shape.commands)fn=this.transformPath;else if(shape.text)fn=this.transformText;else if(void 0!==shape.x&&void 0!==shape.y)fn=this.transformPoint;else{if(void 0!==shape._transform)return shape._transform(this.m);if(!(Array.isArray(shape)&&shape.length>0))throw new Error("Don't know how to transform "+shape);if(void 0===shape[0].x||void 0===shape[0].y){for(var l=[],i=0;i<shape.length;i+=1)l.push(this.transformShape(shape[i]));return l}fn=this.transformPoints}return fn.call(this,shape)},module.exports=Transform},{"../objects/group":33,"../objects/path":35,"../objects/point":36,"../util/bezier":42,"../util/math":46}],40:[function(require,module,exports){"use strict";var Point=require("../objects/point"),Transform=require("../objects/transform"),Transformable={translate:function(position){var t;return position||(position=Point.ZERO),(new Transform).translate(position.x,position.y).transformShape(this)},scale:function(scale,origin){var sx,sy;origin||(origin=Point.ZERO),"number"==typeof scale?(sx=scale,sy=scale):(sx=scale.x,sy=scale.y);var t=new Transform;return(t=(t=(t=t.translate(origin.x,origin.y)).scale(sx,sy)).translate(-origin.x,-origin.y)).transformShape(this)},rotate:function(angle,origin){origin||(origin=Point.ZERO);var t=new Transform;return(t=(t=(t=t.translate(origin.x,origin.y)).rotate(angle)).translate(-origin.x,-origin.y)).transformShape(this)},skew:function(skew,origin){origin||(origin=Point.ZERO);var t=new Transform;return(t=(t=(t=t.translate(origin.x,origin.y)).skew(skew.x,skew.y)).translate(-origin.x,-origin.y)).transformShape(this)}};module.exports=Transformable},{"../objects/point":36,"../objects/transform":39}],41:[function(require,module,exports){"use strict";var Vec3=function(x,y,z){this.x=void 0===x?0:x,this.y=void 0===y?0:y,this.z=void 0===z?0:z};Vec3.ZERO=new Vec3(0,0,0),Vec3.up=function(){return new Vec3(0,1,0)},Vec3.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z},Vec3.cross=function(a,b){return new Vec3(a.y*b.z-a.z*b.y,a.z*b.x-a.x*b.z,a.x*b.y-a.y*b.x)},Vec3.prototype.toString=function(){return"["+this.x+", "+this.y+", "+this.z+"]"},Vec3.prototype.toArray=function(){var array=[];return array.push(this.x),array.push(this.y),array.push(this.z),array},Vec3.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},Vec3.prototype.normalize=function(){var len,c;return 0===(len=this.getLength())?this:(c=1/len,new Vec3(this.x*c,this.y*c,this.z*c))},Vec3.prototype.add=function(o){return new Vec3(this.x+o.x,this.y+o.y,this.z+o.z)},Vec3.prototype.subtract=function(o){return new Vec3(this.x-o.x,this.y-o.y,this.z-o.z)},Vec3.prototype.transform=function(matrix4){var x,y,z,w,matrix;return matrix=matrix4,x=this.x*matrix.m[0]+this.y*matrix.m[4]+this.z*matrix.m[8]+matrix.m[12],y=this.x*matrix.m[1]+this.y*matrix.m[5]+this.z*matrix.m[9]+matrix.m[13],z=this.x*matrix.m[2]+this.y*matrix.m[6]+this.z*matrix.m[10]+matrix.m[14],w=this.x*matrix.m[3]+this.y*matrix.m[7]+this.z*matrix.m[11]+matrix.m[15],new Vec3(x/w,y/w,z/w)},module.exports=Vec3},{}],42:[function(require,module,exports){"use strict";var math=require("../util/math"),Point=require("../objects/point"),Rect=require("../objects/rect"),bezier={},MOVETO=bezier.MOVETO="M",LINETO=bezier.LINETO="L";bezier.QUADTO="Q";var CURVETO=bezier.CURVETO="C",CLOSE=bezier.CLOSE="Z";function fuzzyCompare(p1,p2){return Math.abs(p1-p2)<=1e-12*Math.min(Math.abs(p1),Math.abs(p2))}function coefficients(t){var mT,a,b,c,d;return d=(c=t*t)*t,[a=(b=(mT=1-t)*mT)*mT,b*=3*t,c*=3*mT,d]}function pointAt(x1,y1,x2,y2,x3,y3,x4,y4,t){var a,b,c,d,coeff;return{x:(a=(coeff=coefficients(t))[0])*x1+(b=coeff[1])*x2+(c=coeff[2])*x3+(d=coeff[3])*x4,y:a*y1+b*y2+c*y3+d*y4}}bezier.linePoint=function(t,x0,y0,x1,y1){var x,y;return{type:LINETO,x:x0+t*(x1-x0),y:y0+t*(y1-y0)}},bezier.lineLength=function(x0,y0,x1,y1){var a=Math.pow(Math.abs(x0-x1),2),b=Math.pow(Math.abs(y0-y1),2);return Math.sqrt(a+b)},bezier.curvePoint=function(t,x0,y0,x1,y1,x2,y2,x3,y3){var dt=1-t,x01,y01,x12=x1*dt+x2*t,y12=y1*dt+y2*t,x23,y23,h1x=(x0*dt+x1*t)*dt+x12*t,h1y=(y0*dt+y1*t)*dt+y12*t,h2x=x12*dt+(x2*dt+x3*t)*t,h2y=y12*dt+(y2*dt+y3*t)*t,x,y;return{type:CURVETO,x1:h1x,y1:h1y,x2:h2x,y2:h2y,x:h1x*dt+h2x*t,y:h1y*dt+h2y*t}},bezier.curveLength=function(x0,y0,x1,y1,x2,y2,x3,y3,n){void 0===n&&(n=20);var i,t,cmd,length=0,xi=x0,yi=y0;for(i=0;i<n;i+=1)t=(i+1)/n,cmd=bezier.curvePoint(t,x0,y0,x1,y1,x2,y2,x3,y3),length+=Math.sqrt(Math.pow(Math.abs(xi-cmd.x),2)+Math.pow(Math.abs(yi-cmd.y),2)),xi=cmd.x,yi=cmd.y;return length},bezier.segmentLengths=function(commands,relative,n){var i,cmd,type,closeX,closeY,x0,y0,s,lengths,ll;for(relative=void 0!==relative&&relative,void 0===n&&(n=20),lengths=[],i=0;i<commands.length;i+=1)type=(cmd=commands[i]).type,0===i?(closeX=cmd.x,closeY=cmd.y):type===MOVETO?(closeX=cmd.x,closeY=cmd.y,lengths.push(0)):type===CLOSE?lengths.push(bezier.lineLength(x0,y0,closeX,closeY)):type===LINETO?lengths.push(bezier.lineLength(x0,y0,cmd.x,cmd.y)):type===CURVETO&&lengths.push(bezier.curveLength(x0,y0,cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y,n)),type!==CLOSE&&(x0=cmd.x,y0=cmd.y);if(!0===relative){if(s=math.sum(lengths),(ll=[]).length=lengths.length,s>0)for(i=0;i<lengths.length;i+=1)ll[i]=lengths[i]/s;else for(i=0;i<lengths.length;i+=1)ll[i]=0;return ll}return lengths},bezier.length=function(path,n){return n=n||20,math.sum(bezier.segmentLengths(path.commands,!1,n))},bezier._locate=function(path,t,segmentLengths){var i,cmd,closeTo;for(void 0===segmentLengths&&(segmentLengths=bezier.segmentLengths(path.commands,!0)),i=0;i<path.commands.length&&(cmd=path.commands[i],0!==i&&cmd.type!==MOVETO||(closeTo=new Point(cmd.x,cmd.y)),!(t<=segmentLengths[i]||i===segmentLengths.length-1));i+=1)t-=segmentLengths[i];return 0!==segmentLengths[i]&&(t/=segmentLengths[i]),i===segmentLengths.length-1&&0===segmentLengths[i]&&(i-=1),[i,t,closeTo]},bezier.point=function(path,t,segmentLengths){var loc,i,closeTo,x0,y0,cmd;return i=(loc=bezier._locate(path,t,segmentLengths))[0],t=loc[1],closeTo=loc[2],x0=path.commands[i].x,y0=path.commands[i].y,(cmd=path.commands[i+1]).type===LINETO||cmd.type===CLOSE?cmd=cmd.type===CLOSE?bezier.linePoint(t,x0,y0,closeTo.x,closeTo.y):bezier.linePoint(t,x0,y0,cmd.x,cmd.y):cmd.type===CURVETO&&(cmd=bezier.curvePoint(t,x0,y0,cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y)),cmd},bezier.extrema=function(x1,y1,x2,y2,x3,y3,x4,y4){var minX,maxX,minY,maxY,ax,bx,cx,ay,by,cy,temp,rcp,tx,ty;function bezierCheck(t){if(t>=0&&t<=1){var p=pointAt(x1,y1,x2,y2,x3,y3,x4,y4,t);p.x<minX?minX=p.x:p.x>maxX&&(maxX=p.x),p.y<minY?minY=p.y:p.y>maxY&&(maxY=p.y)}}return x1<x4?(minX=x1,maxX=x4):(minX=x4,maxX=x1),y1<y4?(minY=y1,maxY=y4):(minY=y4,maxY=y1),bx=6*(x1-2*x2+x3),cx=3*(-x1+x2),fuzzyCompare(1+(ax=3*(3*x2-x1-3*x3+x4)),1)?fuzzyCompare(bx+1,1)||bezierCheck(-cx/bx):(tx=bx*bx-4*ax*cx)>=0&&(bezierCheck((-bx+(temp=Math.sqrt(tx)))*(rcp=1/(2*ax))),bezierCheck((-bx-temp)*rcp)),by=6*(y1-2*y2+y3),cy=3*(-y1+y2),fuzzyCompare(1+(ay=3*(3*y2-y1-3*y3+y4)),1)?fuzzyCompare(by+1,1)||bezierCheck(-cy/by):(ty=by*by-4*ay*cy)>0&&(bezierCheck((-by+(temp=Math.sqrt(ty)))*(rcp=1/(2*ay))),bezierCheck((-by-temp)*rcp)),new Rect(minX,minY,maxX-minX,maxY-minY)},module.exports=bezier},{"../objects/point":36,"../objects/rect":37,"../util/math":46}],43:[function(require,module,exports){"use strict";var color={};function toHex(i){var s;return 0===i?"00":((s=i.toString(16).toUpperCase()).length<2&&(s="0"+s),s)}color.namedColors={lightpink:[1,.71,.76],pink:[1,.75,.8],crimson:[.86,.08,.24],lavenderblush:[1,.94,.96],palevioletred:[.86,.44,.58],hotpink:[1,.41,.71],deeppink:[1,.08,.58],mediumvioletred:[.78,.08,.52],orchid:[.85,.44,.84],thistle:[.85,.75,.85],plum:[.87,.63,.87],violet:[.93,.51,.93],fuchsia:[1,0,1],darkmagenta:[.55,0,.55],purple:[.5,0,.5],mediumorchid:[.73,.33,.83],darkviolet:[.58,0,.83],darkorchid:[.6,.2,.8],indigo:[.29,0,.51],blueviolet:[.54,.17,.89],mediumpurple:[.58,.44,.86],mediumslateblue:[.48,.41,.93],slateblue:[.42,.35,.8],darkslateblue:[.28,.24,.55],ghostwhite:[.97,.97,1],lavender:[.9,.9,.98],blue:[0,0,1],mediumblue:[0,0,.8],darkblue:[0,0,.55],navy:[0,0,.5],midnightblue:[.1,.1,.44],royalblue:[.25,.41,.88],cornflowerblue:[.39,.58,.93],lightsteelblue:[.69,.77,.87],lightslategray:[.47,.53,.6],slategray:[.44,.5,.56],dodgerblue:[.12,.56,1],aliceblue:[.94,.97,1],steelblue:[.27,.51,.71],lightskyblue:[.53,.81,.98],skyblue:[.53,.81,.92],deepskyblue:[0,.75,1],lightblue:[.68,.85,.9],powderblue:[.69,.88,.9],cadetblue:[.37,.62,.63],darkturquoise:[0,.81,.82],azure:[.94,1,1],lightcyan:[.88,1,1],paleturquoise:[.69,.93,.93],aqua:[0,1,1],darkcyan:[0,.55,.55],teal:[0,.5,.5],darkslategray:[.18,.31,.31],mediumturquoise:[.28,.82,.8],lightseagreen:[.13,.7,.67],turquoise:[.25,.88,.82],aquamarine:[.5,1,.83],mediumaquamarine:[.4,.8,.67],mediumspringgreen:[0,.98,.6],mintcream:[.96,1,.98],springgreen:[0,1,.5],mediumseagreen:[.24,.7,.44],seagreen:[.18,.55,.34],honeydew:[.94,1,.94],darkseagreen:[.56,.74,.56],palegreen:[.6,.98,.6],lightgreen:[.56,.93,.56],limegreen:[.2,.8,.2],lime:[0,1,0],forestgreen:[.13,.55,.13],green:[0,.5,0],darkgreen:[0,.39,0],lawngreen:[.49,.99,0],chartreuse:[.5,1,0],greenyellow:[.68,1,.18],darkolivegreen:[.33,.42,.18],yellowgreen:[.6,.8,.2],olivedrab:[.42,.56,.14],ivory:[1,1,.94],beige:[.96,.96,.86],lightyellow:[1,1,.88],lightgoldenrodyellow:[.98,.98,.82],yellow:[1,1,0],olive:[.5,.5,0],darkkhaki:[.74,.72,.42],palegoldenrod:[.93,.91,.67],lemonchiffon:[1,.98,.8],khaki:[.94,.9,.55],gold:[1,.84,0],cornsilk:[1,.97,.86],goldenrod:[.85,.65,.13],darkgoldenrod:[.72,.53,.04],floralwhite:[1,.98,.94],oldlace:[.99,.96,.9],wheat:[.96,.87,.07],orange:[1,.65,0],moccasin:[1,.89,.71],papayawhip:[1,.94,.84],blanchedalmond:[1,.92,.8],navajowhite:[1,.87,.68],antiquewhite:[.98,.92,.84],tan:[.82,.71,.55],burlywood:[.87,.72,.53],darkorange:[1,.55,0],bisque:[1,.89,.77],linen:[.98,.94,.9],peru:[.8,.52,.25],peachpuff:[1,.85,.73],sandybrown:[.96,.64,.38],chocolate:[.82,.41,.12],saddlebrown:[.55,.27,.07],seashell:[1,.96,.93],sienna:[.63,.32,.18],lightsalmon:[1,.63,.48],coral:[1,.5,.31],orangered:[1,.27,0],darksalmon:[.91,.59,.48],tomato:[1,.39,.28],salmon:[.98,.5,.45],mistyrose:[1,.89,.88],lightcoral:[.94,.5,.5],snow:[1,.98,.98],rosybrown:[.74,.56,.56],indianred:[.8,.36,.36],red:[1,0,0],brown:[.65,.16,.16],firebrick:[.7,.13,.13],darkred:[.55,0,0],maroon:[.5,0,0],white:[1,1,1],whitesmoke:[.96,.96,.96],gainsboro:[.86,.86,.86],lightgrey:[.83,.83,.83],silver:[.75,.75,.75],darkgray:[.66,.66,.66],gray:[.5,.5,.5],grey:[.5,.5,.5],dimgray:[.41,.41,.41],dimgrey:[.41,.41,.41],black:[0,0,0],cyan:[0,.68,.94],transparent:[0,0,0,0],bark:[.25,.19,.13]},color.rgb2hex=function(r,g,b){return"#"+toHex(Math.round(255*r))+toHex(Math.round(255*g))+toHex(Math.round(255*b))},color.rgba2hex=function(r,g,b,a){return"#"+toHex(Math.round(255*r))+toHex(Math.round(255*g))+toHex(Math.round(255*b))+toHex(Math.round(255*a))},color.hex2rgb=function(hex){var r,g,b;if(3!==(hex=hex.replace(/^#/,"")).length&&6!==hex.length||!/^[0-9a-fA-F]*$/.test(hex))throw new Error("Invalid hex value: #"+hex);return 3===hex.length&&(hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]),[r=parseInt(hex.substr(0,2),16)/255,g=parseInt(hex.substr(2,2),16)/255,b=parseInt(hex.substr(4,2),16)/255]},color.rgb2hsb=function(r,g,b){var h=0,s=0,v=Math.max(r,g,b),d=v-Math.min(r,g,b);return 0!==v&&(s=d/v),0!==s&&(h=r===v?0+(g-b)/d:g===v?2+(b-r)/d:4+(r-g)/d),(h*=60/360)<0&&(h+=1),[h,s,v]},color.hsb2rgb=function(h,s,v){if(0===s)return[v,v,v];h=h%1*6;var i=Math.floor(h),f=h-i,x=v*(1-s),y=v*(1-s*f),z=v*(1-s*(1-f));return i>4?[v,x,y]:[[v,z,x],[y,v,x],[x,v,z],[x,y,v],[z,x,v]][parseInt(i,10)]},color.rgb2hsl=function(r,g,b){var min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min,h,s,l;return max===min?h=0:r===max?h=(g-b)/delta:g===max?h=2+(b-r)/delta:b===max&&(h=4+(r-g)/delta),(h=Math.min(60*h,360))<0&&(h+=360),l=(min+max)/2,[h/360,s=max===min?0:l<=.5?delta/(max+min):delta/(2-max-min),l]},color.hsl2rgb=function(h,s,l){var t1,t2,t3,rgb,val;if(0===s)return[val=l,val,val];t1=2*l-(t2=l<.5?l*(1+s):l+s-l*s),rgb=[0,0,0];for(var i=0;i<3;i++)(t3=h+1/3*-(i-1))<0&&(t3+=1),t3>1&&(t3-=1),val=6*t3<1?t1+6*(t2-t1)*t3:2*t3<1?t2:3*t3<2?t1+(t2-t1)*(2/3-t3)*6:t1,rgb[i]=val;return rgb},module.exports=color},{}],44:[function(require,module,exports){"use strict";var math=require("../util/math"),Point=require("../objects/point"),geo={angle:function(x0,y0,x1,y1){return math.degrees(Math.atan2(y1-y0,x1-x0))},distance:function(x0,y0,x1,y1){return Math.sqrt(Math.pow(x1-x0,2)+Math.pow(y1-y0,2))},coordinates:function(x0,y0,angle,distance){var x=x0+Math.cos(math.radians(angle))*distance,y=y0+Math.sin(math.radians(angle))*distance;return new Point(x,y)},pointInPolygon:function(points,x,y){var i,j,x0,y0,x1,y1,odd=!1,n=points.length;for(i=0;i<n;i+=1)j=i<n-1?i+1:0,x0=points[i].x,y0=points[i].y,x1=points[j].x,y1=points[j].y,(y0<y&&y1>=y||y1<y&&y0>=y)&&x0+(y-y0)/(y1-y0)*(x1-x0)<x&&(odd=!odd);return odd}};module.exports=geo},{"../objects/point":36,"../util/math":46}],45:[function(require,module,exports){"use strict";exports.defineAlias=function(cls,origProperty,newProperty){Object.defineProperty(cls.prototype,newProperty,{get:function(){return this[origProperty]},set:function(v){this[origProperty]=v}})},exports.defineGetter=function(cls,property,getterFn){Object.defineProperty(cls.prototype,property,{get:getterFn})}},{}],46:[function(require,module,exports){"use strict";var math={sum:function(values){var i,n=values.length,total=0;for(i=0;i<n;i+=1)total+=values[i];return total},round:function(x,decimals){return decimals?Math.round(x*Math.pow(10,decimals))/Math.pow(10,decimals):Math.round(x)},sign:function(x){return x<0?-1:x>0?1:0},degrees:function(radians){return 180*radians/Math.PI},radians:function(degrees){return degrees/180*Math.PI},clamp:function(v,min,max){return min<max?v<min?min:v>max?max:v:v<max?max:v>min?min:v},snap:function(v,distance,strength){return v*(1-(strength=void 0!==strength?strength:1))+strength*Math.round(v/distance)*distance},dot:function(a,b){var m=Math.min(a.length,b.length),n=0,i;for(i=0;i<m;i+=1)n+=a[i]*b[i];return n}},_lerp=math.mix=math.lerp=function(from,to,t,clamp){if(clamp){if(t<0)return from;if(t>1)return to}return from+(to-from)*t};function _fade(t){return t*t*t*(t*(6*t-15)+10)}function _grad(hash,x,y,z){var h,u,v;return u=(h=15&hash)<8?x:y,v=h<4?y:12===h||14===h?x:z,(0==(1&h)?u:-u)+(0==(2&h)?v:-v)}function _scale(n){return(1+n)/2}var _permutation=function(){var permutation,p,i;for(permutation=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],p=new Uint8Array(512),i=0;i<256;i+=1)p[256+i]=p[i]=permutation[i];return p}();math.noise=function(x,y,z){var p=_permutation,X=255&Math.floor(x),Y=255&Math.floor(y),Z=255&Math.floor(z);x-=Math.floor(x),y-=Math.floor(y),z-=Math.floor(z);var u=_fade(x),v=_fade(y),w=_fade(z),A=p[X]+Y,AA=p[A]+Z,AB=p[A+1]+Z,B=p[X+1]+Y,BA=p[B]+Z,BB=p[B+1]+Z;return _scale(_lerp(_lerp(_lerp(_grad(p[AA],x,y,z),_grad(p[BA],x-1,y,z),u),_lerp(_grad(p[AB],x,y-1,z),_grad(p[BB],x-1,y-1,z),u),v),_lerp(_lerp(_grad(p[AA+1],x,y,z-1),_grad(p[BA+1],x-1,y,z-1),u),_lerp(_grad(p[AB+1],x,y-1,z-1),_grad(p[BB+1],x-1,y-1,z-1),u),v),w))},module.exports=math},{}],47:[function(require,module,exports){"use strict";function generator(seed){if(seed<0){for(var gen=generator(Math.abs(seed)),i=0;i<23;i+=1)gen();return generator(gen(0,1e4))}return function(min,max){var v;return(min=min||0)+(seed=(9301*seed+49297)%233280)/233280*((max=max||1)-min)}}exports.generator=generator},{}],48:[function(require,module,exports){"use strict";var xmldom=require("xmldom"),Color=require("../objects/color"),Group=require("../objects/group"),Path=require("../objects/path"),Point=require("../objects/point"),Transform=require("../objects/transform"),trim=function(s){return s.replace(/^\s+|\s+$/g,"")},compressSpaces=function(s){return s.replace(/[\s\r\t\n]+/gm," ")},toNumberArray=function(s){var i,a=trim(compressSpaces((s||"").replace(/,/g," "))).split(" ");for(i=0;i<a.length;i+=1)a[i]=parseFloat(a[i]);return a},readSvgAttributes=function(node,parentAttributes){var fill,fillOpacity,stroke,strokeOpacity,strokeWidth,opacity,color,transforms,types,transform,i,attributes,v,data,type,s,d,elems,el;attributes=parentAttributes?Object.create(parentAttributes):{},transforms=[],(types={}).translate=function(s){var a=toNumberArray(s),tx=a[0],ty=a[1]||0;return(new Transform).translate(tx,ty)},types.scale=function(s){var a=toNumberArray(s),sx=a[0],sy=a[1]||sx;return(new Transform).scale(sx,sy)},types.rotate=function(s){var t,a=toNumberArray(s),r=a[0],tx=a[1]||0,ty=a[2]||0;return t=(t=(t=(t=new Transform).translate(tx,ty)).rotate(r)).translate(-tx,-ty)},types.matrix=function(s){var m=toNumberArray(s);return new Transform([m[0],m[1],0,m[2],m[3],0,m[4],m[5],1])};for(var j=0;j<node.attributes.length;j+=1)switch((v=node.attributes[j]).nodeName){case"transform":for(data=trim(compressSpaces(v.nodeValue)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),i=0;i<data.length;i+=1)type=trim(data[i].split("(")[0]),s=data[i].split("(")[1].replace(")",""),transform=types[type](s),transforms.push(transform);break;case"visibility":case"stroke-linecap":case"stroke-linejoin":case"stroke-miterlimit":break;case"stroke-width":strokeWidth=parseFloat(v.nodeValue);break;case"stroke-opacity":strokeOpacity=parseFloat(v.nodeValue);break;case"fill-opacity":fillOpacity=parseFloat(v.nodeValue);break;case"fill":fill=v.nodeValue;break;case"stroke":stroke=v.nodeValue;break;case"opacity":opacity=parseFloat(v.nodeValue);break;case"color":color=v.nodeValue;break;case"style":for(d={},elems=v.nodeValue.split(";"),i=0;i<elems.length;i+=1)d[(el=elems[i].split(":"))[0].trim()]=el[1];d.fill&&(fill=d.fill),d.stroke&&(stroke=d.stroke),void 0!==d["stroke-width"]&&(strokeWidth=parseFloat(d["stroke-width"])),void 0!==d["stroke-opacity"]&&(strokeOpacity=parseFloat(d["stroke-opacity"])),void 0!==d["fill-opacity"]&&(fillOpacity=parseFloat(d["fill-opacity"])),void 0!==d.opacity&&(opacity=parseFloat(d.opacity)),d.color&&(color=d.color)}if(void 0!==fill&&(attributes.fill=fill),void 0!==stroke&&(attributes.stroke=stroke),void 0!==fillOpacity&&(attributes.fillOpacity=fillOpacity),void 0!==strokeOpacity&&(attributes.strokeOpacity=strokeOpacity),void 0!==strokeWidth&&(attributes.strokeWidth=strokeWidth),void 0!==opacity&&(attributes.opacity=opacity),void 0!==color&&"currentColor"!==color&&(attributes.color=color),transforms.length>0){for(transform=new Transform,i=0;i<transforms.length;i+=1)transform=transform.append(transforms[i]);transform.isIdentity()||(attributes.transform?attributes.transform=attributes.transform.append(transform):attributes.transform=transform)}return attributes},applySvgAttributes=function(shape,attributes){var fill=attributes.fill;shape.commands&&shape.commands.length>0&&void 0===fill&&(fill="black");var fillOpacity=attributes.fillOpacity,stroke=attributes.stroke,strokeOpacity=attributes.strokeOpacity,opacity=attributes.opacity,strokeWidth=attributes.strokeWidth,transform=attributes.transform,color=attributes.color,commands;"currentColor"===fill&&(fill=void 0===color?"black":color),void 0!==fill&&(fill=Color.parse(fill),void 0!==fillOpacity&&(fill.a*=fillOpacity),void 0!==opacity&&(fill.a*=opacity)),"currentColor"===stroke&&(stroke=void 0===color?"black":color),void 0!==stroke&&(stroke=Color.parse(stroke),void 0!==strokeOpacity&&(stroke.a*=strokeOpacity),void 0!==opacity&&(stroke.a*=opacity)),commands=transform?transform.transformShape(shape).commands:shape.commands;var f=void 0===fill?shape.fill:fill,s=void 0===stroke?shape.stroke:stroke,sw=void 0===strokeWidth?shape.strokeWidth:strokeWidth;return void 0!==sw&&void 0!==transform&&(sw*=transform.m[0]),new Path(commands,f,s,sw)},arcToSegments=function(x,y,rx,ry,large,sweep,rotateX,ox,oy){var th,sinTh,cosTh,px,py,pl,a00,a01,a10,a11,x0,y0,x1,y1,d,sFactorSq,sFactor,xc,yc,th0,th1,thArc,segments,result,th2,th3,i;for(th=rotateX*(Math.PI/180),sinTh=Math.sin(th),(pl=(px=(cosTh=Math.cos(th))*(ox-x)*.5+sinTh*(oy-y)*.5)*px/((rx=Math.abs(rx))*rx)+(py=cosTh*(oy-y)*.5-sinTh*(ox-x)*.5)*py/((ry=Math.abs(ry))*ry))>1&&(rx*=pl=Math.sqrt(pl),ry*=pl),(sFactorSq=1/(d=((x1=(a00=cosTh/rx)*x+(a01=sinTh/rx)*y)-(x0=a00*ox+a01*oy))*(x1-x0)+((y1=(a10=-sinTh/ry)*x+(a11=cosTh/ry)*y)-(y0=a10*ox+a11*oy))*(y1-y0))-.25)<0&&(sFactorSq=0),sFactor=Math.sqrt(sFactorSq),sweep===large&&(sFactor=-sFactor),xc=.5*(x0+x1)-sFactor*(y1-y0),yc=.5*(y0+y1)+sFactor*(x1-x0),th0=Math.atan2(y0-yc,x0-xc),(thArc=(th1=Math.atan2(y1-yc,x1-xc))-th0)<0&&1===sweep?thArc+=2*Math.PI:thArc>0&&0===sweep&&(thArc-=2*Math.PI),segments=Math.ceil(Math.abs(thArc/(.5*Math.PI+.001))),result=[],i=0;i<segments;i+=1)th2=th0+i*thArc/segments,th3=th0+(i+1)*thArc/segments,result[i]=[xc,yc,th2,th3,rx,ry,sinTh,cosTh];return result},segmentToBezier=function(cx,cy,th0,th1,rx,ry,sinTh,cosTh){var a00=cosTh*rx,a01=-sinTh*ry,a10=sinTh*rx,a11=cosTh*ry,thHalf=.5*(th1-th0),t=8/3*Math.sin(.5*thHalf)*Math.sin(.5*thHalf)/Math.sin(thHalf),x1=cx+Math.cos(th0)-t*Math.sin(th0),y1=cy+Math.sin(th0)+t*Math.cos(th0),x3=cx+Math.cos(th1),y3=cy+Math.sin(th1),x2=x3+t*Math.sin(th1),y2=y3-t*Math.cos(th1);return[a00*x1+a01*y1,a10*x1+a11*y1,a00*x2+a01*y2,a10*x2+a11*y2,a00*x3+a01*y3,a10*x3+a11*y3]},read={svg:function(){return read.g.apply(this,arguments)},g:function(node,parentAttributes){for(var shapes=[],attributes=readSvgAttributes(node,parentAttributes),n,tag,tagName,o,i=0;i<node.childNodes.length;i+=1){if(!(tag=(n=node.childNodes[i]).nodeName))return;tagName=tag.replace(/svg\:/gi,"").toLowerCase(),void 0!==read[tagName]&&(o=read[tagName].call(this,n,attributes),shapes.push(o))}return new Group(shapes)},_polyline:function(node){var points=node.getAttribute("points"),p=new Path;return points.replace(/([\d\.?]+),([\d\.?]+)/g,(function(match,p1,p2){var x=parseFloat(p1),y=parseFloat(p2);0===p.commands.length?p.moveTo(x,y):p.lineTo(x,y)})),p},polygon:function(node,parentAttributes){var attributes=readSvgAttributes(node,parentAttributes),p=read._polyline(node);return p.close(),applySvgAttributes(p,attributes)},polyline:function(node,parentAttributes){var attributes=readSvgAttributes(node,parentAttributes),p=read._polyline(node);return applySvgAttributes(p,attributes)},rect:function(node,parentAttributes){var attributes=readSvgAttributes(node,parentAttributes),x=parseFloat(node.getAttribute("x")),y=parseFloat(node.getAttribute("y"));x||(x=0),y||(y=0);var width=parseFloat(node.getAttribute("width")),height=parseFloat(node.getAttribute("height"));width||(width=0),height||(height=0),width<0&&(console.error('Error: invalid negative value for <rect> attribute width="'+width+'"'),width=0),height<0&&(console.error('Error: invalid negative value for <rect> attribute height="'+height+'"'),height=0);var rx=parseFloat(node.getAttribute("rx")),ry=parseFloat(node.getAttribute("ry"));rx||(rx=0),ry||(ry=0),rx<0&&(console.error('Error: invalid negative value for <rect> attribute rx="'+rx+'"'),rx=0),ry<0&&(console.error('Error: invalid negative value for <rect> attribute ry="'+ry+'"'),ry=0),rx&&ry||(rx=ry=Math.max(rx,ry)),rx>width/2&&(rx=width/2),ry>height/2&&(ry=height/2);var p=new Path;return rx&&ry?p.addRoundedRect(x,y,width,height,rx,ry):p.addRect(x,y,width,height),applySvgAttributes(p,attributes)},ellipse:function(node,parentAttributes){var attributes=readSvgAttributes(node,parentAttributes),cx=parseFloat(node.getAttribute("cx")),cy=parseFloat(node.getAttribute("cy"));cx||(cx=0),cy||(cy=0);var rx=parseFloat(node.getAttribute("rx")),ry=parseFloat(node.getAttribute("ry"));rx||(rx=0),ry||(ry=0),rx<0&&(console.error('Error: invalid negative value for <ellipse> attribute rx="'+rx+'"'),rx=0),ry<0&&(console.error('Error: invalid negative value for <ellipse> attribute ry="'+ry+'"'),ry=0);var p=new Path;return p.addEllipse(cx-rx,cy-ry,2*rx,2*ry),applySvgAttributes(p,attributes)},circle:function(node,parentAttributes){var attributes=readSvgAttributes(node,parentAttributes),cx=parseFloat(node.getAttribute("cx")),cy=parseFloat(node.getAttribute("cy"));cx||(cx=0),cy||(cy=0);var r=parseFloat(node.getAttribute("r"));r||(r=0),r<0&&(console.error('Error: invalid negative value for <circle> attribute r="'+r+'"'),r=0);var p=new Path;return p.addEllipse(cx-r,cy-r,2*r,2*r),applySvgAttributes(p,attributes)},line:function(node,parentAttributes){var attributes=readSvgAttributes(node,parentAttributes),x1=parseFloat(node.getAttribute("x1")),y1=parseFloat(node.getAttribute("y1")),x2=parseFloat(node.getAttribute("x2")),y2=parseFloat(node.getAttribute("y2"));x1||(x1=0),y1||(y1=0),x2||(x2=0),y2||(y2=0);var p=new Path;return p.addLine(x1,y1,x2,y2),applySvgAttributes(p,attributes)},path:function(node,parentAttributes){var attributes=readSvgAttributes(node,parentAttributes),d,PathParser,pp,pt,newP,curr,p1,cntrl,cp,cp1x,cp1y,cp2x,cp2y,rx,ry,rot,large,sweep,ex,ey,segs,i,bez;d=(d=(d=(d=(d=(d=(d=(d=(d=node.getAttribute("d")).replace(/,/gm," ")).replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2")).replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2")).replace(/(\.[0-9]*)(\.)/gm,"$1 $2")).replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),d=compressSpaces(d),d=trim(d),PathParser=function(d){this.tokens=d.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new Point(0,0),this.control=new Point(0,0),this.current=new Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!==this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i+=1,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var pt=new Point(this.getScalar(),this.getScalar());return this.makeAbsolute(pt)},this.getAsControlPoint=function(){var pt=this.getPoint();return this.control=pt,pt},this.getAsCurrentPoint=function(){var pt=this.getPoint();return this.current=pt,pt},this.getReflectedControlPoint=function(){return"c"!==this.previousCommand.toLowerCase()&&"s"!==this.previousCommand.toLowerCase()&&"q"!==this.previousCommand.toLowerCase()&&"t"!==this.previousCommand.toLowerCase()?this.current:new Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);var pt},this.makeAbsolute=function(pt){return this.isRelativeCommand()?new Point(pt.x+this.current.x,pt.y+this.current.y):pt}};var p=new Path;for((pp=new PathParser(d)).reset();!pp.isEnd();)switch(pp.nextCommand(),pp.command){case"M":case"m":for(pt=pp.getAsCurrentPoint(),p.moveTo(pt.x,pt.y),pp.start=pp.current;!pp.isCommandOrEnd();)pt=pp.getAsCurrentPoint(),p.lineTo(pt.x,pt.y);break;case"L":case"l":for(;!pp.isCommandOrEnd();)pt=pp.getAsCurrentPoint(),p.lineTo(pt.x,pt.y);break;case"H":case"h":for(;!pp.isCommandOrEnd();)newP=new Point((pp.isRelativeCommand()?pp.current.x:0)+pp.getScalar(),pp.current.y),pp.current=newP,p.lineTo(pp.current.x,pp.current.y);break;case"V":case"v":for(;!pp.isCommandOrEnd();)newP=new Point(pp.current.x,(pp.isRelativeCommand()?pp.current.y:0)+pp.getScalar()),pp.current=newP,p.lineTo(pp.current.x,pp.current.y);break;case"C":case"c":for(;!pp.isCommandOrEnd();)curr=pp.current,p1=pp.getPoint(),cntrl=pp.getAsControlPoint(),cp=pp.getAsCurrentPoint(),p.curveTo(p1.x,p1.y,cntrl.x,cntrl.y,cp.x,cp.y);break;case"S":case"s":for(;!pp.isCommandOrEnd();)curr=pp.current,p1=pp.getReflectedControlPoint(),cntrl=pp.getAsControlPoint(),cp=pp.getAsCurrentPoint(),p.curveTo(p1.x,p1.y,cntrl.x,cntrl.y,cp.x,cp.y);break;case"Q":case"q":for(;!pp.isCommandOrEnd();)curr=pp.current,cntrl=pp.getAsControlPoint(),cp=pp.getAsCurrentPoint(),cp1x=curr.x+2/3*(cntrl.x-curr.x),cp1y=curr.y+2/3*(cntrl.y-curr.y),cp2x=cp1x+1/3*(cp.x-curr.x),cp2y=cp1y+1/3*(cp.y-curr.y),p.curveTo(cp1x,cp1y,cp2x,cp2y,cp.x,cp.y);break;case"T":case"t":for(;!pp.isCommandOrEnd();)curr=pp.current,cntrl=pp.getReflectedControlPoint(),pp.control=cntrl,cp=pp.getAsCurrentPoint(),cp1x=curr.x+2/3*(cntrl.x-curr.x),cp1y=curr.y+2/3*(cntrl.y-curr.y),cp2x=cp1x+1/3*(cp.x-curr.x),cp2y=cp1y+1/3*(cp.y-curr.y),p.curveTo(cp1x,cp1y,cp2x,cp2y,cp.x,cp.y);break;case"A":case"a":for(;!pp.isCommandOrEnd();)for(curr=pp.current,rx=pp.getScalar(),ry=pp.getScalar(),rot=pp.getScalar(),large=pp.getScalar(),sweep=pp.getScalar(),ex=(cp=pp.getAsCurrentPoint()).x,ey=cp.y,segs=arcToSegments(ex,ey,rx,ry,large,sweep,rot,curr.x,curr.y),i=0;i<segs.length;i+=1)bez=segmentToBezier.apply(this,segs[i]),p.curveTo.apply(p,bez);break;case"Z":case"z":p.close(),pp.current=pp.start}return applySvgAttributes(p,attributes)}};exports.interpret=function(svgNode){var node,tag=svgNode.tagName.toLowerCase();return void 0===read[tag]?null:node=read[tag].call(this,svgNode)},exports.parseString=function(s){var doc=new xmldom.DOMParser({errorHandler:function(key,msg){throw new Error('Could not parse string "'+String(s)+'": '+msg)}}).parseFromString(s);return doc?exports.interpret(doc.documentElement):null}},{"../objects/color":32,"../objects/group":33,"../objects/path":35,"../objects/point":36,"../objects/transform":39,xmldom:10}],49:[function(require,module,exports){"use strict";var assignIn=require("lodash.assignin"),vg={};function importCommands(module){for(var k in module)vg[k]=module[k]}vg.bezier=require("./util/bezier"),vg.color=require("./util/color"),vg.geo=require("./util/geo"),vg.math=require("./util/math"),vg.random=require("./util/random"),vg.svg=require("./util/svg"),vg.Color=require("./objects/color"),vg.Group=require("./objects/group"),vg.Matrix4=require("./objects/matrix4"),vg.Path=require("./objects/path"),vg.Point=vg.Vec2=require("./objects/point"),vg.Rect=require("./objects/rect"),vg.Text=require("./objects/text"),vg.Transform=vg.Matrix3=require("./objects/transform"),vg.Vec3=require("./objects/vec3");var Transformable=require("./objects/transformable");assignIn(vg.Point.prototype,Transformable),assignIn(vg.Path.prototype,Transformable),assignIn(vg.Group.prototype,Transformable),assignIn(vg.Text.prototype,Transformable),importCommands(require("./commands/draw")),importCommands(require("./commands/filters")),importCommands(require("./commands/shapes")),module.exports=vg},{"./commands/draw":29,"./commands/filters":30,"./commands/shapes":31,"./objects/color":32,"./objects/group":33,"./objects/matrix4":34,"./objects/path":35,"./objects/point":36,"./objects/rect":37,"./objects/text":38,"./objects/transform":39,"./objects/transformable":40,"./objects/vec3":41,"./util/bezier":42,"./util/color":43,"./util/geo":44,"./util/math":46,"./util/random":47,"./util/svg":48,"lodash.assignin":2}],50:[function(require,module,exports){!function(){"use strict";var ClipperLib={use_lines:!0,use_xyz:!1},isNode=!1,navigator_appName;if(void 0!==module&&module.exports?(module.exports=ClipperLib,isNode=!0):"undefined"!=typeof document?window.ClipperLib=ClipperLib:self.ClipperLib=ClipperLib,isNode){var nav="chrome";navigator_appName="Netscape"}else{var nav=navigator.userAgent.toString().toLowerCase();navigator_appName=navigator.appName}var browser={},dbits;-1!=nav.indexOf("chrome")&&-1==nav.indexOf("chromium")?browser.chrome=1:browser.chrome=0,-1!=nav.indexOf("chromium")?browser.chromium=1:browser.chromium=0,-1!=nav.indexOf("safari")&&-1==nav.indexOf("chrome")&&-1==nav.indexOf("chromium")?browser.safari=1:browser.safari=0,-1!=nav.indexOf("firefox")?browser.firefox=1:browser.firefox=0,-1!=nav.indexOf("firefox/17")?browser.firefox17=1:browser.firefox17=0,-1!=nav.indexOf("firefox/15")?browser.firefox15=1:browser.firefox15=0,-1!=nav.indexOf("firefox/3")?browser.firefox3=1:browser.firefox3=0,-1!=nav.indexOf("opera")?browser.opera=1:browser.opera=0,-1!=nav.indexOf("msie 10")?browser.msie10=1:browser.msie10=0,-1!=nav.indexOf("msie 9")?browser.msie9=1:browser.msie9=0,-1!=nav.indexOf("msie 8")?browser.msie8=1:browser.msie8=0,-1!=nav.indexOf("msie 7")?browser.msie7=1:browser.msie7=0,-1!=nav.indexOf("msie ")?browser.msie=1:browser.msie=0,ClipperLib.biginteger_used=null;var canary=0xdeadbeefcafe,j_lm=!0;function BigInteger(a,b,c){ClipperLib.biginteger_used=1,null!=a&&("number"==typeof a&&void 0===b?this.fromInt(a):"number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function nbi(){return new BigInteger(null,void 0,void 0)}function am1(i,x,w,j,c,n){for(;--n>=0;){var v=x*this[i++]+w[j]+c;c=Math.floor(v/67108864),w[j++]=67108863&v}return c}function am2(i,x,w,j,c,n){for(var xl=32767&x,xh=x>>15;--n>=0;){var l=32767&this[i],h=this[i++]>>15,m=xh*l+h*xl;c=((l=xl*l+((32767&m)<<15)+w[j]+(1073741823&c))>>>30)+(m>>>15)+xh*h+(c>>>30),w[j++]=1073741823&l}return c}function am3(i,x,w,j,c,n){for(var xl=16383&x,xh=x>>14;--n>=0;){var l=16383&this[i],h=this[i++]>>14,m=xh*l+h*xl;c=((l=xl*l+((16383&m)<<14)+w[j]+c)>>28)+(m>>14)+xh*h,w[j++]=268435455&l}return c}"Microsoft Internet Explorer"==navigator_appName?(BigInteger.prototype.am=am2,dbits=30):"Netscape"!=navigator_appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,52),BigInteger.prototype.F1=52-dbits,BigInteger.prototype.F2=2*dbits-52;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(n){return BI_RM.charAt(n)}function intAt(s,i){var c=BI_RC[s.charCodeAt(i)];return null==c?-1:c}function bnpCopyTo(r){for(var i=this.t-1;i>=0;--i)r[i]=this[i];r.t=this.t,r.s=this.s}function bnpFromInt(x){this.t=1,this.s=x<0?-1:0,x>0?this[0]=x:x<-1?this[0]=x+this.DV:this.t=0}function nbv(i){var r=nbi();return r.fromInt(i),r}function bnpFromString(s,b){var k;if(16==b)k=4;else if(8==b)k=3;else if(256==b)k=8;else if(2==b)k=1;else if(32==b)k=5;else{if(4!=b)return void this.fromRadix(s,b);k=2}this.t=0,this.s=0;for(var i=s.length,mi=!1,sh=0;--i>=0;){var x=8==k?255&s[i]:intAt(s,i);x<0?"-"==s.charAt(i)&&(mi=!0):(mi=!1,0==sh?this[this.t++]=x:sh+k>this.DB?(this[this.t-1]|=(x&(1<<this.DB-sh)-1)<<sh,this[this.t++]=x>>this.DB-sh):this[this.t-1]|=x<<sh,(sh+=k)>=this.DB&&(sh-=this.DB))}8==k&&0!=(128&s[0])&&(this.s=-1,sh>0&&(this[this.t-1]|=(1<<this.DB-sh)-1<<sh)),this.clamp(),mi&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var c=this.s&this.DM;this.t>0&&this[this.t-1]==c;)--this.t}function bnToString(b){if(this.s<0)return"-"+this.negate().toString(b);var k;if(16==b)k=4;else if(8==b)k=3;else if(2==b)k=1;else if(32==b)k=5;else{if(4!=b)return this.toRadix(b);k=2}var km=(1<<k)-1,d,m=!1,r="",i=this.t,p=this.DB-i*this.DB%k;if(i-- >0)for(p<this.DB&&(d=this[i]>>p)>0&&(m=!0,r=int2char(d));i>=0;)p<k?(d=(this[i]&(1<<p)-1)<<k-p,d|=this[--i]>>(p+=this.DB-k)):(d=this[i]>>(p-=k)&km,p<=0&&(p+=this.DB,--i)),d>0&&(m=!0),m&&(r+=int2char(d));return m?r:"0"}function bnNegate(){var r=nbi();return BigInteger.ZERO.subTo(this,r),r}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(a){var r=this.s-a.s;if(0!=r)return r;var i=this.t;if(0!=(r=i-a.t))return this.s<0?-r:r;for(;--i>=0;)if(0!=(r=this[i]-a[i]))return r;return 0}function nbits(x){var r=1,t;return 0!=(t=x>>>16)&&(x=t,r+=16),0!=(t=x>>8)&&(x=t,r+=8),0!=(t=x>>4)&&(x=t,r+=4),0!=(t=x>>2)&&(x=t,r+=2),0!=(t=x>>1)&&(x=t,r+=1),r}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(n,r){var i;for(i=this.t-1;i>=0;--i)r[i+n]=this[i];for(i=n-1;i>=0;--i)r[i]=0;r.t=this.t+n,r.s=this.s}function bnpDRShiftTo(n,r){for(var i=n;i<this.t;++i)r[i-n]=this[i];r.t=Math.max(this.t-n,0),r.s=this.s}function bnpLShiftTo(n,r){var bs=n%this.DB,cbs=this.DB-bs,bm=(1<<cbs)-1,ds=Math.floor(n/this.DB),c=this.s<<bs&this.DM,i;for(i=this.t-1;i>=0;--i)r[i+ds+1]=this[i]>>cbs|c,c=(this[i]&bm)<<bs;for(i=ds-1;i>=0;--i)r[i]=0;r[ds]=c,r.t=this.t+ds+1,r.s=this.s,r.clamp()}function bnpRShiftTo(n,r){r.s=this.s;var ds=Math.floor(n/this.DB);if(ds>=this.t)r.t=0;else{var bs=n%this.DB,cbs=this.DB-bs,bm=(1<<bs)-1;r[0]=this[ds]>>bs;for(var i=ds+1;i<this.t;++i)r[i-ds-1]|=(this[i]&bm)<<cbs,r[i-ds]=this[i]>>bs;bs>0&&(r[this.t-ds-1]|=(this.s&bm)<<cbs),r.t=this.t-ds,r.clamp()}}function bnpSubTo(a,r){for(var i=0,c=0,m=Math.min(a.t,this.t);i<m;)c+=this[i]-a[i],r[i++]=c&this.DM,c>>=this.DB;if(a.t<this.t){for(c-=a.s;i<this.t;)c+=this[i],r[i++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;i<a.t;)c-=a[i],r[i++]=c&this.DM,c>>=this.DB;c-=a.s}r.s=c<0?-1:0,c<-1?r[i++]=this.DV+c:c>0&&(r[i++]=c),r.t=i,r.clamp()}function bnpMultiplyTo(a,r){var x=this.abs(),y=a.abs(),i=x.t;for(r.t=i+y.t;--i>=0;)r[i]=0;for(i=0;i<y.t;++i)r[i+x.t]=x.am(0,y[i],r,i,0,x.t);r.s=0,r.clamp(),this.s!=a.s&&BigInteger.ZERO.subTo(r,r)}function bnpSquareTo(r){for(var x=this.abs(),i=r.t=2*x.t;--i>=0;)r[i]=0;for(i=0;i<x.t-1;++i){var c=x.am(i,x[i],r,2*i,0,1);(r[i+x.t]+=x.am(i+1,2*x[i],r,2*i+1,c,x.t-i-1))>=x.DV&&(r[i+x.t]-=x.DV,r[i+x.t+1]=1)}r.t>0&&(r[r.t-1]+=x.am(i,x[i],r,2*i,0,1)),r.s=0,r.clamp()}function bnpDivRemTo(m,q,r){var pm=m.abs();if(!(pm.t<=0)){var pt=this.abs();if(pt.t<pm.t)return null!=q&&q.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=nbi());var y=nbi(),ts=this.s,ms=m.s,nsh=this.DB-nbits(pm[pm.t-1]);nsh>0?(pm.lShiftTo(nsh,y),pt.lShiftTo(nsh,r)):(pm.copyTo(y),pt.copyTo(r));var ys=y.t,y0=y[ys-1];if(0!=y0){var yt=y0*(1<<this.F1)+(ys>1?y[ys-2]>>this.F2:0),d1=this.FV/yt,d2=(1<<this.F1)/yt,e=1<<this.F2,i=r.t,j=i-ys,t=null==q?nbi():q;for(y.dlShiftTo(j,t),r.compareTo(t)>=0&&(r[r.t++]=1,r.subTo(t,r)),BigInteger.ONE.dlShiftTo(ys,t),t.subTo(y,y);y.t<ys;)y[y.t++]=0;for(;--j>=0;){var qd=r[--i]==y0?this.DM:Math.floor(r[i]*d1+(r[i-1]+e)*d2);if((r[i]+=y.am(0,qd,r,j,0,ys))<qd)for(y.dlShiftTo(j,t),r.subTo(t,r);r[i]<--qd;)r.subTo(t,r)}null!=q&&(r.drShiftTo(ys,q),ts!=ms&&BigInteger.ZERO.subTo(q,q)),r.t=ys,r.clamp(),nsh>0&&r.rShiftTo(nsh,r),ts<0&&BigInteger.ZERO.subTo(r,r)}}}function bnMod(a){var r=nbi();return this.abs().divRemTo(a,null,r),this.s<0&&r.compareTo(BigInteger.ZERO)>0&&a.subTo(r,r),r}function Classic(m){this.m=m}function cConvert(x){return x.s<0||x.compareTo(this.m)>=0?x.mod(this.m):x}function cRevert(x){return x}function cReduce(x){x.divRemTo(this.m,null,x)}function cMulTo(x,y,r){x.multiplyTo(y,r),this.reduce(r)}function cSqrTo(x,r){x.squareTo(r),this.reduce(r)}function bnpInvDigit(){if(this.t<1)return 0;var x=this[0];if(0==(1&x))return 0;var y=3&x;return(y=(y=(y=(y=y*(2-(15&x)*y)&15)*(2-(255&x)*y)&255)*(2-((65535&x)*y&65535))&65535)*(2-x*y%this.DV)%this.DV)>0?this.DV-y:-y}function Montgomery(m){this.m=m,this.mp=m.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<m.DB-15)-1,this.mt2=2*m.t}function montConvert(x){var r=nbi();return x.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),x.s<0&&r.compareTo(BigInteger.ZERO)>0&&this.m.subTo(r,r),r}function montRevert(x){var r=nbi();return x.copyTo(r),this.reduce(r),r}function montReduce(x){for(;x.t<=this.mt2;)x[x.t++]=0;for(var i=0;i<this.m.t;++i){var j=32767&x[i],u0=j*this.mpl+((j*this.mph+(x[i]>>15)*this.mpl&this.um)<<15)&x.DM;for(x[j=i+this.m.t]+=this.m.am(0,u0,x,i,0,this.m.t);x[j]>=x.DV;)x[j]-=x.DV,x[++j]++}x.clamp(),x.drShiftTo(this.m.t,x),x.compareTo(this.m)>=0&&x.subTo(this.m,x)}function montSqrTo(x,r){x.squareTo(r),this.reduce(r)}function montMulTo(x,y,r){x.multiplyTo(y,r),this.reduce(r)}function bnpIsEven(){return 0==(this.t>0?1&this[0]:this.s)}function bnpExp(e,z){if(e>4294967295||e<1)return BigInteger.ONE;var r=nbi(),r2=nbi(),g=z.convert(this),i=nbits(e)-1;for(g.copyTo(r);--i>=0;)if(z.sqrTo(r,r2),(e&1<<i)>0)z.mulTo(r2,g,r);else{var t=r;r=r2,r2=t}return z.revert(r)}function bnModPowInt(e,m){var z;return z=e<256||m.isEven()?new Classic(m):new Montgomery(m),this.exp(e,z)}function bnClone(){var r=nbi();return this.copyTo(r),r}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(r){return Math.floor(Math.LN2*this.DB/Math.log(r))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(b){if(null==b&&(b=10),0==this.signum()||b<2||b>36)return"0";var cs=this.chunkSize(b),a=Math.pow(b,cs),d=nbv(a),y=nbi(),z=nbi(),r="";for(this.divRemTo(d,y,z);y.signum()>0;)r=(a+z.intValue()).toString(b).substr(1)+r,y.divRemTo(d,y,z);return z.intValue().toString(b)+r}function bnpFromRadix(s,b){this.fromInt(0),null==b&&(b=10);for(var cs=this.chunkSize(b),d=Math.pow(b,cs),mi=!1,j=0,w=0,i=0;i<s.length;++i){var x=intAt(s,i);x<0?"-"==s.charAt(i)&&0==this.signum()&&(mi=!0):(w=b*w+x,++j>=cs&&(this.dMultiply(d),this.dAddOffset(w,0),j=0,w=0))}j>0&&(this.dMultiply(Math.pow(b,j)),this.dAddOffset(w,0)),mi&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(a,b,c){if("number"==typeof b)if(a<2)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(BigInteger.ONE.shiftLeft(a-1),this);else{var x=new Array,t=7&a;x.length=1+(a>>3),b.nextBytes(x),t>0?x[0]&=(1<<t)-1:x[0]=0,this.fromString(x,256)}}function bnToByteArray(){var i=this.t,r=new Array;r[0]=this.s;var p=this.DB-i*this.DB%8,d,k=0;if(i-- >0)for(p<this.DB&&(d=this[i]>>p)!=(this.s&this.DM)>>p&&(r[k++]=d|this.s<<this.DB-p);i>=0;)p<8?(d=(this[i]&(1<<p)-1)<<8-p,d|=this[--i]>>(p+=this.DB-8)):(d=this[i]>>(p-=8)&255,p<=0&&(p+=this.DB,--i)),0!=(128&d)&&(d|=-256),0==k&&(128&this.s)!=(128&d)&&++k,(k>0||d!=this.s)&&(r[k++]=d);return r}function bnEquals(a){return 0==this.compareTo(a)}function bnMin(a){return this.compareTo(a)<0?this:a}function bnMax(a){return this.compareTo(a)>0?this:a}function bnpBitwiseTo(a,op,r){var i,f,m=Math.min(a.t,this.t);for(i=0;i<m;++i)r[i]=op(this[i],a[i]);if(a.t<this.t){for(f=a.s&this.DM,i=m;i<this.t;++i)r[i]=op(this[i],f);r.t=this.t}else{for(f=this.s&this.DM,i=m;i<a.t;++i)r[i]=op(f,a[i]);r.t=a.t}r.s=op(this.s,a.s),r.clamp()}function op_and(x,y){return x&y}function bnAnd(a){var r=nbi();return this.bitwiseTo(a,op_and,r),r}function op_or(x,y){return x|y}function bnOr(a){var r=nbi();return this.bitwiseTo(a,op_or,r),r}function op_xor(x,y){return x^y}function bnXor(a){var r=nbi();return this.bitwiseTo(a,op_xor,r),r}function op_andnot(x,y){return x&~y}function bnAndNot(a){var r=nbi();return this.bitwiseTo(a,op_andnot,r),r}function bnNot(){for(var r=nbi(),i=0;i<this.t;++i)r[i]=this.DM&~this[i];return r.t=this.t,r.s=~this.s,r}function bnShiftLeft(n){var r=nbi();return n<0?this.rShiftTo(-n,r):this.lShiftTo(n,r),r}function bnShiftRight(n){var r=nbi();return n<0?this.lShiftTo(-n,r):this.rShiftTo(n,r),r}function lbit(x){if(0==x)return-1;var r=0;return 0==(65535&x)&&(x>>=16,r+=16),0==(255&x)&&(x>>=8,r+=8),0==(15&x)&&(x>>=4,r+=4),0==(3&x)&&(x>>=2,r+=2),0==(1&x)&&++r,r}function bnGetLowestSetBit(){for(var i=0;i<this.t;++i)if(0!=this[i])return i*this.DB+lbit(this[i]);return this.s<0?this.t*this.DB:-1}function cbit(x){for(var r=0;0!=x;)x&=x-1,++r;return r}function bnBitCount(){for(var r=0,x=this.s&this.DM,i=0;i<this.t;++i)r+=cbit(this[i]^x);return r}function bnTestBit(n){var j=Math.floor(n/this.DB);return j>=this.t?0!=this.s:0!=(this[j]&1<<n%this.DB)}function bnpChangeBit(n,op){var r=BigInteger.ONE.shiftLeft(n);return this.bitwiseTo(r,op,r),r}function bnSetBit(n){return this.changeBit(n,op_or)}function bnClearBit(n){return this.changeBit(n,op_andnot)}function bnFlipBit(n){return this.changeBit(n,op_xor)}function bnpAddTo(a,r){for(var i=0,c=0,m=Math.min(a.t,this.t);i<m;)c+=this[i]+a[i],r[i++]=c&this.DM,c>>=this.DB;if(a.t<this.t){for(c+=a.s;i<this.t;)c+=this[i],r[i++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;i<a.t;)c+=a[i],r[i++]=c&this.DM,c>>=this.DB;c+=a.s}r.s=c<0?-1:0,c>0?r[i++]=c:c<-1&&(r[i++]=this.DV+c),r.t=i,r.clamp()}function bnAdd(a){var r=nbi();return this.addTo(a,r),r}function bnSubtract(a){var r=nbi();return this.subTo(a,r),r}function bnMultiply(a){var r=nbi();return this.multiplyTo(a,r),r}function bnSquare(){var r=nbi();return this.squareTo(r),r}function bnDivide(a){var r=nbi();return this.divRemTo(a,r,null),r}function bnRemainder(a){var r=nbi();return this.divRemTo(a,null,r),r}function bnDivideAndRemainder(a){var q=nbi(),r=nbi();return this.divRemTo(a,q,r),new Array(q,r)}function bnpDMultiply(n){this[this.t]=this.am(0,n-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(n,w){if(0!=n){for(;this.t<=w;)this[this.t++]=0;for(this[w]+=n;this[w]>=this.DV;)this[w]-=this.DV,++w>=this.t&&(this[this.t++]=0),++this[w]}}function NullExp(){}function nNop(x){return x}function nMulTo(x,y,r){x.multiplyTo(y,r)}function nSqrTo(x,r){x.squareTo(r)}function bnPow(e){return this.exp(e,new NullExp)}function bnpMultiplyLowerTo(a,n,r){var i=Math.min(this.t+a.t,n),j;for(r.s=0,r.t=i;i>0;)r[--i]=0;for(j=r.t-this.t;i<j;++i)r[i+this.t]=this.am(0,a[i],r,i,0,this.t);for(j=Math.min(a.t,n);i<j;++i)this.am(0,a[i],r,i,0,n-i);r.clamp()}function bnpMultiplyUpperTo(a,n,r){--n;var i=r.t=this.t+a.t-n;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(n-this.t,0);i<a.t;++i)r[this.t+i-n]=this.am(n-i,a[i],r,0,0,this.t+i-n);r.clamp(),r.drShiftTo(1,r)}function Barrett(m){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*m.t,this.r2),this.mu=this.r2.divide(m),this.m=m}function barrettConvert(x){if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);if(x.compareTo(this.m)<0)return x;var r=nbi();return x.copyTo(r),this.reduce(r),r}function barrettRevert(x){return x}function barrettReduce(x){for(x.drShiftTo(this.m.t-1,this.r2),x.t>this.m.t+1&&(x.t=this.m.t+1,x.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);x.compareTo(this.r2)<0;)x.dAddOffset(1,this.m.t+1);for(x.subTo(this.r2,x);x.compareTo(this.m)>=0;)x.subTo(this.m,x)}function barrettSqrTo(x,r){x.squareTo(r),this.reduce(r)}function barrettMulTo(x,y,r){x.multiplyTo(y,r),this.reduce(r)}function bnModPow(e,m){var i=e.bitLength(),k,r=nbv(1),z;if(i<=0)return r;k=i<18?1:i<48?3:i<144?4:i<768?5:6,z=i<8?new Classic(m):m.isEven()?new Barrett(m):new Montgomery(m);var g=new Array,n=3,k1=k-1,km=(1<<k)-1;if(g[1]=z.convert(this),k>1){var g2=nbi();for(z.sqrTo(g[1],g2);n<=km;)g[n]=nbi(),z.mulTo(g2,g[n-2],g[n]),n+=2}var j=e.t-1,w,is1=!0,r2=nbi(),t;for(i=nbits(e[j])-1;j>=0;){for(i>=k1?w=e[j]>>i-k1&km:(w=(e[j]&(1<<i+1)-1)<<k1-i,j>0&&(w|=e[j-1]>>this.DB+i-k1)),n=k;0==(1&w);)w>>=1,--n;if((i-=n)<0&&(i+=this.DB,--j),is1)g[w].copyTo(r),is1=!1;else{for(;n>1;)z.sqrTo(r,r2),z.sqrTo(r2,r),n-=2;n>0?z.sqrTo(r,r2):(t=r,r=r2,r2=t),z.mulTo(r2,g[w],r)}for(;j>=0&&0==(e[j]&1<<i);)z.sqrTo(r,r2),t=r,r=r2,r2=t,--i<0&&(i=this.DB-1,--j)}return z.revert(r)}function bnGCD(a){var x=this.s<0?this.negate():this.clone(),y=a.s<0?a.negate():a.clone();if(x.compareTo(y)<0){var t=x;x=y,y=t}var i=x.getLowestSetBit(),g=y.getLowestSetBit();if(g<0)return x;for(i<g&&(g=i),g>0&&(x.rShiftTo(g,x),y.rShiftTo(g,y));x.signum()>0;)(i=x.getLowestSetBit())>0&&x.rShiftTo(i,x),(i=y.getLowestSetBit())>0&&y.rShiftTo(i,y),x.compareTo(y)>=0?(x.subTo(y,x),x.rShiftTo(1,x)):(y.subTo(x,y),y.rShiftTo(1,y));return g>0&&y.lShiftTo(g,y),y}function bnpModInt(n){if(n<=0)return 0;var d=this.DV%n,r=this.s<0?n-1:0;if(this.t>0)if(0==d)r=this[0]%n;else for(var i=this.t-1;i>=0;--i)r=(d*r+this[i])%n;return r}function bnModInverse(m){var ac=m.isEven();if(this.isEven()&&ac||0==m.signum())return BigInteger.ZERO;for(var u=m.clone(),v=this.clone(),a=nbv(1),b=nbv(0),c=nbv(0),d=nbv(1);0!=u.signum();){for(;u.isEven();)u.rShiftTo(1,u),ac?(a.isEven()&&b.isEven()||(a.addTo(this,a),b.subTo(m,b)),a.rShiftTo(1,a)):b.isEven()||b.subTo(m,b),b.rShiftTo(1,b);for(;v.isEven();)v.rShiftTo(1,v),ac?(c.isEven()&&d.isEven()||(c.addTo(this,c),d.subTo(m,d)),c.rShiftTo(1,c)):d.isEven()||d.subTo(m,d),d.rShiftTo(1,d);u.compareTo(v)>=0?(u.subTo(v,u),ac&&a.subTo(c,a),b.subTo(d,b)):(v.subTo(u,v),ac&&c.subTo(a,c),d.subTo(b,d))}return 0!=v.compareTo(BigInteger.ONE)?BigInteger.ZERO:d.compareTo(m)>=0?d.subtract(m):d.signum()<0?(d.addTo(m,d),d.signum()<0?d.add(m):d):d}Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(t){var i,x=this.abs();if(1==x.t&&x[0]<=lowprimes[lowprimes.length-1]){for(i=0;i<lowprimes.length;++i)if(x[0]==lowprimes[i])return!0;return!1}if(x.isEven())return!1;for(i=1;i<lowprimes.length;){for(var m=lowprimes[i],j=i+1;j<lowprimes.length&&m<lplim;)m*=lowprimes[j++];for(m=x.modInt(m);i<j;)if(m%lowprimes[i++]==0)return!1}return x.millerRabin(t)}function bnpMillerRabin(t){var n1=this.subtract(BigInteger.ONE),k=n1.getLowestSetBit();if(k<=0)return!1;var r=n1.shiftRight(k);(t=t+1>>1)>lowprimes.length&&(t=lowprimes.length);for(var a=nbi(),i=0;i<t;++i){a.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var y=a.modPow(r,this);if(0!=y.compareTo(BigInteger.ONE)&&0!=y.compareTo(n1)){for(var j=1;j++<k&&0!=y.compareTo(n1);)if(0==(y=y.modPowInt(2,this)).compareTo(BigInteger.ONE))return!1;if(0!=y.compareTo(n1))return!1}}return!0}BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare;var Int128=BigInteger;Int128.prototype.IsNegative=function(){return-1==this.compareTo(Int128.ZERO)},Int128.op_Equality=function(val1,val2){return 0==val1.compareTo(val2)},Int128.op_Inequality=function(val1,val2){return 0!=val1.compareTo(val2)},Int128.op_GreaterThan=function(val1,val2){return val1.compareTo(val2)>0},Int128.op_LessThan=function(val1,val2){return val1.compareTo(val2)<0},Int128.op_Addition=function(lhs,rhs){return new Int128(lhs).add(new Int128(rhs))},Int128.op_Subtraction=function(lhs,rhs){return new Int128(lhs).subtract(new Int128(rhs))},Int128.Int128Mul=function(lhs,rhs){return new Int128(lhs).multiply(new Int128(rhs))},Int128.op_Division=function(lhs,rhs){return lhs.divide(rhs)},Int128.prototype.ToDouble=function(){return parseFloat(this.toString())};var Inherit=function(ce,ce2){var p;if(void 0===Object.getOwnPropertyNames){for(p in ce2.prototype)void 0!==ce.prototype[p]&&ce.prototype[p]!=Object.prototype[p]||(ce.prototype[p]=ce2.prototype[p]);for(p in ce2)void 0===ce[p]&&(ce[p]=ce2[p]);ce.$baseCtor=ce2}else{for(var props=Object.getOwnPropertyNames(ce2.prototype),i=0;i<props.length;i++)void 0===Object.getOwnPropertyDescriptor(ce.prototype,props[i])&&Object.defineProperty(ce.prototype,props[i],Object.getOwnPropertyDescriptor(ce2.prototype,props[i]));for(p in ce2)void 0===ce[p]&&(ce[p]=ce2[p]);ce.$baseCtor=ce2}};ClipperLib.Path=function(){return[]},ClipperLib.Paths=function(){return[]},ClipperLib.DoublePoint=function(){var a=arguments;this.X=0,this.Y=0,1==a.length?(this.X=a[0].X,this.Y=a[0].Y):2==a.length&&(this.X=a[0],this.Y=a[1])},ClipperLib.DoublePoint0=function(){this.X=0,this.Y=0},ClipperLib.DoublePoint1=function(dp){this.X=dp.X,this.Y=dp.Y},ClipperLib.DoublePoint2=function(x,y){this.X=x,this.Y=y},ClipperLib.PolyNode=function(){this.m_Parent=null,this.m_polygon=new ClipperLib.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},ClipperLib.PolyNode.prototype.IsHoleNode=function(){for(var result=!0,node=this.m_Parent;null!==node;)result=!result,node=node.m_Parent;return result},ClipperLib.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},ClipperLib.PolyNode.prototype.Contour=function(){return this.m_polygon},ClipperLib.PolyNode.prototype.AddChild=function(Child){var cnt=this.m_Childs.length;this.m_Childs.push(Child),Child.m_Parent=this,Child.m_Index=cnt},ClipperLib.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},ClipperLib.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},ClipperLib.PolyNode.prototype.Childs=function(){return this.m_Childs},ClipperLib.PolyNode.prototype.Parent=function(){return this.m_Parent},ClipperLib.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},ClipperLib.PolyTree=function(){this.m_AllPolys=[],ClipperLib.PolyNode.call(this)},ClipperLib.PolyTree.prototype.Clear=function(){for(var i=0,ilen=this.m_AllPolys.length;i<ilen;i++)this.m_AllPolys[i]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},ClipperLib.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},ClipperLib.PolyTree.prototype.Total=function(){var result=this.m_AllPolys.length;return result>0&&this.m_Childs[0]!=this.m_AllPolys[0]&&result--,result},Inherit(ClipperLib.PolyTree,ClipperLib.PolyNode),ClipperLib.Math_Abs_Int64=ClipperLib.Math_Abs_Int32=ClipperLib.Math_Abs_Double=function(a){return Math.abs(a)},ClipperLib.Math_Max_Int32_Int32=function(a,b){return Math.max(a,b)},browser.msie||browser.opera||browser.safari?ClipperLib.Cast_Int32=function(a){return 0|a}:ClipperLib.Cast_Int32=function(a){return~~a},browser.chrome?ClipperLib.Cast_Int64=function(a){return a<-2147483648||a>2147483647?a<0?Math.ceil(a):Math.floor(a):~~a}:browser.firefox&&"function"==typeof Number.toInteger?ClipperLib.Cast_Int64=function(a){return Number.toInteger(a)}:browser.msie7||browser.msie8?ClipperLib.Cast_Int64=function(a){return parseInt(a,10)}:browser.msie?ClipperLib.Cast_Int64=function(a){return a<-2147483648||a>2147483647?a<0?Math.ceil(a):Math.floor(a):0|a}:ClipperLib.Cast_Int64=function(a){return a<0?Math.ceil(a):Math.floor(a)},ClipperLib.Clear=function(a){a.length=0},ClipperLib.PI=3.141592653589793,ClipperLib.PI2=6.283185307179586,ClipperLib.IntPoint=function(){var a=arguments,alen=a.length;if(this.X=0,this.Y=0,ClipperLib.use_xyz)if(this.Z=0,3==alen)this.X=a[0],this.Y=a[1],this.Z=a[2];else if(2==alen)this.X=a[0],this.Y=a[1],this.Z=0;else if(1==alen)if(a[0]instanceof ClipperLib.DoublePoint){var dp=a[0];this.X=ClipperLib.Clipper.Round(dp.X),this.Y=ClipperLib.Clipper.Round(dp.Y),this.Z=0}else{var pt;void 0===(pt=a[0]).Z&&(pt.Z=0),this.X=pt.X,this.Y=pt.Y,this.Z=pt.Z}else this.X=0,this.Y=0,this.Z=0;else if(2==alen)this.X=a[0],this.Y=a[1];else if(1==alen)if(a[0]instanceof ClipperLib.DoublePoint){var dp=a[0];this.X=ClipperLib.Clipper.Round(dp.X),this.Y=ClipperLib.Clipper.Round(dp.Y)}else{var pt=a[0];this.X=pt.X,this.Y=pt.Y}else this.X=0,this.Y=0},ClipperLib.IntPoint.op_Equality=function(a,b){return a.X==b.X&&a.Y==b.Y},ClipperLib.IntPoint.op_Inequality=function(a,b){return a.X!=b.X||a.Y!=b.Y},ClipperLib.use_xyz?(ClipperLib.IntPoint0=function(){this.X=0,this.Y=0,this.Z=0},ClipperLib.IntPoint1=function(pt){this.X=pt.X,this.Y=pt.Y,this.Z=pt.Z},ClipperLib.IntPoint1dp=function(dp){this.X=ClipperLib.Clipper.Round(dp.X),this.Y=ClipperLib.Clipper.Round(dp.Y),this.Z=0},ClipperLib.IntPoint2=function(x,y){this.X=x,this.Y=y,this.Z=0},ClipperLib.IntPoint3=function(x,y,z){this.X=x,this.Y=y,this.Z=z}):(ClipperLib.IntPoint0=function(){this.X=0,this.Y=0},ClipperLib.IntPoint1=function(pt){this.X=pt.X,this.Y=pt.Y},ClipperLib.IntPoint1dp=function(dp){this.X=ClipperLib.Clipper.Round(dp.X),this.Y=ClipperLib.Clipper.Round(dp.Y)},ClipperLib.IntPoint2=function(x,y){this.X=x,this.Y=y}),ClipperLib.IntRect=function(){var a=arguments,alen=a.length;4==alen?(this.left=a[0],this.top=a[1],this.right=a[2],this.bottom=a[3]):1==alen?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0)},ClipperLib.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},ClipperLib.IntRect1=function(ir){this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom},ClipperLib.IntRect4=function(l,t,r,b){this.left=l,this.top=t,this.right=r,this.bottom=b},ClipperLib.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},ClipperLib.PolyType={ptSubject:0,ptClip:1},ClipperLib.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},ClipperLib.JoinType={jtSquare:0,jtRound:1,jtMiter:2},ClipperLib.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},ClipperLib.EdgeSide={esLeft:0,esRight:1},ClipperLib.Direction={dRightToLeft:0,dLeftToRight:1},ClipperLib.TEdge=function(){this.Bot=new ClipperLib.IntPoint,this.Curr=new ClipperLib.IntPoint,this.Top=new ClipperLib.IntPoint,this.Delta=new ClipperLib.IntPoint,this.Dx=0,this.PolyTyp=ClipperLib.PolyType.ptSubject,this.Side=ClipperLib.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},ClipperLib.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new ClipperLib.IntPoint},ClipperLib.MyIntersectNodeSort=function(){},ClipperLib.MyIntersectNodeSort.Compare=function(node1,node2){var i=node2.Pt.Y-node1.Pt.Y;return i>0?1:i<0?-1:0},ClipperLib.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},ClipperLib.Scanbeam=function(){this.Y=0,this.Next=null},ClipperLib.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},ClipperLib.OutPt=function(){this.Idx=0,this.Pt=new ClipperLib.IntPoint,this.Next=null,this.Prev=null},ClipperLib.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new ClipperLib.IntPoint},ClipperLib.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_MinimaList=null,this.m_CurrentLM=null,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},ClipperLib.ClipperBase.horizontal=-9007199254740992,ClipperLib.ClipperBase.Skip=-2,ClipperLib.ClipperBase.Unassigned=-1,ClipperLib.ClipperBase.tolerance=1e-20,ClipperLib.ClipperBase.loRange=47453132,ClipperLib.ClipperBase.hiRange=0xfffffffffffff,ClipperLib.ClipperBase.near_zero=function(val){return val>-ClipperLib.ClipperBase.tolerance&&val<ClipperLib.ClipperBase.tolerance},ClipperLib.ClipperBase.IsHorizontal=function(e){return 0===e.Delta.Y},ClipperLib.ClipperBase.prototype.PointIsVertex=function(pt,pp){var pp2=pp;do{if(ClipperLib.IntPoint.op_Equality(pp2.Pt,pt))return!0;pp2=pp2.Next}while(pp2!=pp);return!1},ClipperLib.ClipperBase.prototype.PointOnLineSegment=function(pt,linePt1,linePt2,UseFullRange){return UseFullRange?pt.X==linePt1.X&&pt.Y==linePt1.Y||pt.X==linePt2.X&&pt.Y==linePt2.Y||pt.X>linePt1.X==pt.X<linePt2.X&&pt.Y>linePt1.Y==pt.Y<linePt2.Y&&Int128.op_Equality(Int128.Int128Mul(pt.X-linePt1.X,linePt2.Y-linePt1.Y),Int128.Int128Mul(linePt2.X-linePt1.X,pt.Y-linePt1.Y)):pt.X==linePt1.X&&pt.Y==linePt1.Y||pt.X==linePt2.X&&pt.Y==linePt2.Y||pt.X>linePt1.X==pt.X<linePt2.X&&pt.Y>linePt1.Y==pt.Y<linePt2.Y&&(pt.X-linePt1.X)*(linePt2.Y-linePt1.Y)==(linePt2.X-linePt1.X)*(pt.Y-linePt1.Y)},ClipperLib.ClipperBase.prototype.PointOnPolygon=function(pt,pp,UseFullRange){for(var pp2=pp;;){if(this.PointOnLineSegment(pt,pp2.Pt,pp2.Next.Pt,UseFullRange))return!0;if((pp2=pp2.Next)==pp)break}return!1},ClipperLib.ClipperBase.prototype.SlopesEqual=ClipperLib.ClipperBase.SlopesEqual=function(){var a=arguments,alen=a.length,e1,e2,pt1,pt2,pt3,pt4,UseFullRange;return 3==alen?(e1=a[0],e2=a[1],(UseFullRange=a[2])?Int128.op_Equality(Int128.Int128Mul(e1.Delta.Y,e2.Delta.X),Int128.Int128Mul(e1.Delta.X,e2.Delta.Y)):ClipperLib.Cast_Int64(e1.Delta.Y*e2.Delta.X)==ClipperLib.Cast_Int64(e1.Delta.X*e2.Delta.Y)):4==alen?(pt1=a[0],pt2=a[1],pt3=a[2],(UseFullRange=a[3])?Int128.op_Equality(Int128.Int128Mul(pt1.Y-pt2.Y,pt2.X-pt3.X),Int128.Int128Mul(pt1.X-pt2.X,pt2.Y-pt3.Y)):ClipperLib.Cast_Int64((pt1.Y-pt2.Y)*(pt2.X-pt3.X))-ClipperLib.Cast_Int64((pt1.X-pt2.X)*(pt2.Y-pt3.Y))==0):(pt1=a[0],pt2=a[1],pt3=a[2],pt4=a[3],(UseFullRange=a[4])?Int128.op_Equality(Int128.Int128Mul(pt1.Y-pt2.Y,pt3.X-pt4.X),Int128.Int128Mul(pt1.X-pt2.X,pt3.Y-pt4.Y)):ClipperLib.Cast_Int64((pt1.Y-pt2.Y)*(pt3.X-pt4.X))-ClipperLib.Cast_Int64((pt1.X-pt2.X)*(pt3.Y-pt4.Y))==0)},ClipperLib.ClipperBase.SlopesEqual3=function(e1,e2,UseFullRange){return UseFullRange?Int128.op_Equality(Int128.Int128Mul(e1.Delta.Y,e2.Delta.X),Int128.Int128Mul(e1.Delta.X,e2.Delta.Y)):ClipperLib.Cast_Int64(e1.Delta.Y*e2.Delta.X)==ClipperLib.Cast_Int64(e1.Delta.X*e2.Delta.Y)},ClipperLib.ClipperBase.SlopesEqual4=function(pt1,pt2,pt3,UseFullRange){return UseFullRange?Int128.op_Equality(Int128.Int128Mul(pt1.Y-pt2.Y,pt2.X-pt3.X),Int128.Int128Mul(pt1.X-pt2.X,pt2.Y-pt3.Y)):ClipperLib.Cast_Int64((pt1.Y-pt2.Y)*(pt2.X-pt3.X))-ClipperLib.Cast_Int64((pt1.X-pt2.X)*(pt2.Y-pt3.Y))==0},ClipperLib.ClipperBase.SlopesEqual5=function(pt1,pt2,pt3,pt4,UseFullRange){return UseFullRange?Int128.op_Equality(Int128.Int128Mul(pt1.Y-pt2.Y,pt3.X-pt4.X),Int128.Int128Mul(pt1.X-pt2.X,pt3.Y-pt4.Y)):ClipperLib.Cast_Int64((pt1.Y-pt2.Y)*(pt3.X-pt4.X))-ClipperLib.Cast_Int64((pt1.X-pt2.X)*(pt3.Y-pt4.Y))==0},ClipperLib.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var i=0,ilen=this.m_edges.length;i<ilen;++i){for(var j=0,jlen=this.m_edges[i].length;j<jlen;++j)this.m_edges[i][j]=null;ClipperLib.Clear(this.m_edges[i])}ClipperLib.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},ClipperLib.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var tmpLm=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=tmpLm}this.m_CurrentLM=null},ClipperLib.ClipperBase.prototype.RangeTest=function(Pt,useFullRange){useFullRange.Value?(Pt.X>ClipperLib.ClipperBase.hiRange||Pt.Y>ClipperLib.ClipperBase.hiRange||-Pt.X>ClipperLib.ClipperBase.hiRange||-Pt.Y>ClipperLib.ClipperBase.hiRange)&&ClipperLib.Error("Coordinate outside allowed range in RangeTest()."):(Pt.X>ClipperLib.ClipperBase.loRange||Pt.Y>ClipperLib.ClipperBase.loRange||-Pt.X>ClipperLib.ClipperBase.loRange||-Pt.Y>ClipperLib.ClipperBase.loRange)&&(useFullRange.Value=!0,this.RangeTest(Pt,useFullRange))},ClipperLib.ClipperBase.prototype.InitEdge=function(e,eNext,ePrev,pt){e.Next=eNext,e.Prev=ePrev,e.Curr.X=pt.X,e.Curr.Y=pt.Y,ClipperLib.use_xyz&&(e.Curr.Z=pt.Z),e.OutIdx=-1},ClipperLib.ClipperBase.prototype.InitEdge2=function(e,polyType){e.Curr.Y>=e.Next.Curr.Y?(e.Bot.X=e.Curr.X,e.Bot.Y=e.Curr.Y,ClipperLib.use_xyz&&(e.Bot.Z=e.Curr.Z),e.Top.X=e.Next.Curr.X,e.Top.Y=e.Next.Curr.Y,ClipperLib.use_xyz&&(e.Top.Z=e.Next.Curr.Z)):(e.Top.X=e.Curr.X,e.Top.Y=e.Curr.Y,ClipperLib.use_xyz&&(e.Top.Z=e.Curr.Z),e.Bot.X=e.Next.Curr.X,e.Bot.Y=e.Next.Curr.Y,ClipperLib.use_xyz&&(e.Bot.Z=e.Next.Curr.Z)),this.SetDx(e),e.PolyTyp=polyType},ClipperLib.ClipperBase.prototype.FindNextLocMin=function(E){for(var E2;;){for(;ClipperLib.IntPoint.op_Inequality(E.Bot,E.Prev.Bot)||ClipperLib.IntPoint.op_Equality(E.Curr,E.Top);)E=E.Next;if(E.Dx!=ClipperLib.ClipperBase.horizontal&&E.Prev.Dx!=ClipperLib.ClipperBase.horizontal)break;for(;E.Prev.Dx==ClipperLib.ClipperBase.horizontal;)E=E.Prev;for(E2=E;E.Dx==ClipperLib.ClipperBase.horizontal;)E=E.Next;if(E.Top.Y!=E.Prev.Bot.Y){E2.Prev.Bot.X<E.Bot.X&&(E=E2);break}}return E},ClipperLib.ClipperBase.prototype.ProcessBound=function(E,LeftBoundIsForward){var EStart,Result=E,Horz;if(Result.OutIdx==ClipperLib.ClipperBase.Skip){if(E=Result,LeftBoundIsForward){for(;E.Top.Y==E.Next.Bot.Y;)E=E.Next;for(;E!=Result&&E.Dx==ClipperLib.ClipperBase.horizontal;)E=E.Prev}else{for(;E.Top.Y==E.Prev.Bot.Y;)E=E.Prev;for(;E!=Result&&E.Dx==ClipperLib.ClipperBase.horizontal;)E=E.Next}if(E==Result)Result=LeftBoundIsForward?E.Next:E.Prev;else{E=LeftBoundIsForward?Result.Next:Result.Prev;var locMin=new ClipperLib.LocalMinima;locMin.Next=null,locMin.Y=E.Bot.Y,locMin.LeftBound=null,locMin.RightBound=E,E.WindDelta=0,Result=this.ProcessBound(E,LeftBoundIsForward),this.InsertLocalMinima(locMin)}return Result}if(E.Dx==ClipperLib.ClipperBase.horizontal&&(EStart=LeftBoundIsForward?E.Prev:E.Next).OutIdx!=ClipperLib.ClipperBase.Skip&&(EStart.Dx==ClipperLib.ClipperBase.horizontal?EStart.Bot.X!=E.Bot.X&&EStart.Top.X!=E.Bot.X&&this.ReverseHorizontal(E):EStart.Bot.X!=E.Bot.X&&this.ReverseHorizontal(E)),EStart=E,LeftBoundIsForward){for(;Result.Top.Y==Result.Next.Bot.Y&&Result.Next.OutIdx!=ClipperLib.ClipperBase.Skip;)Result=Result.Next;if(Result.Dx==ClipperLib.ClipperBase.horizontal&&Result.Next.OutIdx!=ClipperLib.ClipperBase.Skip){for(Horz=Result;Horz.Prev.Dx==ClipperLib.ClipperBase.horizontal;)Horz=Horz.Prev;Horz.Prev.Top.X==Result.Next.Top.X?LeftBoundIsForward||(Result=Horz.Prev):Horz.Prev.Top.X>Result.Next.Top.X&&(Result=Horz.Prev)}for(;E!=Result;)E.NextInLML=E.Next,E.Dx==ClipperLib.ClipperBase.horizontal&&E!=EStart&&E.Bot.X!=E.Prev.Top.X&&this.ReverseHorizontal(E),E=E.Next;E.Dx==ClipperLib.ClipperBase.horizontal&&E!=EStart&&E.Bot.X!=E.Prev.Top.X&&this.ReverseHorizontal(E),Result=Result.Next}else{for(;Result.Top.Y==Result.Prev.Bot.Y&&Result.Prev.OutIdx!=ClipperLib.ClipperBase.Skip;)Result=Result.Prev;if(Result.Dx==ClipperLib.ClipperBase.horizontal&&Result.Prev.OutIdx!=ClipperLib.ClipperBase.Skip){for(Horz=Result;Horz.Next.Dx==ClipperLib.ClipperBase.horizontal;)Horz=Horz.Next;Horz.Next.Top.X==Result.Prev.Top.X?LeftBoundIsForward||(Result=Horz.Next):Horz.Next.Top.X>Result.Prev.Top.X&&(Result=Horz.Next)}for(;E!=Result;)E.NextInLML=E.Prev,E.Dx==ClipperLib.ClipperBase.horizontal&&E!=EStart&&E.Bot.X!=E.Next.Top.X&&this.ReverseHorizontal(E),E=E.Prev;E.Dx==ClipperLib.ClipperBase.horizontal&&E!=EStart&&E.Bot.X!=E.Next.Top.X&&this.ReverseHorizontal(E),Result=Result.Prev}return Result},ClipperLib.ClipperBase.prototype.AddPath=function(pg,polyType,Closed){ClipperLib.use_lines?Closed||polyType!=ClipperLib.PolyType.ptClip||ClipperLib.Error("AddPath: Open paths must be subject."):Closed||ClipperLib.Error("AddPath: Open paths have been disabled.");var highI=pg.length-1;if(Closed)for(;highI>0&&ClipperLib.IntPoint.op_Equality(pg[highI],pg[0]);)--highI;for(;highI>0&&ClipperLib.IntPoint.op_Equality(pg[highI],pg[highI-1]);)--highI;if(Closed&&highI<2||!Closed&&highI<1)return!1;for(var edges=new Array,i=0;i<=highI;i++)edges.push(new ClipperLib.TEdge);var IsFlat=!0;edges[1].Curr.X=pg[1].X,edges[1].Curr.Y=pg[1].Y,ClipperLib.use_xyz&&(edges[1].Curr.Z=pg[1].Z);var $1={Value:this.m_UseFullRange};this.RangeTest(pg[0],$1),this.m_UseFullRange=$1.Value,$1.Value=this.m_UseFullRange,this.RangeTest(pg[highI],$1),this.m_UseFullRange=$1.Value,this.InitEdge(edges[0],edges[1],edges[highI],pg[0]),this.InitEdge(edges[highI],edges[0],edges[highI-1],pg[highI]);for(var i=highI-1;i>=1;--i)$1.Value=this.m_UseFullRange,this.RangeTest(pg[i],$1),this.m_UseFullRange=$1.Value,this.InitEdge(edges[i],edges[i+1],edges[i-1],pg[i]);for(var eStart=edges[0],E=eStart,eLoopStop=eStart,leftBoundIsForward;;)if(E.Curr!=E.Next.Curr||!Closed&&E.Next==eStart){if(E.Prev==E.Next)break;if(!Closed||!ClipperLib.ClipperBase.SlopesEqual(E.Prev.Curr,E.Curr,E.Next.Curr,this.m_UseFullRange)||this.PreserveCollinear&&this.Pt2IsBetweenPt1AndPt3(E.Prev.Curr,E.Curr,E.Next.Curr)){if((E=E.Next)==eLoopStop||!Closed&&E.Next==eStart)break}else E==eStart&&(eStart=E.Next),eLoopStop=E=(E=this.RemoveEdge(E)).Prev}else{if(E==E.Next)break;E==eStart&&(eStart=E.Next),eLoopStop=E=this.RemoveEdge(E)}if(!Closed&&E==E.Next||Closed&&E.Prev==E.Next)return!1;Closed||(this.m_HasOpenPaths=!0,eStart.Prev.OutIdx=ClipperLib.ClipperBase.Skip),E=eStart;do{this.InitEdge2(E,polyType),E=E.Next,IsFlat&&E.Curr.Y!=eStart.Curr.Y&&(IsFlat=!1)}while(E!=eStart);if(IsFlat){if(Closed)return!1;var locMin;for(E.Prev.OutIdx=ClipperLib.ClipperBase.Skip,E.Prev.Bot.X<E.Prev.Top.X&&this.ReverseHorizontal(E.Prev),(locMin=new ClipperLib.LocalMinima).Next=null,locMin.Y=E.Bot.Y,locMin.LeftBound=null,locMin.RightBound=E,locMin.RightBound.Side=ClipperLib.EdgeSide.esRight,locMin.RightBound.WindDelta=0;E.Next.OutIdx!=ClipperLib.ClipperBase.Skip;)E.NextInLML=E.Next,E.Bot.X!=E.Prev.Top.X&&this.ReverseHorizontal(E),E=E.Next;return this.InsertLocalMinima(locMin),this.m_edges.push(edges),!0}this.m_edges.push(edges);var EMin=null;for(ClipperLib.IntPoint.op_Equality(E.Prev.Bot,E.Prev.Top)&&(E=E.Next);(E=this.FindNextLocMin(E))!=EMin;){var locMin;null==EMin&&(EMin=E),(locMin=new ClipperLib.LocalMinima).Next=null,locMin.Y=E.Bot.Y,E.Dx<E.Prev.Dx?(locMin.LeftBound=E.Prev,locMin.RightBound=E,leftBoundIsForward=!1):(locMin.LeftBound=E,locMin.RightBound=E.Prev,leftBoundIsForward=!0),locMin.LeftBound.Side=ClipperLib.EdgeSide.esLeft,locMin.RightBound.Side=ClipperLib.EdgeSide.esRight,Closed?locMin.LeftBound.Next==locMin.RightBound?locMin.LeftBound.WindDelta=-1:locMin.LeftBound.WindDelta=1:locMin.LeftBound.WindDelta=0,locMin.RightBound.WindDelta=-locMin.LeftBound.WindDelta,(E=this.ProcessBound(locMin.LeftBound,leftBoundIsForward)).OutIdx==ClipperLib.ClipperBase.Skip&&(E=this.ProcessBound(E,leftBoundIsForward));var E2=this.ProcessBound(locMin.RightBound,!leftBoundIsForward);E2.OutIdx==ClipperLib.ClipperBase.Skip&&(E2=this.ProcessBound(E2,!leftBoundIsForward)),locMin.LeftBound.OutIdx==ClipperLib.ClipperBase.Skip?locMin.LeftBound=null:locMin.RightBound.OutIdx==ClipperLib.ClipperBase.Skip&&(locMin.RightBound=null),this.InsertLocalMinima(locMin),leftBoundIsForward||(E=E2)}return!0},ClipperLib.ClipperBase.prototype.AddPaths=function(ppg,polyType,closed){for(var result=!1,i=0,ilen=ppg.length;i<ilen;++i)this.AddPath(ppg[i],polyType,closed)&&(result=!0);return result},ClipperLib.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(pt1,pt2,pt3){return!(ClipperLib.IntPoint.op_Equality(pt1,pt3)||ClipperLib.IntPoint.op_Equality(pt1,pt2)||ClipperLib.IntPoint.op_Equality(pt3,pt2))&&(pt1.X!=pt3.X?pt2.X>pt1.X==pt2.X<pt3.X:pt2.Y>pt1.Y==pt2.Y<pt3.Y)},ClipperLib.ClipperBase.prototype.RemoveEdge=function(e){e.Prev.Next=e.Next,e.Next.Prev=e.Prev;var result=e.Next;return e.Prev=null,result},ClipperLib.ClipperBase.prototype.SetDx=function(e){e.Delta.X=e.Top.X-e.Bot.X,e.Delta.Y=e.Top.Y-e.Bot.Y,0===e.Delta.Y?e.Dx=ClipperLib.ClipperBase.horizontal:e.Dx=e.Delta.X/e.Delta.Y},ClipperLib.ClipperBase.prototype.InsertLocalMinima=function(newLm){if(null===this.m_MinimaList)this.m_MinimaList=newLm;else if(newLm.Y>=this.m_MinimaList.Y)newLm.Next=this.m_MinimaList,this.m_MinimaList=newLm;else{for(var tmpLm=this.m_MinimaList;null!==tmpLm.Next&&newLm.Y<tmpLm.Next.Y;)tmpLm=tmpLm.Next;newLm.Next=tmpLm.Next,tmpLm.Next=newLm}},ClipperLib.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)},ClipperLib.ClipperBase.prototype.ReverseHorizontal=function(e){var tmp=e.Top.X;e.Top.X=e.Bot.X,e.Bot.X=tmp,ClipperLib.use_xyz&&(tmp=e.Top.Z,e.Top.Z=e.Bot.Z,e.Bot.Z=tmp)},ClipperLib.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,null!=this.m_CurrentLM)for(var lm=this.m_MinimaList;null!=lm;){var e=lm.LeftBound;null!=e&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,ClipperLib.use_xyz&&(e.Curr.Z=e.Bot.Z),e.Side=ClipperLib.EdgeSide.esLeft,e.OutIdx=ClipperLib.ClipperBase.Unassigned),null!=(e=lm.RightBound)&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,ClipperLib.use_xyz&&(e.Curr.Z=e.Bot.Z),e.Side=ClipperLib.EdgeSide.esRight,e.OutIdx=ClipperLib.ClipperBase.Unassigned),lm=lm.Next}},ClipperLib.Clipper=function(InitOptions){void 0===InitOptions&&(InitOptions=0),this.m_PolyOuts=null,this.m_ClipType=ClipperLib.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=ClipperLib.PolyFillType.pftEvenOdd,this.m_SubjFillType=ClipperLib.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,ClipperLib.ClipperBase.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=ClipperLib.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=0!=(1&InitOptions),this.StrictlySimple=0!=(2&InitOptions),this.PreserveCollinear=0!=(4&InitOptions),ClipperLib.use_xyz&&(this.ZFillFunction=null)},ClipperLib.Clipper.ioReverseSolution=1,ClipperLib.Clipper.ioStrictlySimple=2,ClipperLib.Clipper.ioPreserveCollinear=4,ClipperLib.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),ClipperLib.ClipperBase.prototype.Clear.call(this))},ClipperLib.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var sb2=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=sb2}},ClipperLib.Clipper.prototype.Reset=function(){ClipperLib.ClipperBase.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var lm=this.m_MinimaList;null!==lm;)this.InsertScanbeam(lm.Y),lm=lm.Next},ClipperLib.Clipper.prototype.InsertScanbeam=function(Y){if(null===this.m_Scanbeam)this.m_Scanbeam=new ClipperLib.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=Y;else if(Y>this.m_Scanbeam.Y){var newSb;(newSb=new ClipperLib.Scanbeam).Y=Y,newSb.Next=this.m_Scanbeam,this.m_Scanbeam=newSb}else{for(var sb2=this.m_Scanbeam;null!==sb2.Next&&Y<=sb2.Next.Y;)sb2=sb2.Next;if(Y==sb2.Y)return;var newSb;(newSb=new ClipperLib.Scanbeam).Y=Y,newSb.Next=sb2.Next,sb2.Next=newSb}},ClipperLib.Clipper.prototype.Execute=function(){var a=arguments,alen=a.length,ispolytree=a[1]instanceof ClipperLib.PolyTree;if(4==alen&&!ispolytree){var clipType=a[0],solution=a[1],subjFillType=a[2],clipFillType=a[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&ClipperLib.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,ClipperLib.Clear(solution),this.m_SubjFillType=subjFillType,this.m_ClipFillType=clipFillType,this.m_ClipType=clipType,this.m_UsingPolyTree=!1;try{var succeeded;(succeeded=this.ExecuteInternal())&&this.BuildResult(solution)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return succeeded}if(4==alen&&ispolytree){var clipType=a[0],polytree=a[1],subjFillType=a[2],clipFillType=a[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=subjFillType,this.m_ClipFillType=clipFillType,this.m_ClipType=clipType,this.m_UsingPolyTree=!0;try{var succeeded;(succeeded=this.ExecuteInternal())&&this.BuildResult2(polytree)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return succeeded}if(2==alen&&!ispolytree){var clipType=a[0],solution=a[1];return this.Execute(clipType,solution,ClipperLib.PolyFillType.pftEvenOdd,ClipperLib.PolyFillType.pftEvenOdd)}if(2==alen&&ispolytree){var clipType=a[0],polytree=a[1];return this.Execute(clipType,polytree,ClipperLib.PolyFillType.pftEvenOdd,ClipperLib.PolyFillType.pftEvenOdd)}},ClipperLib.Clipper.prototype.FixHoleLinkage=function(outRec){if(null!==outRec.FirstLeft&&(outRec.IsHole==outRec.FirstLeft.IsHole||null===outRec.FirstLeft.Pts)){for(var orfl=outRec.FirstLeft;null!==orfl&&(orfl.IsHole==outRec.IsHole||null===orfl.Pts);)orfl=orfl.FirstLeft;outRec.FirstLeft=orfl}},ClipperLib.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),null===this.m_CurrentLM)return!1;var botY=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(botY),ClipperLib.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),null===this.m_Scanbeam)break;var topY=this.PopScanbeam();if(!this.ProcessIntersections(topY))return!1;this.ProcessEdgesAtTopOfScanbeam(topY),botY=topY}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);for(var i=0,ilen=this.m_PolyOuts.length;i<ilen;i++){var outRec;null===(outRec=this.m_PolyOuts[i]).Pts||outRec.IsOpen||(outRec.IsHole^this.ReverseSolution)==this.Area(outRec)>0&&this.ReversePolyPtLinks(outRec.Pts)}this.JoinCommonEdges();for(var i=0,ilen=this.m_PolyOuts.length;i<ilen;i++){var outRec;null===(outRec=this.m_PolyOuts[i]).Pts||outRec.IsOpen||this.FixupOutPolygon(outRec)}return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{ClipperLib.Clear(this.m_Joins),ClipperLib.Clear(this.m_GhostJoins)}},ClipperLib.Clipper.prototype.PopScanbeam=function(){var Y=this.m_Scanbeam.Y;return this.m_Scanbeam=this.m_Scanbeam.Next,Y},ClipperLib.Clipper.prototype.DisposeAllPolyPts=function(){for(var i=0,ilen=this.m_PolyOuts.length;i<ilen;++i)this.DisposeOutRec(i);ClipperLib.Clear(this.m_PolyOuts)},ClipperLib.Clipper.prototype.DisposeOutRec=function(index){var outRec=this.m_PolyOuts[index];outRec.Pts=null,outRec=null,this.m_PolyOuts[index]=null},ClipperLib.Clipper.prototype.AddJoin=function(Op1,Op2,OffPt){var j=new ClipperLib.Join;j.OutPt1=Op1,j.OutPt2=Op2,j.OffPt.X=OffPt.X,j.OffPt.Y=OffPt.Y,ClipperLib.use_xyz&&(j.OffPt.Z=OffPt.Z),this.m_Joins.push(j)},ClipperLib.Clipper.prototype.AddGhostJoin=function(Op,OffPt){var j=new ClipperLib.Join;j.OutPt1=Op,j.OffPt.X=OffPt.X,j.OffPt.Y=OffPt.Y,ClipperLib.use_xyz&&(j.OffPt.Z=OffPt.Z),this.m_GhostJoins.push(j)},ClipperLib.Clipper.prototype.SetZ=function(pt,e1,e2){if(null!==this.ZFillFunction){if(0!=pt.Z||null===this.ZFillFunction)return;ClipperLib.IntPoint.op_Equality(pt,e1.Bot)?pt.Z=e1.Bot.Z:ClipperLib.IntPoint.op_Equality(pt,e1.Top)?pt.Z=e1.Top.Z:ClipperLib.IntPoint.op_Equality(pt,e2.Bot)?pt.Z=e2.Bot.Z:ClipperLib.IntPoint.op_Equality(pt,e2.Top)?pt.Z=e2.Top.Z:this.ZFillFunction(e1.Bot,e1.Top,e2.Bot,e2.Top,pt)}},ClipperLib.Clipper.prototype.InsertLocalMinimaIntoAEL=function(botY){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==botY;){var lb=this.m_CurrentLM.LeftBound,rb=this.m_CurrentLM.RightBound;this.PopLocalMinima();var Op1=null;if(null===lb?(this.InsertEdgeIntoAEL(rb,null),this.SetWindingCount(rb),this.IsContributing(rb)&&(Op1=this.AddOutPt(rb,rb.Bot))):null==rb?(this.InsertEdgeIntoAEL(lb,null),this.SetWindingCount(lb),this.IsContributing(lb)&&(Op1=this.AddOutPt(lb,lb.Bot)),this.InsertScanbeam(lb.Top.Y)):(this.InsertEdgeIntoAEL(lb,null),this.InsertEdgeIntoAEL(rb,lb),this.SetWindingCount(lb),rb.WindCnt=lb.WindCnt,rb.WindCnt2=lb.WindCnt2,this.IsContributing(lb)&&(Op1=this.AddLocalMinPoly(lb,rb,lb.Bot)),this.InsertScanbeam(lb.Top.Y)),null!=rb&&(ClipperLib.ClipperBase.IsHorizontal(rb)?this.AddEdgeToSEL(rb):this.InsertScanbeam(rb.Top.Y)),null!=lb&&null!=rb){if(null!==Op1&&ClipperLib.ClipperBase.IsHorizontal(rb)&&this.m_GhostJoins.length>0&&0!==rb.WindDelta)for(var i=0,ilen=this.m_GhostJoins.length;i<ilen;i++){var j=this.m_GhostJoins[i];this.HorzSegmentsOverlap(j.OutPt1.Pt.X,j.OffPt.X,rb.Bot.X,rb.Top.X)&&this.AddJoin(j.OutPt1,Op1,j.OffPt)}if(lb.OutIdx>=0&&null!==lb.PrevInAEL&&lb.PrevInAEL.Curr.X==lb.Bot.X&&lb.PrevInAEL.OutIdx>=0&&ClipperLib.ClipperBase.SlopesEqual(lb.PrevInAEL,lb,this.m_UseFullRange)&&0!==lb.WindDelta&&0!==lb.PrevInAEL.WindDelta){var Op2=this.AddOutPt(lb.PrevInAEL,lb.Bot);this.AddJoin(Op1,Op2,lb.Top)}if(lb.NextInAEL!=rb){if(rb.OutIdx>=0&&rb.PrevInAEL.OutIdx>=0&&ClipperLib.ClipperBase.SlopesEqual(rb.PrevInAEL,rb,this.m_UseFullRange)&&0!==rb.WindDelta&&0!==rb.PrevInAEL.WindDelta){var Op2=this.AddOutPt(rb.PrevInAEL,rb.Bot);this.AddJoin(Op1,Op2,rb.Top)}var e=lb.NextInAEL;if(null!==e)for(;e!=rb;)this.IntersectEdges(rb,e,lb.Curr,!1),e=e.NextInAEL}}}},ClipperLib.Clipper.prototype.InsertEdgeIntoAEL=function(edge,startEdge){if(null===this.m_ActiveEdges)edge.PrevInAEL=null,edge.NextInAEL=null,this.m_ActiveEdges=edge;else if(null===startEdge&&this.E2InsertsBeforeE1(this.m_ActiveEdges,edge))edge.PrevInAEL=null,edge.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=edge,this.m_ActiveEdges=edge;else{for(null===startEdge&&(startEdge=this.m_ActiveEdges);null!==startEdge.NextInAEL&&!this.E2InsertsBeforeE1(startEdge.NextInAEL,edge);)startEdge=startEdge.NextInAEL;edge.NextInAEL=startEdge.NextInAEL,null!==startEdge.NextInAEL&&(startEdge.NextInAEL.PrevInAEL=edge),edge.PrevInAEL=startEdge,startEdge.NextInAEL=edge}},ClipperLib.Clipper.prototype.E2InsertsBeforeE1=function(e1,e2){return e2.Curr.X==e1.Curr.X?e2.Top.Y>e1.Top.Y?e2.Top.X<ClipperLib.Clipper.TopX(e1,e2.Top.Y):e1.Top.X>ClipperLib.Clipper.TopX(e2,e1.Top.Y):e2.Curr.X<e1.Curr.X},ClipperLib.Clipper.prototype.IsEvenOddFillType=function(edge){return edge.PolyTyp==ClipperLib.PolyType.ptSubject?this.m_SubjFillType==ClipperLib.PolyFillType.pftEvenOdd:this.m_ClipFillType==ClipperLib.PolyFillType.pftEvenOdd},ClipperLib.Clipper.prototype.IsEvenOddAltFillType=function(edge){return edge.PolyTyp==ClipperLib.PolyType.ptSubject?this.m_ClipFillType==ClipperLib.PolyFillType.pftEvenOdd:this.m_SubjFillType==ClipperLib.PolyFillType.pftEvenOdd},ClipperLib.Clipper.prototype.IsContributing=function(edge){var pft,pft2;switch(edge.PolyTyp==ClipperLib.PolyType.ptSubject?(pft=this.m_SubjFillType,pft2=this.m_ClipFillType):(pft=this.m_ClipFillType,pft2=this.m_SubjFillType),pft){case ClipperLib.PolyFillType.pftEvenOdd:if(0===edge.WindDelta&&1!=edge.WindCnt)return!1;break;case ClipperLib.PolyFillType.pftNonZero:if(1!=Math.abs(edge.WindCnt))return!1;break;case ClipperLib.PolyFillType.pftPositive:if(1!=edge.WindCnt)return!1;break;default:if(-1!=edge.WindCnt)return!1}switch(this.m_ClipType){case ClipperLib.ClipType.ctIntersection:switch(pft2){case ClipperLib.PolyFillType.pftEvenOdd:case ClipperLib.PolyFillType.pftNonZero:return 0!==edge.WindCnt2;case ClipperLib.PolyFillType.pftPositive:return edge.WindCnt2>0;default:return edge.WindCnt2<0}case ClipperLib.ClipType.ctUnion:switch(pft2){case ClipperLib.PolyFillType.pftEvenOdd:case ClipperLib.PolyFillType.pftNonZero:return 0===edge.WindCnt2;case ClipperLib.PolyFillType.pftPositive:return edge.WindCnt2<=0;default:return edge.WindCnt2>=0}case ClipperLib.ClipType.ctDifference:if(edge.PolyTyp==ClipperLib.PolyType.ptSubject)switch(pft2){case ClipperLib.PolyFillType.pftEvenOdd:case ClipperLib.PolyFillType.pftNonZero:return 0===edge.WindCnt2;case ClipperLib.PolyFillType.pftPositive:return edge.WindCnt2<=0;default:return edge.WindCnt2>=0}else switch(pft2){case ClipperLib.PolyFillType.pftEvenOdd:case ClipperLib.PolyFillType.pftNonZero:return 0!==edge.WindCnt2;case ClipperLib.PolyFillType.pftPositive:return edge.WindCnt2>0;default:return edge.WindCnt2<0}case ClipperLib.ClipType.ctXor:if(0!==edge.WindDelta)return!0;switch(pft2){case ClipperLib.PolyFillType.pftEvenOdd:case ClipperLib.PolyFillType.pftNonZero:return 0===edge.WindCnt2;case ClipperLib.PolyFillType.pftPositive:return edge.WindCnt2<=0;default:return edge.WindCnt2>=0}}return!0},ClipperLib.Clipper.prototype.SetWindingCount=function(edge){for(var e=edge.PrevInAEL;null!==e&&(e.PolyTyp!=edge.PolyTyp||0===e.WindDelta);)e=e.PrevInAEL;if(null===e)edge.WindCnt=0===edge.WindDelta?1:edge.WindDelta,edge.WindCnt2=0,e=this.m_ActiveEdges;else if(0===edge.WindDelta&&this.m_ClipType!=ClipperLib.ClipType.ctUnion)edge.WindCnt=1,edge.WindCnt2=e.WindCnt2,e=e.NextInAEL;else if(this.IsEvenOddFillType(edge)){if(0===edge.WindDelta){for(var Inside=!0,e2=e.PrevInAEL;null!==e2;)e2.PolyTyp==e.PolyTyp&&0!==e2.WindDelta&&(Inside=!Inside),e2=e2.PrevInAEL;edge.WindCnt=Inside?0:1}else edge.WindCnt=edge.WindDelta;edge.WindCnt2=e.WindCnt2,e=e.NextInAEL}else e.WindCnt*e.WindDelta<0?Math.abs(e.WindCnt)>1?e.WindDelta*edge.WindDelta<0?edge.WindCnt=e.WindCnt:edge.WindCnt=e.WindCnt+edge.WindDelta:edge.WindCnt=0===edge.WindDelta?1:edge.WindDelta:0===edge.WindDelta?edge.WindCnt=e.WindCnt<0?e.WindCnt-1:e.WindCnt+1:e.WindDelta*edge.WindDelta<0?edge.WindCnt=e.WindCnt:edge.WindCnt=e.WindCnt+edge.WindDelta,edge.WindCnt2=e.WindCnt2,e=e.NextInAEL;if(this.IsEvenOddAltFillType(edge))for(;e!=edge;)0!==e.WindDelta&&(edge.WindCnt2=0===edge.WindCnt2?1:0),e=e.NextInAEL;else for(;e!=edge;)edge.WindCnt2+=e.WindDelta,e=e.NextInAEL},ClipperLib.Clipper.prototype.AddEdgeToSEL=function(edge){null===this.m_SortedEdges?(this.m_SortedEdges=edge,edge.PrevInSEL=null,edge.NextInSEL=null):(edge.NextInSEL=this.m_SortedEdges,edge.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=edge,this.m_SortedEdges=edge)},ClipperLib.Clipper.prototype.CopyAELToSEL=function(){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;null!==e;)e.PrevInSEL=e.PrevInAEL,e.NextInSEL=e.NextInAEL,e=e.NextInAEL},ClipperLib.Clipper.prototype.SwapPositionsInAEL=function(edge1,edge2){if(edge1.NextInAEL!=edge1.PrevInAEL&&edge2.NextInAEL!=edge2.PrevInAEL){var next,prev;if(edge1.NextInAEL==edge2)null!==(next=edge2.NextInAEL)&&(next.PrevInAEL=edge1),null!==(prev=edge1.PrevInAEL)&&(prev.NextInAEL=edge2),edge2.PrevInAEL=prev,edge2.NextInAEL=edge1,edge1.PrevInAEL=edge2,edge1.NextInAEL=next;else if(edge2.NextInAEL==edge1){var next,prev;null!==(next=edge1.NextInAEL)&&(next.PrevInAEL=edge2),null!==(prev=edge2.PrevInAEL)&&(prev.NextInAEL=edge1),edge1.PrevInAEL=prev,edge1.NextInAEL=edge2,edge2.PrevInAEL=edge1,edge2.NextInAEL=next}else{var next=edge1.NextInAEL,prev=edge1.PrevInAEL;edge1.NextInAEL=edge2.NextInAEL,null!==edge1.NextInAEL&&(edge1.NextInAEL.PrevInAEL=edge1),edge1.PrevInAEL=edge2.PrevInAEL,null!==edge1.PrevInAEL&&(edge1.PrevInAEL.NextInAEL=edge1),edge2.NextInAEL=next,null!==edge2.NextInAEL&&(edge2.NextInAEL.PrevInAEL=edge2),edge2.PrevInAEL=prev,null!==edge2.PrevInAEL&&(edge2.PrevInAEL.NextInAEL=edge2)}null===edge1.PrevInAEL?this.m_ActiveEdges=edge1:null===edge2.PrevInAEL&&(this.m_ActiveEdges=edge2)}},ClipperLib.Clipper.prototype.SwapPositionsInSEL=function(edge1,edge2){if(!(null===edge1.NextInSEL&&null===edge1.PrevInSEL||null===edge2.NextInSEL&&null===edge2.PrevInSEL)){var next,prev;if(edge1.NextInSEL==edge2)null!==(next=edge2.NextInSEL)&&(next.PrevInSEL=edge1),null!==(prev=edge1.PrevInSEL)&&(prev.NextInSEL=edge2),edge2.PrevInSEL=prev,edge2.NextInSEL=edge1,edge1.PrevInSEL=edge2,edge1.NextInSEL=next;else if(edge2.NextInSEL==edge1){var next,prev;null!==(next=edge1.NextInSEL)&&(next.PrevInSEL=edge2),null!==(prev=edge2.PrevInSEL)&&(prev.NextInSEL=edge1),edge1.PrevInSEL=prev,edge1.NextInSEL=edge2,edge2.PrevInSEL=edge1,edge2.NextInSEL=next}else{var next=edge1.NextInSEL,prev=edge1.PrevInSEL;edge1.NextInSEL=edge2.NextInSEL,null!==edge1.NextInSEL&&(edge1.NextInSEL.PrevInSEL=edge1),edge1.PrevInSEL=edge2.PrevInSEL,null!==edge1.PrevInSEL&&(edge1.PrevInSEL.NextInSEL=edge1),edge2.NextInSEL=next,null!==edge2.NextInSEL&&(edge2.NextInSEL.PrevInSEL=edge2),edge2.PrevInSEL=prev,null!==edge2.PrevInSEL&&(edge2.PrevInSEL.NextInSEL=edge2)}null===edge1.PrevInSEL?this.m_SortedEdges=edge1:null===edge2.PrevInSEL&&(this.m_SortedEdges=edge2)}},ClipperLib.Clipper.prototype.AddLocalMaxPoly=function(e1,e2,pt){this.AddOutPt(e1,pt),0==e2.WindDelta&&this.AddOutPt(e2,pt),e1.OutIdx==e2.OutIdx?(e1.OutIdx=-1,e2.OutIdx=-1):e1.OutIdx<e2.OutIdx?this.AppendPolygon(e1,e2):this.AppendPolygon(e2,e1)},ClipperLib.Clipper.prototype.AddLocalMinPoly=function(e1,e2,pt){var result,e,prevE;if(ClipperLib.ClipperBase.IsHorizontal(e2)||e1.Dx>e2.Dx?(result=this.AddOutPt(e1,pt),e2.OutIdx=e1.OutIdx,e1.Side=ClipperLib.EdgeSide.esLeft,e2.Side=ClipperLib.EdgeSide.esRight,prevE=(e=e1).PrevInAEL==e2?e2.PrevInAEL:e.PrevInAEL):(result=this.AddOutPt(e2,pt),e1.OutIdx=e2.OutIdx,e1.Side=ClipperLib.EdgeSide.esRight,e2.Side=ClipperLib.EdgeSide.esLeft,prevE=(e=e2).PrevInAEL==e1?e1.PrevInAEL:e.PrevInAEL),null!==prevE&&prevE.OutIdx>=0&&ClipperLib.Clipper.TopX(prevE,pt.Y)==ClipperLib.Clipper.TopX(e,pt.Y)&&ClipperLib.ClipperBase.SlopesEqual(e,prevE,this.m_UseFullRange)&&0!==e.WindDelta&&0!==prevE.WindDelta){var outPt=this.AddOutPt(prevE,pt);this.AddJoin(result,outPt,e.Top)}return result},ClipperLib.Clipper.prototype.CreateOutRec=function(){var result=new ClipperLib.OutRec;return result.Idx=-1,result.IsHole=!1,result.IsOpen=!1,result.FirstLeft=null,result.Pts=null,result.BottomPt=null,result.PolyNode=null,this.m_PolyOuts.push(result),result.Idx=this.m_PolyOuts.length-1,result},ClipperLib.Clipper.prototype.AddOutPt=function(e,pt){var ToFront=e.Side==ClipperLib.EdgeSide.esLeft;if(e.OutIdx<0){var outRec;(outRec=this.CreateOutRec()).IsOpen=0===e.WindDelta;var newOp=new ClipperLib.OutPt;return outRec.Pts=newOp,newOp.Idx=outRec.Idx,newOp.Pt.X=pt.X,newOp.Pt.Y=pt.Y,ClipperLib.use_xyz&&(newOp.Pt.Z=pt.Z),newOp.Next=newOp,newOp.Prev=newOp,outRec.IsOpen||this.SetHoleState(e,outRec),e.OutIdx=outRec.Idx,newOp}var outRec,op=(outRec=this.m_PolyOuts[e.OutIdx]).Pts,newOp;return ToFront&&ClipperLib.IntPoint.op_Equality(pt,op.Pt)?op:!ToFront&&ClipperLib.IntPoint.op_Equality(pt,op.Prev.Pt)?op.Prev:((newOp=new ClipperLib.OutPt).Idx=outRec.Idx,newOp.Pt.X=pt.X,newOp.Pt.Y=pt.Y,ClipperLib.use_xyz&&(newOp.Pt.Z=pt.Z),newOp.Next=op,newOp.Prev=op.Prev,newOp.Prev.Next=newOp,op.Prev=newOp,ToFront&&(outRec.Pts=newOp),newOp)},ClipperLib.Clipper.prototype.SwapPoints=function(pt1,pt2){var tmp=new ClipperLib.IntPoint(pt1.Value);pt1.Value.X=pt2.Value.X,pt1.Value.Y=pt2.Value.Y,ClipperLib.use_xyz&&(pt1.Value.Z=pt2.Value.Z),pt2.Value.X=tmp.X,pt2.Value.Y=tmp.Y,ClipperLib.use_xyz&&(pt2.Value.Z=tmp.Z)},ClipperLib.Clipper.prototype.HorzSegmentsOverlap=function(seg1a,seg1b,seg2a,seg2b){var tmp;return seg1a>seg1b&&(tmp=seg1a,seg1a=seg1b,seg1b=tmp),seg2a>seg2b&&(tmp=seg2a,seg2a=seg2b,seg2b=tmp),seg1a<seg2b&&seg2a<seg1b},ClipperLib.Clipper.prototype.SetHoleState=function(e,outRec){for(var isHole=!1,e2=e.PrevInAEL;null!==e2;)e2.OutIdx>=0&&0!=e2.WindDelta&&(isHole=!isHole,null===outRec.FirstLeft&&(outRec.FirstLeft=this.m_PolyOuts[e2.OutIdx])),e2=e2.PrevInAEL;isHole&&(outRec.IsHole=!0)},ClipperLib.Clipper.prototype.GetDx=function(pt1,pt2){return pt1.Y==pt2.Y?ClipperLib.ClipperBase.horizontal:(pt2.X-pt1.X)/(pt2.Y-pt1.Y)},ClipperLib.Clipper.prototype.FirstIsBottomPt=function(btmPt1,btmPt2){for(var p=btmPt1.Prev;ClipperLib.IntPoint.op_Equality(p.Pt,btmPt1.Pt)&&p!=btmPt1;)p=p.Prev;var dx1p=Math.abs(this.GetDx(btmPt1.Pt,p.Pt));for(p=btmPt1.Next;ClipperLib.IntPoint.op_Equality(p.Pt,btmPt1.Pt)&&p!=btmPt1;)p=p.Next;var dx1n=Math.abs(this.GetDx(btmPt1.Pt,p.Pt));for(p=btmPt2.Prev;ClipperLib.IntPoint.op_Equality(p.Pt,btmPt2.Pt)&&p!=btmPt2;)p=p.Prev;var dx2p=Math.abs(this.GetDx(btmPt2.Pt,p.Pt));for(p=btmPt2.Next;ClipperLib.IntPoint.op_Equality(p.Pt,btmPt2.Pt)&&p!=btmPt2;)p=p.Next;var dx2n=Math.abs(this.GetDx(btmPt2.Pt,p.Pt));return dx1p>=dx2p&&dx1p>=dx2n||dx1n>=dx2p&&dx1n>=dx2n},ClipperLib.Clipper.prototype.GetBottomPt=function(pp){for(var dups=null,p=pp.Next;p!=pp;)p.Pt.Y>pp.Pt.Y?(pp=p,dups=null):p.Pt.Y==pp.Pt.Y&&p.Pt.X<=pp.Pt.X&&(p.Pt.X<pp.Pt.X?(dups=null,pp=p):p.Next!=pp&&p.Prev!=pp&&(dups=p)),p=p.Next;if(null!==dups)for(;dups!=p;)for(this.FirstIsBottomPt(p,dups)||(pp=dups),dups=dups.Next;ClipperLib.IntPoint.op_Inequality(dups.Pt,pp.Pt);)dups=dups.Next;return pp},ClipperLib.Clipper.prototype.GetLowermostRec=function(outRec1,outRec2){null===outRec1.BottomPt&&(outRec1.BottomPt=this.GetBottomPt(outRec1.Pts)),null===outRec2.BottomPt&&(outRec2.BottomPt=this.GetBottomPt(outRec2.Pts));var bPt1=outRec1.BottomPt,bPt2=outRec2.BottomPt;return bPt1.Pt.Y>bPt2.Pt.Y?outRec1:bPt1.Pt.Y<bPt2.Pt.Y?outRec2:bPt1.Pt.X<bPt2.Pt.X?outRec1:bPt1.Pt.X>bPt2.Pt.X?outRec2:bPt1.Next==bPt1?outRec2:bPt2.Next==bPt2?outRec1:this.FirstIsBottomPt(bPt1,bPt2)?outRec1:outRec2},ClipperLib.Clipper.prototype.Param1RightOfParam2=function(outRec1,outRec2){do{if((outRec1=outRec1.FirstLeft)==outRec2)return!0}while(null!==outRec1);return!1},ClipperLib.Clipper.prototype.GetOutRec=function(idx){for(var outrec=this.m_PolyOuts[idx];outrec!=this.m_PolyOuts[outrec.Idx];)outrec=this.m_PolyOuts[outrec.Idx];return outrec},ClipperLib.Clipper.prototype.AppendPolygon=function(e1,e2){var outRec1=this.m_PolyOuts[e1.OutIdx],outRec2=this.m_PolyOuts[e2.OutIdx],holeStateRec;holeStateRec=this.Param1RightOfParam2(outRec1,outRec2)?outRec2:this.Param1RightOfParam2(outRec2,outRec1)?outRec1:this.GetLowermostRec(outRec1,outRec2);var p1_lft=outRec1.Pts,p1_rt=p1_lft.Prev,p2_lft=outRec2.Pts,p2_rt=p2_lft.Prev,side;e1.Side==ClipperLib.EdgeSide.esLeft?(e2.Side==ClipperLib.EdgeSide.esLeft?(this.ReversePolyPtLinks(p2_lft),p2_lft.Next=p1_lft,p1_lft.Prev=p2_lft,p1_rt.Next=p2_rt,p2_rt.Prev=p1_rt,outRec1.Pts=p2_rt):(p2_rt.Next=p1_lft,p1_lft.Prev=p2_rt,p2_lft.Prev=p1_rt,p1_rt.Next=p2_lft,outRec1.Pts=p2_lft),side=ClipperLib.EdgeSide.esLeft):(e2.Side==ClipperLib.EdgeSide.esRight?(this.ReversePolyPtLinks(p2_lft),p1_rt.Next=p2_rt,p2_rt.Prev=p1_rt,p2_lft.Next=p1_lft,p1_lft.Prev=p2_lft):(p1_rt.Next=p2_lft,p2_lft.Prev=p1_rt,p1_lft.Prev=p2_rt,p2_rt.Next=p1_lft),side=ClipperLib.EdgeSide.esRight),outRec1.BottomPt=null,holeStateRec==outRec2&&(outRec2.FirstLeft!=outRec1&&(outRec1.FirstLeft=outRec2.FirstLeft),outRec1.IsHole=outRec2.IsHole),outRec2.Pts=null,outRec2.BottomPt=null,outRec2.FirstLeft=outRec1;var OKIdx=e1.OutIdx,ObsoleteIdx=e2.OutIdx;e1.OutIdx=-1,e2.OutIdx=-1;for(var e=this.m_ActiveEdges;null!==e;){if(e.OutIdx==ObsoleteIdx){e.OutIdx=OKIdx,e.Side=side;break}e=e.NextInAEL}outRec2.Idx=outRec1.Idx},ClipperLib.Clipper.prototype.ReversePolyPtLinks=function(pp){if(null!==pp){var pp1,pp2;pp1=pp;do{pp2=pp1.Next,pp1.Next=pp1.Prev,pp1.Prev=pp2,pp1=pp2}while(pp1!=pp)}},ClipperLib.Clipper.SwapSides=function(edge1,edge2){var side=edge1.Side;edge1.Side=edge2.Side,edge2.Side=side},ClipperLib.Clipper.SwapPolyIndexes=function(edge1,edge2){var outIdx=edge1.OutIdx;edge1.OutIdx=edge2.OutIdx,edge2.OutIdx=outIdx},ClipperLib.Clipper.prototype.IntersectEdges=function(e1,e2,pt){var e1Contributing=e1.OutIdx>=0,e2Contributing=e2.OutIdx>=0;if(ClipperLib.use_xyz&&this.SetZ(pt,e1,e2),!ClipperLib.use_lines||0!==e1.WindDelta&&0!==e2.WindDelta){if(e1.PolyTyp==e2.PolyTyp)if(this.IsEvenOddFillType(e1)){var oldE1WindCnt=e1.WindCnt;e1.WindCnt=e2.WindCnt,e2.WindCnt=oldE1WindCnt}else e1.WindCnt+e2.WindDelta===0?e1.WindCnt=-e1.WindCnt:e1.WindCnt+=e2.WindDelta,e2.WindCnt-e1.WindDelta==0?e2.WindCnt=-e2.WindCnt:e2.WindCnt-=e1.WindDelta;else this.IsEvenOddFillType(e2)?e1.WindCnt2=0===e1.WindCnt2?1:0:e1.WindCnt2+=e2.WindDelta,this.IsEvenOddFillType(e1)?e2.WindCnt2=0===e2.WindCnt2?1:0:e2.WindCnt2-=e1.WindDelta;var e1FillType,e2FillType,e1FillType2,e2FillType2,e1Wc,e2Wc;switch(e1.PolyTyp==ClipperLib.PolyType.ptSubject?(e1FillType=this.m_SubjFillType,e1FillType2=this.m_ClipFillType):(e1FillType=this.m_ClipFillType,e1FillType2=this.m_SubjFillType),e2.PolyTyp==ClipperLib.PolyType.ptSubject?(e2FillType=this.m_SubjFillType,e2FillType2=this.m_ClipFillType):(e2FillType=this.m_ClipFillType,e2FillType2=this.m_SubjFillType),e1FillType){case ClipperLib.PolyFillType.pftPositive:e1Wc=e1.WindCnt;break;case ClipperLib.PolyFillType.pftNegative:e1Wc=-e1.WindCnt;break;default:e1Wc=Math.abs(e1.WindCnt)}switch(e2FillType){case ClipperLib.PolyFillType.pftPositive:e2Wc=e2.WindCnt;break;case ClipperLib.PolyFillType.pftNegative:e2Wc=-e2.WindCnt;break;default:e2Wc=Math.abs(e2.WindCnt)}if(e1Contributing&&e2Contributing)0!=e1Wc&&1!=e1Wc||0!=e2Wc&&1!=e2Wc||e1.PolyTyp!=e2.PolyTyp&&this.m_ClipType!=ClipperLib.ClipType.ctXor?this.AddLocalMaxPoly(e1,e2,pt):(this.AddOutPt(e1,pt),this.AddOutPt(e2,pt),ClipperLib.Clipper.SwapSides(e1,e2),ClipperLib.Clipper.SwapPolyIndexes(e1,e2));else if(e1Contributing)0!==e2Wc&&1!=e2Wc||(this.AddOutPt(e1,pt),ClipperLib.Clipper.SwapSides(e1,e2),ClipperLib.Clipper.SwapPolyIndexes(e1,e2));else if(e2Contributing)0!==e1Wc&&1!=e1Wc||(this.AddOutPt(e2,pt),ClipperLib.Clipper.SwapSides(e1,e2),ClipperLib.Clipper.SwapPolyIndexes(e1,e2));else if(!(0!=e1Wc&&1!=e1Wc||0!=e2Wc&&1!=e2Wc)){var e1Wc2,e2Wc2;switch(e1FillType2){case ClipperLib.PolyFillType.pftPositive:e1Wc2=e1.WindCnt2;break;case ClipperLib.PolyFillType.pftNegative:e1Wc2=-e1.WindCnt2;break;default:e1Wc2=Math.abs(e1.WindCnt2)}switch(e2FillType2){case ClipperLib.PolyFillType.pftPositive:e2Wc2=e2.WindCnt2;break;case ClipperLib.PolyFillType.pftNegative:e2Wc2=-e2.WindCnt2;break;default:e2Wc2=Math.abs(e2.WindCnt2)}if(e1.PolyTyp!=e2.PolyTyp)this.AddLocalMinPoly(e1,e2,pt);else if(1==e1Wc&&1==e2Wc)switch(this.m_ClipType){case ClipperLib.ClipType.ctIntersection:e1Wc2>0&&e2Wc2>0&&this.AddLocalMinPoly(e1,e2,pt);break;case ClipperLib.ClipType.ctUnion:e1Wc2<=0&&e2Wc2<=0&&this.AddLocalMinPoly(e1,e2,pt);break;case ClipperLib.ClipType.ctDifference:(e1.PolyTyp==ClipperLib.PolyType.ptClip&&e1Wc2>0&&e2Wc2>0||e1.PolyTyp==ClipperLib.PolyType.ptSubject&&e1Wc2<=0&&e2Wc2<=0)&&this.AddLocalMinPoly(e1,e2,pt);break;case ClipperLib.ClipType.ctXor:this.AddLocalMinPoly(e1,e2,pt)}else ClipperLib.Clipper.SwapSides(e1,e2)}}else{if(0==e1.WindDelta&&0==e2.WindDelta)return;e1.PolyTyp==e2.PolyTyp&&e1.WindDelta!=e2.WindDelta&&this.m_ClipType==ClipperLib.ClipType.ctUnion?0===e1.WindDelta?e2Contributing&&(this.AddOutPt(e1,pt),e1Contributing&&(e1.OutIdx=-1)):e1Contributing&&(this.AddOutPt(e2,pt),e2Contributing&&(e2.OutIdx=-1)):e1.PolyTyp!=e2.PolyTyp&&(0!==e1.WindDelta||1!=Math.abs(e2.WindCnt)||this.m_ClipType==ClipperLib.ClipType.ctUnion&&0!==e2.WindCnt2?0!==e2.WindDelta||1!=Math.abs(e1.WindCnt)||this.m_ClipType==ClipperLib.ClipType.ctUnion&&0!==e1.WindCnt2||(this.AddOutPt(e2,pt),e2Contributing&&(e2.OutIdx=-1)):(this.AddOutPt(e1,pt),e1Contributing&&(e1.OutIdx=-1)))}},ClipperLib.Clipper.prototype.DeleteFromAEL=function(e){var AelPrev=e.PrevInAEL,AelNext=e.NextInAEL;null===AelPrev&&null===AelNext&&e!=this.m_ActiveEdges||(null!==AelPrev?AelPrev.NextInAEL=AelNext:this.m_ActiveEdges=AelNext,null!==AelNext&&(AelNext.PrevInAEL=AelPrev),e.NextInAEL=null,e.PrevInAEL=null)},ClipperLib.Clipper.prototype.DeleteFromSEL=function(e){var SelPrev=e.PrevInSEL,SelNext=e.NextInSEL;null===SelPrev&&null===SelNext&&e!=this.m_SortedEdges||(null!==SelPrev?SelPrev.NextInSEL=SelNext:this.m_SortedEdges=SelNext,null!==SelNext&&(SelNext.PrevInSEL=SelPrev),e.NextInSEL=null,e.PrevInSEL=null)},ClipperLib.Clipper.prototype.UpdateEdgeIntoAEL=function(e){null===e.NextInLML&&ClipperLib.Error("UpdateEdgeIntoAEL: invalid call");var AelPrev=e.PrevInAEL,AelNext=e.NextInAEL;return e.NextInLML.OutIdx=e.OutIdx,null!==AelPrev?AelPrev.NextInAEL=e.NextInLML:this.m_ActiveEdges=e.NextInLML,null!==AelNext&&(AelNext.PrevInAEL=e.NextInLML),e.NextInLML.Side=e.Side,e.NextInLML.WindDelta=e.WindDelta,e.NextInLML.WindCnt=e.WindCnt,e.NextInLML.WindCnt2=e.WindCnt2,(e=e.NextInLML).Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,ClipperLib.use_xyz&&(e.Curr.Z=e.Bot.Z),e.PrevInAEL=AelPrev,e.NextInAEL=AelNext,ClipperLib.ClipperBase.IsHorizontal(e)||this.InsertScanbeam(e.Top.Y),e},ClipperLib.Clipper.prototype.ProcessHorizontals=function(isTopOfScanbeam){for(var horzEdge=this.m_SortedEdges;null!==horzEdge;)this.DeleteFromSEL(horzEdge),this.ProcessHorizontal(horzEdge,isTopOfScanbeam),horzEdge=this.m_SortedEdges},ClipperLib.Clipper.prototype.GetHorzDirection=function(HorzEdge,$var){HorzEdge.Bot.X<HorzEdge.Top.X?($var.Left=HorzEdge.Bot.X,$var.Right=HorzEdge.Top.X,$var.Dir=ClipperLib.Direction.dLeftToRight):($var.Left=HorzEdge.Top.X,$var.Right=HorzEdge.Bot.X,$var.Dir=ClipperLib.Direction.dRightToLeft)},ClipperLib.Clipper.prototype.ProcessHorizontal=function(horzEdge,isTopOfScanbeam){var $var={Dir:null,Left:null,Right:null};this.GetHorzDirection(horzEdge,$var);for(var dir=$var.Dir,horzLeft=$var.Left,horzRight=$var.Right,eLastHorz=horzEdge,eMaxPair=null;null!==eLastHorz.NextInLML&&ClipperLib.ClipperBase.IsHorizontal(eLastHorz.NextInLML);)eLastHorz=eLastHorz.NextInLML;for(null===eLastHorz.NextInLML&&(eMaxPair=this.GetMaximaPair(eLastHorz));;){for(var IsLastHorz=horzEdge==eLastHorz,e=this.GetNextInAEL(horzEdge,dir);null!==e&&!(e.Curr.X==horzEdge.Top.X&&null!==horzEdge.NextInLML&&e.Dx<horzEdge.NextInLML.Dx);){var eNext=this.GetNextInAEL(e,dir);if(dir==ClipperLib.Direction.dLeftToRight&&e.Curr.X<=horzRight||dir==ClipperLib.Direction.dRightToLeft&&e.Curr.X>=horzLeft){if(e==eMaxPair&&IsLastHorz){if(horzEdge.OutIdx>=0){for(var op1=this.AddOutPt(horzEdge,horzEdge.Top),eNextHorz=this.m_SortedEdges;null!==eNextHorz;){if(eNextHorz.OutIdx>=0&&this.HorzSegmentsOverlap(horzEdge.Bot.X,horzEdge.Top.X,eNextHorz.Bot.X,eNextHorz.Top.X)){var op2=this.AddOutPt(eNextHorz,eNextHorz.Bot);this.AddJoin(op2,op1,eNextHorz.Top)}eNextHorz=eNextHorz.NextInSEL}this.AddGhostJoin(op1,horzEdge.Bot),this.AddLocalMaxPoly(horzEdge,eMaxPair,horzEdge.Top)}return this.DeleteFromAEL(horzEdge),void this.DeleteFromAEL(eMaxPair)}if(dir==ClipperLib.Direction.dLeftToRight){var Pt=new ClipperLib.IntPoint(e.Curr.X,horzEdge.Curr.Y);this.IntersectEdges(horzEdge,e,Pt)}else{var Pt=new ClipperLib.IntPoint(e.Curr.X,horzEdge.Curr.Y);this.IntersectEdges(e,horzEdge,Pt)}this.SwapPositionsInAEL(horzEdge,e)}else if(dir==ClipperLib.Direction.dLeftToRight&&e.Curr.X>=horzRight||dir==ClipperLib.Direction.dRightToLeft&&e.Curr.X<=horzLeft)break;e=eNext}if(null===horzEdge.NextInLML||!ClipperLib.ClipperBase.IsHorizontal(horzEdge.NextInLML))break;(horzEdge=this.UpdateEdgeIntoAEL(horzEdge)).OutIdx>=0&&this.AddOutPt(horzEdge,horzEdge.Bot);var $var={Dir:dir,Left:horzLeft,Right:horzRight};this.GetHorzDirection(horzEdge,$var),dir=$var.Dir,horzLeft=$var.Left,horzRight=$var.Right}if(null!==horzEdge.NextInLML)if(horzEdge.OutIdx>=0){var op1=this.AddOutPt(horzEdge,horzEdge.Top);if(isTopOfScanbeam&&this.AddGhostJoin(op1,horzEdge.Bot),0===(horzEdge=this.UpdateEdgeIntoAEL(horzEdge)).WindDelta)return;var ePrev=horzEdge.PrevInAEL,eNext=horzEdge.NextInAEL;if(null!==ePrev&&ePrev.Curr.X==horzEdge.Bot.X&&ePrev.Curr.Y==horzEdge.Bot.Y&&0!==ePrev.WindDelta&&ePrev.OutIdx>=0&&ePrev.Curr.Y>ePrev.Top.Y&&ClipperLib.ClipperBase.SlopesEqual(horzEdge,ePrev,this.m_UseFullRange)){var op2=this.AddOutPt(ePrev,horzEdge.Bot);this.AddJoin(op1,op2,horzEdge.Top)}else if(null!==eNext&&eNext.Curr.X==horzEdge.Bot.X&&eNext.Curr.Y==horzEdge.Bot.Y&&0!==eNext.WindDelta&&eNext.OutIdx>=0&&eNext.Curr.Y>eNext.Top.Y&&ClipperLib.ClipperBase.SlopesEqual(horzEdge,eNext,this.m_UseFullRange)){var op2=this.AddOutPt(eNext,horzEdge.Bot);this.AddJoin(op1,op2,horzEdge.Top)}}else horzEdge=this.UpdateEdgeIntoAEL(horzEdge);else horzEdge.OutIdx>=0&&this.AddOutPt(horzEdge,horzEdge.Top),this.DeleteFromAEL(horzEdge)},ClipperLib.Clipper.prototype.GetNextInAEL=function(e,Direction){return Direction==ClipperLib.Direction.dLeftToRight?e.NextInAEL:e.PrevInAEL},ClipperLib.Clipper.prototype.IsMinima=function(e){return null!==e&&e.Prev.NextInLML!=e&&e.Next.NextInLML!=e},ClipperLib.Clipper.prototype.IsMaxima=function(e,Y){return null!==e&&e.Top.Y==Y&&null===e.NextInLML},ClipperLib.Clipper.prototype.IsIntermediate=function(e,Y){return e.Top.Y==Y&&null!==e.NextInLML},ClipperLib.Clipper.prototype.GetMaximaPair=function(e){var result=null;return ClipperLib.IntPoint.op_Equality(e.Next.Top,e.Top)&&null===e.Next.NextInLML?result=e.Next:ClipperLib.IntPoint.op_Equality(e.Prev.Top,e.Top)&&null===e.Prev.NextInLML&&(result=e.Prev),null===result||-2!=result.OutIdx&&(result.NextInAEL!=result.PrevInAEL||ClipperLib.ClipperBase.IsHorizontal(result))?result:null},ClipperLib.Clipper.prototype.ProcessIntersections=function(topY){if(null==this.m_ActiveEdges)return!0;try{if(this.BuildIntersectList(topY),0==this.m_IntersectList.length)return!0;if(1!=this.m_IntersectList.length&&!this.FixupIntersectionOrder())return!1;this.ProcessIntersectList()}catch($$e2){this.m_SortedEdges=null,this.m_IntersectList.length=0,ClipperLib.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},ClipperLib.Clipper.prototype.BuildIntersectList=function(topY){if(null!==this.m_ActiveEdges){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;null!==e;)e.PrevInSEL=e.PrevInAEL,e.NextInSEL=e.NextInAEL,e.Curr.X=ClipperLib.Clipper.TopX(e,topY),e=e.NextInAEL;for(var isModified=!0;isModified&&null!==this.m_SortedEdges;){for(isModified=!1,e=this.m_SortedEdges;null!==e.NextInSEL;){var eNext=e.NextInSEL,pt=new ClipperLib.IntPoint;if(e.Curr.X>eNext.Curr.X){this.IntersectPoint(e,eNext,pt);var newNode=new ClipperLib.IntersectNode;newNode.Edge1=e,newNode.Edge2=eNext,newNode.Pt.X=pt.X,newNode.Pt.Y=pt.Y,ClipperLib.use_xyz&&(newNode.Pt.Z=pt.Z),this.m_IntersectList.push(newNode),this.SwapPositionsInSEL(e,eNext),isModified=!0}else e=eNext}if(null===e.PrevInSEL)break;e.PrevInSEL.NextInSEL=null}this.m_SortedEdges=null}},ClipperLib.Clipper.prototype.EdgesAdjacent=function(inode){return inode.Edge1.NextInSEL==inode.Edge2||inode.Edge1.PrevInSEL==inode.Edge2},ClipperLib.Clipper.IntersectNodeSort=function(node1,node2){return node2.Pt.Y-node1.Pt.Y},ClipperLib.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var cnt=this.m_IntersectList.length,i=0;i<cnt;i++){if(!this.EdgesAdjacent(this.m_IntersectList[i])){for(var j=i+1;j<cnt&&!this.EdgesAdjacent(this.m_IntersectList[j]);)j++;if(j==cnt)return!1;var tmp=this.m_IntersectList[i];this.m_IntersectList[i]=this.m_IntersectList[j],this.m_IntersectList[j]=tmp}this.SwapPositionsInSEL(this.m_IntersectList[i].Edge1,this.m_IntersectList[i].Edge2)}return!0},ClipperLib.Clipper.prototype.ProcessIntersectList=function(){for(var i=0,ilen=this.m_IntersectList.length;i<ilen;i++){var iNode=this.m_IntersectList[i];this.IntersectEdges(iNode.Edge1,iNode.Edge2,iNode.Pt),this.SwapPositionsInAEL(iNode.Edge1,iNode.Edge2)}this.m_IntersectList.length=0};var R1=function(a){return a<0?Math.ceil(a-.5):Math.round(a)},R2=function(a){return a<0?Math.ceil(a-.5):Math.floor(a+.5)},R3=function(a){return a<0?-Math.round(Math.abs(a)):Math.round(a)},R4=function(a){return a<0?(a-=.5)<-2147483648?Math.ceil(a):0|a:(a+=.5)>2147483647?Math.floor(a):0|a};browser.msie?ClipperLib.Clipper.Round=R1:browser.chromium?ClipperLib.Clipper.Round=R3:browser.safari?ClipperLib.Clipper.Round=R4:ClipperLib.Clipper.Round=R2,ClipperLib.Clipper.TopX=function(edge,currentY){return currentY==edge.Top.Y?edge.Top.X:edge.Bot.X+ClipperLib.Clipper.Round(edge.Dx*(currentY-edge.Bot.Y))},ClipperLib.Clipper.prototype.IntersectPoint=function(edge1,edge2,ip){var b1,b2;if(ip.X=0,ip.Y=0,edge1.Dx==edge2.Dx)return ip.Y=edge1.Curr.Y,void(ip.X=ClipperLib.Clipper.TopX(edge1,ip.Y));if(0===edge1.Delta.X)ip.X=edge1.Bot.X,ClipperLib.ClipperBase.IsHorizontal(edge2)?ip.Y=edge2.Bot.Y:(b2=edge2.Bot.Y-edge2.Bot.X/edge2.Dx,ip.Y=ClipperLib.Clipper.Round(ip.X/edge2.Dx+b2));else if(0===edge2.Delta.X)ip.X=edge2.Bot.X,ClipperLib.ClipperBase.IsHorizontal(edge1)?ip.Y=edge1.Bot.Y:(b1=edge1.Bot.Y-edge1.Bot.X/edge1.Dx,ip.Y=ClipperLib.Clipper.Round(ip.X/edge1.Dx+b1));else{b1=edge1.Bot.X-edge1.Bot.Y*edge1.Dx;var q=((b2=edge2.Bot.X-edge2.Bot.Y*edge2.Dx)-b1)/(edge1.Dx-edge2.Dx);ip.Y=ClipperLib.Clipper.Round(q),Math.abs(edge1.Dx)<Math.abs(edge2.Dx)?ip.X=ClipperLib.Clipper.Round(edge1.Dx*q+b1):ip.X=ClipperLib.Clipper.Round(edge2.Dx*q+b2)}if(ip.Y<edge1.Top.Y||ip.Y<edge2.Top.Y){if(edge1.Top.Y>edge2.Top.Y)return ip.Y=edge1.Top.Y,ip.X=ClipperLib.Clipper.TopX(edge2,edge1.Top.Y),ip.X<edge1.Top.X;ip.Y=edge2.Top.Y,Math.abs(edge1.Dx)<Math.abs(edge2.Dx)?ip.X=ClipperLib.Clipper.TopX(edge1,ip.Y):ip.X=ClipperLib.Clipper.TopX(edge2,ip.Y)}ip.Y>edge1.Curr.Y&&(ip.Y=edge1.Curr.Y,Math.abs(edge1.Dx)>Math.abs(edge2.Dx)?ip.X=ClipperLib.Clipper.TopX(edge2,ip.Y):ip.X=ClipperLib.Clipper.TopX(edge1,ip.Y))},ClipperLib.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(topY){for(var e=this.m_ActiveEdges;null!==e;){var IsMaximaEdge=this.IsMaxima(e,topY);if(IsMaximaEdge){var eMaxPair=this.GetMaximaPair(e);IsMaximaEdge=null===eMaxPair||!ClipperLib.ClipperBase.IsHorizontal(eMaxPair)}if(IsMaximaEdge){var ePrev=e.PrevInAEL;this.DoMaxima(e),e=null===ePrev?this.m_ActiveEdges:ePrev.NextInAEL}else{if(this.IsIntermediate(e,topY)&&ClipperLib.ClipperBase.IsHorizontal(e.NextInLML)?((e=this.UpdateEdgeIntoAEL(e)).OutIdx>=0&&this.AddOutPt(e,e.Bot),this.AddEdgeToSEL(e)):(e.Curr.X=ClipperLib.Clipper.TopX(e,topY),e.Curr.Y=topY),this.StrictlySimple){var ePrev=e.PrevInAEL;if(e.OutIdx>=0&&0!==e.WindDelta&&null!==ePrev&&ePrev.OutIdx>=0&&ePrev.Curr.X==e.Curr.X&&0!==ePrev.WindDelta){var ip=new ClipperLib.IntPoint(e.Curr);ClipperLib.use_xyz&&this.SetZ(ip,ePrev,e);var op=this.AddOutPt(ePrev,ip),op2=this.AddOutPt(e,ip);this.AddJoin(op,op2,ip)}}e=e.NextInAEL}}for(this.ProcessHorizontals(!0),e=this.m_ActiveEdges;null!==e;){if(this.IsIntermediate(e,topY)){var op=null;e.OutIdx>=0&&(op=this.AddOutPt(e,e.Top));var ePrev=(e=this.UpdateEdgeIntoAEL(e)).PrevInAEL,eNext=e.NextInAEL;if(null!==ePrev&&ePrev.Curr.X==e.Bot.X&&ePrev.Curr.Y==e.Bot.Y&&null!==op&&ePrev.OutIdx>=0&&ePrev.Curr.Y>ePrev.Top.Y&&ClipperLib.ClipperBase.SlopesEqual(e,ePrev,this.m_UseFullRange)&&0!==e.WindDelta&&0!==ePrev.WindDelta){var op2=this.AddOutPt(ePrev,e.Bot);this.AddJoin(op,op2,e.Top)}else if(null!==eNext&&eNext.Curr.X==e.Bot.X&&eNext.Curr.Y==e.Bot.Y&&null!==op&&eNext.OutIdx>=0&&eNext.Curr.Y>eNext.Top.Y&&ClipperLib.ClipperBase.SlopesEqual(e,eNext,this.m_UseFullRange)&&0!==e.WindDelta&&0!==eNext.WindDelta){var op2=this.AddOutPt(eNext,e.Bot);this.AddJoin(op,op2,e.Top)}}e=e.NextInAEL}},ClipperLib.Clipper.prototype.DoMaxima=function(e){var eMaxPair=this.GetMaximaPair(e);if(null===eMaxPair)return e.OutIdx>=0&&this.AddOutPt(e,e.Top),void this.DeleteFromAEL(e);for(var eNext=e.NextInAEL;null!==eNext&&eNext!=eMaxPair;)this.IntersectEdges(e,eNext,e.Top),this.SwapPositionsInAEL(e,eNext),eNext=e.NextInAEL;-1==e.OutIdx&&-1==eMaxPair.OutIdx?(this.DeleteFromAEL(e),this.DeleteFromAEL(eMaxPair)):e.OutIdx>=0&&eMaxPair.OutIdx>=0?(e.OutIdx>=0&&this.AddLocalMaxPoly(e,eMaxPair,e.Top),this.DeleteFromAEL(e),this.DeleteFromAEL(eMaxPair)):ClipperLib.use_lines&&0===e.WindDelta?(e.OutIdx>=0&&(this.AddOutPt(e,e.Top),e.OutIdx=-1),this.DeleteFromAEL(e),eMaxPair.OutIdx>=0&&(this.AddOutPt(eMaxPair,e.Top),eMaxPair.OutIdx=-1),this.DeleteFromAEL(eMaxPair)):ClipperLib.Error("DoMaxima error")},ClipperLib.Clipper.ReversePaths=function(polys){for(var i=0,len=polys.length;i<len;i++)polys[i].reverse()},ClipperLib.Clipper.Orientation=function(poly){return ClipperLib.Clipper.Area(poly)>=0},ClipperLib.Clipper.prototype.PointCount=function(pts){if(null===pts)return 0;var result=0,p=pts;do{result++,p=p.Next}while(p!=pts);return result},ClipperLib.Clipper.prototype.BuildResult=function(polyg){ClipperLib.Clear(polyg);for(var i=0,ilen=this.m_PolyOuts.length;i<ilen;i++){var outRec=this.m_PolyOuts[i];if(null!==outRec.Pts){var p=outRec.Pts.Prev,cnt=this.PointCount(p);if(!(cnt<2)){for(var pg=new Array(cnt),j=0;j<cnt;j++)pg[j]=p.Pt,p=p.Prev;polyg.push(pg)}}}},ClipperLib.Clipper.prototype.BuildResult2=function(polytree){polytree.Clear();for(var i=0,ilen=this.m_PolyOuts.length;i<ilen;i++){var outRec=this.m_PolyOuts[i],cnt=this.PointCount(outRec.Pts);if(!(outRec.IsOpen&&cnt<2||!outRec.IsOpen&&cnt<3)){this.FixHoleLinkage(outRec);var pn=new ClipperLib.PolyNode;polytree.m_AllPolys.push(pn),outRec.PolyNode=pn,pn.m_polygon.length=cnt;for(var op=outRec.Pts.Prev,j=0;j<cnt;j++)pn.m_polygon[j]=op.Pt,op=op.Prev}}for(var i=0,ilen=this.m_PolyOuts.length;i<ilen;i++){var outRec;null!==(outRec=this.m_PolyOuts[i]).PolyNode&&(outRec.IsOpen?(outRec.PolyNode.IsOpen=!0,polytree.AddChild(outRec.PolyNode)):null!==outRec.FirstLeft&&null!=outRec.FirstLeft.PolyNode?outRec.FirstLeft.PolyNode.AddChild(outRec.PolyNode):polytree.AddChild(outRec.PolyNode))}},ClipperLib.Clipper.prototype.FixupOutPolygon=function(outRec){var lastOK=null;outRec.BottomPt=null;for(var pp=outRec.Pts;;){if(pp.Prev==pp||pp.Prev==pp.Next)return void(outRec.Pts=null);if(ClipperLib.IntPoint.op_Equality(pp.Pt,pp.Next.Pt)||ClipperLib.IntPoint.op_Equality(pp.Pt,pp.Prev.Pt)||ClipperLib.ClipperBase.SlopesEqual(pp.Prev.Pt,pp.Pt,pp.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(pp.Prev.Pt,pp.Pt,pp.Next.Pt)))lastOK=null,pp.Prev.Next=pp.Next,pp.Next.Prev=pp.Prev,pp=pp.Prev;else{if(pp==lastOK)break;null===lastOK&&(lastOK=pp),pp=pp.Next}}outRec.Pts=pp},ClipperLib.Clipper.prototype.DupOutPt=function(outPt,InsertAfter){var result=new ClipperLib.OutPt;return result.Pt.X=outPt.Pt.X,result.Pt.Y=outPt.Pt.Y,ClipperLib.use_xyz&&(result.Pt.Z=outPt.Pt.Z),result.Idx=outPt.Idx,InsertAfter?(result.Next=outPt.Next,result.Prev=outPt,outPt.Next.Prev=result,outPt.Next=result):(result.Prev=outPt.Prev,result.Next=outPt,outPt.Prev.Next=result,outPt.Prev=result),result},ClipperLib.Clipper.prototype.GetOverlap=function(a1,a2,b1,b2,$val){return a1<a2?b1<b2?($val.Left=Math.max(a1,b1),$val.Right=Math.min(a2,b2)):($val.Left=Math.max(a1,b2),$val.Right=Math.min(a2,b1)):b1<b2?($val.Left=Math.max(a2,b1),$val.Right=Math.min(a1,b2)):($val.Left=Math.max(a2,b2),$val.Right=Math.min(a1,b1)),$val.Left<$val.Right},ClipperLib.Clipper.prototype.JoinHorz=function(op1,op1b,op2,op2b,Pt,DiscardLeft){var Dir1=op1.Pt.X>op1b.Pt.X?ClipperLib.Direction.dRightToLeft:ClipperLib.Direction.dLeftToRight,Dir2=op2.Pt.X>op2b.Pt.X?ClipperLib.Direction.dRightToLeft:ClipperLib.Direction.dLeftToRight;if(Dir1==Dir2)return!1;if(Dir1==ClipperLib.Direction.dLeftToRight){for(;op1.Next.Pt.X<=Pt.X&&op1.Next.Pt.X>=op1.Pt.X&&op1.Next.Pt.Y==Pt.Y;)op1=op1.Next;DiscardLeft&&op1.Pt.X!=Pt.X&&(op1=op1.Next),op1b=this.DupOutPt(op1,!DiscardLeft),ClipperLib.IntPoint.op_Inequality(op1b.Pt,Pt)&&((op1=op1b).Pt.X=Pt.X,op1.Pt.Y=Pt.Y,ClipperLib.use_xyz&&(op1.Pt.Z=Pt.Z),op1b=this.DupOutPt(op1,!DiscardLeft))}else{for(;op1.Next.Pt.X>=Pt.X&&op1.Next.Pt.X<=op1.Pt.X&&op1.Next.Pt.Y==Pt.Y;)op1=op1.Next;DiscardLeft||op1.Pt.X==Pt.X||(op1=op1.Next),op1b=this.DupOutPt(op1,DiscardLeft),ClipperLib.IntPoint.op_Inequality(op1b.Pt,Pt)&&((op1=op1b).Pt.X=Pt.X,op1.Pt.Y=Pt.Y,ClipperLib.use_xyz&&(op1.Pt.Z=Pt.Z),op1b=this.DupOutPt(op1,DiscardLeft))}if(Dir2==ClipperLib.Direction.dLeftToRight){for(;op2.Next.Pt.X<=Pt.X&&op2.Next.Pt.X>=op2.Pt.X&&op2.Next.Pt.Y==Pt.Y;)op2=op2.Next;DiscardLeft&&op2.Pt.X!=Pt.X&&(op2=op2.Next),op2b=this.DupOutPt(op2,!DiscardLeft),ClipperLib.IntPoint.op_Inequality(op2b.Pt,Pt)&&((op2=op2b).Pt.X=Pt.X,op2.Pt.Y=Pt.Y,ClipperLib.use_xyz&&(op2.Pt.Z=Pt.Z),op2b=this.DupOutPt(op2,!DiscardLeft))}else{for(;op2.Next.Pt.X>=Pt.X&&op2.Next.Pt.X<=op2.Pt.X&&op2.Next.Pt.Y==Pt.Y;)op2=op2.Next;DiscardLeft||op2.Pt.X==Pt.X||(op2=op2.Next),op2b=this.DupOutPt(op2,DiscardLeft),ClipperLib.IntPoint.op_Inequality(op2b.Pt,Pt)&&((op2=op2b).Pt.X=Pt.X,op2.Pt.Y=Pt.Y,ClipperLib.use_xyz&&(op2.Pt.Z=Pt.Z),op2b=this.DupOutPt(op2,DiscardLeft))}return Dir1==ClipperLib.Direction.dLeftToRight==DiscardLeft?(op1.Prev=op2,op2.Next=op1,op1b.Next=op2b,op2b.Prev=op1b):(op1.Next=op2,op2.Prev=op1,op1b.Prev=op2b,op2b.Next=op1b),!0},ClipperLib.Clipper.prototype.JoinPoints=function(j,outRec1,outRec2){var op1=j.OutPt1,op1b=new ClipperLib.OutPt,op2=j.OutPt2,op2b=new ClipperLib.OutPt,isHorizontal=j.OutPt1.Pt.Y==j.OffPt.Y;if(isHorizontal&&ClipperLib.IntPoint.op_Equality(j.OffPt,j.OutPt1.Pt)&&ClipperLib.IntPoint.op_Equality(j.OffPt,j.OutPt2.Pt)){if(outRec1!=outRec2)return!1;for(op1b=j.OutPt1.Next;op1b!=op1&&ClipperLib.IntPoint.op_Equality(op1b.Pt,j.OffPt);)op1b=op1b.Next;var reverse1=op1b.Pt.Y>j.OffPt.Y,reverse2;for(op2b=j.OutPt2.Next;op2b!=op2&&ClipperLib.IntPoint.op_Equality(op2b.Pt,j.OffPt);)op2b=op2b.Next;return reverse1!=op2b.Pt.Y>j.OffPt.Y&&(reverse1?(op1b=this.DupOutPt(op1,!1),op2b=this.DupOutPt(op2,!0),op1.Prev=op2,op2.Next=op1,op1b.Next=op2b,op2b.Prev=op1b,j.OutPt1=op1,j.OutPt2=op1b,!0):(op1b=this.DupOutPt(op1,!0),op2b=this.DupOutPt(op2,!1),op1.Next=op2,op2.Prev=op1,op1b.Prev=op2b,op2b.Next=op1b,j.OutPt1=op1,j.OutPt2=op1b,!0))}if(isHorizontal){for(op1b=op1;op1.Prev.Pt.Y==op1.Pt.Y&&op1.Prev!=op1b&&op1.Prev!=op2;)op1=op1.Prev;for(;op1b.Next.Pt.Y==op1b.Pt.Y&&op1b.Next!=op1&&op1b.Next!=op2;)op1b=op1b.Next;if(op1b.Next==op1||op1b.Next==op2)return!1;for(op2b=op2;op2.Prev.Pt.Y==op2.Pt.Y&&op2.Prev!=op2b&&op2.Prev!=op1b;)op2=op2.Prev;for(;op2b.Next.Pt.Y==op2b.Pt.Y&&op2b.Next!=op2&&op2b.Next!=op1;)op2b=op2b.Next;if(op2b.Next==op2||op2b.Next==op1)return!1;var $val={Left:null,Right:null};if(!this.GetOverlap(op1.Pt.X,op1b.Pt.X,op2.Pt.X,op2b.Pt.X,$val))return!1;var Left=$val.Left,Right=$val.Right,Pt=new ClipperLib.IntPoint,DiscardLeftSide;return op1.Pt.X>=Left&&op1.Pt.X<=Right?(Pt.X=op1.Pt.X,Pt.Y=op1.Pt.Y,ClipperLib.use_xyz&&(Pt.Z=op1.Pt.Z),DiscardLeftSide=op1.Pt.X>op1b.Pt.X):op2.Pt.X>=Left&&op2.Pt.X<=Right?(Pt.X=op2.Pt.X,Pt.Y=op2.Pt.Y,ClipperLib.use_xyz&&(Pt.Z=op2.Pt.Z),DiscardLeftSide=op2.Pt.X>op2b.Pt.X):op1b.Pt.X>=Left&&op1b.Pt.X<=Right?(Pt.X=op1b.Pt.X,Pt.Y=op1b.Pt.Y,ClipperLib.use_xyz&&(Pt.Z=op1b.Pt.Z),DiscardLeftSide=op1b.Pt.X>op1.Pt.X):(Pt.X=op2b.Pt.X,Pt.Y=op2b.Pt.Y,ClipperLib.use_xyz&&(Pt.Z=op2b.Pt.Z),DiscardLeftSide=op2b.Pt.X>op2.Pt.X),j.OutPt1=op1,j.OutPt2=op2,this.JoinHorz(op1,op1b,op2,op2b,Pt,DiscardLeftSide)}for(op1b=op1.Next;ClipperLib.IntPoint.op_Equality(op1b.Pt,op1.Pt)&&op1b!=op1;)op1b=op1b.Next;var Reverse1=op1b.Pt.Y>op1.Pt.Y||!ClipperLib.ClipperBase.SlopesEqual(op1.Pt,op1b.Pt,j.OffPt,this.m_UseFullRange);if(Reverse1){for(op1b=op1.Prev;ClipperLib.IntPoint.op_Equality(op1b.Pt,op1.Pt)&&op1b!=op1;)op1b=op1b.Prev;if(op1b.Pt.Y>op1.Pt.Y||!ClipperLib.ClipperBase.SlopesEqual(op1.Pt,op1b.Pt,j.OffPt,this.m_UseFullRange))return!1}for(op2b=op2.Next;ClipperLib.IntPoint.op_Equality(op2b.Pt,op2.Pt)&&op2b!=op2;)op2b=op2b.Next;var Reverse2=op2b.Pt.Y>op2.Pt.Y||!ClipperLib.ClipperBase.SlopesEqual(op2.Pt,op2b.Pt,j.OffPt,this.m_UseFullRange);if(Reverse2){for(op2b=op2.Prev;ClipperLib.IntPoint.op_Equality(op2b.Pt,op2.Pt)&&op2b!=op2;)op2b=op2b.Prev;if(op2b.Pt.Y>op2.Pt.Y||!ClipperLib.ClipperBase.SlopesEqual(op2.Pt,op2b.Pt,j.OffPt,this.m_UseFullRange))return!1}return!(op1b==op1||op2b==op2||op1b==op2b||outRec1==outRec2&&Reverse1==Reverse2||(Reverse1?(op1b=this.DupOutPt(op1,!1),op2b=this.DupOutPt(op2,!0),op1.Prev=op2,op2.Next=op1,op1b.Next=op2b,op2b.Prev=op1b,j.OutPt1=op1,j.OutPt2=op1b,0):(op1b=this.DupOutPt(op1,!0),op2b=this.DupOutPt(op2,!1),op1.Next=op2,op2.Prev=op1,op1b.Prev=op2b,op2b.Next=op1b,j.OutPt1=op1,j.OutPt2=op1b,0)))},ClipperLib.Clipper.GetBounds=function(paths){for(var i=0,cnt=paths.length;i<cnt&&0==paths[i].length;)i++;if(i==cnt)return new ClipperLib.IntRect(0,0,0,0);var result=new ClipperLib.IntRect;for(result.left=paths[i][0].X,result.right=result.left,result.top=paths[i][0].Y,result.bottom=result.top;i<cnt;i++)for(var j=0,jlen=paths[i].length;j<jlen;j++)paths[i][j].X<result.left?result.left=paths[i][j].X:paths[i][j].X>result.right&&(result.right=paths[i][j].X),paths[i][j].Y<result.top?result.top=paths[i][j].Y:paths[i][j].Y>result.bottom&&(result.bottom=paths[i][j].Y);return result},ClipperLib.Clipper.prototype.GetBounds2=function(ops){var opStart=ops,result=new ClipperLib.IntRect;for(result.left=ops.Pt.X,result.right=ops.Pt.X,result.top=ops.Pt.Y,result.bottom=ops.Pt.Y,ops=ops.Next;ops!=opStart;)ops.Pt.X<result.left&&(result.left=ops.Pt.X),ops.Pt.X>result.right&&(result.right=ops.Pt.X),ops.Pt.Y<result.top&&(result.top=ops.Pt.Y),ops.Pt.Y>result.bottom&&(result.bottom=ops.Pt.Y),ops=ops.Next;return result},ClipperLib.Clipper.PointInPolygon=function(pt,path){var result=0,cnt=path.length;if(cnt<3)return 0;for(var ip=path[0],i=1;i<=cnt;++i){var ipNext=i==cnt?path[0]:path[i];if(ipNext.Y==pt.Y&&(ipNext.X==pt.X||ip.Y==pt.Y&&ipNext.X>pt.X==ip.X<pt.X))return-1;if(ip.Y<pt.Y!=ipNext.Y<pt.Y)if(ip.X>=pt.X)if(ipNext.X>pt.X)result=1-result;else{var d;if(0==(d=(ip.X-pt.X)*(ipNext.Y-pt.Y)-(ipNext.X-pt.X)*(ip.Y-pt.Y)))return-1;d>0==ipNext.Y>ip.Y&&(result=1-result)}else if(ipNext.X>pt.X){var d;if(0==(d=(ip.X-pt.X)*(ipNext.Y-pt.Y)-(ipNext.X-pt.X)*(ip.Y-pt.Y)))return-1;d>0==ipNext.Y>ip.Y&&(result=1-result)}ip=ipNext}return result},ClipperLib.Clipper.prototype.PointInPolygon=function(pt,op){var result=0,startOp=op,ptx=pt.X,pty=pt.Y,poly0x=op.Pt.X,poly0y=op.Pt.Y;do{var poly1x=(op=op.Next).Pt.X,poly1y=op.Pt.Y;if(poly1y==pty&&(poly1x==ptx||poly0y==pty&&poly1x>ptx==poly0x<ptx))return-1;if(poly0y<pty!=poly1y<pty)if(poly0x>=ptx)if(poly1x>ptx)result=1-result;else{var d;if(0==(d=(poly0x-ptx)*(poly1y-pty)-(poly1x-ptx)*(poly0y-pty)))return-1;d>0==poly1y>poly0y&&(result=1-result)}else if(poly1x>ptx){var d;if(0==(d=(poly0x-ptx)*(poly1y-pty)-(poly1x-ptx)*(poly0y-pty)))return-1;d>0==poly1y>poly0y&&(result=1-result)}poly0x=poly1x,poly0y=poly1y}while(startOp!=op);return result},ClipperLib.Clipper.prototype.Poly2ContainsPoly1=function(outPt1,outPt2){var op=outPt1;do{var res=this.PointInPolygon(op.Pt,outPt2);if(res>=0)return res>0;op=op.Next}while(op!=outPt1);return!0},ClipperLib.Clipper.prototype.FixupFirstLefts1=function(OldOutRec,NewOutRec){for(var i=0,ilen=this.m_PolyOuts.length;i<ilen;i++){var outRec=this.m_PolyOuts[i],firstLeft;null!=outRec.Pts&&null!=outRec.FirstLeft&&this.ParseFirstLeft(outRec.FirstLeft)==OldOutRec&&this.Poly2ContainsPoly1(outRec.Pts,NewOutRec.Pts)&&(outRec.FirstLeft=NewOutRec)}},ClipperLib.Clipper.prototype.FixupFirstLefts2=function(OldOutRec,NewOutRec){for(var $i2=0,$t2=this.m_PolyOuts,$l2=$t2.length,outRec=$t2[$i2];$i2<$l2;outRec=$t2[++$i2])outRec.FirstLeft==OldOutRec&&(outRec.FirstLeft=NewOutRec)},ClipperLib.Clipper.ParseFirstLeft=function(FirstLeft){for(;null!=FirstLeft&&null==FirstLeft.Pts;)FirstLeft=FirstLeft.FirstLeft;return FirstLeft},ClipperLib.Clipper.prototype.JoinCommonEdges=function(){for(var i=0,ilen=this.m_Joins.length;i<ilen;i++){var join=this.m_Joins[i],outRec1=this.GetOutRec(join.OutPt1.Idx),outRec2=this.GetOutRec(join.OutPt2.Idx),holeStateRec;if(null!=outRec1.Pts&&null!=outRec2.Pts&&(holeStateRec=outRec1==outRec2?outRec1:this.Param1RightOfParam2(outRec1,outRec2)?outRec2:this.Param1RightOfParam2(outRec2,outRec1)?outRec1:this.GetLowermostRec(outRec1,outRec2),this.JoinPoints(join,outRec1,outRec2)))if(outRec1==outRec2){if(outRec1.Pts=join.OutPt1,outRec1.BottomPt=null,(outRec2=this.CreateOutRec()).Pts=join.OutPt2,this.UpdateOutPtIdxs(outRec2),this.m_UsingPolyTree)for(var j=0,jlen=this.m_PolyOuts.length;j<jlen-1;j++){var oRec=this.m_PolyOuts[j];null!=oRec.Pts&&ClipperLib.Clipper.ParseFirstLeft(oRec.FirstLeft)==outRec1&&oRec.IsHole!=outRec1.IsHole&&this.Poly2ContainsPoly1(oRec.Pts,join.OutPt2)&&(oRec.FirstLeft=outRec2)}this.Poly2ContainsPoly1(outRec2.Pts,outRec1.Pts)?(outRec2.IsHole=!outRec1.IsHole,outRec2.FirstLeft=outRec1,this.m_UsingPolyTree&&this.FixupFirstLefts2(outRec2,outRec1),(outRec2.IsHole^this.ReverseSolution)==this.Area(outRec2)>0&&this.ReversePolyPtLinks(outRec2.Pts)):this.Poly2ContainsPoly1(outRec1.Pts,outRec2.Pts)?(outRec2.IsHole=outRec1.IsHole,outRec1.IsHole=!outRec2.IsHole,outRec2.FirstLeft=outRec1.FirstLeft,outRec1.FirstLeft=outRec2,this.m_UsingPolyTree&&this.FixupFirstLefts2(outRec1,outRec2),(outRec1.IsHole^this.ReverseSolution)==this.Area(outRec1)>0&&this.ReversePolyPtLinks(outRec1.Pts)):(outRec2.IsHole=outRec1.IsHole,outRec2.FirstLeft=outRec1.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(outRec1,outRec2))}else outRec2.Pts=null,outRec2.BottomPt=null,outRec2.Idx=outRec1.Idx,outRec1.IsHole=holeStateRec.IsHole,holeStateRec==outRec2&&(outRec1.FirstLeft=outRec2.FirstLeft),outRec2.FirstLeft=outRec1,this.m_UsingPolyTree&&this.FixupFirstLefts2(outRec2,outRec1)}},ClipperLib.Clipper.prototype.UpdateOutPtIdxs=function(outrec){var op=outrec.Pts;do{op.Idx=outrec.Idx,op=op.Prev}while(op!=outrec.Pts)},ClipperLib.Clipper.prototype.DoSimplePolygons=function(){for(var i=0;i<this.m_PolyOuts.length;){var outrec=this.m_PolyOuts[i++],op=outrec.Pts;if(null!=op&&!outrec.IsOpen)do{for(var op2=op.Next;op2!=outrec.Pts;){if(ClipperLib.IntPoint.op_Equality(op.Pt,op2.Pt)&&op2.Next!=op&&op2.Prev!=op){var op3=op.Prev,op4=op2.Prev;op.Prev=op4,op4.Next=op,op2.Prev=op3,op3.Next=op2,outrec.Pts=op;var outrec2=this.CreateOutRec();outrec2.Pts=op2,this.UpdateOutPtIdxs(outrec2),this.Poly2ContainsPoly1(outrec2.Pts,outrec.Pts)?(outrec2.IsHole=!outrec.IsHole,outrec2.FirstLeft=outrec,this.m_UsingPolyTree&&this.FixupFirstLefts2(outrec2,outrec)):this.Poly2ContainsPoly1(outrec.Pts,outrec2.Pts)?(outrec2.IsHole=outrec.IsHole,outrec.IsHole=!outrec2.IsHole,outrec2.FirstLeft=outrec.FirstLeft,outrec.FirstLeft=outrec2,this.m_UsingPolyTree&&this.FixupFirstLefts2(outrec,outrec2)):(outrec2.IsHole=outrec.IsHole,outrec2.FirstLeft=outrec.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(outrec,outrec2)),op2=op}op2=op2.Next}op=op.Next}while(op!=outrec.Pts)}},ClipperLib.Clipper.Area=function(poly){var cnt=poly.length;if(cnt<3)return 0;for(var a=0,i=0,j=cnt-1;i<cnt;++i)a+=(poly[j].X+poly[i].X)*(poly[j].Y-poly[i].Y),j=i;return.5*-a},ClipperLib.Clipper.prototype.Area=function(outRec){var op=outRec.Pts;if(null==op)return 0;var a=0;do{a+=(op.Prev.Pt.X+op.Pt.X)*(op.Prev.Pt.Y-op.Pt.Y),op=op.Next}while(op!=outRec.Pts);return.5*a},ClipperLib.Clipper.SimplifyPolygon=function(poly,fillType){var result=new Array,c=new ClipperLib.Clipper(0);return c.StrictlySimple=!0,c.AddPath(poly,ClipperLib.PolyType.ptSubject,!0),c.Execute(ClipperLib.ClipType.ctUnion,result,fillType,fillType),result},ClipperLib.Clipper.SimplifyPolygons=function(polys,fillType){void 0===fillType&&(fillType=ClipperLib.PolyFillType.pftEvenOdd);var result=new Array,c=new ClipperLib.Clipper(0);return c.StrictlySimple=!0,c.AddPaths(polys,ClipperLib.PolyType.ptSubject,!0),c.Execute(ClipperLib.ClipType.ctUnion,result,fillType,fillType),result},ClipperLib.Clipper.DistanceSqrd=function(pt1,pt2){var dx=pt1.X-pt2.X,dy=pt1.Y-pt2.Y;return dx*dx+dy*dy},ClipperLib.Clipper.DistanceFromLineSqrd=function(pt,ln1,ln2){var A=ln1.Y-ln2.Y,B=ln2.X-ln1.X,C=A*ln1.X+B*ln1.Y;return(C=A*pt.X+B*pt.Y-C)*C/(A*A+B*B)},ClipperLib.Clipper.SlopesNearCollinear=function(pt1,pt2,pt3,distSqrd){return Math.abs(pt1.X-pt2.X)>Math.abs(pt1.Y-pt2.Y)?pt1.X>pt2.X==pt1.X<pt3.X?ClipperLib.Clipper.DistanceFromLineSqrd(pt1,pt2,pt3)<distSqrd:pt2.X>pt1.X==pt2.X<pt3.X?ClipperLib.Clipper.DistanceFromLineSqrd(pt2,pt1,pt3)<distSqrd:ClipperLib.Clipper.DistanceFromLineSqrd(pt3,pt1,pt2)<distSqrd:pt1.Y>pt2.Y==pt1.Y<pt3.Y?ClipperLib.Clipper.DistanceFromLineSqrd(pt1,pt2,pt3)<distSqrd:pt2.Y>pt1.Y==pt2.Y<pt3.Y?ClipperLib.Clipper.DistanceFromLineSqrd(pt2,pt1,pt3)<distSqrd:ClipperLib.Clipper.DistanceFromLineSqrd(pt3,pt1,pt2)<distSqrd},ClipperLib.Clipper.PointsAreClose=function(pt1,pt2,distSqrd){var dx=pt1.X-pt2.X,dy=pt1.Y-pt2.Y;return dx*dx+dy*dy<=distSqrd},ClipperLib.Clipper.ExcludeOp=function(op){var result=op.Prev;return result.Next=op.Next,op.Next.Prev=result,result.Idx=0,result},ClipperLib.Clipper.CleanPolygon=function(path,distance){void 0===distance&&(distance=1.415);var cnt=path.length;if(0==cnt)return new Array;for(var outPts=new Array(cnt),i=0;i<cnt;++i)outPts[i]=new ClipperLib.OutPt;for(var i=0;i<cnt;++i)outPts[i].Pt=path[i],outPts[i].Next=outPts[(i+1)%cnt],outPts[i].Next.Prev=outPts[i],outPts[i].Idx=0;for(var distSqrd=distance*distance,op=outPts[0];0==op.Idx&&op.Next!=op.Prev;)ClipperLib.Clipper.PointsAreClose(op.Pt,op.Prev.Pt,distSqrd)?(op=ClipperLib.Clipper.ExcludeOp(op),cnt--):ClipperLib.Clipper.PointsAreClose(op.Prev.Pt,op.Next.Pt,distSqrd)?(ClipperLib.Clipper.ExcludeOp(op.Next),op=ClipperLib.Clipper.ExcludeOp(op),cnt-=2):ClipperLib.Clipper.SlopesNearCollinear(op.Prev.Pt,op.Pt,op.Next.Pt,distSqrd)?(op=ClipperLib.Clipper.ExcludeOp(op),cnt--):(op.Idx=1,op=op.Next);cnt<3&&(cnt=0);for(var result=new Array(cnt),i=0;i<cnt;++i)result[i]=new ClipperLib.IntPoint(op.Pt),op=op.Next;return outPts=null,result},ClipperLib.Clipper.CleanPolygons=function(polys,distance){for(var result=new Array(polys.length),i=0,ilen=polys.length;i<ilen;i++)result[i]=ClipperLib.Clipper.CleanPolygon(polys[i],distance);return result},ClipperLib.Clipper.Minkowski=function(pattern,path,IsSum,IsClosed){var delta=IsClosed?1:0,polyCnt=pattern.length,pathCnt=path.length,result=new Array;if(IsSum)for(var i=0;i<pathCnt;i++){for(var p=new Array(polyCnt),j=0,jlen=pattern.length,ip=pattern[j];j<jlen;ip=pattern[++j])p[j]=new ClipperLib.IntPoint(path[i].X+ip.X,path[i].Y+ip.Y);result.push(p)}else for(var i=0;i<pathCnt;i++){for(var p=new Array(polyCnt),j=0,jlen=pattern.length,ip=pattern[j];j<jlen;ip=pattern[++j])p[j]=new ClipperLib.IntPoint(path[i].X-ip.X,path[i].Y-ip.Y);result.push(p)}for(var quads=new Array,i=0;i<pathCnt-1+delta;i++)for(var j=0;j<polyCnt;j++){var quad=new Array;quad.push(result[i%pathCnt][j%polyCnt]),quad.push(result[(i+1)%pathCnt][j%polyCnt]),quad.push(result[(i+1)%pathCnt][(j+1)%polyCnt]),quad.push(result[i%pathCnt][(j+1)%polyCnt]),ClipperLib.Clipper.Orientation(quad)||quad.reverse(),quads.push(quad)}return quads},ClipperLib.Clipper.MinkowskiSum=function(pattern,path_or_paths,pathIsClosed){if(path_or_paths[0]instanceof Array){for(var paths=path_or_paths,solution=new ClipperLib.Paths,c=new ClipperLib.Clipper,i=0;i<paths.length;++i){var tmp=ClipperLib.Clipper.Minkowski(pattern,paths[i],!0,pathIsClosed);if(c.AddPaths(tmp,ClipperLib.PolyType.ptSubject,!0),pathIsClosed){var path=ClipperLib.Clipper.TranslatePath(paths[i],pattern[0]);c.AddPath(path,ClipperLib.PolyType.ptClip,!0)}}return c.Execute(ClipperLib.ClipType.ctUnion,solution,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero),solution}var path=path_or_paths,paths=ClipperLib.Clipper.Minkowski(pattern,path,!0,pathIsClosed),c;return(c=new ClipperLib.Clipper).AddPaths(paths,ClipperLib.PolyType.ptSubject,!0),c.Execute(ClipperLib.ClipType.ctUnion,paths,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero),paths},ClipperLib.Clipper.TranslatePath=function(path,delta){for(var outPath=new ClipperLib.Path,i=0;i<path.length;i++)outPath.push(new ClipperLib.IntPoint(path[i].X+delta.X,path[i].Y+delta.Y));return outPath},ClipperLib.Clipper.MinkowskiDiff=function(poly1,poly2){var paths=ClipperLib.Clipper.Minkowski(poly1,poly2,!1,!0),c=new ClipperLib.Clipper;return c.AddPaths(paths,ClipperLib.PolyType.ptSubject,!0),c.Execute(ClipperLib.ClipType.ctUnion,paths,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero),paths},ClipperLib.Clipper.PolyTreeToPaths=function(polytree){var result=new Array;return ClipperLib.Clipper.AddPolyNodeToPaths(polytree,ClipperLib.Clipper.NodeType.ntAny,result),result},ClipperLib.Clipper.AddPolyNodeToPaths=function(polynode,nt,paths){var match=!0;switch(nt){case ClipperLib.Clipper.NodeType.ntOpen:return;case ClipperLib.Clipper.NodeType.ntClosed:match=!polynode.IsOpen}polynode.m_polygon.length>0&&match&&paths.push(polynode.m_polygon);for(var $i3=0,$t3=polynode.Childs(),$l3=$t3.length,pn=$t3[$i3];$i3<$l3;pn=$t3[++$i3])ClipperLib.Clipper.AddPolyNodeToPaths(pn,nt,paths)},ClipperLib.Clipper.OpenPathsFromPolyTree=function(polytree){for(var result=new ClipperLib.Paths,i=0,ilen=polytree.ChildCount();i<ilen;i++)polytree.Childs()[i].IsOpen&&result.push(polytree.Childs()[i].m_polygon);return result},ClipperLib.Clipper.ClosedPathsFromPolyTree=function(polytree){var result=new ClipperLib.Paths;return ClipperLib.Clipper.AddPolyNodeToPaths(polytree,ClipperLib.Clipper.NodeType.ntClosed,result),result},Inherit(ClipperLib.Clipper,ClipperLib.ClipperBase),ClipperLib.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},ClipperLib.ClipperOffset=function(miterLimit,arcTolerance){void 0===miterLimit&&(miterLimit=2),void 0===arcTolerance&&(arcTolerance=ClipperLib.ClipperOffset.def_arc_tolerance),this.m_destPolys=new ClipperLib.Paths,this.m_srcPoly=new ClipperLib.Path,this.m_destPoly=new ClipperLib.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new ClipperLib.IntPoint,this.m_polyNodes=new ClipperLib.PolyNode,this.MiterLimit=miterLimit,this.ArcTolerance=arcTolerance,this.m_lowest.X=-1},ClipperLib.ClipperOffset.two_pi=6.28318530717959,ClipperLib.ClipperOffset.def_arc_tolerance=.25,ClipperLib.ClipperOffset.prototype.Clear=function(){ClipperLib.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},ClipperLib.ClipperOffset.Round=ClipperLib.Clipper.Round,ClipperLib.ClipperOffset.prototype.AddPath=function(path,joinType,endType){var highI=path.length-1;if(!(highI<0)){var newNode=new ClipperLib.PolyNode;if(newNode.m_jointype=joinType,newNode.m_endtype=endType,endType==ClipperLib.EndType.etClosedLine||endType==ClipperLib.EndType.etClosedPolygon)for(;highI>0&&ClipperLib.IntPoint.op_Equality(path[0],path[highI]);)highI--;newNode.m_polygon.push(path[0]);for(var j=0,k=0,i=1;i<=highI;i++)ClipperLib.IntPoint.op_Inequality(newNode.m_polygon[j],path[i])&&(j++,newNode.m_polygon.push(path[i]),(path[i].Y>newNode.m_polygon[k].Y||path[i].Y==newNode.m_polygon[k].Y&&path[i].X<newNode.m_polygon[k].X)&&(k=j));if(!(endType==ClipperLib.EndType.etClosedPolygon&&j<2)&&(this.m_polyNodes.AddChild(newNode),endType==ClipperLib.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new ClipperLib.IntPoint(this.m_polyNodes.ChildCount()-1,k);else{var ip=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(newNode.m_polygon[k].Y>ip.Y||newNode.m_polygon[k].Y==ip.Y&&newNode.m_polygon[k].X<ip.X)&&(this.m_lowest=new ClipperLib.IntPoint(this.m_polyNodes.ChildCount()-1,k))}}},ClipperLib.ClipperOffset.prototype.AddPaths=function(paths,joinType,endType){for(var i=0,ilen=paths.length;i<ilen;i++)this.AddPath(paths[i],joinType,endType)},ClipperLib.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!ClipperLib.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var i=0;i<this.m_polyNodes.ChildCount();i++){var node;((node=this.m_polyNodes.Childs()[i]).m_endtype==ClipperLib.EndType.etClosedPolygon||node.m_endtype==ClipperLib.EndType.etClosedLine&&ClipperLib.Clipper.Orientation(node.m_polygon))&&node.m_polygon.reverse()}else for(var i=0;i<this.m_polyNodes.ChildCount();i++){var node;(node=this.m_polyNodes.Childs()[i]).m_endtype!=ClipperLib.EndType.etClosedLine||ClipperLib.Clipper.Orientation(node.m_polygon)||node.m_polygon.reverse()}},ClipperLib.ClipperOffset.GetUnitNormal=function(pt1,pt2){var dx=pt2.X-pt1.X,dy=pt2.Y-pt1.Y;if(0==dx&&0==dy)return new ClipperLib.DoublePoint(0,0);var f=1/Math.sqrt(dx*dx+dy*dy);return dx*=f,dy*=f,new ClipperLib.DoublePoint(dy,-dx)},ClipperLib.ClipperOffset.prototype.DoOffset=function(delta){if(this.m_destPolys=new Array,this.m_delta=delta,ClipperLib.ClipperBase.near_zero(delta))for(var i=0;i<this.m_polyNodes.ChildCount();i++){var node;(node=this.m_polyNodes.Childs()[i]).m_endtype==ClipperLib.EndType.etClosedPolygon&&this.m_destPolys.push(node.m_polygon)}else{var y;this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5,y=this.ArcTolerance<=0?ClipperLib.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(delta)*ClipperLib.ClipperOffset.def_arc_tolerance?Math.abs(delta)*ClipperLib.ClipperOffset.def_arc_tolerance:this.ArcTolerance;var steps=3.14159265358979/Math.acos(1-y/Math.abs(delta));this.m_sin=Math.sin(ClipperLib.ClipperOffset.two_pi/steps),this.m_cos=Math.cos(ClipperLib.ClipperOffset.two_pi/steps),this.m_StepsPerRad=steps/ClipperLib.ClipperOffset.two_pi,delta<0&&(this.m_sin=-this.m_sin);for(var i=0;i<this.m_polyNodes.ChildCount();i++){var node=this.m_polyNodes.Childs()[i];this.m_srcPoly=node.m_polygon;var len=this.m_srcPoly.length;if(!(0==len||delta<=0&&(len<3||node.m_endtype!=ClipperLib.EndType.etClosedPolygon)))if(this.m_destPoly=new Array,1!=len){this.m_normals.length=0;for(var j=0;j<len-1;j++)this.m_normals.push(ClipperLib.ClipperOffset.GetUnitNormal(this.m_srcPoly[j],this.m_srcPoly[j+1]));if(node.m_endtype==ClipperLib.EndType.etClosedLine||node.m_endtype==ClipperLib.EndType.etClosedPolygon?this.m_normals.push(ClipperLib.ClipperOffset.GetUnitNormal(this.m_srcPoly[len-1],this.m_srcPoly[0])):this.m_normals.push(new ClipperLib.DoublePoint(this.m_normals[len-2])),node.m_endtype==ClipperLib.EndType.etClosedPolygon){for(var k=len-1,j=0;j<len;j++)k=this.OffsetPoint(j,k,node.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(node.m_endtype==ClipperLib.EndType.etClosedLine){for(var k=len-1,j=0;j<len;j++)k=this.OffsetPoint(j,k,node.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var n=this.m_normals[len-1],j=len-1;j>0;j--)this.m_normals[j]=new ClipperLib.DoublePoint(-this.m_normals[j-1].X,-this.m_normals[j-1].Y);this.m_normals[0]=new ClipperLib.DoublePoint(-n.X,-n.Y),k=0;for(var j=len-1;j>=0;j--)k=this.OffsetPoint(j,k,node.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var k=0,j=1,pt1;j<len-1;++j)k=this.OffsetPoint(j,k,node.m_jointype);if(node.m_endtype==ClipperLib.EndType.etOpenButt){var j=len-1;pt1=new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].X+this.m_normals[j].X*delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].Y+this.m_normals[j].Y*delta)),this.m_destPoly.push(pt1),pt1=new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].X-this.m_normals[j].X*delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].Y-this.m_normals[j].Y*delta)),this.m_destPoly.push(pt1)}else{var j=len-1;k=len-2,this.m_sinA=0,this.m_normals[j]=new ClipperLib.DoublePoint(-this.m_normals[j].X,-this.m_normals[j].Y),node.m_endtype==ClipperLib.EndType.etOpenSquare?this.DoSquare(j,k):this.DoRound(j,k)}for(var j=len-1;j>0;j--)this.m_normals[j]=new ClipperLib.DoublePoint(-this.m_normals[j-1].X,-this.m_normals[j-1].Y);this.m_normals[0]=new ClipperLib.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y);for(var j=(k=len-1)-1;j>0;--j)k=this.OffsetPoint(j,k,node.m_jointype);node.m_endtype==ClipperLib.EndType.etOpenButt?(pt1=new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*delta)),this.m_destPoly.push(pt1),pt1=new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*delta)),this.m_destPoly.push(pt1)):(k=1,this.m_sinA=0,node.m_endtype==ClipperLib.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}else{if(node.m_jointype==ClipperLib.JoinType.jtRound)for(var X=1,Y=0,j=1;j<=steps;j++){this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].X+X*delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].Y+Y*delta)));var X2=X;X=X*this.m_cos-this.m_sin*Y,Y=X2*this.m_sin+Y*this.m_cos}else for(var X=-1,Y=-1,j=0;j<4;++j)this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].X+X*delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].Y+Y*delta))),X<0?X=1:Y<0?Y=1:X=-1;this.m_destPolys.push(this.m_destPoly)}}}},ClipperLib.ClipperOffset.prototype.Execute=function(){var a=arguments,ispolytree=a[0]instanceof ClipperLib.PolyTree;if(ispolytree){var solution=a[0],delta=a[1],clpr;if(solution.Clear(),this.FixOrientations(),this.DoOffset(delta),(clpr=new ClipperLib.Clipper(0)).AddPaths(this.m_destPolys,ClipperLib.PolyType.ptSubject,!0),delta>0)clpr.Execute(ClipperLib.ClipType.ctUnion,solution,ClipperLib.PolyFillType.pftPositive,ClipperLib.PolyFillType.pftPositive);else{var r=ClipperLib.Clipper.GetBounds(this.m_destPolys),outer;if((outer=new ClipperLib.Path).push(new ClipperLib.IntPoint(r.left-10,r.bottom+10)),outer.push(new ClipperLib.IntPoint(r.right+10,r.bottom+10)),outer.push(new ClipperLib.IntPoint(r.right+10,r.top-10)),outer.push(new ClipperLib.IntPoint(r.left-10,r.top-10)),clpr.AddPath(outer,ClipperLib.PolyType.ptSubject,!0),clpr.ReverseSolution=!0,clpr.Execute(ClipperLib.ClipType.ctUnion,solution,ClipperLib.PolyFillType.pftNegative,ClipperLib.PolyFillType.pftNegative),1==solution.ChildCount()&&solution.Childs()[0].ChildCount()>0){var outerNode=solution.Childs()[0];solution.Childs()[0]=outerNode.Childs()[0],solution.Childs()[0].m_Parent=solution;for(var i=1;i<outerNode.ChildCount();i++)solution.AddChild(outerNode.Childs()[i])}else solution.Clear()}}else{var solution=a[0],delta=a[1],clpr;if(ClipperLib.Clear(solution),this.FixOrientations(),this.DoOffset(delta),(clpr=new ClipperLib.Clipper(0)).AddPaths(this.m_destPolys,ClipperLib.PolyType.ptSubject,!0),delta>0)clpr.Execute(ClipperLib.ClipType.ctUnion,solution,ClipperLib.PolyFillType.pftPositive,ClipperLib.PolyFillType.pftPositive);else{var r=ClipperLib.Clipper.GetBounds(this.m_destPolys),outer;(outer=new ClipperLib.Path).push(new ClipperLib.IntPoint(r.left-10,r.bottom+10)),outer.push(new ClipperLib.IntPoint(r.right+10,r.bottom+10)),outer.push(new ClipperLib.IntPoint(r.right+10,r.top-10)),outer.push(new ClipperLib.IntPoint(r.left-10,r.top-10)),clpr.AddPath(outer,ClipperLib.PolyType.ptSubject,!0),clpr.ReverseSolution=!0,clpr.Execute(ClipperLib.ClipType.ctUnion,solution,ClipperLib.PolyFillType.pftNegative,ClipperLib.PolyFillType.pftNegative),solution.length>0&&solution.splice(0,1)}}},ClipperLib.ClipperOffset.prototype.OffsetPoint=function(j,k,jointype){var cosA;if(this.m_sinA=this.m_normals[k].X*this.m_normals[j].Y-this.m_normals[j].X*this.m_normals[k].Y,Math.abs(this.m_sinA*this.m_delta)<1){if(this.m_normals[k].X*this.m_normals[j].X+this.m_normals[j].Y*this.m_normals[k].Y>0)return this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].X+this.m_normals[k].X*this.m_delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].Y+this.m_normals[k].Y*this.m_delta))),k}else this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1);if(this.m_sinA*this.m_delta<0)this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].X+this.m_normals[k].X*this.m_delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].Y+this.m_normals[k].Y*this.m_delta))),this.m_destPoly.push(new ClipperLib.IntPoint(this.m_srcPoly[j])),this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].X+this.m_normals[j].X*this.m_delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].Y+this.m_normals[j].Y*this.m_delta)));else switch(jointype){case ClipperLib.JoinType.jtMiter:var r=this.m_normals[j].X*this.m_normals[k].X+this.m_normals[j].Y*this.m_normals[k].Y+1;r>=this.m_miterLim?this.DoMiter(j,k,r):this.DoSquare(j,k);break;case ClipperLib.JoinType.jtSquare:this.DoSquare(j,k);break;case ClipperLib.JoinType.jtRound:this.DoRound(j,k)}return k=j},ClipperLib.ClipperOffset.prototype.DoSquare=function(j,k){var dx=Math.tan(Math.atan2(this.m_sinA,this.m_normals[k].X*this.m_normals[j].X+this.m_normals[k].Y*this.m_normals[j].Y)/4);this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].X+this.m_delta*(this.m_normals[k].X-this.m_normals[k].Y*dx)),ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].Y+this.m_delta*(this.m_normals[k].Y+this.m_normals[k].X*dx)))),this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].X+this.m_delta*(this.m_normals[j].X+this.m_normals[j].Y*dx)),ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].Y+this.m_delta*(this.m_normals[j].Y-this.m_normals[j].X*dx))))},ClipperLib.ClipperOffset.prototype.DoMiter=function(j,k,r){var q=this.m_delta/r;this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].X+(this.m_normals[k].X+this.m_normals[j].X)*q),ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].Y+(this.m_normals[k].Y+this.m_normals[j].Y)*q)))},ClipperLib.ClipperOffset.prototype.DoRound=function(j,k){for(var a=Math.atan2(this.m_sinA,this.m_normals[k].X*this.m_normals[j].X+this.m_normals[k].Y*this.m_normals[j].Y),steps=Math.max(ClipperLib.Cast_Int32(ClipperLib.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(a))),1),X=this.m_normals[k].X,Y=this.m_normals[k].Y,X2,i=0;i<steps;++i)this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].X+X*this.m_delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].Y+Y*this.m_delta))),X2=X,X=X*this.m_cos-this.m_sin*Y,Y=X2*this.m_sin+Y*this.m_cos;this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].X+this.m_normals[j].X*this.m_delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[j].Y+this.m_normals[j].Y*this.m_delta)))},ClipperLib.Error=function(message){throw new Error(message)},ClipperLib.JS={},ClipperLib.JS.AreaOfPolygon=function(poly,scale){return scale||(scale=1),ClipperLib.Clipper.Area(poly)/(scale*scale)},ClipperLib.JS.AreaOfPolygons=function(poly,scale){scale||(scale=1);for(var area=0,i=0;i<poly.length;i++)area+=ClipperLib.Clipper.Area(poly[i]);return area/(scale*scale)},ClipperLib.JS.BoundsOfPath=function(path,scale){return ClipperLib.JS.BoundsOfPaths([path],scale)},ClipperLib.JS.BoundsOfPaths=function(paths,scale){scale||(scale=1);var bounds=ClipperLib.Clipper.GetBounds(paths);return bounds.left/=scale,bounds.bottom/=scale,bounds.right/=scale,bounds.top/=scale,bounds},ClipperLib.JS.Clean=function(polygon,delta){if(!(polygon instanceof Array))return[];var isPolygons=polygon[0]instanceof Array,polygon=ClipperLib.JS.Clone(polygon);if("number"!=typeof delta||null===delta)return ClipperLib.Error("Delta is not a number in Clean()."),polygon;if(0===polygon.length||1==polygon.length&&0===polygon[0].length||delta<0)return polygon;isPolygons||(polygon=[polygon]);for(var k_length=polygon.length,len,poly,result,d,p,j,i,results=[],k=0;k<k_length;k++)if(0!==(len=(poly=polygon[k]).length))if(len<3)result=poly,results.push(result);else{for(result=poly,d=delta*delta,p=poly[0],j=1,i=1;i<len;i++)(poly[i].X-p.X)*(poly[i].X-p.X)+(poly[i].Y-p.Y)*(poly[i].Y-p.Y)<=d||(result[j]=poly[i],p=poly[i],j++);p=poly[j-1],(poly[0].X-p.X)*(poly[0].X-p.X)+(poly[0].Y-p.Y)*(poly[0].Y-p.Y)<=d&&j--,j<len&&result.splice(j,len-j),result.length&&results.push(result)}return!isPolygons&&results.length?results=results[0]:isPolygons||0!==results.length?isPolygons&&0===results.length&&(results=[[]]):results=[],results},ClipperLib.JS.Clone=function(polygon){if(!(polygon instanceof Array))return[];if(0===polygon.length)return[];if(1==polygon.length&&0===polygon[0].length)return[[]];var isPolygons=polygon[0]instanceof Array;isPolygons||(polygon=[polygon]);var len=polygon.length,plen,i,j,result,results=new Array(len);for(i=0;i<len;i++){for(plen=polygon[i].length,result=new Array(plen),j=0;j<plen;j++)result[j]={X:polygon[i][j].X,Y:polygon[i][j].Y};results[i]=result}return isPolygons||(results=results[0]),results},ClipperLib.JS.Lighten=function(polygon,tolerance){if(!(polygon instanceof Array))return[];if("number"!=typeof tolerance||null===tolerance)return ClipperLib.Error("Tolerance is not a number in Lighten()."),ClipperLib.JS.Clone(polygon);if(0===polygon.length||1==polygon.length&&0===polygon[0].length||tolerance<0)return ClipperLib.JS.Clone(polygon);var i,j,poly,k,poly2,plen,A,B,P,d,rem,addlast,bxax,byay,l,ax,ay;polygon[0]instanceof Array||(polygon=[polygon]);var len=polygon.length,toleranceSq=tolerance*tolerance,results=[];for(i=0;i<len;i++)if(0!=(plen=(poly=polygon[i]).length)){for(k=0;k<1e6;k++){for(poly2=[],poly[(plen=poly.length)-1].X!=poly[0].X||poly[plen-1].Y!=poly[0].Y?(addlast=1,poly.push({X:poly[0].X,Y:poly[0].Y}),plen=poly.length):addlast=0,rem=[],j=0;j<plen-2;j++)A=poly[j],P=poly[j+1],B=poly[j+2],ax=A.X,ay=A.Y,bxax=B.X-ax,byay=B.Y-ay,0===bxax&&0===byay||((l=((P.X-ax)*bxax+(P.Y-ay)*byay)/(bxax*bxax+byay*byay))>1?(ax=B.X,ay=B.Y):l>0&&(ax+=bxax*l,ay+=byay*l)),(d=(bxax=P.X-ax)*bxax+(byay=P.Y-ay)*byay)<=toleranceSq&&(rem[j+1]=1,j++);for(poly2.push({X:poly[0].X,Y:poly[0].Y}),j=1;j<plen-1;j++)rem[j]||poly2.push({X:poly[j].X,Y:poly[j].Y});if(poly2.push({X:poly[plen-1].X,Y:poly[plen-1].Y}),addlast&&poly.pop(),!rem.length)break;poly=poly2}poly2[(plen=poly2.length)-1].X==poly2[0].X&&poly2[plen-1].Y==poly2[0].Y&&poly2.pop(),poly2.length>2&&results.push(poly2)}return polygon[0]instanceof Array||(results=results[0]),void 0===results&&(results=[[]]),results},ClipperLib.JS.PerimeterOfPath=function(path,closed,scale){if(void 0===path)return 0;var sqrt=Math.sqrt,perimeter=0,p1,p2,p1x=0,p1y=0,p2x=0,p2y=0,j=path.length;if(j<2)return 0;for(closed&&(path[j]=path[0],j++);--j;)p1x=(p1=path[j]).X,p1y=p1.Y,perimeter+=sqrt((p1x-(p2x=(p2=path[j-1]).X))*(p1x-p2x)+(p1y-(p2y=p2.Y))*(p1y-p2y));return closed&&path.pop(),perimeter/scale},ClipperLib.JS.PerimeterOfPaths=function(paths,closed,scale){scale||(scale=1);for(var perimeter=0,i=0;i<paths.length;i++)perimeter+=ClipperLib.JS.PerimeterOfPath(paths[i],closed,scale);return perimeter},ClipperLib.JS.ScaleDownPath=function(path,scale){var i,p;for(scale||(scale=1),i=path.length;i--;)(p=path[i]).X=p.X/scale,p.Y=p.Y/scale},ClipperLib.JS.ScaleDownPaths=function(paths,scale){var i,j,p;for(scale||(scale=1),i=paths.length;i--;)for(j=paths[i].length;j--;)(p=paths[i][j]).X=p.X/scale,p.Y=p.Y/scale},ClipperLib.JS.ScaleUpPath=function(path,scale){var i,p,round=Math.round;for(scale||(scale=1),i=path.length;i--;)(p=path[i]).X=round(p.X*scale),p.Y=round(p.Y*scale)},ClipperLib.JS.ScaleUpPaths=function(paths,scale){var i,j,p,round=Math.round;for(scale||(scale=1),i=paths.length;i--;)for(j=paths[i].length;j--;)(p=paths[i][j]).X=round(p.X*scale),p.Y=round(p.Y*scale)},ClipperLib.ExPolygons=function(){return[]},ClipperLib.ExPolygon=function(){this.outer=null,this.holes=null},ClipperLib.JS.AddOuterPolyNodeToExPolygons=function(polynode,expolygons){var ep=new ClipperLib.ExPolygon;ep.outer=polynode.Contour();var childs=polynode.Childs(),ilen=childs.length,node,n,i,j,childs2,jlen;for(ep.holes=new Array(ilen),i=0;i<ilen;i++)for(node=childs[i],ep.holes[i]=node.Contour(),j=0,jlen=(childs2=node.Childs()).length;j<jlen;j++)n=childs2[j],ClipperLib.JS.AddOuterPolyNodeToExPolygons(n,expolygons);expolygons.push(ep)},ClipperLib.JS.ExPolygonsToPaths=function(expolygons){var a,i,alen,ilen,paths=new ClipperLib.Paths;for(a=0,alen=expolygons.length;a<alen;a++)for(paths.push(expolygons[a].outer),i=0,ilen=expolygons[a].holes.length;i<ilen;i++)paths.push(expolygons[a].holes[i]);return paths},ClipperLib.JS.PolyTreeToExPolygons=function(polytree){var expolygons=new ClipperLib.ExPolygons,node,i,childs,ilen;for(i=0,ilen=(childs=polytree.Childs()).length;i<ilen;i++)node=childs[i],ClipperLib.JS.AddOuterPolyNodeToExPolygons(node,expolygons);return expolygons}}()},{}]},{},[13])(13)})),function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;(g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).gd=f()}}((function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){var n=t[o][1][e];return s(n||e)}),l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function Treemap(){this.parent,this.data,this.count=0,this.items=[],this.x=0,this.y=0,this.w=0,this.h=0,this.options,arguments.length>=4?(this.x=arguments[0],this.y=arguments[1],this.w=arguments[2],this.h=arguments[3],this.options=arguments[4]):(this.parent=arguments[0],this.data=arguments[1],this.count=arguments[2]||0),this.x=this.x||0,this.y=this.y||0,this.w=this.w||0,this.h=this.h||0,this.minCount=0,this.maxCount=0,this.parent?this.level=this.parent.level+1:this.level=0,this.depth=0,this.itemCount=1,this.index=0,this.root=this,this.isRoot=!0,this.parent&&(this.root=this.parent.root,this.isRoot=!1),this.options=this.options||this.root.options,this.ignored=!1,Treemap.prototype.addData=function(data,keys){if(keys){keys.data?this.data=data[keys.data]:this.data=data,this.count="number"==typeof data?data:data[keys.count]||0;var children=data;return keys.children&&(children=data[keys.children]),children instanceof Array&&(children.forEach(function(child){var t=new Treemap(this);this.items.push(t),t.addData(child,keys)}.bind(this)),!0)}var i=this.items.findIndex((function(el){return el.data==data}));return i>=0?(this.items[i].count++,!1):(this.items.push(new Treemap(this,data,1)),!0)},Treemap.prototype.addTreemap=function(data,count){var t=new Treemap(this,data,count);return this.items.push(t),t},Treemap.prototype.sumUpCounters=function(){if(this.options.ignore instanceof Array&&(this.options.ignore.indexOf(this.data)>=0?this.ignored=!0:this.ignored=!1),0==this.items.length){if(this.ignored)return 0}else{if(this.minCount=Number.MAX_VALUE,this.maxCount=0,this.depth=0,this.itemCount=1,this.count=0,this.ignored)return 0;for(var i=0;i<this.items.length;i++){var sum=this.items[i].sumUpCounters();this.count+=sum,this.minCount=min(this.minCount,sum),this.maxCount=max(this.maxCount,sum),this.depth=max(this.depth,this.items[i].depth+1),this.itemCount+=this.items[i].itemCount}}return this.count},Treemap.prototype.calculate=function(){if(0!=this.items.length){if(this==this.root&&this.sumUpCounters(),this.ignored)return this.x=-1e5,this.y=0,this.w=0,void(this.h=0);1==this.options.sort||null==this.options.sort?this.items.sort((function(a,b){return a.count<b.count?1:a.count>b.count?-1:0})):shuffleArray(this.items);for(var i=0;i<this.items.length;i++)this.items[i].index=i;for(var restSum=this.count,pad=this.options.padding||0,restX=this.x+pad,restY=this.y+pad,restW=this.w-2*pad,restH=this.h-2*pad,actIndex=0;actIndex<this.items.length;){var isHorizontal=!0,a=restW,b=restH;"horizontal"!=this.options.direction&&(restW>restH||"vertical"==this.options.direction)&&(isHorizontal=!1,a=restH,b=restW);for(var rowSum=0,rowCount=0,avRelPrev=Number.MAX_VALUE,i=actIndex;i<this.items.length;i++){var percentage,bLen=b*((rowSum+=this.items[i].count)/restSum),avRel=a/++rowCount/bLen;if(avRel<1||i==this.items.length-1){avRelPrev<1/avRel&&(rowCount--,bLen=b*(rowSum-=this.items[i].count)/restSum,i--);var aPos=restX,bPos=restY,aLen=restW;isHorizontal||(aPos=restY,bPos=restX,aLen=restH);for(var j=actIndex;j<=i;j++){var aPart=aLen*this.items[j].count/rowSum;isHorizontal?(this.items[j].x=aPos,this.items[j].y=bPos,this.items[j].w=aPart,this.items[j].h=bLen):(this.items[j].x=bPos,this.items[j].y=aPos,this.items[j].w=bLen,this.items[j].h=aPart),this.items[j].w=max(this.items[j].w,0),this.items[j].h=max(this.items[j].h,0),this.items[j].calculate(),aPos+=aPart}isHorizontal?(restY+=bLen,restH-=bLen):(restX+=bLen,restW-=bLen),restSum-=rowSum;break}avRelPrev=avRel}actIndex=i+1}}},Treemap.prototype.draw=function(drawItemFunction){if(!this.ignored){drawItemFunction?drawItemFunction(this):rect(this.x,this.y,this.w,this.h);for(var i=0;i<this.items.length;i++)this.items[i].draw(drawItemFunction)}}}function shuffleArray(array){for(var i=array.length-1;i>0;i--){var j=floor(random()*(i+1)),temp=array[i];array[i]=array[j],array[j]=temp}}module.exports=Treemap},{}],2:[function(require,module,exports){"use strict";function WacomTablet(){this.penValues={isWacom:null,isEraser:null,pressure:null,sysX:null,sysY:null,tabX:null,tabY:null,rotationDeg:null,rotationRad:null,tiltX:null,tiltY:null,tangPressure:null,version:null,pointerType:null,tabletModel:null,azimuth:null,altitude:null}}WacomTablet.prototype._calcAzimuthXAndAltitude=function(tiltX,tiltY){var PI_over_2=Math.PI/2,azimuthXAndAltitude=[];if(tiltX<0)azimuthXAndAltitude[0]=PI;else{if(0==tiltX&&0==tiltY)return azimuthXAndAltitude[0]=0,azimuthXAndAltitude[1]=PI_over_2,azimuthXAndAltitude;azimuthXAndAltitude[0]=0}var tanTiltY=Math.tan(tiltY);return azimuthXAndAltitude[0]+=Math.atan(tanTiltY/Math.tan(tiltX)),azimuthXAndAltitude[1]=0==azimuthXAndAltitude[0]?PI_over_2-tiltX:Math.abs(Math.atan(Math.sin(azimuthXAndAltitude[0])/tanTiltY)),azimuthXAndAltitude},WacomTablet.prototype._getWacomPlugin=function(){return document.getElementById("wtPlugin")},WacomTablet.prototype._update=function(){var wtPlugin=this._getWacomPlugin();if(!wtPlugin)return this.penValues;if(!wtPlugin.penAPI)return this.penValues;this.penValues.isWacom=wtPlugin.penAPI.isWacom,this.penValues.isEraser=wtPlugin.penAPI.isEraser,this.penValues.pressure=wtPlugin.penAPI.pressure,this.penValues.sysX=wtPlugin.penAPI.sysX,this.penValues.sysY=wtPlugin.penAPI.sysY,this.penValues.tabX=Number(wtPlugin.penAPI.tabX),this.penValues.tabY=Number(wtPlugin.penAPI.tabY),this.penValues.rotationDeg=wtPlugin.penAPI.rotationDeg,this.penValues.rotationRad=wtPlugin.penAPI.rotationRad,this.penValues.tiltX=wtPlugin.penAPI.tiltX,this.penValues.tiltY=wtPlugin.penAPI.tiltY,this.penValues.tangPressure=wtPlugin.penAPI.tangPressure,this.penValues.version=wtPlugin.penAPI.version,this.penValues.pointerType=Number(wtPlugin.penAPI.pointerType),this.penValues.tabletModel=wtPlugin.penAPI.tabletModel;var evalAzimuthXAndAltitude=this._calcAzimuthXAndAltitude(this.penValues.tiltX,this.penValues.tiltY);return this.penValues.azimuth=evalAzimuthXAndAltitude[0],this.penValues.altitude=evalAzimuthXAndAltitude[1],this.penValues},WacomTablet.prototype.values=function(){return this._update()},module.exports=WacomTablet},{}],3:[function(require,module,exports){"use strict";var aseUtils=require("ase-utils"),RED="red",GREEN="green",BLUE="blue",HUE="hue",SATURATION="saturation",BRIGHTNESS="brightness",GRAYSCALE="grayscale",ALPHA="alpha",sortColors=function(colors,method){return method==RED&&colors.sort((function(a,b){return red(a)<red(b)?-1:red(a)>red(b)?1:0})),method==GREEN&&colors.sort((function(a,b){return green(a)<green(b)?-1:green(a)>green(b)?1:0})),method==BLUE&&colors.sort((function(a,b){return blue(a)<blue(b)?-1:blue(a)>blue(b)?1:0})),method==HUE&&colors.sort((function(a,b){var aHue=chroma(red(a),green(a),blue(a)).get("hsv.h"),bHue=chroma(red(b),green(b),blue(b)).get("hsv.h");return aHue<bHue?-1:aHue>bHue?1:0})),method==SATURATION&&colors.sort((function(a,b){var aSat=chroma(red(a),green(a),blue(a)).get("hsv.s"),bSat=chroma(red(b),green(b),blue(b)).get("hsv.s");return aSat<bSat?-1:aSat>bSat?1:0})),method==BRIGHTNESS&&colors.sort((function(a,b){var aBright=chroma(red(a),green(a),blue(a)).get("hsv.v"),bBright=chroma(red(b),green(b),blue(b)).get("hsv.v");return aBright<bBright?-1:aBright>bBright?1:0})),method==GRAYSCALE&&colors.sort((function(a,b){var aGrey=.222*red(a)+.707*green(a)+.071*blue(a),bGrey=.222*red(b)+.707*green(b)+.071*blue(b);return aGrey<bGrey?-1:aGrey>bGrey?1:0})),method==ALPHA&&colors.sort((function(a,b){return alpha(a)<alpha(b)?-1:alpha(a)>alpha(b)?1:0})),colors},aseEncode=function(p5colors){var swatches={version:"1.0",groups:[],colors:[]};function checkAndAddSwatch(c){if(!(c instanceof p5.Color))throw new Error("Needs p5.Color array as argument.");swatches.colors.push({name:c._array.slice(0,3).join("-"),model:"RGB",color:c._array.slice(0,3),type:"global"})}return Array.isArray(p5colors)?p5colors.forEach((function(c){checkAndAddSwatch(c)})):checkAndAddSwatch(p5colors),aseUtils.encode(swatches)};module.exports.RED=RED,module.exports.GREEN=GREEN,module.exports.BLUE=BLUE,module.exports.HUE=HUE,module.exports.SATURATION=SATURATION,module.exports.BRIGHTNESS=BRIGHTNESS,module.exports.GRAYSCALE=GRAYSCALE,module.exports.ALPHA=ALPHA,module.exports.sortColors=sortColors,module.exports.ase={},module.exports.ase.encode=aseEncode},{"ase-utils":8}],4:[function(require,module,exports){"use strict";var packageInfo=require("./package.json"),color=require("./color"),WacomTablet=require("./WacomTablet.js"),Treemap=require("./Treemap.js");console.log("%c * "+packageInfo.name+" "+packageInfo.version+" * ","background: #3c3; color: black");var timestamp=function(){var date=new Date,year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate(),hour=date.getHours(),minute=date.getMinutes(),second=date.getSeconds(),millis=date.getMilliseconds();return[year=year.toString().substr(2),month=("00"+month).substr(-2,2),day=("00"+day).substr(-2,2),"_",hour,minute=("00"+minute).substr(-2,2),second=("00"+second).substr(-2,2),"_",millis].join("")};module.exports.version=packageInfo.version,module.exports.timestamp=timestamp,module.exports.WacomTablet=WacomTablet,module.exports.Treemap=Treemap,module.exports.RED=color.RED,module.exports.GREEN=color.GREEN,module.exports.BLUE=color.BLUE,module.exports.HUE=color.HUE,module.exports.SATURATION=color.SATURATION,module.exports.BRIGHTNESS=color.BRIGHTNESS,module.exports.GRAYSCALE=color.GRAYSCALE,module.exports.ALPHA=color.ALPHA,module.exports.sortColors=color.sortColors,module.exports.ase=color.ase},{"./Treemap.js":1,"./WacomTablet.js":2,"./color":3,"./package.json":19}],5:[function(require,module,exports){module.exports={FILE_SIGNATURE:"ASEF",FORMAT_VERSION:65536,COLOR_START:1,GROUP_START:49153,GROUP_END:49154,MODE_COLOR:1,MODE_GROUP:2,STATE_GET_MODE:1,STATE_GET_LENGTH:2,STATE_GET_NAME:3,STATE_GET_MODEL:4,STATE_GET_COLOR:5,STATE_GET_TYPE:6,COLOR_SIZES:{CMYK:4,RGB:3,LAB:3,GRAY:1},READ_COLOR_TYPES:{0:"global",1:"spot",2:"normal"},WRITE_COLOR_TYPES:{global:0,spot:1,normal:2}}},{}],6:[function(require,module,exports){(function(Buffer){var assert=require("assert"),constants=require("./constants"),errors_header="Not a valid .ASE file",errors_unexpected="Unexpected state. This is a bug!";function decode(buffer){"string"==typeof buffer&&(buffer=Buffer(buffer));var output={},groups=output.groups=[],colors=output.colors=[];assert("A"===getChar8(0),errors_header),assert("S"===getChar8(1),errors_header),assert("E"===getChar8(2),errors_header),assert("F"===getChar8(3),errors_header),output.version=[buffer.readUInt16BE(4),buffer.readUInt16BE(6)].join(".");var blocks=buffer.readUInt32BE(8),state=constants.STATE_GET_MODE,mode=constants.MODE_COLOR,position=12,blockLength,block,group,color;x:for(;position<buffer.length;){switch(state){case constants.STATE_GET_MODE:readBlockMode();continue x;case constants.STATE_GET_LENGTH:readBlockLength();continue x;case constants.STATE_GET_NAME:readBlockName();continue x;case constants.STATE_GET_MODEL:readBlockModel();continue x;case constants.STATE_GET_COLOR:readBlockColor();continue x;case constants.STATE_GET_TYPE:readBlockType();continue x}throw new Error(errors_unexpected)}return output;function readBlockMode(){switch(buffer.readUInt16BE(position)){case constants.COLOR_START:colors.push(block=color={}),mode=constants.MODE_COLOR;break;case constants.GROUP_START:groups.push(block=group={colors:[]}),mode=constants.MODE_GROUP;break;case constants.GROUP_END:group=null;break;default:throw new Error("Unexpected block type at byte #"+position)}group&&block===color&&group.colors.push(color),position+=2,state=constants.STATE_GET_LENGTH}function readBlockLength(){blockLength=buffer.readUInt32BE(position),position+=4,state=constants.STATE_GET_NAME}function readBlockName(){for(var length=buffer.readUInt16BE(position),name="";--length;)name+=getChar16(position+=2);position+=4,block.name=name,state=mode===constants.MODE_GROUP?constants.STATE_GET_MODE:constants.STATE_GET_MODEL}function readBlockModel(){block.model=(getChar8(position++)+getChar8(position++)+getChar8(position++)+getChar8(position++)).trim(),state=constants.STATE_GET_COLOR}function readBlockColor(){for(var model=block.model.toUpperCase(),count=constants.COLOR_SIZES[model],channels=[];count--;)channels.push(buffer.readFloatBE(position)),position+=4;block.color=channels,state=constants.STATE_GET_TYPE}function readBlockType(){block.type=constants.READ_COLOR_TYPES[buffer.readUInt16BE(position)],position+=2,state=constants.STATE_GET_MODE}function getChar8(index){return String.fromCharCode(buffer.readUInt8(index))}function getChar16(index){return String.fromCharCode(buffer.readUInt16BE(index))}}module.exports=decode}).call(this,require("buffer").Buffer)},{"./constants":5,assert:11,buffer:13}],7:[function(require,module,exports){var ByteBuffer=require("bytebuffer"),constants=require("./constants");function encode(data){var colors=data.colors,numberOfSwatches=data.colors.length,ase=new ByteBuffer;ase.writeUTF8String(constants.FILE_SIGNATURE),ase.writeInt(constants.FORMAT_VERSION),ase.writeInt(numberOfSwatches);for(var i=0;i<numberOfSwatches;i++){var color=colors[i],swatch=new ByteBuffer,j=null;for(ase.writeShort(constants.COLOR_START),swatch.writeShort(color.name.length+1),j=0;j<color.name.length;j++)swatch.writeShort(color.name.charCodeAt(j));swatch.writeShort(0);var model=4==color.model.length?color.model:color.model+" ";for(swatch.writeUTF8String(model),j=0;j<constants.COLOR_SIZES[color.model.toUpperCase()];j++)swatch.writeFloat(color.color[j]);swatch.writeShort(constants.WRITE_COLOR_TYPES[color.type]),ase.writeInt(swatch.offset),swatch.flip(),ase.append(swatch)}return ase.flip(),ase.toBuffer()}module.exports=encode},{"./constants":5,bytebuffer:9}],8:[function(require,module,exports){module.exports={encode:require("./encode"),decode:require("./decode")}},{"./decode":6,"./encode":7}],9:[function(require,module,exports){
/**
 * @license ByteBuffer.js (c) 2013-2014 Daniel Wirtz <dcode@dcode.io>
 * This version of ByteBuffer.js uses an ArrayBuffer (AB) as its backing buffer and is compatible with modern browsers.
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/ByteBuffer.js for details
 */
!function(global){"use strict";function loadByteBuffer(Long){var ByteBuffer=function(capacity,littleEndian,noAssert){if(void 0===capacity&&(capacity=ByteBuffer.DEFAULT_CAPACITY),void 0===littleEndian&&(littleEndian=ByteBuffer.DEFAULT_ENDIAN),void 0===noAssert&&(noAssert=ByteBuffer.DEFAULT_NOASSERT),!noAssert){if((capacity|=0)<0)throw RangeError("Illegal capacity");littleEndian=!!littleEndian,noAssert=!!noAssert}this.buffer=0===capacity?EMPTY_BUFFER:new ArrayBuffer(capacity),this.view=0===capacity?null:new DataView(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=capacity,this.littleEndian=void 0!==littleEndian&&!!littleEndian,this.noAssert=!!noAssert};ByteBuffer.VERSION="3.5.4",ByteBuffer.LITTLE_ENDIAN=!0,ByteBuffer.BIG_ENDIAN=!1,ByteBuffer.DEFAULT_CAPACITY=16,ByteBuffer.DEFAULT_ENDIAN=ByteBuffer.BIG_ENDIAN,ByteBuffer.DEFAULT_NOASSERT=!1,ByteBuffer.Long=Long||null;var ByteBufferPrototype=ByteBuffer.prototype,EMPTY_BUFFER=new ArrayBuffer(0),stringFromCharCode=String.fromCharCode;function stringSource(s){var i=0;return function(){return i<s.length?s.charCodeAt(i++):null}}function stringDestination(){var cs=[],ps=[];return function(){if(0===arguments.length)return ps.join("")+stringFromCharCode.apply(String,cs);cs.length+arguments.length>1024&&(ps.push(stringFromCharCode.apply(String,cs)),cs.length=0),Array.prototype.push.apply(cs,arguments)}}ByteBuffer.allocate=function(capacity,littleEndian,noAssert){return new ByteBuffer(capacity,littleEndian,noAssert)},ByteBuffer.concat=function(buffers,encoding,littleEndian,noAssert){"boolean"!=typeof encoding&&"string"==typeof encoding||(noAssert=littleEndian,littleEndian=encoding,encoding=void 0);for(var capacity=0,i=0,k=buffers.length,length;i<k;++i)ByteBuffer.isByteBuffer(buffers[i])||(buffers[i]=ByteBuffer.wrap(buffers[i],encoding)),(length=buffers[i].limit-buffers[i].offset)>0&&(capacity+=length);if(0===capacity)return new ByteBuffer(0,littleEndian,noAssert);var bb=new ByteBuffer(capacity,littleEndian,noAssert),bi,view=new Uint8Array(bb.buffer);for(i=0;i<k;)(length=(bi=buffers[i++]).limit-bi.offset)<=0||(view.set(new Uint8Array(bi.buffer).subarray(bi.offset,bi.limit),bb.offset),bb.offset+=length);return bb.limit=bb.offset,bb.offset=0,bb},ByteBuffer.isByteBuffer=function(bb){return!0===(bb&&bb instanceof ByteBuffer)},ByteBuffer.type=function(){return ArrayBuffer},ByteBuffer.wrap=function(buffer,encoding,littleEndian,noAssert){if("string"!=typeof encoding&&(noAssert=littleEndian,littleEndian=encoding,encoding=void 0),"string"==typeof buffer)switch(void 0===encoding&&(encoding="utf8"),encoding){case"base64":return ByteBuffer.fromBase64(buffer,littleEndian);case"hex":return ByteBuffer.fromHex(buffer,littleEndian);case"binary":return ByteBuffer.fromBinary(buffer,littleEndian);case"utf8":return ByteBuffer.fromUTF8(buffer,littleEndian);case"debug":return ByteBuffer.fromDebug(buffer,littleEndian);default:throw Error("Unsupported encoding: "+encoding)}if(null===buffer||"object"!=typeof buffer)throw TypeError("Illegal buffer");var bb;if(ByteBuffer.isByteBuffer(buffer))return(bb=ByteBufferPrototype.clone.call(buffer)).markedOffset=-1,bb;if(buffer instanceof Uint8Array)bb=new ByteBuffer(0,littleEndian,noAssert),buffer.length>0&&(bb.buffer=buffer.buffer,bb.offset=buffer.byteOffset,bb.limit=buffer.byteOffset+buffer.length,bb.view=buffer.length>0?new DataView(buffer.buffer):null);else if(buffer instanceof ArrayBuffer)bb=new ByteBuffer(0,littleEndian,noAssert),buffer.byteLength>0&&(bb.buffer=buffer,bb.offset=0,bb.limit=buffer.byteLength,bb.view=buffer.byteLength>0?new DataView(buffer):null);else{if("[object Array]"!==Object.prototype.toString.call(buffer))throw TypeError("Illegal buffer");for((bb=new ByteBuffer(buffer.length,littleEndian,noAssert)).limit=buffer.length,i=0;i<buffer.length;++i)bb.view.setUint8(i,buffer[i])}return bb},ByteBufferPrototype.writeInt8=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value|=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=1;var capacity0=this.buffer.byteLength;return offset>capacity0&&this.resize((capacity0*=2)>offset?capacity0:offset),offset-=1,this.view.setInt8(offset,value),relative&&(this.offset+=1),this},ByteBufferPrototype.writeByte=ByteBufferPrototype.writeInt8,ByteBufferPrototype.readInt8=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var value=this.view.getInt8(offset);return relative&&(this.offset+=1),value},ByteBufferPrototype.readByte=ByteBufferPrototype.readInt8,ByteBufferPrototype.writeUint8=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value>>>=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=1;var capacity1=this.buffer.byteLength;return offset>capacity1&&this.resize((capacity1*=2)>offset?capacity1:offset),offset-=1,this.view.setUint8(offset,value),relative&&(this.offset+=1),this},ByteBufferPrototype.readUint8=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var value=this.view.getUint8(offset);return relative&&(this.offset+=1),value},ByteBufferPrototype.writeInt16=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value|=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=2;var capacity2=this.buffer.byteLength;return offset>capacity2&&this.resize((capacity2*=2)>offset?capacity2:offset),offset-=2,this.view.setInt16(offset,value,this.littleEndian),relative&&(this.offset+=2),this},ByteBufferPrototype.writeShort=ByteBufferPrototype.writeInt16,ByteBufferPrototype.readInt16=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+2) <= "+this.buffer.byteLength)}var value=this.view.getInt16(offset,this.littleEndian);return relative&&(this.offset+=2),value},ByteBufferPrototype.readShort=ByteBufferPrototype.readInt16,ByteBufferPrototype.writeUint16=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value>>>=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=2;var capacity3=this.buffer.byteLength;return offset>capacity3&&this.resize((capacity3*=2)>offset?capacity3:offset),offset-=2,this.view.setUint16(offset,value,this.littleEndian),relative&&(this.offset+=2),this},ByteBufferPrototype.readUint16=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+2) <= "+this.buffer.byteLength)}var value=this.view.getUint16(offset,this.littleEndian);return relative&&(this.offset+=2),value},ByteBufferPrototype.writeInt32=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value|=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=4;var capacity4=this.buffer.byteLength;return offset>capacity4&&this.resize((capacity4*=2)>offset?capacity4:offset),offset-=4,this.view.setInt32(offset,value,this.littleEndian),relative&&(this.offset+=4),this},ByteBufferPrototype.writeInt=ByteBufferPrototype.writeInt32,ByteBufferPrototype.readInt32=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+4) <= "+this.buffer.byteLength)}var value=this.view.getInt32(offset,this.littleEndian);return relative&&(this.offset+=4),value},ByteBufferPrototype.readInt=ByteBufferPrototype.readInt32,ByteBufferPrototype.writeUint32=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value>>>=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=4;var capacity5=this.buffer.byteLength;return offset>capacity5&&this.resize((capacity5*=2)>offset?capacity5:offset),offset-=4,this.view.setUint32(offset,value,this.littleEndian),relative&&(this.offset+=4),this},ByteBufferPrototype.readUint32=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+4) <= "+this.buffer.byteLength)}var value=this.view.getUint32(offset,this.littleEndian);return relative&&(this.offset+=4),value},Long&&(ByteBufferPrototype.writeInt64=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"==typeof value)value=Long.fromNumber(value);else if(!(value&&value instanceof Long))throw TypeError("Illegal value: "+value+" (not an integer or Long)");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}"number"==typeof value&&(value=Long.fromNumber(value)),offset+=8;var capacity6=this.buffer.byteLength;return offset>capacity6&&this.resize((capacity6*=2)>offset?capacity6:offset),offset-=8,this.littleEndian?(this.view.setInt32(offset,value.low,!0),this.view.setInt32(offset+4,value.high,!0)):(this.view.setInt32(offset,value.high,!1),this.view.setInt32(offset+4,value.low,!1)),relative&&(this.offset+=8),this},ByteBufferPrototype.writeLong=ByteBufferPrototype.writeInt64,ByteBufferPrototype.readInt64=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+8) <= "+this.buffer.byteLength)}var value=this.littleEndian?new Long(this.view.getInt32(offset,!0),this.view.getInt32(offset+4,!0),!1):new Long(this.view.getInt32(offset+4,!1),this.view.getInt32(offset,!1),!1);return relative&&(this.offset+=8),value},ByteBufferPrototype.readLong=ByteBufferPrototype.readInt64,ByteBufferPrototype.writeUint64=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"==typeof value)value=Long.fromNumber(value);else if(!(value&&value instanceof Long))throw TypeError("Illegal value: "+value+" (not an integer or Long)");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}"number"==typeof value&&(value=Long.fromNumber(value)),offset+=8;var capacity7=this.buffer.byteLength;return offset>capacity7&&this.resize((capacity7*=2)>offset?capacity7:offset),offset-=8,this.littleEndian?(this.view.setInt32(offset,value.low,!0),this.view.setInt32(offset+4,value.high,!0)):(this.view.setInt32(offset,value.high,!1),this.view.setInt32(offset+4,value.low,!1)),relative&&(this.offset+=8),this},ByteBufferPrototype.readUint64=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+8) <= "+this.buffer.byteLength)}var value=this.littleEndian?new Long(this.view.getInt32(offset,!0),this.view.getInt32(offset+4,!0),!0):new Long(this.view.getInt32(offset+4,!1),this.view.getInt32(offset,!1),!0);return relative&&(this.offset+=8),value}),ByteBufferPrototype.writeFloat32=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value)throw TypeError("Illegal value: "+value+" (not a number)");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=4;var capacity8=this.buffer.byteLength;return offset>capacity8&&this.resize((capacity8*=2)>offset?capacity8:offset),offset-=4,this.view.setFloat32(offset,value,this.littleEndian),relative&&(this.offset+=4),this},ByteBufferPrototype.writeFloat=ByteBufferPrototype.writeFloat32,ByteBufferPrototype.readFloat32=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+4) <= "+this.buffer.byteLength)}var value=this.view.getFloat32(offset,this.littleEndian);return relative&&(this.offset+=4),value},ByteBufferPrototype.readFloat=ByteBufferPrototype.readFloat32,ByteBufferPrototype.writeFloat64=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value)throw TypeError("Illegal value: "+value+" (not a number)");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=8;var capacity9=this.buffer.byteLength;return offset>capacity9&&this.resize((capacity9*=2)>offset?capacity9:offset),offset-=8,this.view.setFloat64(offset,value,this.littleEndian),relative&&(this.offset+=8),this},ByteBufferPrototype.writeDouble=ByteBufferPrototype.writeFloat64,ByteBufferPrototype.readFloat64=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+8) <= "+this.buffer.byteLength)}var value=this.view.getFloat64(offset,this.littleEndian);return relative&&(this.offset+=8),value},ByteBufferPrototype.readDouble=ByteBufferPrototype.readFloat64,ByteBuffer.MAX_VARINT32_BYTES=5,ByteBuffer.calculateVarint32=function(value){return(value>>>=0)<128?1:value<16384?2:value<1<<21?3:value<1<<28?4:5},ByteBuffer.zigZagEncode32=function(n){return((n|=0)<<1^n>>31)>>>0},ByteBuffer.zigZagDecode32=function(n){return n>>>1^-(1&n)|0},ByteBufferPrototype.writeVarint32=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value|=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var size=ByteBuffer.calculateVarint32(value),b;offset+=size;var capacity10=this.buffer.byteLength;return offset>capacity10&&this.resize((capacity10*=2)>offset?capacity10:offset),offset-=size,this.view.setUint8(offset,b=128|value),(value>>>=0)>=128?(b=value>>7|128,this.view.setUint8(offset+1,b),value>=16384?(b=value>>14|128,this.view.setUint8(offset+2,b),value>=1<<21?(b=value>>21|128,this.view.setUint8(offset+3,b),value>=1<<28?(this.view.setUint8(offset+4,value>>28&15),size=5):(this.view.setUint8(offset+3,127&b),size=4)):(this.view.setUint8(offset+2,127&b),size=3)):(this.view.setUint8(offset+1,127&b),size=2)):(this.view.setUint8(offset,127&b),size=1),relative?(this.offset+=size,this):size},ByteBufferPrototype.writeVarint32ZigZag=function(value,offset){return this.writeVarint32(ByteBuffer.zigZagEncode32(value),offset)},ByteBufferPrototype.readVarint32=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var size=0,value=0,temp,ioffset;do{if(ioffset=offset+size,!this.noAssert&&ioffset>this.limit){var err=Error("Truncated");throw err.truncated=!0,err}temp=this.view.getUint8(ioffset),size<5&&(value|=(127&temp)<<7*size>>>0),++size}while(128==(128&temp));return value|=0,relative?(this.offset+=size,value):{value:value,length:size}},ByteBufferPrototype.readVarint32ZigZag=function(offset){var val=this.readVarint32(offset);return"object"==typeof val?val.value=ByteBuffer.zigZagDecode32(val.value):val=ByteBuffer.zigZagDecode32(val),val},Long&&(ByteBuffer.MAX_VARINT64_BYTES=10,ByteBuffer.calculateVarint64=function(value){"number"==typeof value&&(value=Long.fromNumber(value));var part0=value.toInt()>>>0,part1=value.shiftRightUnsigned(28).toInt()>>>0,part2=value.shiftRightUnsigned(56).toInt()>>>0;return 0==part2?0==part1?part0<16384?part0<128?1:2:part0<1<<21?3:4:part1<16384?part1<128?5:6:part1<1<<21?7:8:part2<128?9:10},ByteBuffer.zigZagEncode64=function(value){return"number"==typeof value?value=Long.fromNumber(value,!1):!1!==value.unsigned&&(value=value.toSigned()),value.shiftLeft(1).xor(value.shiftRight(63)).toUnsigned()},ByteBuffer.zigZagDecode64=function(value){return"number"==typeof value?value=Long.fromNumber(value,!1):!1!==value.unsigned&&(value=value.toSigned()),value.shiftRightUnsigned(1).xor(value.and(Long.ONE).toSigned().negate()).toSigned()},ByteBufferPrototype.writeVarint64=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"==typeof value)value=Long.fromNumber(value);else if(!(value&&value instanceof Long))throw TypeError("Illegal value: "+value+" (not an integer or Long)");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}"number"==typeof value?value=Long.fromNumber(value,!1):!1!==value.unsigned&&(value=value.toSigned());var size=ByteBuffer.calculateVarint64(value),part0=value.toInt()>>>0,part1=value.shiftRightUnsigned(28).toInt()>>>0,part2=value.shiftRightUnsigned(56).toInt()>>>0;offset+=size;var capacity11=this.buffer.byteLength;switch(offset>capacity11&&this.resize((capacity11*=2)>offset?capacity11:offset),offset-=size,size){case 10:this.view.setUint8(offset+9,part2>>>7&1);case 9:this.view.setUint8(offset+8,9!==size?128|part2:127&part2);case 8:this.view.setUint8(offset+7,8!==size?part1>>>21|128:part1>>>21&127);case 7:this.view.setUint8(offset+6,7!==size?part1>>>14|128:part1>>>14&127);case 6:this.view.setUint8(offset+5,6!==size?part1>>>7|128:part1>>>7&127);case 5:this.view.setUint8(offset+4,5!==size?128|part1:127&part1);case 4:this.view.setUint8(offset+3,4!==size?part0>>>21|128:part0>>>21&127);case 3:this.view.setUint8(offset+2,3!==size?part0>>>14|128:part0>>>14&127);case 2:this.view.setUint8(offset+1,2!==size?part0>>>7|128:part0>>>7&127);case 1:this.view.setUint8(offset,1!==size?128|part0:127&part0)}return relative?(this.offset+=size,this):size},ByteBufferPrototype.writeVarint64ZigZag=function(value,offset){return this.writeVarint64(ByteBuffer.zigZagEncode64(value),offset)},ByteBufferPrototype.readVarint64=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var start=offset,part0=0,part1=0,part2=0,b=0;if(part0=127&(b=this.view.getUint8(offset++)),128&b&&(part0|=(127&(b=this.view.getUint8(offset++)))<<7,128&b&&(part0|=(127&(b=this.view.getUint8(offset++)))<<14,128&b&&(part0|=(127&(b=this.view.getUint8(offset++)))<<21,128&b&&(part1=127&(b=this.view.getUint8(offset++)),128&b&&(part1|=(127&(b=this.view.getUint8(offset++)))<<7,128&b&&(part1|=(127&(b=this.view.getUint8(offset++)))<<14,128&b&&(part1|=(127&(b=this.view.getUint8(offset++)))<<21,128&b&&(part2=127&(b=this.view.getUint8(offset++)),128&b&&(part2|=(127&(b=this.view.getUint8(offset++)))<<7,128&b))))))))))throw Error("Buffer overrun");var value=Long.fromBits(part0|part1<<28,part1>>>4|part2<<24,!1);return relative?(this.offset=offset,value):{value:value,length:offset-start}},ByteBufferPrototype.readVarint64ZigZag=function(offset){var val=this.readVarint64(offset);return val&&val.value instanceof Long?val.value=ByteBuffer.zigZagDecode64(val.value):val=ByteBuffer.zigZagDecode64(val),val}),ByteBufferPrototype.writeCString=function(str,offset){var relative=void 0===offset;relative&&(offset=this.offset);var i,k=str.length;if(!this.noAssert){if("string"!=typeof str)throw TypeError("Illegal str: Not a string");for(i=0;i<k;++i)if(0===str.charCodeAt(i))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var start=offset;k=utfx.calculateUTF16asUTF8(stringSource(str))[1],offset+=k+1;var capacity12=this.buffer.byteLength;return offset>capacity12&&this.resize((capacity12*=2)>offset?capacity12:offset),offset-=k+1,utfx.encodeUTF16toUTF8(stringSource(str),function(b){this.view.setUint8(offset++,b)}.bind(this)),this.view.setUint8(offset++,0),relative?(this.offset=offset-start,this):k},ByteBufferPrototype.readCString=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var start=offset,temp,sd,b=-1;return utfx.decodeUTF8toUTF16(function(){if(0===b)return null;if(offset>=this.limit)throw RangeError("Illegal range: Truncated data, "+offset+" < "+this.limit);return 0===(b=this.view.getUint8(offset++))?null:b}.bind(this),sd=stringDestination(),!0),relative?(this.offset=offset,sd()):{string:sd(),length:offset-start}},ByteBufferPrototype.writeIString=function(str,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("string"!=typeof str)throw TypeError("Illegal str: Not a string");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var start=offset,k;k=utfx.calculateUTF16asUTF8(stringSource(str),this.noAssert)[1],offset+=4+k;var capacity13=this.buffer.byteLength;if(offset>capacity13&&this.resize((capacity13*=2)>offset?capacity13:offset),offset-=4+k,this.view.setUint32(offset,k,this.littleEndian),offset+=4,utfx.encodeUTF16toUTF8(stringSource(str),function(b){this.view.setUint8(offset++,b)}.bind(this)),offset!==start+4+k)throw RangeError("Illegal range: Truncated data, "+offset+" == "+(offset+4+k));return relative?(this.offset=offset,this):offset-start},ByteBufferPrototype.readIString=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+4) <= "+this.buffer.byteLength)}var temp=0,start=offset,str;temp=this.view.getUint32(offset,this.littleEndian);var k=(offset+=4)+temp,sd;return utfx.decodeUTF8toUTF16(function(){return offset<k?this.view.getUint8(offset++):null}.bind(this),sd=stringDestination(),this.noAssert),str=sd(),relative?(this.offset=offset,str):{string:str,length:offset-start}},ByteBuffer.METRICS_CHARS="c",ByteBuffer.METRICS_BYTES="b",ByteBufferPrototype.writeUTF8String=function(str,offset){var relative=void 0===offset,k;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var start=offset;k=utfx.calculateUTF16asUTF8(stringSource(str))[1],offset+=k;var capacity14=this.buffer.byteLength;return offset>capacity14&&this.resize((capacity14*=2)>offset?capacity14:offset),offset-=k,utfx.encodeUTF16toUTF8(stringSource(str),function(b){this.view.setUint8(offset++,b)}.bind(this)),relative?(this.offset=offset,this):offset-start},ByteBufferPrototype.writeString=ByteBufferPrototype.writeUTF8String,ByteBuffer.calculateUTF8Chars=function(str){return utfx.calculateUTF16asUTF8(stringSource(str))[0]},ByteBuffer.calculateUTF8Bytes=function(str){return utfx.calculateUTF16asUTF8(stringSource(str))[1]},ByteBufferPrototype.readUTF8String=function(length,metrics,offset){"number"==typeof metrics&&(offset=metrics,metrics=void 0);var relative=void 0===offset;if(relative&&(offset=this.offset),void 0===metrics&&(metrics=ByteBuffer.METRICS_CHARS),!this.noAssert){if("number"!=typeof length||length%1!=0)throw TypeError("Illegal length: "+length+" (not an integer)");if(length|=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var i=0,start=offset,sd;if(metrics===ByteBuffer.METRICS_CHARS){if(sd=stringDestination(),utfx.decodeUTF8(function(){return i<length&&offset<this.limit?this.view.getUint8(offset++):null}.bind(this),function(cp){++i,utfx.UTF8toUTF16(cp,sd)}.bind(this)),i!==length)throw RangeError("Illegal range: Truncated data, "+i+" == "+length);return relative?(this.offset=offset,sd()):{string:sd(),length:offset-start}}if(metrics===ByteBuffer.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+length>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+"+length+") <= "+this.buffer.byteLength)}var k=offset+length;if(utfx.decodeUTF8toUTF16(function(){return offset<k?this.view.getUint8(offset++):null}.bind(this),sd=stringDestination(),this.noAssert),offset!==k)throw RangeError("Illegal range: Truncated data, "+offset+" == "+k);return relative?(this.offset=offset,sd()):{string:sd(),length:offset-start}}throw TypeError("Unsupported metrics: "+metrics)},ByteBufferPrototype.readString=ByteBufferPrototype.readUTF8String,ByteBufferPrototype.writeVString=function(str,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("string"!=typeof str)throw TypeError("Illegal str: Not a string");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var start=offset,k,l;k=utfx.calculateUTF16asUTF8(stringSource(str),this.noAssert)[1],l=ByteBuffer.calculateVarint32(k),offset+=l+k;var capacity15=this.buffer.byteLength;if(offset>capacity15&&this.resize((capacity15*=2)>offset?capacity15:offset),offset-=l+k,offset+=this.writeVarint32(k,offset),utfx.encodeUTF16toUTF8(stringSource(str),function(b){this.view.setUint8(offset++,b)}.bind(this)),offset!==start+k+l)throw RangeError("Illegal range: Truncated data, "+offset+" == "+(offset+k+l));return relative?(this.offset=offset,this):offset-start},ByteBufferPrototype.readVString=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var temp=this.readVarint32(offset),start=offset,str;offset+=temp.length,temp=temp.value;var k=offset+temp,sd=stringDestination();return utfx.decodeUTF8toUTF16(function(){return offset<k?this.view.getUint8(offset++):null}.bind(this),sd,this.noAssert),str=sd(),relative?(this.offset=offset,str):{string:str,length:offset-start}},ByteBufferPrototype.append=function(source,encoding,offset){"number"!=typeof encoding&&"string"==typeof encoding||(offset=encoding,encoding=void 0);var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}source instanceof ByteBuffer||(source=ByteBuffer.wrap(source,encoding));var length=source.limit-source.offset;if(length<=0)return this;offset+=length;var capacity16=this.buffer.byteLength;return offset>capacity16&&this.resize((capacity16*=2)>offset?capacity16:offset),offset-=length,new Uint8Array(this.buffer,offset).set(new Uint8Array(source.buffer).subarray(source.offset,source.limit)),source.offset+=length,relative&&(this.offset+=length),this},ByteBufferPrototype.appendTo=function(target,offset){return target.append(this,offset),this},ByteBufferPrototype.assert=function(assert){return this.noAssert=!assert,this},ByteBufferPrototype.capacity=function(){return this.buffer.byteLength},ByteBufferPrototype.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},ByteBufferPrototype.clone=function(copy){var bb=new ByteBuffer(0,this.littleEndian,this.noAssert);if(copy){var buffer=new ArrayBuffer(this.buffer.byteLength);new Uint8Array(buffer).set(this.buffer),bb.buffer=buffer,bb.view=new DataView(buffer)}else bb.buffer=this.buffer,bb.view=this.view;return bb.offset=this.offset,bb.markedOffset=this.markedOffset,bb.limit=this.limit,bb},ByteBufferPrototype.compact=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}if(0===begin&&end===this.buffer.byteLength)return this;var len=end-begin;if(0===len)return this.buffer=EMPTY_BUFFER,this.view=null,this.markedOffset>=0&&(this.markedOffset-=begin),this.offset=0,this.limit=0,this;var buffer=new ArrayBuffer(len);return new Uint8Array(buffer).set(new Uint8Array(this.buffer).subarray(begin,end)),this.buffer=buffer,this.view=new DataView(buffer),this.markedOffset>=0&&(this.markedOffset-=begin),this.offset=0,this.limit=len,this},ByteBufferPrototype.copy=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}if(begin===end)return new ByteBuffer(0,this.littleEndian,this.noAssert);var capacity=end-begin,bb=new ByteBuffer(capacity,this.littleEndian,this.noAssert);return bb.offset=0,bb.limit=capacity,bb.markedOffset>=0&&(bb.markedOffset-=begin),this.copyTo(bb,0,begin,end),bb},ByteBufferPrototype.copyTo=function(target,targetOffset,sourceOffset,sourceLimit){var relative,targetRelative;if(!this.noAssert&&!ByteBuffer.isByteBuffer(target))throw TypeError("Illegal target: Not a ByteBuffer");if(targetOffset=(targetRelative=void 0===targetOffset)?target.offset:0|targetOffset,sourceOffset=(relative=void 0===sourceOffset)?this.offset:0|sourceOffset,sourceLimit=void 0===sourceLimit?this.limit:0|sourceLimit,targetOffset<0||targetOffset>target.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+targetOffset+" <= "+target.buffer.byteLength);if(sourceOffset<0||sourceLimit>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+sourceOffset+" <= "+this.buffer.byteLength);var len=sourceLimit-sourceOffset;return 0===len?target:(target.ensureCapacity(targetOffset+len),new Uint8Array(target.buffer).set(new Uint8Array(this.buffer).subarray(sourceOffset,sourceLimit),targetOffset),relative&&(this.offset+=len),targetRelative&&(target.offset+=len),this)},ByteBufferPrototype.ensureCapacity=function(capacity){var current=this.buffer.byteLength;return current<capacity?this.resize((current*=2)>capacity?current:capacity):this},ByteBufferPrototype.fill=function(value,begin,end){var relative=void 0===begin;if(relative&&(begin=this.offset),"string"==typeof value&&value.length>0&&(value=value.charCodeAt(0)),void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value|=0,"number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}if(begin>=end)return this;for(;begin<end;)this.view.setUint8(begin++,value);return relative&&(this.offset=begin),this},ByteBufferPrototype.flip=function(){return this.limit=this.offset,this.offset=0,this},ByteBufferPrototype.mark=function(offset){if(offset=void 0===offset?this.offset:offset,!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=offset,this},ByteBufferPrototype.order=function(littleEndian){if(!this.noAssert&&"boolean"!=typeof littleEndian)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!littleEndian,this},ByteBufferPrototype.LE=function(littleEndian){return this.littleEndian=void 0===littleEndian||!!littleEndian,this},ByteBufferPrototype.BE=function(bigEndian){return this.littleEndian=void 0!==bigEndian&&!bigEndian,this},ByteBufferPrototype.prepend=function(source,encoding,offset){"number"!=typeof encoding&&"string"==typeof encoding||(offset=encoding,encoding=void 0);var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}source instanceof ByteBuffer||(source=ByteBuffer.wrap(source,encoding));var len=source.limit-source.offset;if(len<=0)return this;var diff=len-offset,arrayView;if(diff>0){var buffer=new ArrayBuffer(this.buffer.byteLength+diff);(arrayView=new Uint8Array(buffer)).set(new Uint8Array(this.buffer).subarray(offset,this.buffer.byteLength),len),this.buffer=buffer,this.view=new DataView(buffer),this.offset+=diff,this.markedOffset>=0&&(this.markedOffset+=diff),this.limit+=diff,offset+=diff}else arrayView=new Uint8Array(this.buffer);return arrayView.set(new Uint8Array(source.buffer).subarray(source.offset,source.limit),offset-len),source.offset=source.limit,relative&&(this.offset-=len),this},ByteBufferPrototype.prependTo=function(target,offset){return target.prepend(this,offset),this},ByteBufferPrototype.printDebug=function(out){"function"!=typeof out&&(out=console.log.bind(console)),out(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},ByteBufferPrototype.remaining=function(){return this.limit-this.offset},ByteBufferPrototype.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},ByteBufferPrototype.resize=function(capacity){if(!this.noAssert){if("number"!=typeof capacity||capacity%1!=0)throw TypeError("Illegal capacity: "+capacity+" (not an integer)");if((capacity|=0)<0)throw RangeError("Illegal capacity: 0 <= "+capacity)}if(this.buffer.byteLength<capacity){var buffer=new ArrayBuffer(capacity);new Uint8Array(buffer).set(new Uint8Array(this.buffer)),this.buffer=buffer,this.view=new DataView(buffer)}return this},ByteBufferPrototype.reverse=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}return begin===end?this:(Array.prototype.reverse.call(new Uint8Array(this.buffer).subarray(begin,end)),this.view=new DataView(this.buffer),this)},ByteBufferPrototype.skip=function(length){if(!this.noAssert){if("number"!=typeof length||length%1!=0)throw TypeError("Illegal length: "+length+" (not an integer)");length|=0}var offset=this.offset+length;if(!this.noAssert&&(offset<0||offset>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+length+" <= "+this.buffer.byteLength);return this.offset=offset,this},ByteBufferPrototype.slice=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}var bb=this.clone();return bb.offset=begin,bb.limit=end,bb},ByteBufferPrototype.toBuffer=function(forceCopy){var offset=this.offset,limit=this.limit;if(offset>limit){var t=offset;offset=limit,limit=t}if(!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: Not an integer");if(offset>>>=0,"number"!=typeof limit||limit%1!=0)throw TypeError("Illegal limit: Not an integer");if(limit>>>=0,offset<0||offset>limit||limit>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+offset+" <= "+limit+" <= "+this.buffer.byteLength)}if(!forceCopy&&0===offset&&limit===this.buffer.byteLength)return this.buffer;if(offset===limit)return EMPTY_BUFFER;var buffer=new ArrayBuffer(limit-offset);return new Uint8Array(buffer).set(new Uint8Array(this.buffer).subarray(offset,limit),0),buffer},ByteBufferPrototype.toArrayBuffer=ByteBufferPrototype.toBuffer,ByteBufferPrototype.toString=function(encoding,begin,end){if(void 0===encoding)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof encoding&&(end=begin=encoding="utf8"),encoding){case"utf8":return this.toUTF8(begin,end);case"base64":return this.toBase64(begin,end);case"hex":return this.toHex(begin,end);case"binary":return this.toBinary(begin,end);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+encoding)}};var lxiv=function(){for(var lxiv={},aout=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],ain=[],i=0,k=aout.length;i<k;++i)ain[aout[i]]=i;return lxiv.encode=function(src,dst){for(var b,t;null!==(b=src());)dst(aout[b>>2&63]),t=(3&b)<<4,null!==(b=src())?(dst(aout[63&((t|=b>>4&15)|b>>4&15)]),t=(15&b)<<2,null!==(b=src())?(dst(aout[63&(t|b>>6&3)]),dst(aout[63&b])):(dst(aout[63&t]),dst(61))):(dst(aout[63&t]),dst(61),dst(61))},lxiv.decode=function(src,dst){var c,t1,t2;function fail(c){throw Error("Illegal character code: "+c)}for(;null!==(c=src());)if(void 0===(t1=ain[c])&&fail(c),null!==(c=src())&&(void 0===(t2=ain[c])&&fail(c),dst(t1<<2>>>0|(48&t2)>>4),null!==(c=src()))){if(void 0===(t1=ain[c])){if(61===c)break;fail(c)}if(dst((15&t2)<<4>>>0|(60&t1)>>2),null!==(c=src())){if(void 0===(t2=ain[c])){if(61===c)break;fail(c)}dst((3&t1)<<6>>>0|t2)}}},lxiv.test=function(str){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(str)},lxiv}();ByteBufferPrototype.toBase64=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}var sd;return lxiv.encode(function(){return begin<end?this.view.getUint8(begin++):null}.bind(this),sd=stringDestination()),sd()},ByteBuffer.fromBase64=function(str,littleEndian,noAssert){if(!noAssert){if("string"!=typeof str)throw TypeError("Illegal str: Not a string");if(str.length%4!=0)throw TypeError("Illegal str: Length not a multiple of 4")}var bb=new ByteBuffer(str.length/4*3,littleEndian,noAssert),i=0;return lxiv.decode(stringSource(str),(function(b){bb.view.setUint8(i++,b)})),bb.limit=i,bb},ByteBuffer.btoa=function(str){return ByteBuffer.fromBinary(str).toBase64()},ByteBuffer.atob=function(b64){return ByteBuffer.fromBase64(b64).toBinary()},ByteBufferPrototype.toBinary=function(begin,end){if(begin=void 0===begin?this.offset:begin,end=void 0===end?this.limit:end,!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}if(begin===end)return"";for(var cc=[],pt=[];begin<end;)cc.push(this.view.getUint8(begin++)),cc.length>=1024&&(pt.push(String.fromCharCode.apply(String,cc)),cc=[]);return pt.join("")+String.fromCharCode.apply(String,cc)},ByteBuffer.fromBinary=function(str,littleEndian,noAssert){if(!noAssert&&"string"!=typeof str)throw TypeError("Illegal str: Not a string");for(var i=0,k=str.length,charCode,bb=new ByteBuffer(k,littleEndian,noAssert);i<k;){if(charCode=str.charCodeAt(i),!noAssert&&charCode>255)throw RangeError("Illegal charCode at "+i+": 0 <= "+charCode+" <= 255");bb.view.setUint8(i++,charCode)}return bb.limit=k,bb},ByteBufferPrototype.toDebug=function(columns){for(var i=-1,k=this.buffer.byteLength,b,hex="",asc="",out="";i<k;){if(-1!==i&&(hex+=(b=this.view.getUint8(i))<16?"0"+b.toString(16).toUpperCase():b.toString(16).toUpperCase(),columns&&(asc+=b>32&&b<127?String.fromCharCode(b):".")),++i,columns&&i>0&&i%16==0&&i!==k){for(;hex.length<51;)hex+=" ";out+=hex+asc+"\n",hex=asc=""}i===this.offset&&i===this.limit?hex+=i===this.markedOffset?"!":"|":i===this.offset?hex+=i===this.markedOffset?"[":"<":i===this.limit?hex+=i===this.markedOffset?"]":">":hex+=i===this.markedOffset?"'":columns||0!==i&&i!==k?" ":""}if(columns&&" "!==hex){for(;hex.length<51;)hex+=" ";out+=hex+asc+"\n"}return columns?out:hex},ByteBuffer.fromDebug=function(str,littleEndian,noAssert){for(var k=str.length,bb=new ByteBuffer((k+1)/3|0,littleEndian,noAssert),i=0,j=0,ch,b,rs=!1,ho=!1,hm=!1,hl=!1,fail=!1;i<k;){switch(ch=str.charAt(i++)){case"!":if(!noAssert){if(ho||hm||hl){fail=!0;break}ho=hm=hl=!0}bb.offset=bb.markedOffset=bb.limit=j,rs=!1;break;case"|":if(!noAssert){if(ho||hl){fail=!0;break}ho=hl=!0}bb.offset=bb.limit=j,rs=!1;break;case"[":if(!noAssert){if(ho||hm){fail=!0;break}ho=hm=!0}bb.offset=bb.markedOffset=j,rs=!1;break;case"<":if(!noAssert){if(ho){fail=!0;break}ho=!0}bb.offset=j,rs=!1;break;case"]":if(!noAssert){if(hl||hm){fail=!0;break}hl=hm=!0}bb.limit=bb.markedOffset=j,rs=!1;break;case">":if(!noAssert){if(hl){fail=!0;break}hl=!0}bb.limit=j,rs=!1;break;case"'":if(!noAssert){if(hm){fail=!0;break}hm=!0}bb.markedOffset=j,rs=!1;break;case" ":rs=!1;break;default:if(!noAssert&&rs){fail=!0;break}if(b=parseInt(ch+str.charAt(i++),16),!noAssert&&(isNaN(b)||b<0||b>255))throw TypeError("Illegal str: Not a debug encoded string");bb.view.setUint8(j++,b),rs=!0}if(fail)throw TypeError("Illegal str: Invalid symbol at "+i)}if(!noAssert){if(!ho||!hl)throw TypeError("Illegal str: Missing offset or limit");if(j<bb.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+j+" < "+k)}return bb},ByteBufferPrototype.toHex=function(begin,end){if(begin=void 0===begin?this.offset:begin,end=void 0===end?this.limit:end,!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}for(var out=new Array(end-begin),b;begin<end;)(b=this.view.getUint8(begin++))<16?out.push("0",b.toString(16)):out.push(b.toString(16));return out.join("")},ByteBuffer.fromHex=function(str,littleEndian,noAssert){if(!noAssert){if("string"!=typeof str)throw TypeError("Illegal str: Not a string");if(str.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var k=str.length,bb=new ByteBuffer(k/2|0,littleEndian),b,i=0,j=0;i<k;i+=2){if(b=parseInt(str.substring(i,i+2),16),!noAssert&&(!isFinite(b)||b<0||b>255))throw TypeError("Illegal str: Contains non-hex characters");bb.view.setUint8(j++,b)}return bb.limit=j,bb};var utfx=function(){var utfx={MAX_CODEPOINT:1114111,encodeUTF8:function(src,dst){var cp=null;for("number"==typeof src&&(cp=src,src=function(){return null});null!==cp||null!==(cp=src());)cp<128?dst(127&cp):cp<2048?(dst(cp>>6&31|192),dst(63&cp|128)):cp<65536?(dst(cp>>12&15|224),dst(cp>>6&63|128),dst(63&cp|128)):(dst(cp>>18&7|240),dst(cp>>12&63|128),dst(cp>>6&63|128),dst(63&cp|128)),cp=null},decodeUTF8:function(src,dst){for(var a,b,c,d,fail=function(b){b=b.slice(0,b.indexOf(null));var err=Error(b.toString());throw err.name="TruncatedError",err.bytes=b,err};null!==(a=src());)if(0==(128&a))dst(a);else if(192==(224&a))null===(b=src())&&fail([a,b]),dst((31&a)<<6|63&b);else if(224==(240&a))(null===(b=src())||null===(c=src()))&&fail([a,b,c]),dst((15&a)<<12|(63&b)<<6|63&c);else{if(240!=(248&a))throw RangeError("Illegal starting byte: "+a);(null===(b=src())||null===(c=src())||null===(d=src()))&&fail([a,b,c,d]),dst((7&a)<<18|(63&b)<<12|(63&c)<<6|63&d)}},UTF16toUTF8:function(src,dst){for(var c1,c2=null;null!==(c1=null!==c2?c2:src());)c1>=55296&&c1<=57343&&null!==(c2=src())&&c2>=56320&&c2<=57343?(dst(1024*(c1-55296)+c2-56320+65536),c2=null):dst(c1);null!==c2&&dst(c2)},UTF8toUTF16:function(src,dst){var cp=null;for("number"==typeof src&&(cp=src,src=function(){return null});null!==cp||null!==(cp=src());)cp<=65535?dst(cp):(dst(55296+((cp-=65536)>>10)),dst(cp%1024+56320)),cp=null},encodeUTF16toUTF8:function(src,dst){utfx.UTF16toUTF8(src,(function(cp){utfx.encodeUTF8(cp,dst)}))},decodeUTF8toUTF16:function(src,dst){utfx.decodeUTF8(src,(function(cp){utfx.UTF8toUTF16(cp,dst)}))},calculateCodePoint:function(cp){return cp<128?1:cp<2048?2:cp<65536?3:4},calculateUTF8:function(src){for(var cp,l=0;null!==(cp=src());)l+=utfx.calculateCodePoint(cp);return l},calculateUTF16asUTF8:function(src){var n=0,l=0;return utfx.UTF16toUTF8(src,(function(cp){++n,l+=utfx.calculateCodePoint(cp)})),[n,l]}};return utfx}();return ByteBufferPrototype.toUTF8=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}var sd;try{utfx.decodeUTF8toUTF16(function(){return begin<end?this.view.getUint8(begin++):null}.bind(this),sd=stringDestination())}catch(e){if(begin!==end)throw RangeError("Illegal range: Truncated data, "+begin+" != "+end)}return sd()},ByteBuffer.fromUTF8=function(str,littleEndian,noAssert){if(!noAssert&&"string"!=typeof str)throw TypeError("Illegal str: Not a string");var bb=new ByteBuffer(utfx.calculateUTF16asUTF8(stringSource(str),!0)[1],littleEndian,noAssert),i=0;return utfx.encodeUTF16toUTF8(stringSource(str),(function(b){bb.view.setUint8(i++,b)})),bb.limit=i,bb},ByteBuffer}"function"==typeof require&&"object"==typeof module&&module&&"object"==typeof exports&&exports?module.exports=function(){var Long;try{Long=require("long")}catch(e){}return loadByteBuffer(Long)}():(global.dcodeIO=global.dcodeIO||{}).ByteBuffer=loadByteBuffer(global.dcodeIO.Long)}(this)},{long:10}],10:[function(require,module,exports){
/**
 * @license Long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/Long.js for details
 */
!function(global,factory){"function"==typeof require&&"object"==typeof module&&module&&module.exports?module.exports=factory():(global.dcodeIO=global.dcodeIO||{}).Long=factory()}(this,(function(){"use strict";function Long(low,high,unsigned){this.low=0|low,this.high=0|high,this.unsigned=!!unsigned}Long.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),Long.isLong=function isLong(obj){return!0===(obj&&obj.__isLong__)};var INT_CACHE={},UINT_CACHE={};Long.fromInt=function fromInt(value,unsigned){var obj,cachedObj;return unsigned?0<=(value>>>=0)&&value<256&&(cachedObj=UINT_CACHE[value])?cachedObj:(obj=new Long(value,(0|value)<0?-1:0,!0),0<=value&&value<256&&(UINT_CACHE[value]=obj),obj):-128<=(value|=0)&&value<128&&(cachedObj=INT_CACHE[value])?cachedObj:(obj=new Long(value,value<0?-1:0,!1),-128<=value&&value<128&&(INT_CACHE[value]=obj),obj)},Long.fromNumber=function fromNumber(value,unsigned){return unsigned=!!unsigned,isNaN(value)||!isFinite(value)?Long.ZERO:!unsigned&&value<=-TWO_PWR_63_DBL?Long.MIN_VALUE:!unsigned&&value+1>=TWO_PWR_63_DBL?Long.MAX_VALUE:unsigned&&value>=TWO_PWR_64_DBL?Long.MAX_UNSIGNED_VALUE:value<0?Long.fromNumber(-value,unsigned).negate():new Long(value%TWO_PWR_32_DBL|0,value/TWO_PWR_32_DBL|0,unsigned)},Long.fromBits=function fromBits(lowBits,highBits,unsigned){return new Long(lowBits,highBits,unsigned)},Long.fromString=function fromString(str,unsigned,radix){if(0===str.length)throw Error("number format error: empty string");if("NaN"===str||"Infinity"===str||"+Infinity"===str||"-Infinity"===str)return Long.ZERO;if("number"==typeof unsigned&&(radix=unsigned,unsigned=!1),(radix=radix||10)<2||36<radix)throw Error("radix out of range: "+radix);var p;if((p=str.indexOf("-"))>0)throw Error('number format error: interior "-" character: '+str);if(0===p)return Long.fromString(str.substring(1),unsigned,radix).negate();for(var radixToPower=Long.fromNumber(Math.pow(radix,8)),result=Long.ZERO,i=0;i<str.length;i+=8){var size=Math.min(8,str.length-i),value=parseInt(str.substring(i,i+size),radix);if(size<8){var power=Long.fromNumber(Math.pow(radix,size));result=result.multiply(power).add(Long.fromNumber(value))}else result=(result=result.multiply(radixToPower)).add(Long.fromNumber(value))}return result.unsigned=unsigned,result},Long.fromValue=function fromValue(val){return val instanceof Long?val:"number"==typeof val?Long.fromNumber(val):"string"==typeof val?Long.fromString(val):new Long(val.low,val.high,val.unsigned)};var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=4294967296,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=Long.fromInt(1<<24);return Long.ZERO=Long.fromInt(0),Long.UZERO=Long.fromInt(0,!0),Long.ONE=Long.fromInt(1),Long.UONE=Long.fromInt(1,!0),Long.NEG_ONE=Long.fromInt(-1),Long.MAX_VALUE=Long.fromBits(-1,2147483647,!1),Long.MAX_UNSIGNED_VALUE=Long.fromBits(-1,-1,!0),Long.MIN_VALUE=Long.fromBits(0,-2147483648,!1),Long.prototype.toInt=function toInt(){return this.unsigned?this.low>>>0:this.low},Long.prototype.toNumber=function toNumber(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},Long.prototype.toString=function toString(radix){if((radix=radix||10)<2||36<radix)throw RangeError("radix out of range: "+radix);if(this.isZero())return"0";var rem;if(this.isNegative()){if(this.equals(Long.MIN_VALUE)){var radixLong=Long.fromNumber(radix),div=this.divide(radixLong);return rem=div.multiply(radixLong).subtract(this),div.toString(radix)+rem.toInt().toString(radix)}return"-"+this.negate().toString(radix)}var radixToPower=Long.fromNumber(Math.pow(radix,6),this.unsigned);rem=this;for(var result="";;){var remDiv=rem.divide(radixToPower),intval,digits=(rem.subtract(remDiv.multiply(radixToPower)).toInt()>>>0).toString(radix);if((rem=remDiv).isZero())return digits+result;for(;digits.length<6;)digits="0"+digits;result=""+digits+result}},Long.prototype.getHighBits=function getHighBits(){return this.high},Long.prototype.getHighBitsUnsigned=function getHighBitsUnsigned(){return this.high>>>0},Long.prototype.getLowBits=function getLowBits(){return this.low},Long.prototype.getLowBitsUnsigned=function getLowBitsUnsigned(){return this.low>>>0},Long.prototype.getNumBitsAbs=function getNumBitsAbs(){if(this.isNegative())return this.equals(Long.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var val=0!=this.high?this.high:this.low,bit=31;bit>0&&0==(val&1<<bit);bit--);return 0!=this.high?bit+33:bit+1},Long.prototype.isZero=function isZero(){return 0===this.high&&0===this.low},Long.prototype.isNegative=function isNegative(){return!this.unsigned&&this.high<0},Long.prototype.isPositive=function isPositive(){return this.unsigned||this.high>=0},Long.prototype.isOdd=function isOdd(){return 1==(1&this.low)},Long.prototype.isEven=function isEven(){return 0==(1&this.low)},Long.prototype.equals=function equals(other){return Long.isLong(other)||(other=Long.fromValue(other)),(this.unsigned===other.unsigned||this.high>>>31!=1||other.high>>>31!=1)&&this.high===other.high&&this.low===other.low},Long.eq=Long.prototype.equals,Long.prototype.notEquals=function notEquals(other){return!this.equals(other)},Long.neq=Long.prototype.notEquals,Long.prototype.lessThan=function lessThan(other){return this.compare(other)<0},Long.prototype.lt=Long.prototype.lessThan,Long.prototype.lessThanOrEqual=function lessThanOrEqual(other){return this.compare(other)<=0},Long.prototype.lte=Long.prototype.lessThanOrEqual,Long.prototype.greaterThan=function greaterThan(other){return this.compare(other)>0},Long.prototype.gt=Long.prototype.greaterThan,Long.prototype.greaterThanOrEqual=function greaterThanOrEqual(other){return this.compare(other)>=0},Long.prototype.gte=Long.prototype.greaterThanOrEqual,Long.prototype.compare=function compare(other){if(Long.isLong(other)||(other=Long.fromValue(other)),this.equals(other))return 0;var thisNeg=this.isNegative(),otherNeg=other.isNegative();return thisNeg&&!otherNeg?-1:!thisNeg&&otherNeg?1:this.unsigned?other.high>>>0>this.high>>>0||other.high===this.high&&other.low>>>0>this.low>>>0?-1:1:this.subtract(other).isNegative()?-1:1},Long.prototype.negate=function negate(){return!this.unsigned&&this.equals(Long.MIN_VALUE)?Long.MIN_VALUE:this.not().add(Long.ONE)},Long.prototype.neg=Long.prototype.negate,Long.prototype.add=function add(addend){Long.isLong(addend)||(addend=Long.fromValue(addend));var a48=this.high>>>16,a32=65535&this.high,a16=this.low>>>16,a00=65535&this.low,b48=addend.high>>>16,b32=65535&addend.high,b16=addend.low>>>16,b00,c48=0,c32=0,c16=0,c00=0;return c16+=(c00+=a00+(65535&addend.low))>>>16,c00&=65535,c32+=(c16+=a16+b16)>>>16,c16&=65535,c48+=(c32+=a32+b32)>>>16,c32&=65535,c48+=a48+b48,c48&=65535,Long.fromBits(c16<<16|c00,c48<<16|c32,this.unsigned)},Long.prototype.subtract=function subtract(subtrahend){return Long.isLong(subtrahend)||(subtrahend=Long.fromValue(subtrahend)),this.add(subtrahend.negate())},Long.prototype.sub=Long.prototype.subtract,Long.prototype.multiply=function multiply(multiplier){if(this.isZero())return Long.ZERO;if(Long.isLong(multiplier)||(multiplier=Long.fromValue(multiplier)),multiplier.isZero())return Long.ZERO;if(this.equals(Long.MIN_VALUE))return multiplier.isOdd()?Long.MIN_VALUE:Long.ZERO;if(multiplier.equals(Long.MIN_VALUE))return this.isOdd()?Long.MIN_VALUE:Long.ZERO;if(this.isNegative())return multiplier.isNegative()?this.negate().multiply(multiplier.negate()):this.negate().multiply(multiplier).negate();if(multiplier.isNegative())return this.multiply(multiplier.negate()).negate();if(this.lessThan(TWO_PWR_24)&&multiplier.lessThan(TWO_PWR_24))return Long.fromNumber(this.toNumber()*multiplier.toNumber(),this.unsigned);var a48=this.high>>>16,a32=65535&this.high,a16=this.low>>>16,a00=65535&this.low,b48=multiplier.high>>>16,b32=65535&multiplier.high,b16=multiplier.low>>>16,b00=65535&multiplier.low,c48=0,c32=0,c16=0,c00=0;return c16+=(c00+=a00*b00)>>>16,c00&=65535,c32+=(c16+=a16*b00)>>>16,c16&=65535,c32+=(c16+=a00*b16)>>>16,c16&=65535,c48+=(c32+=a32*b00)>>>16,c32&=65535,c48+=(c32+=a16*b16)>>>16,c32&=65535,c48+=(c32+=a00*b32)>>>16,c32&=65535,c48+=a48*b00+a32*b16+a16*b32+a00*b48,c48&=65535,Long.fromBits(c16<<16|c00,c48<<16|c32,this.unsigned)},Long.prototype.mul=Long.prototype.multiply,Long.prototype.divide=function divide(divisor){if(Long.isLong(divisor)||(divisor=Long.fromValue(divisor)),divisor.isZero())throw new Error("division by zero");if(this.isZero())return this.unsigned?Long.UZERO:Long.ZERO;var approx,rem,res,halfThis;if(this.equals(Long.MIN_VALUE))return divisor.equals(Long.ONE)||divisor.equals(Long.NEG_ONE)?Long.MIN_VALUE:divisor.equals(Long.MIN_VALUE)?Long.ONE:(approx=this.shiftRight(1).divide(divisor).shiftLeft(1)).equals(Long.ZERO)?divisor.isNegative()?Long.ONE:Long.NEG_ONE:(rem=this.subtract(divisor.multiply(approx)),res=approx.add(rem.divide(divisor)));if(divisor.equals(Long.MIN_VALUE))return this.unsigned?Long.UZERO:Long.ZERO;if(this.isNegative())return divisor.isNegative()?this.negate().divide(divisor.negate()):this.negate().divide(divisor).negate();if(divisor.isNegative())return this.divide(divisor.negate()).negate();for(res=Long.ZERO,rem=this;rem.greaterThanOrEqual(divisor);){approx=Math.max(1,Math.floor(rem.toNumber()/divisor.toNumber()));for(var log2=Math.ceil(Math.log(approx)/Math.LN2),delta=log2<=48?1:Math.pow(2,log2-48),approxRes=Long.fromNumber(approx),approxRem=approxRes.multiply(divisor);approxRem.isNegative()||approxRem.greaterThan(rem);)approx-=delta,approxRem=(approxRes=Long.fromNumber(approx,this.unsigned)).multiply(divisor);approxRes.isZero()&&(approxRes=Long.ONE),res=res.add(approxRes),rem=rem.subtract(approxRem)}return res},Long.prototype.div=Long.prototype.divide,Long.prototype.modulo=function modulo(divisor){return Long.isLong(divisor)||(divisor=Long.fromValue(divisor)),this.subtract(this.divide(divisor).multiply(divisor))},Long.prototype.mod=Long.prototype.modulo,Long.prototype.not=function not(){return Long.fromBits(~this.low,~this.high,this.unsigned)},Long.prototype.and=function and(other){return Long.isLong(other)||(other=Long.fromValue(other)),Long.fromBits(this.low&other.low,this.high&other.high,this.unsigned)},Long.prototype.or=function or(other){return Long.isLong(other)||(other=Long.fromValue(other)),Long.fromBits(this.low|other.low,this.high|other.high,this.unsigned)},Long.prototype.xor=function xor(other){return Long.isLong(other)||(other=Long.fromValue(other)),Long.fromBits(this.low^other.low,this.high^other.high,this.unsigned)},Long.prototype.shiftLeft=function shiftLeft(numBits){return Long.isLong(numBits)&&(numBits=numBits.toInt()),0==(numBits&=63)?this:numBits<32?Long.fromBits(this.low<<numBits,this.high<<numBits|this.low>>>32-numBits,this.unsigned):Long.fromBits(0,this.low<<numBits-32,this.unsigned)},Long.prototype.shl=Long.prototype.shiftLeft,Long.prototype.shiftRight=function shiftRight(numBits){return Long.isLong(numBits)&&(numBits=numBits.toInt()),0==(numBits&=63)?this:numBits<32?Long.fromBits(this.low>>>numBits|this.high<<32-numBits,this.high>>numBits,this.unsigned):Long.fromBits(this.high>>numBits-32,this.high>=0?0:-1,this.unsigned)},Long.prototype.shr=Long.prototype.shiftRight,Long.prototype.shiftRightUnsigned=function shiftRightUnsigned(numBits){if(Long.isLong(numBits)&&(numBits=numBits.toInt()),0==(numBits&=63))return this;var high=this.high;if(numBits<32){var low=this.low;return Long.fromBits(low>>>numBits|high<<32-numBits,high>>>numBits,this.unsigned)}return 32===numBits?Long.fromBits(high,0,this.unsigned):Long.fromBits(high>>>numBits-32,0,this.unsigned)},Long.prototype.shru=Long.prototype.shiftRightUnsigned,Long.prototype.toSigned=function toSigned(){return this.unsigned?new Long(this.low,this.high,!1):this},Long.prototype.toUnsigned=function toUnsigned(){return this.unsigned?this:new Long(this.low,this.high,!0)},Long}))},{}],11:[function(require,module,exports){(function(global){"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function compare(a,b){if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0}function isBuffer(b){return global.Buffer&&"function"==typeof global.Buffer.isBuffer?global.Buffer.isBuffer(b):!(null==b||!b._isBuffer)}var util=require("util/"),hasOwn=Object.prototype.hasOwnProperty,pSlice=Array.prototype.slice,functionsHaveNames="foo"===function foo(){}.name;function pToString(obj){return Object.prototype.toString.call(obj)}function isView(arrbuf){return!isBuffer(arrbuf)&&"function"==typeof global.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(arrbuf):!!arrbuf&&(arrbuf instanceof DataView||!!(arrbuf.buffer&&arrbuf.buffer instanceof ArrayBuffer)))}var assert=module.exports=ok,regex=/\s*function\s+([^\(\s]*)\s*/;function getName(func){if(util.isFunction(func)){if(functionsHaveNames)return func.name;var str,match=func.toString().match(regex);return match&&match[1]}}function truncate(s,n){return"string"==typeof s?s.length<n?s:s.slice(0,n):s}function inspect(something){if(functionsHaveNames||!util.isFunction(something))return util.inspect(something);var rawname=getName(something),name;return"[Function"+(rawname?": "+rawname:"")+"]"}function getMessage(self){return truncate(inspect(self.actual),128)+" "+self.operator+" "+truncate(inspect(self.expected),128)}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}function ok(value,message){value||fail(value,!0,message,"==",assert.ok)}function _deepEqual(actual,expected,strict,memos){if(actual===expected)return!0;if(isBuffer(actual)&&isBuffer(expected))return 0===compare(actual,expected);if(util.isDate(actual)&&util.isDate(expected))return actual.getTime()===expected.getTime();if(util.isRegExp(actual)&&util.isRegExp(expected))return actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase;if(null!==actual&&"object"==typeof actual||null!==expected&&"object"==typeof expected){if(isView(actual)&&isView(expected)&&pToString(actual)===pToString(expected)&&!(actual instanceof Float32Array||actual instanceof Float64Array))return 0===compare(new Uint8Array(actual.buffer),new Uint8Array(expected.buffer));if(isBuffer(actual)!==isBuffer(expected))return!1;var actualIndex=(memos=memos||{actual:[],expected:[]}).actual.indexOf(actual);return-1!==actualIndex&&actualIndex===memos.expected.indexOf(expected)||(memos.actual.push(actual),memos.expected.push(expected),objEquiv(actual,expected,strict,memos))}return strict?actual===expected:actual==expected}function isArguments(object){return"[object Arguments]"==Object.prototype.toString.call(object)}function objEquiv(a,b,strict,actualVisitedObjects){if(null==a||null==b)return!1;if(util.isPrimitive(a)||util.isPrimitive(b))return a===b;if(strict&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return!1;var aIsArgs=isArguments(a),bIsArgs=isArguments(b);if(aIsArgs&&!bIsArgs||!aIsArgs&&bIsArgs)return!1;if(aIsArgs)return _deepEqual(a=pSlice.call(a),b=pSlice.call(b),strict);var ka=objectKeys(a),kb=objectKeys(b),key,i;if(ka.length!==kb.length)return!1;for(ka.sort(),kb.sort(),i=ka.length-1;i>=0;i--)if(ka[i]!==kb[i])return!1;for(i=ka.length-1;i>=0;i--)if(!_deepEqual(a[key=ka[i]],b[key],strict,actualVisitedObjects))return!1;return!0}function notDeepStrictEqual(actual,expected,message){_deepEqual(actual,expected,!0)&&fail(actual,expected,message,"notDeepStrictEqual",notDeepStrictEqual)}function expectedException(actual,expected){if(!actual||!expected)return!1;if("[object RegExp]"==Object.prototype.toString.call(expected))return expected.test(actual);try{if(actual instanceof expected)return!0}catch(e){}return!Error.isPrototypeOf(expected)&&!0===expected.call({},actual)}function _tryBlock(block){var error;try{block()}catch(e){error=e}return error}function _throws(shouldThrow,block,expected,message){var actual;if("function"!=typeof block)throw new TypeError('"block" argument must be a function');"string"==typeof expected&&(message=expected,expected=null),actual=_tryBlock(block),message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:"."),shouldThrow&&!actual&&fail(actual,expected,"Missing expected exception"+message);var userProvidedMessage="string"==typeof message,isUnwantedException,isUnexpectedException=!shouldThrow&&actual&&!expected;if((!shouldThrow&&util.isError(actual)&&userProvidedMessage&&expectedException(actual,expected)||isUnexpectedException)&&fail(actual,expected,"Got unwanted exception"+message),shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual)throw actual}assert.AssertionError=function AssertionError(options){this.name="AssertionError",this.actual=options.actual,this.expected=options.expected,this.operator=options.operator,options.message?(this.message=options.message,this.generatedMessage=!1):(this.message=getMessage(this),this.generatedMessage=!0);var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace)Error.captureStackTrace(this,stackStartFunction);else{var err=new Error;if(err.stack){var out=err.stack,fn_name=getName(stackStartFunction),idx=out.indexOf("\n"+fn_name);if(idx>=0){var next_line=out.indexOf("\n",idx+1);out=out.substring(next_line+1)}this.stack=out}}},util.inherits(assert.AssertionError,Error),assert.fail=fail,assert.ok=ok,assert.equal=function equal(actual,expected,message){actual!=expected&&fail(actual,expected,message,"==",assert.equal)},assert.notEqual=function notEqual(actual,expected,message){actual==expected&&fail(actual,expected,message,"!=",assert.notEqual)},assert.deepEqual=function deepEqual(actual,expected,message){_deepEqual(actual,expected,!1)||fail(actual,expected,message,"deepEqual",assert.deepEqual)},assert.deepStrictEqual=function deepStrictEqual(actual,expected,message){_deepEqual(actual,expected,!0)||fail(actual,expected,message,"deepStrictEqual",assert.deepStrictEqual)},assert.notDeepEqual=function notDeepEqual(actual,expected,message){_deepEqual(actual,expected,!1)&&fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)},assert.notDeepStrictEqual=notDeepStrictEqual,assert.strictEqual=function strictEqual(actual,expected,message){actual!==expected&&fail(actual,expected,message,"===",assert.strictEqual)},assert.notStrictEqual=function notStrictEqual(actual,expected,message){actual===expected&&fail(actual,expected,message,"!==",assert.notStrictEqual)},assert.throws=function(block,error,message){_throws(!0,block,error,message)},assert.doesNotThrow=function(block,error,message){_throws(!1,block,error,message)},assert.ifError=function(err){if(err)throw err};var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)hasOwn.call(obj,key)&&keys.push(key);return keys}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"util/":18}],12:[function(require,module,exports){"use strict";exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function placeHoldersCount(b64){var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===b64[len-2]?2:"="===b64[len-1]?1:0}function byteLength(b64){return 3*b64.length/4-placeHoldersCount(b64)}function toByteArray(b64){var i,l,tmp,placeHolders,arr,len=b64.length;placeHolders=placeHoldersCount(b64),arr=new Arr(3*len/4-placeHolders),l=placeHolders>0?len-4:len;var L=0;for(i=0;i<l;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[L++]=tmp>>16&255,arr[L++]=tmp>>8&255,arr[L++]=255&tmp;return 2===placeHolders?(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[L++]=255&tmp):1===placeHolders&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[L++]=tmp>>8&255,arr[L++]=255&tmp),arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]}function encodeChunk(uint8,start,end){for(var tmp,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output.push(tripletToBase64(tmp));return output.join("")}function fromByteArray(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,output="",parts=[],maxChunkLength=16383,i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));return 1===extraBytes?(tmp=uint8[len-1],output+=lookup[tmp>>2],output+=lookup[tmp<<4&63],output+="=="):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],output+=lookup[tmp>>10],output+=lookup[tmp>>4&63],output+=lookup[tmp<<2&63],output+="="),parts.push(output),parts.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},{}],13:[function(require,module,exports){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
"use strict";var base64=require("base64-js"),ieee754=require("ieee754");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;function typedArraySupport(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()}catch(e){return!1}}function createBuffer(length){if(length>2147483647)throw new RangeError("Invalid typed array length");var buf=new Uint8Array(length);return buf.__proto__=Buffer.prototype,buf}function Buffer(arg,encodingOrOffset,length){if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}function from(value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return isArrayBuffer(value)?fromArrayBuffer(value,encodingOrOffset,length):"string"==typeof value?fromString(value,encodingOrOffset):fromObject(value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be a number');if(size<0)throw new RangeError('"size" argument must not be negative')}function alloc(size,fill,encoding){return assertSize(size),size<=0?createBuffer(size):void 0!==fill?"string"==typeof encoding?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill):createBuffer(size)}function allocUnsafe(size){return assertSize(size),createBuffer(size<0?0:0|checked(size))}function fromString(string,encoding){if("string"==typeof encoding&&""!==encoding||(encoding="utf8"),!Buffer.isEncoding(encoding))throw new TypeError('"encoding" must be a valid string encoding');var length=0|byteLength(string,encoding),buf=createBuffer(length),actual=buf.write(string,encoding);return actual!==length&&(buf=buf.slice(0,actual)),buf}function fromArrayLike(array){for(var length=array.length<0?0:0|checked(array.length),buf=createBuffer(length),i=0;i<length;i+=1)buf[i]=255&array[i];return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset)throw new RangeError("'offset' is out of bounds");if(array.byteLength<byteOffset+(length||0))throw new RangeError("'length' is out of bounds");var buf;return(buf=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length)).__proto__=Buffer.prototype,buf}function fromObject(obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length),buf=createBuffer(len);return 0===buf.length?buf:(obj.copy(buf,0,0,len),buf)}if(obj){if(isArrayBufferView(obj)||"length"in obj)return"number"!=typeof obj.length||numberIsNaN(obj.length)?createBuffer(0):fromArrayLike(obj);if("Buffer"===obj.type&&Array.isArray(obj.data))return fromArrayLike(obj.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(length){if(length>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|length}function SlowBuffer(length){return+length!=length&&(length=0),Buffer.alloc(+length)}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if(isArrayBufferView(string)||isArrayBuffer(string))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if((end>>>=0)<=(start>>>=0))return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),numberIsNaN(byteOffset=+byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1,arrLength=arr.length,valLength=val.length,i;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var strLen=string.length;if(strLen%2!=0)throw new TypeError("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1,secondByte,thirdByte,fourthByte,tempCodePoint;if(i+bytesPerSequence<=end)switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return decodeCodePointsArray(res)}exports.kMaxLength=2147483647,Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Buffer.poolSize=8192,Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)},Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,Buffer.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)},Buffer.isBuffer=function isBuffer(b){return null!=b&&!0===b._isBuffer},Buffer.compare=function compare(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function concat(list,length){if(!Array.isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function swap16(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function swap32(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function swap64(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function toString(){var length=this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function inspect(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(this===target)return 0;for(var x=(thisEnd>>>=0)-(thisStart>>>=0),y=(end>>>=0)-(start>>>=0),len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function includes(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function write(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset>>>=0,isFinite(length)?(length>>>=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=4096)return String.fromCharCode.apply(String,codePoints);for(var res="",i=0;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=4096));return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,value,offset,4,34028234663852886e22,-34028234663852886e22),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,value,offset,8,17976931348623157e292,-17976931348623157e292),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}Buffer.prototype.slice=function slice(start,end){var len=this.length;(start=~~start)<0?(start+=len)<0&&(start=0):start>len&&(start=len),(end=void 0===end?len:~~end)<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start);var newBuf=this.subarray(start,end);return newBuf.__proto__=Buffer.prototype,newBuf},Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function readInt8(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){var maxBytes;value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){var maxBytes;value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,255,0),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value,offset+4},Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,127,-128),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24,offset+4},Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function copy(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var len=end-start,i;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else if(len<1e3)for(i=0;i<len;++i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function fill(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),1===val.length){var code=val.charCodeAt(0);code<256&&(val=code)}if(void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding)}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;var i;if(start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0),"number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:new Buffer(val,encoding),len=bytes.length;for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(str){if((str=str.trim().replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str}function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){var codePoint;units=units||1/0;for(var length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)hi=(c=str.charCodeAt(i))>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isArrayBuffer(obj){return obj instanceof ArrayBuffer||null!=obj&&null!=obj.constructor&&"ArrayBuffer"===obj.constructor.name&&"number"==typeof obj.byteLength}function isArrayBufferView(obj){return"function"==typeof ArrayBuffer.isView&&ArrayBuffer.isView(obj)}function numberIsNaN(obj){return obj!=obj}},{"base64-js":12,ieee754:14}],14:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),(value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias))*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],15:[function(require,module,exports){var process=module.exports={},cachedSetTimeout,cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],16:[function(require,module,exports){"function"==typeof Object.create?module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],17:[function(require,module,exports){module.exports=function isBuffer(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},{}],18:[function(require,module,exports){(function(process,global){var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}for(var i=1,args=arguments,len=args.length,str=String(f).replace(formatRegExp,(function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}})),x=args[i];i<len;x=args[++i])isNull(x)||!isObject(x)?str+=" "+x:str+=" "+inspect(x);return str},exports.deprecate=function(fn,msg){if(isUndefined(global.process))return function(){return exports.deprecate(fn,msg).apply(this,arguments)};if(!0===process.noDeprecation)return fn;var warned=!1;function deprecated(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}return deprecated};var debugs={},debugEnviron;function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};return array.forEach((function(val,idx){hash[val]=!0})),hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=formatPrimitive(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=arrayToHash(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var base="",array=!1,braces=["{","}"],n,output;return isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value)&&(base=" [Function"+(value.name?": "+value.name:"")+"]"),isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0!==keys.length||array&&0!=value.length?recurseTimes<0?isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special"):(ctx.seen.push(value),output=array?formatArray(ctx,value,recurseTimes,visibleKeys,keys):keys.map((function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)})),ctx.seen.pop(),reduceToSingleString(output,base,braces)):braces[0]+base+braces[1]}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}return isNumber(value)?ctx.stylize(""+value,"number"):isBoolean(value)?ctx.stylize(""+value,"boolean"):isNull(value)?ctx.stylize("null","null"):void 0}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;i<l;++i)hasOwnProperty(value,String(i))?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0)):output.push("");return keys.forEach((function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))})),output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if((desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]}).get?str=desc.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1)).indexOf("\n")>-1&&(str=array?str.split("\n").map((function(line){return"  "+line})).join("\n").substr(2):"\n"+str.split("\n").map((function(line){return"   "+line})).join("\n")):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;(name=JSON.stringify(""+key)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0,length;return output.reduce((function(prev,cur){return numLinesEst++,cur.indexOf("\n")>=0&&numLinesEst++,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]:braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}exports.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":17,_process:15,inherits:16}],19:[function(require,module,exports){module.exports={name:"generative-design-library.js",version:"0.1.1",description:"Javascript library for the book Generative Design",main:"index.js",scripts:{test:'echo "Error: no test specified" && exit 1',bundle:"browserify index.js --standalone gd -o dist/generative-design-library.js",dist:"npm run bundle && browserify index.js --standalone gd | uglifyjs > dist/generative-design-library.min.js",watch:"watch 'npm run bundle' .",documentation:"documentation readme index.js --section=API"},repository:{type:"git",url:"https://github.com/generative-design/generative-design-library.js.git"},keywords:["p5","p5.js","processing","generative","computational","design"],author:"Benedikt Groß <bg@benedikt-gross.de>",bugs:{url:"https://github.com/generative-design/generative-design-library.js/issues"},homepage:"https://github.com/generative-design/generative-design-library.js",dependencies:{"ase-utils":"^0.1.1"},devDependencies:{browserify:"^14.4.0",documentation:"^5.2.2","uglify-js":"^3.0.28",watch:"^1.0.2"}}},{}]},{},[4])(4)})),function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;(g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).GIF=f()}}((function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){var n=t[o][1][e];return s(n||e)}),l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if((er=arguments[1])instanceof Error)throw er;var err=new Error('Uncaught, unspecified "error" event. ('+er+")");throw err.context=er,err}if(isUndefined(handler=this._events[type]))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1),handler.apply(this,args)}else if(isObject(handler))for(args=Array.prototype.slice.call(arguments,1),len=(listeners=handler.slice()).length,i=0;i<len;i++)listeners[i].apply(this,args);return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned&&(m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners)&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace()),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(length=(list=this._events[type]).length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-- >0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(position<0)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(isFunction(listeners=this._events[type]))this.removeListener(type,listeners);else if(listeners)for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){var ret;return ret=this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;if(evlistener)return evlistener.length}return 0},EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)}},{}],2:[function(require,module,exports){var UA,browser,mode,platform,ua;ua=navigator.userAgent.toLowerCase(),platform=navigator.platform.toLowerCase(),mode="ie"===(UA=ua.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0])[1]&&document.documentMode,(browser={name:"version"===UA[1]?UA[3]:UA[1],version:mode||parseFloat("opera"===UA[1]&&UA[4]?UA[4]:UA[2]),platform:{name:ua.match(/ip(?:ad|od|hone)/)?"ios":(ua.match(/(?:webos|android)/)||platform.match(/mac|win|linux/)||["other"])[0]}})[browser.name]=!0,browser[browser.name+parseInt(browser.version,10)]=!0,browser.platform[browser.platform.name]=!0,module.exports=browser},{}],3:[function(require,module,exports){var EventEmitter,GIF,browser,extend=function(child,parent){for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);function ctor(){this.constructor=child}return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1},slice=[].slice;EventEmitter=require("events").EventEmitter,browser=require("./browser.coffee"),GIF=function(superClass){var defaults,frameDefaults;function GIF(options){var base,key,value;for(key in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(options),defaults)value=defaults[key],null==(base=this.options)[key]&&(base[key]=value)}return extend(GIF,superClass),defaults={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},frameDefaults={delay:500,copy:!1},GIF.prototype.setOption=function(key,value){if(this.options[key]=value,null!=this._canvas&&("width"===key||"height"===key))return this._canvas[key]=value},GIF.prototype.setOptions=function(options){var key,results,value;for(key in results=[],options)hasProp.call(options,key)&&(value=options[key],results.push(this.setOption(key,value)));return results},GIF.prototype.addFrame=function(image,options){var frame,key;for(key in null==options&&(options={}),(frame={}).transparent=this.options.transparent,frameDefaults)frame[key]=options[key]||frameDefaults[key];if(null==this.options.width&&this.setOption("width",image.width),null==this.options.height&&this.setOption("height",image.height),"undefined"!=typeof ImageData&&null!==ImageData&&image instanceof ImageData)frame.data=image.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&image instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&image instanceof WebGLRenderingContext)options.copy?frame.data=this.getContextData(image):frame.context=image;else{if(null==image.childNodes)throw new Error("Invalid image");options.copy?frame.data=this.getImageData(image):frame.image=image}return this.frames.push(frame)},GIF.prototype.render=function(){var i,j,numWorkers,ref;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var j,ref,results;for(results=[],i=j=0,ref=this.frames.length;0<=ref?j<ref:j>ref;i=0<=ref?++j:--j)results.push(null);return results}.call(this),numWorkers=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(i=j=0,ref=numWorkers;0<=ref?j<ref:j>ref;i=0<=ref?++j:--j)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},GIF.prototype.abort=function(){for(var worker;null!=(worker=this.activeWorkers.shift());)this.log("killing active worker"),worker.terminate();return this.running=!1,this.emit("abort")},GIF.prototype.spawnWorkers=function(){var j,numWorkers,ref,results,_this;return numWorkers=Math.min(this.options.workers,this.frames.length),function(){results=[];for(var j=ref=this.freeWorkers.length;ref<=numWorkers?j<numWorkers:j>numWorkers;ref<=numWorkers?j++:j--)results.push(j);return results}.apply(this).forEach((_this=this,function(i){var worker;return _this.log("spawning worker "+i),(worker=new Worker(_this.options.workerScript)).onmessage=function(event){return _this.activeWorkers.splice(_this.activeWorkers.indexOf(worker),1),_this.freeWorkers.push(worker),_this.frameFinished(event.data)},_this.freeWorkers.push(worker)})),numWorkers},GIF.prototype.frameFinished=function(frame){var i,j,ref;if(this.log("frame "+frame.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[frame.index]=frame,!0===this.options.globalPalette&&(this.options.globalPalette=frame.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(i=j=1,ref=this.freeWorkers.length;1<=ref?j<ref:j>ref;i=1<=ref?++j:--j)this.renderNextFrame();return indexOf.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},GIF.prototype.finishRendering=function(){var data,frame,i,image,j,k,l,len,len1,len2,len3,offset,page,ref,ref1,ref2;for(len=0,j=0,len1=(ref=this.imageParts).length;j<len1;j++)len+=((frame=ref[j]).data.length-1)*frame.pageSize+frame.cursor;for(len+=frame.pageSize-frame.cursor,this.log("rendering finished - filesize "+Math.round(len/1e3)+"kb"),data=new Uint8Array(len),offset=0,k=0,len2=(ref1=this.imageParts).length;k<len2;k++)for(i=l=0,len3=(ref2=(frame=ref1[k]).data).length;l<len3;i=++l)page=ref2[i],data.set(page,offset),i===frame.data.length-1?offset+=frame.cursor:offset+=frame.pageSize;return image=new Blob([data],{type:"image/gif"}),this.emit("finished",image,data)},GIF.prototype.renderNextFrame=function(){var frame,task,worker;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return frame=this.frames[this.nextFrame++],worker=this.freeWorkers.shift(),task=this.getTask(frame),this.log("starting frame "+(task.index+1)+" of "+this.frames.length),this.activeWorkers.push(worker),worker.postMessage(task)},GIF.prototype.getContextData=function(ctx){return ctx.getImageData(0,0,this.options.width,this.options.height).data},GIF.prototype.getImageData=function(image){var ctx;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),(ctx=this._canvas.getContext("2d")).setFill=this.options.background,ctx.fillRect(0,0,this.options.width,this.options.height),ctx.drawImage(image,0,0),this.getContextData(ctx)},GIF.prototype.getTask=function(frame){var index,task;if(task={index:index=this.frames.indexOf(frame),last:index===this.frames.length-1,delay:frame.delay,transparent:frame.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:"chrome"===browser.name},null!=frame.data)task.data=frame.data;else if(null!=frame.context)task.data=this.getContextData(frame.context);else{if(null==frame.image)throw new Error("Invalid frame");task.data=this.getImageData(frame.image)}return task},GIF.prototype.log=function(){var args;if(args=1<=arguments.length?slice.call(arguments,0):[],this.options.debug)return console.log.apply(console,args)},GIF}(EventEmitter),module.exports=GIF},{"./browser.coffee":2,events:1}]},{},[3])(3)})),function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){var n=t[o][1][e];return s(n||e)}),l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var NeuQuant=require("./TypedNeuQuant.js"),LZWEncoder=require("./LZWEncoder.js");function ByteArray(){this.page=-1,this.pages=[],this.newPage()}ByteArray.pageSize=4096,ByteArray.charMap={};for(var i=0;i<256;i++)ByteArray.charMap[i]=String.fromCharCode(i);function GIFEncoder(width,height){this.width=~~width,this.height=~~height,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new ByteArray}ByteArray.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(ByteArray.pageSize),this.cursor=0},ByteArray.prototype.getData=function(){for(var rv="",p=0;p<this.pages.length;p++)for(var i=0;i<ByteArray.pageSize;i++)rv+=ByteArray.charMap[this.pages[p][i]];return rv},ByteArray.prototype.writeByte=function(val){this.cursor>=ByteArray.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=val},ByteArray.prototype.writeUTFBytes=function(string){for(var l=string.length,i=0;i<l;i++)this.writeByte(string.charCodeAt(i))},ByteArray.prototype.writeBytes=function(array,offset,length){for(var l=length||array.length,i=offset||0;i<l;i++)this.writeByte(array[i])},GIFEncoder.prototype.setDelay=function(milliseconds){this.delay=Math.round(milliseconds/10)},GIFEncoder.prototype.setFrameRate=function(fps){this.delay=Math.round(100/fps)},GIFEncoder.prototype.setDispose=function(disposalCode){disposalCode>=0&&(this.dispose=disposalCode)},GIFEncoder.prototype.setRepeat=function(repeat){this.repeat=repeat},GIFEncoder.prototype.setTransparent=function(color){this.transparent=color},GIFEncoder.prototype.addFrame=function(imageData){this.image=imageData,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},GIFEncoder.prototype.finish=function(){this.out.writeByte(59)},GIFEncoder.prototype.setQuality=function(quality){quality<1&&(quality=1),this.sample=quality},GIFEncoder.prototype.setDither=function(dither){!0===dither&&(dither="FloydSteinberg"),this.dither=dither},GIFEncoder.prototype.setGlobalPalette=function(palette){this.globalPalette=palette},GIFEncoder.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},GIFEncoder.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},GIFEncoder.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new NeuQuant(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},GIFEncoder.prototype.indexPixels=function(imgq){var nPix=this.pixels.length/3;this.indexedPixels=new Uint8Array(nPix);for(var k=0,j=0;j<nPix;j++){var index=this.findClosestRGB(255&this.pixels[k++],255&this.pixels[k++],255&this.pixels[k++]);this.usedEntry[index]=!0,this.indexedPixels[j]=index}},GIFEncoder.prototype.ditherPixels=function(kernel,serpentine){var kernels={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[.25,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!kernel||!kernels[kernel])throw"Unknown dithering kernel: "+kernel;var ds=kernels[kernel],index=0,height=this.height,width=this.width,data=this.pixels,direction=serpentine?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var y=0;y<height;y++){serpentine&&(direction*=-1);for(var x=1==direction?0:width-1,xend=1==direction?width:0;x!==xend;x+=direction){var idx=3*(index=y*width+x),r1=data[idx],g1=data[idx+1],b1=data[idx+2];idx=this.findClosestRGB(r1,g1,b1),this.usedEntry[idx]=!0,this.indexedPixels[index]=idx,idx*=3;for(var r2,g2,b2,er=r1-this.colorTab[idx],eg=g1-this.colorTab[idx+1],eb=b1-this.colorTab[idx+2],i=1==direction?0:ds.length-1,end=1==direction?ds.length:0;i!==end;i+=direction){var x1=ds[i][1],y1=ds[i][2];if(x1+x>=0&&x1+x<width&&y1+y>=0&&y1+y<height){var d=ds[i][0];idx=index+x1+y1*width,data[idx*=3]=Math.max(0,Math.min(255,data[idx]+er*d)),data[idx+1]=Math.max(0,Math.min(255,data[idx+1]+eg*d)),data[idx+2]=Math.max(0,Math.min(255,data[idx+2]+eb*d))}}}}},GIFEncoder.prototype.findClosest=function(c,used){return this.findClosestRGB((16711680&c)>>16,(65280&c)>>8,255&c,used)},GIFEncoder.prototype.findClosestRGB=function(r,g,b,used){if(null===this.colorTab)return-1;if(this.neuQuant&&!used)return this.neuQuant.lookupRGB(r,g,b);for(var c=b|g<<8|r<<16,minpos=0,dmin=16777216,len=this.colorTab.length,i=0,index=0;i<len;index++){var dr=r-(255&this.colorTab[i++]),dg=g-(255&this.colorTab[i++]),db=b-(255&this.colorTab[i++]),d=dr*dr+dg*dg+db*db;(!used||this.usedEntry[index])&&d<dmin&&(dmin=d,minpos=index)}return minpos},GIFEncoder.prototype.getImagePixels=function(){var w=this.width,h=this.height;this.pixels=new Uint8Array(w*h*3);for(var data=this.image,srcPos=0,count=0,i=0;i<h;i++)for(var j=0;j<w;j++)this.pixels[count++]=data[srcPos++],this.pixels[count++]=data[srcPos++],this.pixels[count++]=data[srcPos++],srcPos++},GIFEncoder.prototype.writeGraphicCtrlExt=function(){var transp,disp;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?(transp=0,disp=0):(transp=1,disp=2),this.dispose>=0&&(disp=7&dispose),disp<<=2,this.out.writeByte(0|disp|transp),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},GIFEncoder.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},GIFEncoder.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},GIFEncoder.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},GIFEncoder.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var n=768-this.colorTab.length,i=0;i<n;i++)this.out.writeByte(0)},GIFEncoder.prototype.writeShort=function(pValue){this.out.writeByte(255&pValue),this.out.writeByte(pValue>>8&255)},GIFEncoder.prototype.writePixels=function(){var enc;new LZWEncoder(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this.out)},GIFEncoder.prototype.stream=function(){return this.out},module.exports=GIFEncoder},{"./LZWEncoder.js":2,"./TypedNeuQuant.js":3}],2:[function(require,module,exports){var EOF=-1,BITS=12,HSIZE=5003,masks=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function LZWEncoder(width,height,pixels,colorDepth){var initCodeSize=Math.max(2,colorDepth),accum=new Uint8Array(256),htab=new Int32Array(5003),codetab=new Int32Array(5003),cur_accum,cur_bits=0,a_count,free_ent=0,maxcode,clear_flg=!1,g_init_bits,ClearCode,EOFCode;function char_out(c,outs){accum[a_count++]=c,a_count>=254&&flush_char(outs)}function cl_block(outs){cl_hash(5003),free_ent=ClearCode+2,clear_flg=!0,output(ClearCode,outs)}function cl_hash(hsize){for(var i=0;i<hsize;++i)htab[i]=-1}function compress(init_bits,outs){var fcode,c,i,ent,disp,hsize_reg,hshift;for(g_init_bits=init_bits,clear_flg=!1,n_bits=g_init_bits,maxcode=MAXCODE(n_bits),EOFCode=1+(ClearCode=1<<init_bits-1),free_ent=ClearCode+2,a_count=0,ent=nextPixel(),hshift=0,fcode=5003;fcode<65536;fcode*=2)++hshift;hshift=8-hshift,hsize_reg=5003,cl_hash(5003),output(ClearCode,outs);outer_loop:for(;-1!=(c=nextPixel());)if(fcode=(c<<12)+ent,htab[i=c<<hshift^ent]!==fcode){if(htab[i]>=0){disp=5003-i,0===i&&(disp=1);do{if((i-=disp)<0&&(i+=5003),htab[i]===fcode){ent=codetab[i];continue outer_loop}}while(htab[i]>=0)}output(ent,outs),ent=c,free_ent<4096?(codetab[i]=free_ent++,htab[i]=fcode):cl_block(outs)}else ent=codetab[i];output(ent,outs),output(EOFCode,outs)}function encode(outs){outs.writeByte(initCodeSize),remaining=width*height,curPixel=0,compress(initCodeSize+1,outs),outs.writeByte(0)}function flush_char(outs){a_count>0&&(outs.writeByte(a_count),outs.writeBytes(accum,0,a_count),a_count=0)}function MAXCODE(n_bits){return(1<<n_bits)-1}function nextPixel(){return 0===remaining?-1:(--remaining,255&pixels[curPixel++]);var pix}function output(code,outs){for(cur_accum&=masks[cur_bits],cur_bits>0?cur_accum|=code<<cur_bits:cur_accum=code,cur_bits+=n_bits;cur_bits>=8;)char_out(255&cur_accum,outs),cur_accum>>=8,cur_bits-=8;if((free_ent>maxcode||clear_flg)&&(clear_flg?(maxcode=MAXCODE(n_bits=g_init_bits),clear_flg=!1):(++n_bits,maxcode=12==n_bits?4096:MAXCODE(n_bits))),code==EOFCode){for(;cur_bits>0;)char_out(255&cur_accum,outs),cur_accum>>=8,cur_bits-=8;flush_char(outs)}}this.encode=encode}module.exports=LZWEncoder},{}],3:[function(require,module,exports){var ncycles=100,netsize=256,maxnetpos=255,netbiasshift=4,intbiasshift=16,intbias=65536,gammashift=10,gamma=1024,betashift=10,beta=64,betagamma=65536,initrad=32,radiusbiasshift=6,radiusbias=64,initradius=2048,radiusdec=30,alphabiasshift=10,initalpha=1024,alphadec,radbiasshift=8,radbias=256,alpharadbshift=18,alpharadbias=1<<18,prime1=499,prime2=491,prime3=487,prime4=503,minpicturebytes=1509;function NeuQuant(pixels,samplefac){var network,netindex,bias,freq,radpower;function init(){var i,v;for(network=[],netindex=new Int32Array(256),bias=new Int32Array(256),freq=new Int32Array(256),radpower=new Int32Array(32),i=0;i<256;i++)v=(i<<12)/256,network[i]=new Float64Array([v,v,v,0]),freq[i]=256,bias[i]=0}function unbiasnet(){for(var i=0;i<256;i++)network[i][0]>>=4,network[i][1]>>=4,network[i][2]>>=4,network[i][3]=i}function altersingle(alpha,i,b,g,r){network[i][0]-=alpha*(network[i][0]-b)/1024,network[i][1]-=alpha*(network[i][1]-g)/1024,network[i][2]-=alpha*(network[i][2]-r)/1024}function alterneigh(radius,i,b,g,r){for(var lo=Math.abs(i-radius),hi=Math.min(i+radius,256),j=i+1,k=i-1,m=1,p,a;j<hi||k>lo;)a=radpower[m++],j<hi&&((p=network[j++])[0]-=a*(p[0]-b)/(1<<18),p[1]-=a*(p[1]-g)/(1<<18),p[2]-=a*(p[2]-r)/(1<<18)),k>lo&&((p=network[k--])[0]-=a*(p[0]-b)/(1<<18),p[1]-=a*(p[1]-g)/(1<<18),p[2]-=a*(p[2]-r)/(1<<18))}function contest(b,g,r){var bestd=~(1<<31),bestbiasd=bestd,bestpos=-1,bestbiaspos=bestpos,i,n,dist,biasdist,betafreq;for(i=0;i<256;i++)n=network[i],(dist=Math.abs(n[0]-b)+Math.abs(n[1]-g)+Math.abs(n[2]-r))<bestd&&(bestd=dist,bestpos=i),(biasdist=dist-(bias[i]>>12))<bestbiasd&&(bestbiasd=biasdist,bestbiaspos=i),betafreq=freq[i]>>10,freq[i]-=betafreq,bias[i]+=betafreq<<10;return freq[bestpos]+=64,bias[bestpos]-=65536,bestbiaspos}function inxbuild(){var i,j,p,q,smallpos,smallval,previouscol=0,startpos=0;for(i=0;i<256;i++){for(smallpos=i,smallval=(p=network[i])[1],j=i+1;j<256;j++)(q=network[j])[1]<smallval&&(smallpos=j,smallval=q[1]);if(q=network[smallpos],i!=smallpos&&(j=q[0],q[0]=p[0],p[0]=j,j=q[1],q[1]=p[1],p[1]=j,j=q[2],q[2]=p[2],p[2]=j,j=q[3],q[3]=p[3],p[3]=j),smallval!=previouscol){for(netindex[previouscol]=startpos+i>>1,j=previouscol+1;j<smallval;j++)netindex[j]=i;previouscol=smallval,startpos=i}}for(netindex[previouscol]=startpos+255>>1,j=previouscol+1;j<256;j++)netindex[j]=255}function inxsearch(b,g,r){for(var a,p,dist,bestd=1e3,best=-1,i=netindex[g],j=i-1;i<256||j>=0;)i<256&&((dist=(p=network[i])[1]-g)>=bestd?i=256:(i++,dist<0&&(dist=-dist),(a=p[0]-b)<0&&(a=-a),(dist+=a)<bestd&&((a=p[2]-r)<0&&(a=-a),(dist+=a)<bestd&&(bestd=dist,best=p[3])))),j>=0&&((dist=g-(p=network[j])[1])>=bestd?j=-1:(j--,dist<0&&(dist=-dist),(a=p[0]-b)<0&&(a=-a),(dist+=a)<bestd&&((a=p[2]-r)<0&&(a=-a),(dist+=a)<bestd&&(bestd=dist,best=p[3]))));return best}function learn(){var i,lengthcount=pixels.length,alphadec=30+(samplefac-1)/3,samplepixels=lengthcount/(3*samplefac),delta=~~(samplepixels/100),alpha=1024,radius=2048,rad=radius>>6,step,b,g,r,j;for(rad<=1&&(rad=0),i=0;i<rad;i++)radpower[i]=alpha*(256*(rad*rad-i*i)/(rad*rad));lengthcount<1509?(samplefac=1,step=3):step=lengthcount%499!=0?1497:lengthcount%491!=0?1473:lengthcount%487!=0?1461:1509;var pix=0;for(i=0;i<samplepixels;)if(altersingle(alpha,j=contest(b=(255&pixels[pix])<<4,g=(255&pixels[pix+1])<<4,r=(255&pixels[pix+2])<<4),b,g,r),0!==rad&&alterneigh(rad,j,b,g,r),(pix+=step)>=lengthcount&&(pix-=lengthcount),0===delta&&(delta=1),++i%delta==0)for(alpha-=alpha/alphadec,(rad=(radius-=radius/30)>>6)<=1&&(rad=0),j=0;j<rad;j++)radpower[j]=alpha*(256*(rad*rad-j*j)/(rad*rad))}function buildColormap(){init(),learn(),unbiasnet(),inxbuild()}function getColormap(){for(var map=[],index=[],i=0;i<256;i++)index[network[i][3]]=i;for(var k=0,l=0;l<256;l++){var j=index[l];map[k++]=network[j][0],map[k++]=network[j][1],map[k++]=network[j][2]}return map}this.buildColormap=buildColormap,this.getColormap=getColormap,this.lookupRGB=inxsearch}module.exports=NeuQuant},{}],4:[function(require,module,exports){var GIFEncoder,renderFrame;GIFEncoder=require("./GIFEncoder.js"),renderFrame=function(frame){var encoder,page,stream,transfer;return encoder=new GIFEncoder(frame.width,frame.height),0===frame.index?encoder.writeHeader():encoder.firstFrame=!1,encoder.setTransparent(frame.transparent),encoder.setRepeat(frame.repeat),encoder.setDelay(frame.delay),encoder.setQuality(frame.quality),encoder.setDither(frame.dither),encoder.setGlobalPalette(frame.globalPalette),encoder.addFrame(frame.data),frame.last&&encoder.finish(),!0===frame.globalPalette&&(frame.globalPalette=encoder.getGlobalPalette()),stream=encoder.stream(),frame.data=stream.pages,frame.cursor=stream.cursor,frame.pageSize=stream.constructor.pageSize,frame.canTransfer?(transfer=function(){var i,len,ref,results;for(results=[],i=0,len=(ref=frame.data).length;i<len;i++)page=ref[i],results.push(page.buffer);return results}(),self.postMessage(frame,transfer)):self.postMessage(frame)},self.onmessage=function(event){return renderFrame(event.data)}},{"./GIFEncoder.js":1}]},{},[4]),function(){
/**
 * k-d Tree JavaScript - V 1.01
 *
 * https://github.com/ubilabs/kd-tree-javascript
 *
 * @author Mircea Pricop <pricop@ubilabs.net>, 2012
 * @author Martin Kleppe <kleppe@ubilabs.net>, 2012
 * @author Ubilabs http://ubilabs.net, 2012
 * @license MIT License <http://www.opensource.org/licenses/mit-license.php>
 */var root,factory;root=this,factory=function(exports){function Node(obj,dimension,parent){this.obj=obj,this.left=null,this.right=null,this.parent=parent,this.dimension=dimension}function kdTree(points,metric,dimensions){var self=this;function buildTree(points,depth,parent){var dim=depth%dimensions.length,median,node;return 0===points.length?null:1===points.length?new Node(points[0],dim,parent):(points.sort((function(a,b){return a[dimensions[dim]]-b[dimensions[dim]]})),(node=new Node(points[median=Math.floor(points.length/2)],dim,parent)).left=buildTree(points.slice(0,median),depth+1,node),node.right=buildTree(points.slice(median+1),depth+1,node),node)}function loadTree(data){function restoreParent(root){root.left&&(root.left.parent=root,restoreParent(root.left)),root.right&&(root.right.parent=root,restoreParent(root.right))}self.root=data,restoreParent(self.root)}Array.isArray(points)?this.root=buildTree(points,0,null):loadTree(points,metric,dimensions),this.toJSON=function(src){src||(src=this.root);var dest=new Node(src.obj,src.dimension,null);return src.left&&(dest.left=self.toJSON(src.left)),src.right&&(dest.right=self.toJSON(src.right)),dest},this.insert=function(point){function innerSearch(node,parent){if(null===node)return parent;var dimension=dimensions[node.dimension];return point[dimension]<node.obj[dimension]?innerSearch(node.left,node):innerSearch(node.right,node)}var insertPosition=innerSearch(this.root,null),newNode,dimension;null!==insertPosition?(newNode=new Node(point,(insertPosition.dimension+1)%dimensions.length,insertPosition),dimension=dimensions[insertPosition.dimension],point[dimension]<insertPosition.obj[dimension]?insertPosition.left=newNode:insertPosition.right=newNode):this.root=new Node(point,0,null)},this.remove=function(point){var node;function nodeSearch(node){if(null===node)return null;if(node.obj===point)return node;var dimension=dimensions[node.dimension];return point[dimension]<node.obj[dimension]?nodeSearch(node.left,node):nodeSearch(node.right,node)}function removeNode(node){var nextNode,nextObj,pDimension;function findMin(node,dim){var dimension,own,left,right,min;return null===node?null:(dimension=dimensions[dim],node.dimension===dim?null!==node.left?findMin(node.left,dim):node:(own=node.obj[dimension],left=findMin(node.left,dim),right=findMin(node.right,dim),min=node,null!==left&&left.obj[dimension]<own&&(min=left),null!==right&&right.obj[dimension]<min.obj[dimension]&&(min=right),min))}if(null===node.left&&null===node.right)return null===node.parent?void(self.root=null):(pDimension=dimensions[node.parent.dimension],void(node.obj[pDimension]<node.parent.obj[pDimension]?node.parent.left=null:node.parent.right=null));null!==node.right?(nextObj=(nextNode=findMin(node.right,node.dimension)).obj,removeNode(nextNode),node.obj=nextObj):(nextObj=(nextNode=findMin(node.left,node.dimension)).obj,removeNode(nextNode),node.right=node.left,node.left=null,node.obj=nextObj)}null!==(node=nodeSearch(self.root))&&removeNode(node)},this.nearest=function(point,maxNodes,maxDistance){var i,result,bestNodes;function nearestSearch(node){var bestChild,dimension=dimensions[node.dimension],ownDistance=metric(point,node.obj),linearPoint={},linearDistance,otherChild,i;function saveNode(node,distance){bestNodes.push([node,distance]),bestNodes.size()>maxNodes&&bestNodes.pop()}for(i=0;i<dimensions.length;i+=1)i===node.dimension?linearPoint[dimensions[i]]=point[dimensions[i]]:linearPoint[dimensions[i]]=node.obj[dimensions[i]];linearDistance=metric(linearPoint,node.obj),null!==node.right||null!==node.left?(nearestSearch(bestChild=null===node.right?node.left:null===node.left?node.right:point[dimension]<node.obj[dimension]?node.left:node.right),(bestNodes.size()<maxNodes||ownDistance<bestNodes.peek()[1])&&saveNode(node,ownDistance),(bestNodes.size()<maxNodes||Math.abs(linearDistance)<bestNodes.peek()[1])&&null!==(otherChild=bestChild===node.left?node.right:node.left)&&nearestSearch(otherChild)):(bestNodes.size()<maxNodes||ownDistance<bestNodes.peek()[1])&&saveNode(node,ownDistance)}if(bestNodes=new BinaryHeap((function(e){return-e[1]})),maxDistance)for(i=0;i<maxNodes;i+=1)bestNodes.push([null,maxDistance]);for(self.root&&nearestSearch(self.root),result=[],i=0;i<Math.min(maxNodes,bestNodes.content.length);i+=1)bestNodes.content[i][0]&&result.push([bestNodes.content[i][0].obj,bestNodes.content[i][1]]);return result},this.balanceFactor=function(){function height(node){return null===node?0:Math.max(height(node.left),height(node.right))+1}function count(node){return null===node?0:count(node.left)+count(node.right)+1}return height(self.root)/(Math.log(count(self.root))/Math.log(2))}}function BinaryHeap(scoreFunction){this.content=[],this.scoreFunction=scoreFunction}BinaryHeap.prototype={push:function(element){this.content.push(element),this.bubbleUp(this.content.length-1)},pop:function(){var result=this.content[0],end=this.content.pop();return this.content.length>0&&(this.content[0]=end,this.sinkDown(0)),result},peek:function(){return this.content[0]},remove:function(node){for(var len=this.content.length,i=0;i<len;i++)if(this.content[i]==node){var end=this.content.pop();return void(i!=len-1&&(this.content[i]=end,this.scoreFunction(end)<this.scoreFunction(node)?this.bubbleUp(i):this.sinkDown(i)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(n){for(var element=this.content[n];n>0;){var parentN=Math.floor((n+1)/2)-1,parent=this.content[parentN];if(!(this.scoreFunction(element)<this.scoreFunction(parent)))break;this.content[parentN]=element,this.content[n]=parent,n=parentN}},sinkDown:function(n){for(var length=this.content.length,element=this.content[n],elemScore=this.scoreFunction(element);;){var child2N=2*(n+1),child1N=child2N-1,swap=null;if(child1N<length){var child1=this.content[child1N],child1Score=this.scoreFunction(child1);child1Score<elemScore&&(swap=child1N)}if(child2N<length){var child2=this.content[child2N],child2Score;this.scoreFunction(child2)<(null==swap?elemScore:child1Score)&&(swap=child2N)}if(null==swap)break;this.content[n]=this.content[swap],this.content[swap]=element,n=swap}}},this.kdTree=kdTree,exports.kdTree=kdTree,exports.BinaryHeap=BinaryHeap},"function"==typeof define&&define.amd?define(["exports"],factory):"object"==typeof exports?factory(exports):factory(root.commonJsStrict={})}(),function(){if(!pv)var pv={map:function(array,f){var o={};return f?array.map((function(d,i){return o.index=i,f.call(o,d)})):array.slice()},naturalOrder:function(a,b){return a<b?-1:a>b?1:0},sum:function(array,f){var o={};return array.reduce(f?function(p,d,i){return o.index=i,p+f.call(o,d)}:function(p,d){return p+d},0)},max:function(array,f){return Math.max.apply(null,f?pv.map(array,f):array)}};var MMCQ=function(){var sigbits=5,rshift=3,maxIterations=1e3,fractByPopulations=.75;function getColorIndex(r,g,b){return(r<<10)+(g<<5)+b}function PQueue(comparator){var contents=[],sorted=!1;function sort(){contents.sort(comparator),sorted=!0}return{push:function(o){contents.push(o),sorted=!1},peek:function(index){return sorted||sort(),void 0===index&&(index=contents.length-1),contents[index]},pop:function(){return sorted||sort(),contents.pop()},size:function(){return contents.length},map:function(f){return contents.map(f)},debug:function(){return sorted||sort(),contents}}}function VBox(r1,r2,g1,g2,b1,b2,histo){var vbox=this;this.r1=r1,this.r2=r2,this.g1=g1,this.g2=g2,this.b1=b1,this.b2=b2,this.histo=histo}function CMap(){this.vboxes=new PQueue((function(a,b){return pv.naturalOrder(a.vbox.count()*a.vbox.volume(),b.vbox.count()*b.vbox.volume())}))}function getHisto(pixels){var histosize=32768,histo=new Array(32768),index,rval,gval,bval;return pixels.forEach((function(pixel){rval=pixel[0]>>3,gval=pixel[1]>>3,bval=pixel[2]>>3,index=getColorIndex(rval,gval,bval),histo[index]=(histo[index]||0)+1})),histo}function vboxFromPixels(pixels,histo){var rmin=1e6,rmax=0,gmin=1e6,gmax=0,bmin=1e6,bmax=0,rval,gval,bval;return pixels.forEach((function(pixel){rval=pixel[0]>>3,gval=pixel[1]>>3,bval=pixel[2]>>3,rval<rmin?rmin=rval:rval>rmax&&(rmax=rval),gval<gmin?gmin=gval:gval>gmax&&(gmax=gval),bval<bmin?bmin=bval:bval>bmax&&(bmax=bval)})),new VBox(rmin,rmax,gmin,gmax,bmin,bmax,histo)}function medianCutApply(histo,vbox){if(vbox.count()){var rw=vbox.r2-vbox.r1+1,gw=vbox.g2-vbox.g1+1,bw=vbox.b2-vbox.b1+1,maxw=pv.max([rw,gw,bw]);if(1==vbox.count())return[vbox.copy()];var total=0,partialsum=[],lookaheadsum=[],i,j,k,sum,index;if(maxw==rw)for(i=vbox.r1;i<=vbox.r2;i++){for(sum=0,j=vbox.g1;j<=vbox.g2;j++)for(k=vbox.b1;k<=vbox.b2;k++)sum+=histo[index=getColorIndex(i,j,k)]||0;total+=sum,partialsum[i]=total}else if(maxw==gw)for(i=vbox.g1;i<=vbox.g2;i++){for(sum=0,j=vbox.r1;j<=vbox.r2;j++)for(k=vbox.b1;k<=vbox.b2;k++)sum+=histo[index=getColorIndex(j,i,k)]||0;total+=sum,partialsum[i]=total}else for(i=vbox.b1;i<=vbox.b2;i++){for(sum=0,j=vbox.r1;j<=vbox.r2;j++)for(k=vbox.g1;k<=vbox.g2;k++)sum+=histo[index=getColorIndex(j,k,i)]||0;total+=sum,partialsum[i]=total}return partialsum.forEach((function(d,i){lookaheadsum[i]=total-d})),doCut(maxw==rw?"r":maxw==gw?"g":"b")}function doCut(color){var dim1=color+"1",dim2=color+"2",left,right,vbox1,vbox2,d2,count2=0;for(i=vbox[dim1];i<=vbox[dim2];i++)if(partialsum[i]>total/2){for(vbox1=vbox.copy(),vbox2=vbox.copy(),d2=(left=i-vbox[dim1])<=(right=vbox[dim2]-i)?Math.min(vbox[dim2]-1,~~(i+right/2)):Math.max(vbox[dim1],~~(i-1-left/2));!partialsum[d2];)d2++;for(count2=lookaheadsum[d2];!count2&&partialsum[d2-1];)count2=lookaheadsum[--d2];return vbox1[dim2]=d2,vbox2[dim1]=vbox1[dim2]+1,[vbox1,vbox2]}}}function quantize(pixels,maxcolors){if(!pixels.length||maxcolors<2||maxcolors>256)return!1;var histo=getHisto(pixels),histosize=32768,nColors=0;histo.forEach((function(){nColors++}));var vbox=vboxFromPixels(pixels,histo),pq=new PQueue((function(a,b){return pv.naturalOrder(a.count(),b.count())}));function iter(lh,target){for(var ncolors=1,niters=0,vbox;niters<1e3;)if((vbox=lh.pop()).count()){var vboxes=medianCutApply(histo,vbox),vbox1=vboxes[0],vbox2=vboxes[1];if(!vbox1)return;if(lh.push(vbox1),vbox2&&(lh.push(vbox2),ncolors++),ncolors>=target)return;if(niters++>1e3)return}else lh.push(vbox),niters++}pq.push(vbox),iter(pq,.75*maxcolors);for(var pq2=new PQueue((function(a,b){return pv.naturalOrder(a.count()*a.volume(),b.count()*b.volume())}));pq.size();)pq2.push(pq.pop());iter(pq2,maxcolors-pq2.size());for(var cmap=new CMap;pq2.size();)cmap.push(pq2.pop());return cmap}return VBox.prototype={volume:function(force){var vbox=this;return this._volume&&!force||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},count:function(force){var vbox=this,histo=this.histo;if(!this._count_set||force){var npix=0,i,j,k,index;for(i=this.r1;i<=this.r2;i++)for(j=this.g1;j<=this.g2;j++)for(k=this.b1;k<=this.b2;k++)npix+=histo[index=getColorIndex(i,j,k)]||0;this._count=npix,this._count_set=!0}return this._count},copy:function(){var vbox=this;return new VBox(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},avg:function(force){var vbox=this,histo=this.histo;if(!this._avg||force){var ntot=0,mult=8,rsum=0,gsum=0,bsum=0,hval,i,j,k,histoindex;for(i=this.r1;i<=this.r2;i++)for(j=this.g1;j<=this.g2;j++)for(k=this.b1;k<=this.b2;k++)ntot+=hval=histo[histoindex=getColorIndex(i,j,k)]||0,rsum+=hval*(i+.5)*8,gsum+=hval*(j+.5)*8,bsum+=hval*(k+.5)*8;this._avg=ntot?[~~(rsum/ntot),~~(gsum/ntot),~~(bsum/ntot)]:[~~(8*(this.r1+this.r2+1)/2),~~(8*(this.g1+this.g2+1)/2),~~(8*(this.b1+this.b2+1)/2)]}return this._avg},contains:function(pixel){var vbox=this,rval=pixel[0]>>3;return gval=pixel[1]>>3,bval=pixel[2]>>3,rval>=this.r1&&rval<=this.r2&&gval>=this.g1&&gval<=this.g2&&bval>=this.b1&&bval<=this.b2}},CMap.prototype={push:function(vbox){this.vboxes.push({vbox:vbox,color:vbox.avg()})},palette:function(){return this.vboxes.map((function(vb){return vb.color}))},size:function(){return this.vboxes.size()},map:function(color){for(var vboxes=this.vboxes,i=0;i<vboxes.size();i++)if(vboxes.peek(i).vbox.contains(color))return vboxes.peek(i).color;return this.nearest(color)},nearest:function(color){for(var vboxes=this.vboxes,d1,d2,pColor,i=0;i<vboxes.size();i++)((d2=Math.sqrt(Math.pow(color[0]-vboxes.peek(i).color[0],2)+Math.pow(color[1]-vboxes.peek(i).color[1],2)+Math.pow(color[2]-vboxes.peek(i).color[2],2)))<d1||void 0===d1)&&(d1=d2,pColor=vboxes.peek(i).color);return pColor},forcebw:function(){var vboxes=this.vboxes;vboxes.sort((function(a,b){return pv.naturalOrder(pv.sum(a.color),pv.sum(b.color))}));var lowest=vboxes[0].color;lowest[0]<5&&lowest[1]<5&&lowest[2]<5&&(vboxes[0].color=[0,0,0]);var idx=vboxes.length-1,highest=vboxes[idx].color;highest[0]>251&&highest[1]>251&&highest[2]>251&&(vboxes[idx].color=[255,255,255])}},{quantize:quantize}}()}(),function(){function createLabel(title,container){var label=createElement("div",null,"qs_label",container);return label.innerHTML=title,label}function createInput(type,id,className,parent){var input=createElement("input",id,className,parent);return input.type=type,input}function createElement(type,id,className,parent){var element=document.createElement(type);if(element)return element.id=id,className&&(element.className=className),parent&&parent.appendChild(element),element}function isIE(){return-1!=navigator.userAgent.indexOf("rv:11")||-1!=navigator.userAgent.indexOf("MSIE")}function isSafari(){var userAgent=navigator.userAgent.toLowerCase();return!(userAgent.indexOf("chrome")>-1||userAgent.indexOf("firefox")>-1||userAgent.indexOf("epiphany")>-1)&&userAgent.indexOf("safari/")>-1}function isEdge(){var userAgent;return navigator.userAgent.toLowerCase().indexOf("edge")>-1}var cssInjected=!1,css=".qs_main{background-color:#ffffff;text-align:left;position:absolute;width:160px;font:10px sans-serif;box-shadow:none;user-select:none;-webkit-user-select:none;color:#333333;border:1px solid #cccccc}.qs_content{background-color:#ffffff;overflow-y:auto}.qs_title_bar{background-color:#ffffff;user-select:none;-webkit-user-select:none;cursor:pointer;padding:5px;font-weight:bold;border:none;color:#333333}.qs_container{margin:2px;padding:2px;background-color:#ffffff;border:1px solid #cccccc;position:relative}.qs_container_selected{border:1px solid #666666;background-color:#ffffff}.qs_range{-webkit-appearance:none;-moz-appearance:none;width:100%;height:14px;padding:0;margin:0;background-color:transparent;border:none;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.qs_range:focus{outline:none;border:none}.qs_range::-webkit-slider-runnable-track{width:100%;height:12px;cursor:pointer;background:#eeeeee;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.qs_range:focus::-webkit-slider-runnable-track{background:#eeeeee}.qs_range::-webkit-slider-thumb{-webkit-appearance:none;height:12px;width:12px;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;background:#aaaaaa;cursor:pointer;margin-top:0}.qs_range::-moz-range-track{width:100%;height:12px;cursor:pointer;background:#eeeeee;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.qs_range::-moz-range-thumb{height:12px;width:12px;border:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;background:#aaaaaa;cursor:pointer}.qs_range::-ms-track{width:100%;height:12px;cursor:pointer;visibility:hidden;background:transparent}.qs_range::-ms-thumb{height:12px;width:12px;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;background:#aaaaaa;cursor:pointer;border:none}.qs_range::-ms-fill-lower{background:#eeeeee;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.qs_range:focus::-ms-fill-lower{background:#eeeeee}.qs_range::-ms-fill-upper{background:#eeeeee;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.qs_range:focus::-ms-fill-upper{background:#eeeeee}.qs_button{background-color:#ffffff;color:#333333;height:20px;border:1px solid #cccccc;font:10px sans-serif}.qs_button:active{background-color:#cccccc;border:1px solid #cccccc}.qs_button:focus{border:1px solid #cccccc;outline:none}.qs_checkbox{cursor:pointer;display:inline}.qs_checkbox input{position:absolute;left:-99999px}.qs_checkbox span{height:16px;width:100%;display:block;text-indent:20px;background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAALklEQVQ4T2OcOXPmfwYKACPIgLS0NLKMmDVrFsOoAaNhMJoOGBioFwZkZUWoJgApdFaxjUM1YwAAAABJRU5ErkJggg==') no-repeat}.qs_checkbox input:checked+span{background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvElEQVQ4T63Tyw2EIBAA0OFKBxBL40wDRovAUACcKc1IB1zZDAkG18GYZTmSmafzgTnnMgwchoDWGlJKheGcP3JtnPceCqCUAmttSZznuYtgchsXQrgC+77DNE0kUpPbmBOoJaBOIVQylnqWgAAeKhDve/AN+EaklJBzhhgjWRoJVGTbNjiOowAIret6a+4jYIwpX8aDwLIs74C2D0IIYIyVP6Gm898m9kbVm85ljHUTf16k4VUefkwDrxk+zoUEwCt0GbUAAAAASUVORK5CYII=') no-repeat}.qs_checkbox_label{position:absolute;top:5px;left:24px}.qs_label{margin-bottom:3px;user-select:none;-webkit-user-select:none;cursor:default;font:10px sans-serif}.qs_text_input{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%;padding:0 0 0 5px;height:18px;border:none;background-color:#eeeeee;color:#333333;font-size:10px}.qs_text_input:focus{outline:none;background:#eeeeee;border:none}.qs_select{background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAApklEQVRIS+2UwQ2AIAxF2wEYgguMAaPDGHBhCAbAlMQEjbYkxls5wrcPXhtxjDHgx4UKkOyqIskQqKLvinrvYIx5LMSdnR+wPSilQM4ZQgjgvb9AuLM1yAJSSlBrnfkVchanfeccxBhfVYlTdIdQJXrVTnHKiAAKrRD6+SKiePOtHqzvJkhrbW5Za1kt2z24i6WpofU2VU+N2FIkDjsTUIBoTxWJig7pMJi50zaHaQAAAABJRU5ErkJggg==') no-repeat right #ffffff;-webkit-appearance:none;-moz-appearance:none;appearance:none;color:#333333;width:100%;height:18px;border:1px solid #cccccc;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;padding:0 5px;-moz-outline:none;font-size:12px}.qs_select option{font-size:12px}.qs_select::-ms-expand{display:none}.qs_select:focus{outline:none}.qs_number{height:18px}.qs_image{width:100%}.qs_progress{width:100%;height:12px;background-color:#eeeeee;border:1px solid #cccccc;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.qs_progress_value{height:100%;background-color:#aaaaaa}.qs_textarea{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;resize:vertical;width:100%;padding:3px 5px;border:none;background-color:#eeeeee;color:#333333;font-size:10px}.qs_textarea:focus{outline:none;background:#eeeeee;border:none}.qs_color{position:absolute;left:-999999px}.qs_color_label{width:100%;height:20px;display:block;border:1px solid #cccccc;cursor:pointer;padding:0 0 0 5px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.qs_file_chooser{position:absolute;left:-999999px}.qs_file_chooser_label{background-color:#ffffff;color:#333333;height:20px;border:1px solid #cccccc;font:10px sans-serif;width:100%;display:block;cursor:pointer;padding:3px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}";function injectCSS(){var styleTag=document.createElement("style");styleTag.innerText=css,document.head.appendChild(styleTag),cssInjected=!0}var QuickSettings={_version:"3.0.2",_topZ:1,_panel:null,_titleBar:null,_content:null,_startX:0,_startY:0,_hidden:!1,_collapsed:!1,_controls:null,_keyCode:-1,_draggable:!0,_collapsible:!0,_globalChangeHandler:null,useExtStyleSheet:function(){cssInjected=!0},create:function(x,y,title,parent){var obj=Object.create(this);return obj._init(x,y,title,parent),obj},destroy:function(){for(var prop in this._panel.parentElement&&this._panel.parentElement.removeChild(this._panel),this)this[prop]=null},_init:function(x,y,title,parent){cssInjected||injectCSS(),this._bindHandlers(),this._createPanel(x,y,parent),this._createTitleBar(title||"QuickSettings"),this._createContent()},_bindHandlers:function(){this._startDrag=this._startDrag.bind(this),this._drag=this._drag.bind(this),this._endDrag=this._endDrag.bind(this),this._doubleClickTitle=this._doubleClickTitle.bind(this),this._onKeyUp=this._onKeyUp.bind(this)},getValuesAsJSON:function(asString){var json={};for(var title in this._controls)this._controls[title].getValue&&(json[title]=this._controls[title].getValue());return asString&&(json=JSON.stringify(json)),json},setValuesFromJSON:function(json){for(var title in"string"==typeof json&&(json=JSON.parse(json)),json)this._controls[title]&&this._controls[title].setValue&&this._controls[title].setValue(json[title]);return this},saveInLocalStorage:function(name){return this._localStorageName=name,this._readFromLocalStorage(name),this},clearLocalStorage:function(name){return localStorage.removeItem(name),this},_saveInLocalStorage:function(name){localStorage.setItem(name,this.getValuesAsJSON(!0))},_readFromLocalStorage:function(name){var str=localStorage.getItem(name);str&&this.setValuesFromJSON(str)},_createPanel:function(x,y,parent){this._panel=createElement("div",null,"qs_main",parent||document.body),this._panel.style.zIndex=++QuickSettings._topZ,this.setPosition(x||0,y||0),this._controls={}},_createTitleBar:function(text){this._titleBar=createElement("div",null,"qs_title_bar",this._panel),this._titleBar.textContent=text,this._titleBar.addEventListener("mousedown",this._startDrag),this._titleBar.addEventListener("dblclick",this._doubleClickTitle)},_createContent:function(){this._content=createElement("div",null,"qs_content",this._panel)},_createContainer:function(){var container=createElement("div",null,"qs_container");return container.addEventListener("focus",(function(){this.className+=" qs_container_selected"}),!0),container.addEventListener("blur",(function(){var index=this.className.indexOf(" qs_container_selected");index>-1&&(this.className=this.className.substr(0,index))}),!0),this._content.appendChild(container),container},setPosition:function(x,y){return this._panel.style.left=x+"px",this._panel.style.top=Math.max(y,0)+"px",this},setSize:function(w,h){return this._panel.style.width=w+"px",this._content.style.width=w+"px",this._content.style.height=h-this._titleBar.offsetHeight+"px",this},setWidth:function(w){return this._panel.style.width=w+"px",this._content.style.width=w+"px",this},setHeight:function(h){return this._content.style.height=h-this._titleBar.offsetHeight+"px",this},setDraggable:function(draggable){return this._draggable=draggable,this._draggable||this._collapsible?this._titleBar.style.cursor="pointer":this._titleBar.style.cursor="default",this},_startDrag:function(event){this._draggable&&(this._panel.style.zIndex=++QuickSettings._topZ,document.addEventListener("mousemove",this._drag),document.addEventListener("mouseup",this._endDrag),this._startX=event.clientX,this._startY=event.clientY),event.preventDefault()},_drag:function(event){var x=parseInt(this._panel.style.left),y=parseInt(this._panel.style.top),mouseX=event.clientX,mouseY=event.clientY;this.setPosition(x+mouseX-this._startX,y+mouseY-this._startY),this._startX=mouseX,this._startY=mouseY,event.preventDefault()},_endDrag:function(event){document.removeEventListener("mousemove",this._drag),document.removeEventListener("mouseup",this._endDrag),event.preventDefault()},setGlobalChangeHandler:function(handler){return this._globalChangeHandler=handler,this},_callGCH:function(title){this._localStorageName&&this._saveInLocalStorage(this._localStorageName),this._globalChangeHandler&&this._globalChangeHandler(title)},hide:function(){return this._panel.style.visibility="hidden",this._hidden=!0,this},show:function(){return this._panel.style.visibility="visible",this._panel.style.zIndex=++QuickSettings._topZ,this._hidden=!1,this},toggleVisibility:function(){return this._hidden?this.show():this.hide(),this},setCollapsible:function(collapsible){return this._collapsible=collapsible,this._draggable||this._collapsible?this._titleBar.style.cursor="pointer":this._titleBar.style.cursor="default",this},collapse:function(){return this._panel.removeChild(this._content),this._collapsed=!0,this},expand:function(){return this._panel.appendChild(this._content),this._collapsed=!1,this},toggleCollapsed:function(){return this._collapsed?this.expand():this.collapse(),this},setKey:function(char){return this._keyCode=char.toUpperCase().charCodeAt(0),document.addEventListener("keyup",this._onKeyUp),this},_onKeyUp:function(event){event.keyCode===this._keyCode&&["INPUT","SELECT","TEXTAREA"].indexOf(event.target.tagName)<0&&this.toggleVisibility()},_doubleClickTitle:function(){this._collapsible&&this.toggleCollapsed()},removeControl:function(title){if(this._controls[title])var container=this._controls[title].container;return container&&container.parentElement&&container.parentElement.removeChild(container),this._controls[title]=null,this},enableControl:function(title){return this._controls[title]&&(this._controls[title].control.disabled=!1),this},disableControl:function(title){return this._controls[title]&&(this._controls[title].control.disabled=!0),this},hideControl:function(title){return this._controls[title]&&(this._controls[title].container.style.display="none"),this},showControl:function(title){return this._controls[title]&&(this._controls[title].container.style.display="block"),this},overrideStyle:function(title,style,value){return this._controls[title]&&(this._controls[title].control.style[style]=value),this},hideTitle:function(title){var label=this._controls[title].label;return label&&(label.style.display="none"),this},showTitle:function(title){var label=this._controls[title].label;return label&&(label.style.display="block"),this},hideAllTitles:function(){for(var title in this._controls){var label=this._controls[title].label;label&&(label.style.display="none")}return this},showAllTitles:function(){for(var title in this._controls){var label=this._controls[title].label;label&&(label.style.display="block")}return this},getValue:function(title){return this._controls[title].getValue()},setValue:function(title,value){return this._controls[title].setValue(value),this._callGCH(title),this},addBoolean:function(title,value,callback){var container=this._createContainer(),label=createElement("label",null,"qs_checkbox_label",container);label.textContent=title,label.setAttribute("for",title);var checkbox=createElement("label",null,"qs_checkbox",container);checkbox.setAttribute("for",title);var input=createInput("checkbox",title,null,checkbox);input.checked=value;var span=createElement("span",null,null,checkbox);this._controls[title]={container:container,control:input,getValue:function(){return this.control.checked},setValue:function(value){this.control.checked=value,callback&&callback(value)}};var self=this;return input.addEventListener("change",(function(){callback&&callback(input.checked),self._callGCH(title)})),this},bindBoolean:function(title,value,object){return this.addBoolean(title,value,(function(value){object[title]=value}))},addButton:function(title,callback){var container=this._createContainer(),button=createInput("button",title,"qs_button",container);button.value=title,this._controls[title]={container:container,control:button};var self=this;return button.addEventListener("click",(function(){callback&&callback(button),self._callGCH(title)})),this},addColor:function(title,color,callback){if(isSafari()||isEdge()||isIE())return this.addText(title,color,callback);var container=this._createContainer(),label=createLabel("<b>"+title+":</b> "+color,container),colorInput=createInput("color",title,"qs_color",container);colorInput.value=color||"#ff0000";var colorLabel=createElement("label",null,"qs_color_label",container);colorLabel.setAttribute("for",title),colorLabel.style.backgroundColor=colorInput.value,this._controls[title]={container:container,control:colorInput,colorLabel:colorLabel,label:label,title:title,getValue:function(){return this.control.value},setValue:function(value){this.control.value=value,this.colorLabel.style.backgroundColor=colorInput.value,this.label.innerHTML="<b>"+this.title+":</b> "+this.control.value,callback&&callback(value)}};var self=this;return colorInput.addEventListener("input",(function(){label.innerHTML="<b>"+title+":</b> "+colorInput.value,colorLabel.style.backgroundColor=colorInput.value,callback&&callback(colorInput.value),self._callGCH(title)})),this},bindColor:function(title,color,object){return this.addColor(title,color,(function(value){object[title]=value}))},addDate:function(title,date,callback){var dateStr;if(date instanceof Date){var year=date.getFullYear(),month=date.getMonth()+1,day;month<10&&(month="0"+month),dateStr=year+"-"+month+"-"+date.getDate()}else dateStr=date;if(isIE())return this.addText(title,dateStr,callback);var container=this._createContainer(),label=createLabel("<b>"+title+"</b>",container),dateInput=createInput("date",title,"qs_text_input",container);dateInput.value=dateStr||"",this._controls[title]={container:container,control:dateInput,label:label,getValue:function(){return this.control.value},setValue:function(date){var dateStr;if(date instanceof Date){var year=date.getFullYear(),month=date.getMonth()+1;month<10&&(month="0"+month);var day=date.getDate();day<10&&(day="0"+day),dateStr=year+"-"+month+"-"+day}else dateStr=date;this.control.value=dateStr||"",callback&&callback(dateStr)}};var self=this;return dateInput.addEventListener("input",(function(){callback&&callback(dateInput.value),self._callGCH(title)})),this},bindDate:function(title,date,object){return this.addDate(title,date,(function(value){object[title]=value}))},addDropDown:function(title,items,callback){for(var container=this._createContainer(),label=createLabel("<b>"+title+"</b>",container),select=createElement("select",null,"qs_select",container),i=0;i<items.length;i++){var option=createElement("option"),item=items[i];item.label?(option.value=item.value,option.innerText=item.label):(option.label=item,option.innerText=item),select.add(option)}var self=this;return select.addEventListener("change",(function(){var index=select.selectedIndex,options=select.options;callback&&callback({index:index,label:options[index].label,value:items[index].value||items[index]}),self._callGCH(title)})),this._controls[title]={container:container,control:select,label:label,getValue:function(){var index=this.control.selectedIndex;return{index:index,label:this.control.options[index].label,value:items[index].value||items[index]}},setValue:function(value){var index;index=null!=value.index?value.index:value;var options=this.control.options;this.control.selectedIndex=index,callback&&callback({index:index,label:options[index].label,value:items[index].value||items[index]})}},this},bindDropDown:function(title,items,object){return this.addDropDown(title,items,(function(value){object[title]=value.value}))},addElement:function(title,element){var container=this._createContainer(),label=createLabel("<b>"+title+"</b>",container);return container.appendChild(element),this._controls[title]={container:container,label:label},this},addFileChooser:function(title,labelStr,filter,callback){var container=this._createContainer(),label=createLabel("<b>"+title+"</b>",container),fileChooser=createInput("file",title,"qs_file_chooser",container);filter&&(fileChooser.accept=filter);var fcLabel=createElement("label",null,"qs_file_chooser_label",container);fcLabel.setAttribute("for",title),fcLabel.textContent=labelStr||"Choose a file...",this._controls[title]={container:container,control:fileChooser,label:label,getValue:function(){return this.control.files[0]}};var self=this;return fileChooser.addEventListener("change",(function(){fileChooser.files&&fileChooser.files.length&&(fcLabel.textContent=fileChooser.files[0].name,callback&&callback(fileChooser.files[0]),self._callGCH(title))})),this},addHTML:function(title,html){var container=this._createContainer(),label=createLabel("<b>"+title+":</b> ",container),div=createElement("div",null,null,container);return div.innerHTML=html,this._controls[title]={container:container,label:label,control:div,getValue:function(){return this.control.innerHTML},setValue:function(html){this.control.innerHTML=html}},this},addImage:function(title,imageURL,callback){var container=this._createContainer(),label=createLabel("<b>"+title+"</b>",container);return img=createElement("img",null,"qs_image",container),img.src=imageURL,this._controls[title]={container:container,control:img,label:label,getValue:function(){return this.control.src},setValue:function(url){this.control.src=url,callback&&img.addEventListener("load",(function _onLoad(){img.removeEventListener("load",_onLoad),callback(url)}))}},this},addRange:function(title,min,max,value,step,callback){return this._addNumber("range",title,min,max,value,step,callback)},addNumber:function(title,min,max,value,step,callback){return this._addNumber("number",title,min,max,value,step,callback)},_addNumber:function(type,title,min,max,value,step,callback){var container=this._createContainer(),label=createLabel("",container),className,input=createInput(type,title,"range"===type?"qs_range":"qs_text_input qs_number",container);input.min=min||0,input.max=max||100,input.step=step||1,input.value=value||0,label.innerHTML="<b>"+title+":</b> "+input.value,this._controls[title]={container:container,control:input,label:label,title:title,callback:callback,getValue:function(){return parseFloat(this.control.value)},setValue:function(value){this.control.value=value,this.label.innerHTML="<b>"+this.title+":</b> "+this.control.value,callback&&callback(parseFloat(value))}};var eventName="input";"range"===type&&isIE()&&(eventName="change");var self=this;return input.addEventListener(eventName,(function(){label.innerHTML="<b>"+title+":</b> "+input.value,callback&&callback(parseFloat(input.value)),self._callGCH(title)})),this},bindRange:function(title,min,max,value,step,object){return this.addRange(title,min,max,value,step,(function(value){object[title]=value}))},bindNumber:function(title,min,max,value,step,object){return this.addNumber(title,min,max,value,step,(function(value){object[title]=value}))},setRangeParameters:function(title,min,max,step){return this.setNumberParameters(title,min,max,step)},setNumberParameters:function(title,min,max,step){var control=this._controls[title],origValue=control.control.value;return control.control.min=min,control.control.max=max,control.control.step=step,control.control.value!==origValue&&control.callback&&control.callback(control.control.value),this},addPassword:function(title,text,callback){return this._addText("password",title,text,callback)},bindPassword:function(title,text,object){return this.addPassword(title,text,(function(value){object[title]=value}))},addProgressBar:function(title,max,value,valueDisplay){var container=this._createContainer(),label=createLabel("",container),progressDiv=createElement("div",null,"qs_progress",container),valueDiv=createElement("div",null,"qs_progress_value",progressDiv);return valueDiv.style.width=value/max*100+"%",label.innerHTML="numbers"===valueDisplay?"<b>"+title+":</b> "+value+" / "+max:"percent"===valueDisplay?"<b>"+title+":</b> "+Math.round(value/max*100)+"%":"<b>"+title+"</b>",this._controls[title]={container:container,control:progressDiv,valueDiv:valueDiv,valueDisplay:valueDisplay,label:label,value:value,max:max,title:title,getValue:function(){return this.value},setValue:function(value){this.value=Math.max(0,Math.min(value,this.max)),this.valueDiv.style.width=this.value/this.max*100+"%","numbers"===this.valueDisplay?this.label.innerHTML="<b>"+this.title+":</b> "+this.value+" / "+this.max:"percent"===this.valueDisplay&&(this.label.innerHTML="<b>"+this.title+":</b> "+Math.round(this.value/this.max*100)+"%")}},this},setProgressMax:function(title,max){var control=this._controls[title];return control.max=max,control.value=Math.min(control.value,control.max),control.valueDiv.style.width=control.value/control.max*100+"%","numbers"===control.valueDisplay?control.label.innerHTML="<b>"+control.title+":</b> "+control.value+" / "+control.max:"percent"===control.valueDisplay?control.label.innerHTML="<b>"+control.title+":</b> "+Math.round(control.value/control.max*100)+"%":control.label.innerHTML="<b>"+control.title+"</b>",this},addText:function(title,text,callback){return this._addText("text",title,text,callback)},_addText:function(type,title,text,callback){var container=this._createContainer(),label=createLabel("<b>"+title+"</b>",container),textInput;"textarea"===type?(textInput=createElement("textarea",title,"qs_textarea",container)).rows=5:textInput=createInput(type,title,"qs_text_input",container),textInput.value=text||"",this._controls[title]={container:container,control:textInput,label:label,getValue:function(){return this.control.value},setValue:function(text){this.control.value=text,callback&&callback(text)}};var self=this;return textInput.addEventListener("input",(function(){callback&&callback(textInput.value),self._callGCH(title)})),this},bindText:function(title,text,object){return this.addText(title,text,(function(value){object[title]=value}))},addTextArea:function(title,text,callback){return this._addText("textarea",title,text,callback)},setTextAreaRows:function(title,rows){return this._controls[title].control.rows=rows,this},bindTextArea:function(title,text,object){return this.addTextArea(title,text,(function(value){object[title]=value}))},addTime:function(title,time,callback){var timeStr;if(time instanceof Date){var hours=time.getHours();hours<10&&(hours="0"+hours);var minutes=time.getMinutes();minutes<10&&(minutes="0"+minutes);var seconds=time.getSeconds();seconds<10&&(seconds="0"+seconds),timeStr=hours+":"+minutes+":"+seconds}else timeStr=time;if(isIE())return this.addText(title,timeStr,callback);var container=this._createContainer(),label=createLabel("<b>"+title+"</b>",container),timeInput=createInput("time",title,"qs_text_input",container);timeInput.value=timeStr||"",this._controls[title]={container:container,control:timeInput,label:label,getValue:function(){return this.control.value},setValue:function(time){var timeStr;if(time instanceof Date){var hours=time.getHours();hours<10&&(hours="0"+hours);var minutes=time.getMinutes();minutes<10&&(minutes="0"+minutes);var seconds=time.getSeconds();seconds<10&&(seconds="0"+seconds),timeStr=hours+":"+minutes+":"+seconds}else timeStr=time;this.control.value=timeStr||"",callback&&callback(timeStr)}};var self=this;return timeInput.addEventListener("input",(function(){callback&&callback(timeInput.value),self._callGCH(title)})),this},bindTime:function(title,time,object){return this.addTime(title,time,(function(value){object[title]=value}))}};"object"==typeof exports&&"object"==typeof module?module.exports=QuickSettings:"function"==typeof define&&define.amd?define(QuickSettings):window.QuickSettings=QuickSettings}(),function(){var Treemap={};!function(){"use strict";Treemap.generate=function(){function Container(xoffset,yoffset,width,height){this.xoffset=xoffset,this.yoffset=yoffset,this.height=height,this.width=width,this.shortestEdge=function(){return Math.min(this.height,this.width)},this.getCoordinates=function(row){var coordinates=[],subxoffset=this.xoffset,subyoffset=this.yoffset,areawidth=sumArray(row)/this.height,areaheight=sumArray(row)/this.width,i;if(this.width>=this.height)for(i=0;i<row.length;i++)coordinates.push([subxoffset,subyoffset,subxoffset+areawidth,subyoffset+row[i]/areawidth]),subyoffset+=row[i]/areawidth;else for(i=0;i<row.length;i++)coordinates.push([subxoffset,subyoffset,subxoffset+row[i]/areaheight,subyoffset+areaheight]),subxoffset+=row[i]/areaheight;return coordinates},this.cutArea=function(area){var newcontainer;if(this.width>=this.height){var areawidth=area/this.height,newwidth=this.width-areawidth;newcontainer=new Container(this.xoffset+areawidth,this.yoffset,newwidth,this.height)}else{var areaheight=area/this.width,newheight=this.height-areaheight;newcontainer=new Container(this.xoffset,this.yoffset+areaheight,this.width,newheight)}return newcontainer}}function normalize(data,area){var normalizeddata=[],sum,multiplier=area/sumArray(data),i;for(i=0;i<data.length;i++)normalizeddata[i]=data[i]*multiplier;return normalizeddata}function treemapMultidimensional(data,width,height,xoffset,yoffset){xoffset=void 0===xoffset?0:xoffset,yoffset=void 0===yoffset?0:yoffset;var mergeddata=[],mergedtreemap,results=[],i;if(isArray(data[0])){for(i=0;i<data.length;i++)mergeddata[i]=sumMultidimensionalArray(data[i]);for(mergedtreemap=treemapSingledimensional(mergeddata,width,height,xoffset,yoffset),i=0;i<data.length;i++)results.push(treemapMultidimensional(data[i],mergedtreemap[i][2]-mergedtreemap[i][0],mergedtreemap[i][3]-mergedtreemap[i][1],mergedtreemap[i][0],mergedtreemap[i][1]))}else results=treemapSingledimensional(data,width,height,xoffset,yoffset);return results}function treemapSingledimensional(data,width,height,xoffset,yoffset){var rawtreemap;return xoffset=void 0===xoffset?0:xoffset,yoffset=void 0===yoffset?0:yoffset,flattenTreemap(squarify(normalize(data,width*height),[],new Container(xoffset,yoffset,width,height),[]))}function flattenTreemap(rawtreemap){var flattreemap=[],i,j;for(i=0;i<rawtreemap.length;i++)for(j=0;j<rawtreemap[i].length;j++)flattreemap.push(rawtreemap[i][j]);return flattreemap}function squarify(data,currentrow,container,stack){var length,nextdatapoint,newcontainer;if(0!==data.length)return length=container.shortestEdge(),improvesRatio(currentrow,nextdatapoint=data[0],length)?(currentrow.push(nextdatapoint),squarify(data.slice(1),currentrow,container,stack)):(newcontainer=container.cutArea(sumArray(currentrow),stack),stack.push(container.getCoordinates(currentrow)),squarify(data,[],newcontainer,stack)),stack;stack.push(container.getCoordinates(currentrow))}function improvesRatio(currentrow,nextnode,length){var newrow,currentratio,newratio;return 0===currentrow.length||((newrow=currentrow.slice()).push(nextnode),calculateRatio(currentrow,length)>=calculateRatio(newrow,length))}function calculateRatio(row,length){var min=Math.min.apply(Math,row),max=Math.max.apply(Math,row),sum=sumArray(row);return Math.max(Math.pow(length,2)*max/Math.pow(sum,2),Math.pow(sum,2)/(Math.pow(length,2)*min))}function isArray(arr){return arr&&arr.constructor===Array}function sumArray(arr){var sum=0,i;for(i=0;i<arr.length;i++)sum+=arr[i];return sum}function sumMultidimensionalArray(arr){var i,total=0;if(isArray(arr[0]))for(i=0;i<arr.length;i++)total+=sumMultidimensionalArray(arr[i]);else total=sumArray(arr);return total}return treemapMultidimensional}()}()}();